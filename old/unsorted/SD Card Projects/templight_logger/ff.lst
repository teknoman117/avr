GAS LISTING /tmp/ccPugNTh.s 			page 1


   1               		.file	"ff.c"
   2               	__SREG__ = 0x3f
   3               	__SP_H__ = 0x3e
   4               	__SP_L__ = 0x3d
   5               	__CCP__  = 0x34
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  10               		.stabs	"/home/robotdude/Projects/AVR_Projects/templight_logger/",100,0,2,.Ltext0
  11               		.stabs	"ff.c",100,0,2,.Ltext0
  12               		.text
  13               	.Ltext0:
  14               		.stabs	"gcc2_compiled.",60,0,0,0
  15               		.stabs	"int:t(0,1)=r(0,1);-32768;32767;",128,0,1,0
  16               		.stabs	"char:t(0,2)=@s8;r(0,2);0;255;",128,0,1,0
  17               		.stabs	"long int:t(0,3)=@s32;r(0,3);020000000000;017777777777;",128,0,1,0
  18               		.stabs	"unsigned int:t(0,4)=r(0,4);0;0177777;",128,0,1,0
  19               		.stabs	"long unsigned int:t(0,5)=@s32;r(0,5);0;037777777777;",128,0,1,0
  20               		.stabs	"long long int:t(0,6)=@s64;r(0,6);01000000000000000000000;0777777777777777777777;",128,0,1,
  21               		.stabs	"long long unsigned int:t(0,7)=@s64;r(0,7);0;01777777777777777777777;",128,0,1,0
  22               		.stabs	"short int:t(0,8)=r(0,8);-32768;32767;",128,0,1,0
  23               		.stabs	"short unsigned int:t(0,9)=r(0,9);0;0177777;",128,0,1,0
  24               		.stabs	"signed char:t(0,10)=@s8;r(0,10);-128;127;",128,0,1,0
  25               		.stabs	"unsigned char:t(0,11)=@s8;r(0,11);0;255;",128,0,1,0
  26               		.stabs	"float:t(0,12)=r(0,1);4;0;",128,0,1,0
  27               		.stabs	"double:t(0,13)=r(0,1);4;0;",128,0,1,0
  28               		.stabs	"long double:t(0,14)=r(0,1);4;0;",128,0,1,0
  29               		.stabs	"void:t(0,15)=(0,15)",128,0,1,0
  30               		.stabs	"ff.h",130,0,0,0
  31               		.stabs	"integer.h",130,0,0,0
  32               		.stabs	"INT:t(2,1)=(0,1)",128,0,12,0
  33               		.stabs	"UINT:t(2,2)=(0,4)",128,0,13,0
  34               		.stabs	"CHAR:t(2,3)=(0,10)",128,0,16,0
  35               		.stabs	"UCHAR:t(2,4)=(0,11)",128,0,17,0
  36               		.stabs	"BYTE:t(2,5)=(0,11)",128,0,18,0
  37               		.stabs	"SHORT:t(2,6)=(0,8)",128,0,21,0
  38               		.stabs	"USHORT:t(2,7)=(0,9)",128,0,22,0
  39               		.stabs	"WORD:t(2,8)=(0,9)",128,0,23,0
  40               		.stabs	"WCHAR:t(2,9)=(0,9)",128,0,24,0
  41               		.stabs	"LONG:t(2,10)=(0,3)",128,0,27,0
  42               		.stabs	"ULONG:t(2,11)=(0,5)",128,0,28,0
  43               		.stabs	"DWORD:t(2,12)=(0,5)",128,0,29,0
  44               		.stabs	" :T(2,13)=@s8;eFALSE:0,TRUE:1,;",128,0,0,0
  45               		.stabs	"BOOL:t(2,14)=(2,13)",128,0,32,0
  46               		.stabn	162,0,0,0
  47               		.stabs	"XCHAR:t(1,1)=(0,2)",128,0,293,0
  48               		.stabs	"_FATFS_:T(1,2)=s558fs_type:(2,5),0,8;drive:(2,5),8,8;csize:(2,5),16,8;n_fats:(2,5),24,8;wf
  49               		.stabs	"FATFS:t(1,5)=(1,2)",128,0,330,0
  50               		.stabs	"_DIR_:T(1,6)=s22fs:(1,7)=*(1,5),0,16;id:(2,8),16,16;index:(2,8),32,16;sclust:(2,12),48,32;
  51               		.stabs	"DIR:t(1,9)=(1,6)",128,0,349,0
  52               		.stabs	"_FIL_:T(1,10)=s32fs:(1,7),0,16;id:(2,8),16,16;flag:(2,5),32,8;csect:(2,5),40,8;fptr:(2,12)
  53               		.stabs	"FIL:t(1,11)=(1,10)",128,0,372,0
  54               		.stabs	"_FILINFO_:T(1,12)=s22fsize:(2,12),0,32;fdate:(2,8),32,16;ftime:(2,8),48,16;fattrib:(2,5),6
  55               		.stabs	"FILINFO:t(1,14)=(1,12)",128,0,388,0
  56               		.stabs	" :T(1,15)=@s8;eFR_OK:0,FR_DISK_ERR:1,FR_INT_ERR:2,FR_NOT_READY:3,FR_NO_FILE:4,FR_NO_PATH:5
  57               		.stabs	"FRESULT:t(1,16)=(1,15)",128,0,411,0
GAS LISTING /tmp/ccPugNTh.s 			page 2


  58               		.stabn	162,0,0,0
  59               		.stabs	"diskio.h",130,0,0,0
  60               		.stabs	"DSTATUS:t(3,1)=(2,5)",128,0,14,0
  61               		.stabs	" :T(3,2)=@s8;eRES_OK:0,RES_ERROR:1,RES_WRPRT:2,RES_NOTRDY:3,RES_PARERR:4,;",128,0,0,0
  62               		.stabs	"DRESULT:t(3,3)=(3,2)",128,0,23,0
  63               		.stabn	162,0,0,0
  64               		.stabs	"/usr/lib/gcc/avr/4.3.3/include/stdarg.h",130,0,0,0
  65               		.stabs	"__gnuc_va_list:t(4,1)=(4,2)=*(0,15)",128,0,43,0
  66               		.stabs	"va_list:t(4,3)=(4,1)",128,0,105,0
  67               		.stabn	162,0,0,0
  68               		.stabs	"clust2sect:F(2,12)",36,0,531,clust2sect
  69               		.stabs	"fs:P(1,7)",64,0,528,28
  70               		.stabs	"clst:P(2,12)",64,0,529,20
  71               	.global	clust2sect
  72               		.type	clust2sect, @function
  73               	clust2sect:
  74               		.stabd	46,0,0
   1:ff.c          **** /*----------------------------------------------------------------------------/
   2:ff.c          **** /  FatFs - FAT file system module  R0.07e                    (C)ChaN, 2009
   3:ff.c          **** /-----------------------------------------------------------------------------/
   4:ff.c          **** / FatFs module is a generic FAT file system module for small embedded systems.
   5:ff.c          **** / This is a free software that opened for education, research and commercial
   6:ff.c          **** / developments under license policy of following trems.
   7:ff.c          **** /
   8:ff.c          **** /  Copyright (C) 2009, ChaN, all right reserved.
   9:ff.c          **** /
  10:ff.c          **** / * The FatFs module is a free software and there is NO WARRANTY.
  11:ff.c          **** / * No restriction on use. You can use, modify and redistribute it for
  12:ff.c          **** /   personal, non-profit or commercial products UNDER YOUR RESPONSIBILITY.
  13:ff.c          **** / * Redistributions of source code must retain the above copyright notice.
  14:ff.c          **** /
  15:ff.c          **** /-----------------------------------------------------------------------------/
  16:ff.c          **** / Feb 26,'06 R0.00  Prototype.
  17:ff.c          **** /
  18:ff.c          **** / Apr 29,'06 R0.01  First stable version.
  19:ff.c          **** /
  20:ff.c          **** / Jun 01,'06 R0.02  Added FAT12 support.
  21:ff.c          **** /                   Removed unbuffered mode.
  22:ff.c          **** /                   Fixed a problem on small (<32M) patition.
  23:ff.c          **** / Jun 10,'06 R0.02a Added a configuration option (_FS_MINIMUM).
  24:ff.c          **** /
  25:ff.c          **** / Sep 22,'06 R0.03  Added f_rename().
  26:ff.c          **** /                   Changed option _FS_MINIMUM to _FS_MINIMIZE.
  27:ff.c          **** / Dec 11,'06 R0.03a Improved cluster scan algolithm to write files fast.
  28:ff.c          **** /                   Fixed f_mkdir() creates incorrect directory on FAT32.
  29:ff.c          **** /
  30:ff.c          **** / Feb 04,'07 R0.04  Supported multiple drive system.
  31:ff.c          **** /                   Changed some interfaces for multiple drive system.
  32:ff.c          **** /                   Changed f_mountdrv() to f_mount().
  33:ff.c          **** /                   Added f_mkfs().
  34:ff.c          **** / Apr 01,'07 R0.04a Supported multiple partitions on a plysical drive.
  35:ff.c          **** /                   Added a capability of extending file size to f_lseek().
  36:ff.c          **** /                   Added minimization level 3.
  37:ff.c          **** /                   Fixed an endian sensitive code in f_mkfs().
  38:ff.c          **** / May 05,'07 R0.04b Added a configuration option _USE_NTFLAG.
  39:ff.c          **** /                   Added FSInfo support.
  40:ff.c          **** /                   Fixed DBCS name can result FR_INVALID_NAME.
GAS LISTING /tmp/ccPugNTh.s 			page 3


  41:ff.c          **** /                   Fixed short seek (<= csize) collapses the file object.
  42:ff.c          **** /
  43:ff.c          **** / Aug 25,'07 R0.05  Changed arguments of f_read(), f_write() and f_mkfs().
  44:ff.c          **** /                   Fixed f_mkfs() on FAT32 creates incorrect FSInfo.
  45:ff.c          **** /                   Fixed f_mkdir() on FAT32 creates incorrect directory.
  46:ff.c          **** / Feb 03,'08 R0.05a Added f_truncate() and f_utime().
  47:ff.c          **** /                   Fixed off by one error at FAT sub-type determination.
  48:ff.c          **** /                   Fixed btr in f_read() can be mistruncated.
  49:ff.c          **** /                   Fixed cached sector is not flushed when create and close
  50:ff.c          **** /                   without write.
  51:ff.c          **** /
  52:ff.c          **** / Apr 01,'08 R0.06  Added fputc(), fputs(), fprintf() and fgets().
  53:ff.c          **** /                   Improved performance of f_lseek() on moving to the same
  54:ff.c          **** /                   or following cluster.
  55:ff.c          **** /
  56:ff.c          **** / Apr 01,'09 R0.07  Merged Tiny-FatFs as a buffer configuration option.
  57:ff.c          **** /                   Added long file name support.
  58:ff.c          **** /                   Added multiple code page support.
  59:ff.c          **** /                   Added re-entrancy for multitask operation.
  60:ff.c          **** /                   Added auto cluster size selection to f_mkfs().
  61:ff.c          **** /                   Added rewind option to f_readdir().
  62:ff.c          **** /                   Changed result code of critical errors.
  63:ff.c          **** /                   Renamed string functions to avoid name collision.
  64:ff.c          **** / Apr 14,'09 R0.07a Separated out OS dependent code on reentrant cfg.
  65:ff.c          **** /                   Added multiple sector size support.
  66:ff.c          **** / Jun 21,'09 R0.07c Fixed f_unlink() can return FR_OK on error.
  67:ff.c          **** /                   Fixed wrong cache control in f_lseek().
  68:ff.c          **** /                   Added relative path feature.
  69:ff.c          **** /                   Added f_chdir() and f_chdrive().
  70:ff.c          **** /                   Added proper case conversion to extended char.
  71:ff.c          **** / Nov 03,'09 R0.07e Separated out configuration options from ff.h to ffconf.h.
  72:ff.c          **** /                   Fixed f_unlink() fails to remove a sub-dir on _FS_RPATH.
  73:ff.c          **** /                   Fixed name matching error on the 13 char boundary.
  74:ff.c          **** /                   Added a configuration option, _LFN_UNICODE.
  75:ff.c          **** /                   Changed f_readdir() to return the SFN with always upper
  76:ff.c          **** /                   case on non-LFN cfg.
  77:ff.c          **** /---------------------------------------------------------------------------*/
  78:ff.c          **** 
  79:ff.c          **** #include "ff.h"			/* FatFs configurations and declarations */
  80:ff.c          **** #include "diskio.h"		/* Declarations of low level disk I/O functions */
  81:ff.c          **** 
  82:ff.c          **** /*--------------------------------------------------------------------------
  83:ff.c          **** 
  84:ff.c          ****    Module Private Definitions
  85:ff.c          **** 
  86:ff.c          **** ---------------------------------------------------------------------------*/
  87:ff.c          **** 
  88:ff.c          **** #if _FATFS != 0x007E
  89:ff.c          **** #error Wrong include file (ff.h).
  90:ff.c          **** #endif
  91:ff.c          **** 
  92:ff.c          **** #if _FS_REENTRANT
  93:ff.c          **** #if _USE_LFN == 1
  94:ff.c          **** #error Static LFN work area must not be used in re-entrant configuration.
  95:ff.c          **** #endif
  96:ff.c          **** #define	ENTER_FF(fs)		{ if (!lock_fs(fs)) return FR_TIMEOUT; }
  97:ff.c          **** #define	LEAVE_FF(fs, res)	{ unlock_fs(fs, res); return res; }
GAS LISTING /tmp/ccPugNTh.s 			page 4


  98:ff.c          **** 
  99:ff.c          **** #else
 100:ff.c          **** #define	ENTER_FF(fs)
 101:ff.c          **** #define LEAVE_FF(fs, res)	return res
 102:ff.c          **** 
 103:ff.c          **** #endif
 104:ff.c          **** 
 105:ff.c          **** #define	ABORT(fs, res)		{ fp->flag |= FA__ERROR; LEAVE_FF(fs, res); }
 106:ff.c          **** 
 107:ff.c          **** #ifndef NULL
 108:ff.c          **** #define	NULL	0
 109:ff.c          **** #endif
 110:ff.c          **** 
 111:ff.c          **** /* Name status flags */
 112:ff.c          **** #define NS			11		/* Offset of name status byte */
 113:ff.c          **** #define NS_LOSS		0x01	/* Out of 8.3 format */
 114:ff.c          **** #define NS_LFN		0x02	/* Force to create LFN entry */
 115:ff.c          **** #define NS_LAST		0x04	/* Last segment */
 116:ff.c          **** #define NS_BODY		0x08	/* Lower case flag (body) */
 117:ff.c          **** #define NS_EXT		0x10	/* Lower case flag (ext) */
 118:ff.c          **** #define NS_DOT		0x20	/* Dot entry */
 119:ff.c          **** 
 120:ff.c          **** 
 121:ff.c          **** 
 122:ff.c          **** 
 123:ff.c          **** /*--------------------------------------------------------------------------
 124:ff.c          **** 
 125:ff.c          ****    Private Work Area
 126:ff.c          **** 
 127:ff.c          **** ---------------------------------------------------------------------------*/
 128:ff.c          **** 
 129:ff.c          **** #if _DRIVES < 1 || _DRIVES > 9
 130:ff.c          **** #error Number of drives must be 1-9.
 131:ff.c          **** #endif
 132:ff.c          **** static
 133:ff.c          **** FATFS *FatFs[_DRIVES];	/* Pointer to the file system objects (logical drives) */
 134:ff.c          **** 
 135:ff.c          **** static
 136:ff.c          **** WORD Fsid;				/* File system mount ID */
 137:ff.c          **** 
 138:ff.c          **** #if _FS_RPATH
 139:ff.c          **** static
 140:ff.c          **** BYTE Drive;				/* Current drive */
 141:ff.c          **** #endif
 142:ff.c          **** 
 143:ff.c          **** 
 144:ff.c          **** #if _USE_LFN == 1	/* LFN with static LFN working buffer */
 145:ff.c          **** static
 146:ff.c          **** WCHAR LfnBuf[_MAX_LFN + 1];
 147:ff.c          **** #define	NAMEBUF(sp,lp)	BYTE sp[12]; WCHAR *lp = LfnBuf
 148:ff.c          **** #define INITBUF(dj,sp,lp)	dj.fn = sp; dj.lfn = lp
 149:ff.c          **** 
 150:ff.c          **** #elif _USE_LFN > 1	/* LFN with dynamic LFN working buffer */
 151:ff.c          **** #define	NAMEBUF(sp,lp)	BYTE sp[12]; WCHAR lbuf[_MAX_LFN + 1], *lp = lbuf
 152:ff.c          **** #define INITBUF(dj,sp,lp)	dj.fn = sp; dj.lfn = lp
 153:ff.c          **** 
 154:ff.c          **** #else				/* No LFN */
GAS LISTING /tmp/ccPugNTh.s 			page 5


 155:ff.c          **** #define	NAMEBUF(sp,lp)	BYTE sp[12]
 156:ff.c          **** #define INITBUF(dj,sp,lp)	dj.fn = sp
 157:ff.c          **** 
 158:ff.c          **** #endif
 159:ff.c          **** 
 160:ff.c          **** 
 161:ff.c          **** 
 162:ff.c          **** 
 163:ff.c          **** /*--------------------------------------------------------------------------
 164:ff.c          **** 
 165:ff.c          ****    Module Private Functions
 166:ff.c          **** 
 167:ff.c          **** ---------------------------------------------------------------------------*/
 168:ff.c          **** 
 169:ff.c          **** 
 170:ff.c          **** /*-----------------------------------------------------------------------*/
 171:ff.c          **** /* String functions                                                      */
 172:ff.c          **** /*-----------------------------------------------------------------------*/
 173:ff.c          **** 
 174:ff.c          **** /* Copy memory to memory */
 175:ff.c          **** static
 176:ff.c          **** void mem_cpy (void* dst, const void* src, int cnt) {
 177:ff.c          **** 	char *d = (char*)dst;
 178:ff.c          **** 	const char *s = (const char *)src;
 179:ff.c          **** 	while (cnt--) *d++ = *s++;
 180:ff.c          **** }
 181:ff.c          **** 
 182:ff.c          **** /* Fill memory */
 183:ff.c          **** static
 184:ff.c          **** void mem_set (void* dst, int val, int cnt) {
 185:ff.c          **** 	char *d = (char*)dst;
 186:ff.c          **** 	while (cnt--) *d++ = (char)val;
 187:ff.c          **** }
 188:ff.c          **** 
 189:ff.c          **** /* Compare memory to memory */
 190:ff.c          **** static
 191:ff.c          **** int mem_cmp (const void* dst, const void* src, int cnt) {
 192:ff.c          **** 	const char *d = (const char *)dst, *s = (const char *)src;
 193:ff.c          **** 	int r = 0;
 194:ff.c          **** 	while (cnt-- && (r = *d++ - *s++) == 0) ;
 195:ff.c          **** 	return r;
 196:ff.c          **** }
 197:ff.c          **** 
 198:ff.c          **** /* Check if chr is contained in the string */
 199:ff.c          **** static
 200:ff.c          **** int chk_chr (const char* str, int chr) {
 201:ff.c          **** 	while (*str && *str != chr) str++;
 202:ff.c          **** 	return *str;
 203:ff.c          **** }
 204:ff.c          **** 
 205:ff.c          **** 
 206:ff.c          **** 
 207:ff.c          **** /*-----------------------------------------------------------------------*/
 208:ff.c          **** /* Request/Release grant to access the volume                            */
 209:ff.c          **** /*-----------------------------------------------------------------------*/
 210:ff.c          **** #if _FS_REENTRANT
 211:ff.c          **** 
GAS LISTING /tmp/ccPugNTh.s 			page 6


 212:ff.c          **** static
 213:ff.c          **** BOOL lock_fs (
 214:ff.c          **** 	FATFS *fs		/* File system object */
 215:ff.c          **** )
 216:ff.c          **** {
 217:ff.c          **** 	return ff_req_grant(fs->sobj);
 218:ff.c          **** }
 219:ff.c          **** 
 220:ff.c          **** 
 221:ff.c          **** static
 222:ff.c          **** void unlock_fs (
 223:ff.c          **** 	FATFS *fs,		/* File system object */
 224:ff.c          **** 	FRESULT res		/* Result code to be returned */
 225:ff.c          **** )
 226:ff.c          **** {
 227:ff.c          **** 	if (res != FR_NOT_ENABLED &&
 228:ff.c          **** 		res != FR_INVALID_DRIVE &&
 229:ff.c          **** 		res != FR_INVALID_OBJECT &&
 230:ff.c          **** 		res != FR_TIMEOUT) {
 231:ff.c          **** 		ff_rel_grant(fs->sobj);
 232:ff.c          **** 	}
 233:ff.c          **** }
 234:ff.c          **** #endif
 235:ff.c          **** 
 236:ff.c          **** 
 237:ff.c          **** 
 238:ff.c          **** /*-----------------------------------------------------------------------*/
 239:ff.c          **** /* Change window offset                                                  */
 240:ff.c          **** /*-----------------------------------------------------------------------*/
 241:ff.c          **** 
 242:ff.c          **** static
 243:ff.c          **** FRESULT move_window (
 244:ff.c          **** 	FATFS *fs,		/* File system object */
 245:ff.c          **** 	DWORD sector	/* Sector number to make apperance in the fs->win[] */
 246:ff.c          **** )					/* Move to zero only writes back dirty window */
 247:ff.c          **** {
 248:ff.c          **** 	DWORD wsect;
 249:ff.c          **** 
 250:ff.c          **** 
 251:ff.c          **** 	wsect = fs->winsect;
 252:ff.c          **** 	if (wsect != sector) {	/* Changed current window */
 253:ff.c          **** #if !_FS_READONLY
 254:ff.c          **** 		if (fs->wflag) {	/* Write back dirty window if needed */
 255:ff.c          **** 			if (disk_write(fs->drive, fs->win, wsect, 1) != RES_OK)
 256:ff.c          **** 				return FR_DISK_ERR;
 257:ff.c          **** 			fs->wflag = 0;
 258:ff.c          **** 			if (wsect < (fs->fatbase + fs->sects_fat)) {	/* In FAT area */
 259:ff.c          **** 				BYTE nf;
 260:ff.c          **** 				for (nf = fs->n_fats; nf > 1; nf--) {	/* Refrect the change to all FAT copies */
 261:ff.c          **** 					wsect += fs->sects_fat;
 262:ff.c          **** 					disk_write(fs->drive, fs->win, wsect, 1);
 263:ff.c          **** 				}
 264:ff.c          **** 			}
 265:ff.c          **** 		}
 266:ff.c          **** #endif
 267:ff.c          **** 		if (sector) {
 268:ff.c          **** 			if (disk_read(fs->drive, fs->win, sector, 1) != RES_OK)
GAS LISTING /tmp/ccPugNTh.s 			page 7


 269:ff.c          **** 				return FR_DISK_ERR;
 270:ff.c          **** 			fs->winsect = sector;
 271:ff.c          **** 		}
 272:ff.c          **** 	}
 273:ff.c          **** 
 274:ff.c          **** 	return FR_OK;
 275:ff.c          **** }
 276:ff.c          **** 
 277:ff.c          **** 
 278:ff.c          **** 
 279:ff.c          **** 
 280:ff.c          **** /*-----------------------------------------------------------------------*/
 281:ff.c          **** /* Clean-up cached data                                                  */
 282:ff.c          **** /*-----------------------------------------------------------------------*/
 283:ff.c          **** #if !_FS_READONLY
 284:ff.c          **** static
 285:ff.c          **** FRESULT sync (	/* FR_OK: successful, FR_DISK_ERR: failed */
 286:ff.c          **** 	FATFS *fs	/* File system object */
 287:ff.c          **** )
 288:ff.c          **** {
 289:ff.c          **** 	FRESULT res;
 290:ff.c          **** 
 291:ff.c          **** 
 292:ff.c          **** 	res = move_window(fs, 0);
 293:ff.c          **** 	if (res == FR_OK) {
 294:ff.c          **** 		/* Update FSInfo sector if needed */
 295:ff.c          **** 		if (fs->fs_type == FS_FAT32 && fs->fsi_flag) {
 296:ff.c          **** 			fs->winsect = 0;
 297:ff.c          **** 			mem_set(fs->win, 0, 512);
 298:ff.c          **** 			ST_WORD(fs->win+BS_55AA, 0xAA55);
 299:ff.c          **** 			ST_DWORD(fs->win+FSI_LeadSig, 0x41615252);
 300:ff.c          **** 			ST_DWORD(fs->win+FSI_StrucSig, 0x61417272);
 301:ff.c          **** 			ST_DWORD(fs->win+FSI_Free_Count, fs->free_clust);
 302:ff.c          **** 			ST_DWORD(fs->win+FSI_Nxt_Free, fs->last_clust);
 303:ff.c          **** 			disk_write(fs->drive, fs->win, fs->fsi_sector, 1);
 304:ff.c          **** 			fs->fsi_flag = 0;
 305:ff.c          **** 		}
 306:ff.c          **** 		/* Make sure that no pending write process in the physical drive */
 307:ff.c          **** 		if (disk_ioctl(fs->drive, CTRL_SYNC, (void*)NULL) != RES_OK)
 308:ff.c          **** 			res = FR_DISK_ERR;
 309:ff.c          **** 	}
 310:ff.c          **** 
 311:ff.c          **** 	return res;
 312:ff.c          **** }
 313:ff.c          **** #endif
 314:ff.c          **** 
 315:ff.c          **** 
 316:ff.c          **** 
 317:ff.c          **** 
 318:ff.c          **** /*-----------------------------------------------------------------------*/
 319:ff.c          **** /* FAT access - Read value of a FAT entry                                */
 320:ff.c          **** /*-----------------------------------------------------------------------*/
 321:ff.c          **** 
 322:ff.c          **** 
 323:ff.c          **** DWORD get_fat (	/* 0xFFFFFFFF:Disk error, 1:Interal error, Else:Cluster status */
 324:ff.c          **** 	FATFS *fs,	/* File system object */
 325:ff.c          **** 	DWORD clst	/* Cluster# to get the link information */
GAS LISTING /tmp/ccPugNTh.s 			page 8


 326:ff.c          **** )
 327:ff.c          **** {
 328:ff.c          **** 	UINT wc, bc;
 329:ff.c          **** 	DWORD fsect;
 330:ff.c          **** 
 331:ff.c          **** 
 332:ff.c          **** 	if (clst < 2 || clst >= fs->max_clust)	/* Range check */
 333:ff.c          **** 		return 1;
 334:ff.c          **** 
 335:ff.c          **** 	fsect = fs->fatbase;
 336:ff.c          **** 	switch (fs->fs_type) {
 337:ff.c          **** 	case FS_FAT12 :
 338:ff.c          **** 		bc = clst; bc += bc / 2;
 339:ff.c          **** 		if (move_window(fs, fsect + (bc / SS(fs)))) break;
 340:ff.c          **** 		wc = fs->win[bc & (SS(fs) - 1)]; bc++;
 341:ff.c          **** 		if (move_window(fs, fsect + (bc / SS(fs)))) break;
 342:ff.c          **** 		wc |= (WORD)fs->win[bc & (SS(fs) - 1)] << 8;
 343:ff.c          **** 		return (clst & 1) ? (wc >> 4) : (wc & 0xFFF);
 344:ff.c          **** 
 345:ff.c          **** 	case FS_FAT16 :
 346:ff.c          **** 		if (move_window(fs, fsect + (clst / (SS(fs) / 2)))) break;
 347:ff.c          **** 		return LD_WORD(&fs->win[((WORD)clst * 2) & (SS(fs) - 1)]);
 348:ff.c          **** 
 349:ff.c          **** 	case FS_FAT32 :
 350:ff.c          **** 		if (move_window(fs, fsect + (clst / (SS(fs) / 4)))) break;
 351:ff.c          **** 		return LD_DWORD(&fs->win[((WORD)clst * 4) & (SS(fs) - 1)]) & 0x0FFFFFFF;
 352:ff.c          **** 	}
 353:ff.c          **** 
 354:ff.c          **** 	return 0xFFFFFFFF;	/* An error occured at the disk I/O layer */
 355:ff.c          **** }
 356:ff.c          **** 
 357:ff.c          **** 
 358:ff.c          **** 
 359:ff.c          **** 
 360:ff.c          **** /*-----------------------------------------------------------------------*/
 361:ff.c          **** /* FAT access - Change value of a FAT entry                              */
 362:ff.c          **** /*-----------------------------------------------------------------------*/
 363:ff.c          **** #if !_FS_READONLY
 364:ff.c          **** 
 365:ff.c          **** FRESULT put_fat (
 366:ff.c          **** 	FATFS *fs,	/* File system object */
 367:ff.c          **** 	DWORD clst,	/* Cluster# to be changed in range of 2 to fs->max_clust - 1 */
 368:ff.c          **** 	DWORD val	/* New value to mark the cluster */
 369:ff.c          **** )
 370:ff.c          **** {
 371:ff.c          **** 	UINT bc;
 372:ff.c          **** 	BYTE *p;
 373:ff.c          **** 	DWORD fsect;
 374:ff.c          **** 	FRESULT res;
 375:ff.c          **** 
 376:ff.c          **** 
 377:ff.c          **** 	if (clst < 2 || clst >= fs->max_clust) {	/* Range check */
 378:ff.c          **** 		res = FR_INT_ERR;
 379:ff.c          **** 
 380:ff.c          **** 	} else {
 381:ff.c          **** 		fsect = fs->fatbase;
 382:ff.c          **** 		switch (fs->fs_type) {
GAS LISTING /tmp/ccPugNTh.s 			page 9


 383:ff.c          **** 		case FS_FAT12 :
 384:ff.c          **** 			bc = clst; bc += bc / 2;
 385:ff.c          **** 			res = move_window(fs, fsect + (bc / SS(fs)));
 386:ff.c          **** 			if (res != FR_OK) break;
 387:ff.c          **** 			p = &fs->win[bc & (SS(fs) - 1)];
 388:ff.c          **** 			*p = (clst & 1) ? ((*p & 0x0F) | ((BYTE)val << 4)) : (BYTE)val;
 389:ff.c          **** 			bc++;
 390:ff.c          **** 			fs->wflag = 1;
 391:ff.c          **** 			res = move_window(fs, fsect + (bc / SS(fs)));
 392:ff.c          **** 			if (res != FR_OK) break;
 393:ff.c          **** 			p = &fs->win[bc & (SS(fs) - 1)];
 394:ff.c          **** 			*p = (clst & 1) ? (BYTE)(val >> 4) : ((*p & 0xF0) | ((BYTE)(val >> 8) & 0x0F));
 395:ff.c          **** 			break;
 396:ff.c          **** 
 397:ff.c          **** 		case FS_FAT16 :
 398:ff.c          **** 			res = move_window(fs, fsect + (clst / (SS(fs) / 2)));
 399:ff.c          **** 			if (res != FR_OK) break;
 400:ff.c          **** 			ST_WORD(&fs->win[((WORD)clst * 2) & (SS(fs) - 1)], (WORD)val);
 401:ff.c          **** 			break;
 402:ff.c          **** 
 403:ff.c          **** 		case FS_FAT32 :
 404:ff.c          **** 			res = move_window(fs, fsect + (clst / (SS(fs) / 4)));
 405:ff.c          **** 			if (res != FR_OK) break;
 406:ff.c          **** 			ST_DWORD(&fs->win[((WORD)clst * 4) & (SS(fs) - 1)], val);
 407:ff.c          **** 			break;
 408:ff.c          **** 
 409:ff.c          **** 		default :
 410:ff.c          **** 			res = FR_INT_ERR;
 411:ff.c          **** 		}
 412:ff.c          **** 		fs->wflag = 1;
 413:ff.c          **** 	}
 414:ff.c          **** 
 415:ff.c          **** 	return res;
 416:ff.c          **** }
 417:ff.c          **** #endif /* !_FS_READONLY */
 418:ff.c          **** 
 419:ff.c          **** 
 420:ff.c          **** 
 421:ff.c          **** 
 422:ff.c          **** /*-----------------------------------------------------------------------*/
 423:ff.c          **** /* FAT handling - Remove a cluster chain                                 */
 424:ff.c          **** /*-----------------------------------------------------------------------*/
 425:ff.c          **** #if !_FS_READONLY
 426:ff.c          **** static
 427:ff.c          **** FRESULT remove_chain (
 428:ff.c          **** 	FATFS *fs,			/* File system object */
 429:ff.c          **** 	DWORD clst			/* Cluster# to remove a chain from */
 430:ff.c          **** )
 431:ff.c          **** {
 432:ff.c          **** 	FRESULT res;
 433:ff.c          **** 	DWORD nxt;
 434:ff.c          **** 
 435:ff.c          **** 
 436:ff.c          **** 	if (clst < 2 || clst >= fs->max_clust) {	/* Check the range of cluster# */
 437:ff.c          **** 		res = FR_INT_ERR;
 438:ff.c          **** 
 439:ff.c          **** 	} else {
GAS LISTING /tmp/ccPugNTh.s 			page 10


 440:ff.c          **** 		res = FR_OK;
 441:ff.c          **** 		while (clst < fs->max_clust) {			/* Not a last link? */
 442:ff.c          **** 			nxt = get_fat(fs, clst);			/* Get cluster status */
 443:ff.c          **** 			if (nxt == 0) break;				/* Empty cluster? */
 444:ff.c          **** 			if (nxt == 1) { res = FR_INT_ERR; break; }	/* Internal error? */
 445:ff.c          **** 			if (nxt == 0xFFFFFFFF) { res = FR_DISK_ERR; break; }	/* Disk error? */
 446:ff.c          **** 			res = put_fat(fs, clst, 0);			/* Mark the cluster "empty" */
 447:ff.c          **** 			if (res != FR_OK) break;
 448:ff.c          **** 			if (fs->free_clust != 0xFFFFFFFF) {	/* Update FSInfo */
 449:ff.c          **** 				fs->free_clust++;
 450:ff.c          **** 				fs->fsi_flag = 1;
 451:ff.c          **** 			}
 452:ff.c          **** 			clst = nxt;	/* Next cluster */
 453:ff.c          **** 		}
 454:ff.c          **** 	}
 455:ff.c          **** 
 456:ff.c          **** 	return res;
 457:ff.c          **** }
 458:ff.c          **** #endif
 459:ff.c          **** 
 460:ff.c          **** 
 461:ff.c          **** 
 462:ff.c          **** 
 463:ff.c          **** /*-----------------------------------------------------------------------*/
 464:ff.c          **** /* FAT handling - Stretch or Create a cluster chain                      */
 465:ff.c          **** /*-----------------------------------------------------------------------*/
 466:ff.c          **** #if !_FS_READONLY
 467:ff.c          **** static
 468:ff.c          **** DWORD create_chain (	/* 0:No free cluster, 1:Internal error, 0xFFFFFFFF:Disk error, >=2:New cluster
 469:ff.c          **** 	FATFS *fs,			/* File system object */
 470:ff.c          **** 	DWORD clst			/* Cluster# to stretch. 0 means create a new chain. */
 471:ff.c          **** )
 472:ff.c          **** {
 473:ff.c          **** 	DWORD cs, ncl, scl, mcl;
 474:ff.c          **** 
 475:ff.c          **** 
 476:ff.c          **** 	mcl = fs->max_clust;
 477:ff.c          **** 	if (clst == 0) {		/* Create new chain */
 478:ff.c          **** 		scl = fs->last_clust;			/* Get suggested start point */
 479:ff.c          **** 		if (scl == 0 || scl >= mcl) scl = 1;
 480:ff.c          **** 	}
 481:ff.c          **** 	else {					/* Stretch existing chain */
 482:ff.c          **** 		cs = get_fat(fs, clst);			/* Check the cluster status */
 483:ff.c          **** 		if (cs < 2) return 1;			/* It is an invalid cluster */
 484:ff.c          **** 		if (cs < mcl) return cs;		/* It is already followed by next cluster */
 485:ff.c          **** 		scl = clst;
 486:ff.c          **** 	}
 487:ff.c          **** 
 488:ff.c          **** 	ncl = scl;				/* Start cluster */
 489:ff.c          **** 	for (;;) {
 490:ff.c          **** 		ncl++;							/* Next cluster */
 491:ff.c          **** 		if (ncl >= mcl) {				/* Wrap around */
 492:ff.c          **** 			ncl = 2;
 493:ff.c          **** 			if (ncl > scl) return 0;	/* No free custer */
 494:ff.c          **** 		}
 495:ff.c          **** 		cs = get_fat(fs, ncl);			/* Get the cluster status */
 496:ff.c          **** 		if (cs == 0) break;				/* Found a free cluster */
GAS LISTING /tmp/ccPugNTh.s 			page 11


 497:ff.c          **** 		if (cs == 0xFFFFFFFF || cs == 1)/* An error occured */
 498:ff.c          **** 			return cs;
 499:ff.c          **** 		if (ncl == scl) return 0;		/* No free custer */
 500:ff.c          **** 	}
 501:ff.c          **** 
 502:ff.c          **** 	if (put_fat(fs, ncl, 0x0FFFFFFF))	/* Mark the new cluster "in use" */
 503:ff.c          **** 		return 0xFFFFFFFF;
 504:ff.c          **** 	if (clst != 0) {					/* Link it to the previous one if needed */
 505:ff.c          **** 		if (put_fat(fs, clst, ncl))
 506:ff.c          **** 			return 0xFFFFFFFF;
 507:ff.c          **** 	}
 508:ff.c          **** 
 509:ff.c          **** 	fs->last_clust = ncl;				/* Update FSINFO */
 510:ff.c          **** 	if (fs->free_clust != 0xFFFFFFFF) {
 511:ff.c          **** 		fs->free_clust--;
 512:ff.c          **** 		fs->fsi_flag = 1;
 513:ff.c          **** 	}
 514:ff.c          **** 
 515:ff.c          **** 	return ncl;		/* Return new cluster number */
 516:ff.c          **** }
 517:ff.c          **** #endif /* !_FS_READONLY */
 518:ff.c          **** 
 519:ff.c          **** 
 520:ff.c          **** 
 521:ff.c          **** 
 522:ff.c          **** /*-----------------------------------------------------------------------*/
 523:ff.c          **** /* Get sector# from cluster#                                             */
 524:ff.c          **** /*-----------------------------------------------------------------------*/
 525:ff.c          **** 
 526:ff.c          **** 
 527:ff.c          **** DWORD clust2sect (	/* !=0: Sector number, 0: Failed - invalid cluster# */
 528:ff.c          **** 	FATFS *fs,		/* File system object */
 529:ff.c          **** 	DWORD clst		/* Cluster# to be converted */
 530:ff.c          **** )
 531:ff.c          **** {
  75               		.stabn	68,0,531,.LM0-.LFBB1
  76               	.LM0:
  77               	.LFBB1:
  78 0000 EF92      		push r14
  79 0002 FF92      		push r15
  80 0004 0F93      		push r16
  81 0006 1F93      		push r17
  82 0008 CF93      		push r28
  83 000a DF93      		push r29
  84               	/* prologue: function */
  85               	/* frame size = 0 */
  86 000c EC01      		movw r28,r24
  87 000e 7A01      		movw r14,r20
  88 0010 8B01      		movw r16,r22
 532:ff.c          **** 	clst -= 2;
  89               		.stabn	68,0,532,.LM1-.LFBB1
  90               	.LM1:
  91 0012 8EEF      		ldi r24,lo8(-2)
  92 0014 9FEF      		ldi r25,hi8(-2)
  93 0016 AFEF      		ldi r26,hlo8(-2)
  94 0018 BFEF      		ldi r27,hhi8(-2)
  95 001a E80E      		add r14,r24
GAS LISTING /tmp/ccPugNTh.s 			page 12


  96 001c F91E      		adc r15,r25
  97 001e 0A1F      		adc r16,r26
  98 0020 1B1F      		adc r17,r27
 533:ff.c          **** 	if (clst >= (fs->max_clust - 2)) return 0;		/* Invalid cluster# */
  99               		.stabn	68,0,533,.LM2-.LFBB1
 100               	.LM2:
 101 0022 8A8D      		ldd r24,Y+26
 102 0024 9B8D      		ldd r25,Y+27
 103 0026 AC8D      		ldd r26,Y+28
 104 0028 BD8D      		ldd r27,Y+29
 105 002a 0297      		sbiw r24,2
 106 002c A109      		sbc r26,__zero_reg__
 107 002e B109      		sbc r27,__zero_reg__
 108 0030 E816      		cp r14,r24
 109 0032 F906      		cpc r15,r25
 110 0034 0A07      		cpc r16,r26
 111 0036 1B07      		cpc r17,r27
 112 0038 00F0      		brlo .L2
 113 003a 20E0      		ldi r18,lo8(0)
 114 003c 30E0      		ldi r19,hi8(0)
 115 003e 40E0      		ldi r20,hlo8(0)
 116 0040 50E0      		ldi r21,hhi8(0)
 117 0042 00C0      		rjmp .L3
 118               	.L2:
 534:ff.c          **** 	return clst * fs->csize + fs->database;
 119               		.stabn	68,0,534,.LM3-.LFBB1
 120               	.LM3:
 121 0044 2A81      		ldd r18,Y+2
 122 0046 30E0      		ldi r19,lo8(0)
 123 0048 40E0      		ldi r20,lo8(0)
 124 004a 50E0      		ldi r21,hi8(0)
 125 004c C801      		movw r24,r16
 126 004e B701      		movw r22,r14
 127 0050 0E94 0000 		call __mulsi3
 128 0054 9B01      		movw r18,r22
 129 0056 AC01      		movw r20,r24
 130 0058 8EA1      		ldd r24,Y+38
 131 005a 9FA1      		ldd r25,Y+39
 132 005c A8A5      		ldd r26,Y+40
 133 005e B9A5      		ldd r27,Y+41
 134 0060 280F      		add r18,r24
 135 0062 391F      		adc r19,r25
 136 0064 4A1F      		adc r20,r26
 137 0066 5B1F      		adc r21,r27
 138               	.L3:
 535:ff.c          **** }
 139               		.stabn	68,0,535,.LM4-.LFBB1
 140               	.LM4:
 141 0068 B901      		movw r22,r18
 142 006a CA01      		movw r24,r20
 143               	/* epilogue start */
 144 006c DF91      		pop r29
 145 006e CF91      		pop r28
 146 0070 1F91      		pop r17
 147 0072 0F91      		pop r16
 148 0074 FF90      		pop r15
 149 0076 EF90      		pop r14
GAS LISTING /tmp/ccPugNTh.s 			page 13


 150 0078 0895      		ret
 151               		.size	clust2sect, .-clust2sect
 152               	.Lscope1:
 153               		.stabs	"",36,0,0,.Lscope1-.LFBB1
 154               		.stabd	78,0,0
 155               		.stabs	"get_fileinfo:f(0,15)",36,0,1315,get_fileinfo
 156               		.stabs	"dj:P(0,16)=*(1,9)",64,0,1312,30
 157               		.stabs	"fno:P(0,17)=*(1,14)",64,0,1313,14
 158               		.type	get_fileinfo, @function
 159               	get_fileinfo:
 160               		.stabd	46,0,0
 536:ff.c          **** 
 537:ff.c          **** 
 538:ff.c          **** 
 539:ff.c          **** 
 540:ff.c          **** /*-----------------------------------------------------------------------*/
 541:ff.c          **** /* Directory handling - Seek directory index                             */
 542:ff.c          **** /*-----------------------------------------------------------------------*/
 543:ff.c          **** 
 544:ff.c          **** static
 545:ff.c          **** FRESULT dir_seek (
 546:ff.c          **** 	DIR *dj,		/* Pointer to directory object */
 547:ff.c          **** 	WORD idx		/* Directory index number */
 548:ff.c          **** )
 549:ff.c          **** {
 550:ff.c          **** 	DWORD clst;
 551:ff.c          **** 	WORD ic;
 552:ff.c          **** 
 553:ff.c          **** 
 554:ff.c          **** 	dj->index = idx;
 555:ff.c          **** 	clst = dj->sclust;
 556:ff.c          **** 	if (clst == 1 || clst >= dj->fs->max_clust)	/* Check start cluster range */
 557:ff.c          **** 		return FR_INT_ERR;
 558:ff.c          **** 	if (!clst && dj->fs->fs_type == FS_FAT32)	/* Replace cluster# 0 with root cluster# if in FAT32 */
 559:ff.c          **** 		clst = dj->fs->dirbase;
 560:ff.c          **** 
 561:ff.c          **** 	if (clst == 0) {	/* Static table */
 562:ff.c          **** 		dj->clust = clst;
 563:ff.c          **** 		if (idx >= dj->fs->n_rootdir)		/* Index is out of range */
 564:ff.c          **** 			return FR_INT_ERR;
 565:ff.c          **** 		dj->sect = dj->fs->dirbase + idx / (SS(dj->fs) / 32);	/* Sector# */
 566:ff.c          **** 	}
 567:ff.c          **** 	else {				/* Dynamic table */
 568:ff.c          **** 		ic = SS(dj->fs) / 32 * dj->fs->csize;	/* Entries per cluster */
 569:ff.c          **** 		while (idx >= ic) {	/* Follow cluster chain */
 570:ff.c          **** 			clst = get_fat(dj->fs, clst);				/* Get next cluster */
 571:ff.c          **** 			if (clst == 0xFFFFFFFF) return FR_DISK_ERR;	/* Disk error */
 572:ff.c          **** 			if (clst < 2 || clst >= dj->fs->max_clust)	/* Reached to end of table or int error */
 573:ff.c          **** 				return FR_INT_ERR;
 574:ff.c          **** 			idx -= ic;
 575:ff.c          **** 		}
 576:ff.c          **** 		dj->clust = clst;
 577:ff.c          **** 		dj->sect = clust2sect(dj->fs, clst) + idx / (SS(dj->fs) / 32);	/* Sector# */
 578:ff.c          **** 	}
 579:ff.c          **** 
 580:ff.c          **** 	dj->dir = dj->fs->win + (idx % (SS(dj->fs) / 32)) * 32;	/* Ptr to the entry in the sector */
 581:ff.c          **** 
GAS LISTING /tmp/ccPugNTh.s 			page 14


 582:ff.c          **** 	return FR_OK;	/* Seek succeeded */
 583:ff.c          **** }
 584:ff.c          **** 
 585:ff.c          **** 
 586:ff.c          **** 
 587:ff.c          **** 
 588:ff.c          **** /*-----------------------------------------------------------------------*/
 589:ff.c          **** /* Directory handling - Move directory index next                        */
 590:ff.c          **** /*-----------------------------------------------------------------------*/
 591:ff.c          **** 
 592:ff.c          **** static
 593:ff.c          **** FRESULT dir_next (	/* FR_OK:Succeeded, FR_NO_FILE:End of table, FR_DENIED:EOT and could not streach
 594:ff.c          **** 	DIR *dj,		/* Pointer to directory object */
 595:ff.c          **** 	BOOL streach	/* FALSE: Do not streach table, TRUE: Streach table if needed */
 596:ff.c          **** )
 597:ff.c          **** {
 598:ff.c          **** 	DWORD clst;
 599:ff.c          **** 	WORD i;
 600:ff.c          **** 
 601:ff.c          **** 
 602:ff.c          **** 	i = dj->index + 1;
 603:ff.c          **** 	if (!i || !dj->sect)	/* Report EOT when index has reached 65535 */
 604:ff.c          **** 		return FR_NO_FILE;
 605:ff.c          **** 
 606:ff.c          **** 	if (!(i % (SS(dj->fs) / 32))) {	/* Sector changed? */
 607:ff.c          **** 		dj->sect++;					/* Next sector */
 608:ff.c          **** 
 609:ff.c          **** 		if (dj->clust == 0) {	/* Static table */
 610:ff.c          **** 			if (i >= dj->fs->n_rootdir)	/* Report EOT when end of table */
 611:ff.c          **** 				return FR_NO_FILE;
 612:ff.c          **** 		}
 613:ff.c          **** 		else {					/* Dynamic table */
 614:ff.c          **** 			if (((i / (SS(dj->fs) / 32)) & (dj->fs->csize - 1)) == 0) {	/* Cluster changed? */
 615:ff.c          **** 				clst = get_fat(dj->fs, dj->clust);				/* Get next cluster */
 616:ff.c          **** 				if (clst <= 1) return FR_INT_ERR;
 617:ff.c          **** 				if (clst == 0xFFFFFFFF) return FR_DISK_ERR;
 618:ff.c          **** 				if (clst >= dj->fs->max_clust) {				/* When it reached end of dynamic table */
 619:ff.c          **** #if !_FS_READONLY
 620:ff.c          **** 					BYTE c;
 621:ff.c          **** 					if (!streach) return FR_NO_FILE;			/* When do not streach, report EOT */
 622:ff.c          **** 					clst = create_chain(dj->fs, dj->clust);		/* Streach cluster chain */
 623:ff.c          **** 					if (clst == 0) return FR_DENIED;			/* No free cluster */
 624:ff.c          **** 					if (clst == 1) return FR_INT_ERR;
 625:ff.c          **** 					if (clst == 0xFFFFFFFF) return FR_DISK_ERR;
 626:ff.c          **** 					/* Clean-up streached table */
 627:ff.c          **** 					if (move_window(dj->fs, 0)) return FR_DISK_ERR;	/* Flush active window */
 628:ff.c          **** 					mem_set(dj->fs->win, 0, SS(dj->fs));			/* Clear window buffer */
 629:ff.c          **** 					dj->fs->winsect = clust2sect(dj->fs, clst);	/* Cluster start sector */
 630:ff.c          **** 					for (c = 0; c < dj->fs->csize; c++) {		/* Fill the new cluster with 0 */
 631:ff.c          **** 						dj->fs->wflag = 1;
 632:ff.c          **** 						if (move_window(dj->fs, 0)) return FR_DISK_ERR;
 633:ff.c          **** 						dj->fs->winsect++;
 634:ff.c          **** 					}
 635:ff.c          **** 					dj->fs->winsect -= c;						/* Rewind window address */
 636:ff.c          **** #else
 637:ff.c          **** 					return FR_NO_FILE;			/* Report EOT */
 638:ff.c          **** #endif
GAS LISTING /tmp/ccPugNTh.s 			page 15


 639:ff.c          **** 				}
 640:ff.c          **** 				dj->clust = clst;				/* Initialize data for new cluster */
 641:ff.c          **** 				dj->sect = clust2sect(dj->fs, clst);
 642:ff.c          **** 			}
 643:ff.c          **** 		}
 644:ff.c          **** 	}
 645:ff.c          **** 
 646:ff.c          **** 	dj->index = i;
 647:ff.c          **** 	dj->dir = dj->fs->win + (i % (SS(dj->fs) / 32)) * 32;
 648:ff.c          **** 
 649:ff.c          **** 	return FR_OK;
 650:ff.c          **** }
 651:ff.c          **** 
 652:ff.c          **** 
 653:ff.c          **** 
 654:ff.c          **** 
 655:ff.c          **** /*-----------------------------------------------------------------------*/
 656:ff.c          **** /* LFN handling - Test/Pick/Fit an LFN segment from/to directory entry   */
 657:ff.c          **** /*-----------------------------------------------------------------------*/
 658:ff.c          **** #if _USE_LFN
 659:ff.c          **** static
 660:ff.c          **** const BYTE LfnOfs[] = {1,3,5,7,9,14,16,18,20,22,24,28,30};	/* Offset of LFN chars in the directory 
 661:ff.c          **** 
 662:ff.c          **** 
 663:ff.c          **** static
 664:ff.c          **** BOOL cmp_lfn (			/* TRUE:Matched, FALSE:Not matched */
 665:ff.c          **** 	WCHAR *lfnbuf,		/* Pointer to the LFN to be compared */
 666:ff.c          **** 	BYTE *dir			/* Pointer to the directory entry containing a part of LFN */
 667:ff.c          **** )
 668:ff.c          **** {
 669:ff.c          **** 	int i, s;
 670:ff.c          **** 	WCHAR wc, uc;
 671:ff.c          **** 
 672:ff.c          **** 
 673:ff.c          **** 	i = ((dir[LDIR_Ord] & 0xBF) - 1) * 13;	/* Get offset in the LFN buffer */
 674:ff.c          **** 	s = 0; wc = 1;
 675:ff.c          **** 	do {
 676:ff.c          **** 		uc = LD_WORD(dir+LfnOfs[s]);	/* Pick an LFN character from the entry */
 677:ff.c          **** 		if (wc) {	/* Last char has not been processed */
 678:ff.c          **** 			wc = ff_wtoupper(uc);		/* Convert it to upper case */
 679:ff.c          **** 			if (i >= _MAX_LFN || wc != ff_wtoupper(lfnbuf[i++]))	/* Compare it */
 680:ff.c          **** 				return FALSE;			/* Not matched */
 681:ff.c          **** 		} else {
 682:ff.c          **** 			if (uc != 0xFFFF) return FALSE;	/* Check filler */
 683:ff.c          **** 		}
 684:ff.c          **** 	} while (++s < 13);				/* Repeat until all chars in the entry are checked */
 685:ff.c          **** 
 686:ff.c          **** 	if ((dir[LDIR_Ord] & 0x40) && wc && lfnbuf[i])	/* Last segment matched but different length */
 687:ff.c          **** 		return FALSE;
 688:ff.c          **** 
 689:ff.c          **** 	return TRUE;					/* The part of LFN matched */
 690:ff.c          **** }
 691:ff.c          **** 
 692:ff.c          **** 
 693:ff.c          **** 
 694:ff.c          **** static
 695:ff.c          **** BOOL pick_lfn (			/* TRUE:Succeeded, FALSE:Buffer overflow */
GAS LISTING /tmp/ccPugNTh.s 			page 16


 696:ff.c          **** 	WCHAR *lfnbuf,		/* Pointer to the Unicode-LFN buffer */
 697:ff.c          **** 	BYTE *dir			/* Pointer to the directory entry */
 698:ff.c          **** )
 699:ff.c          **** {
 700:ff.c          **** 	int i, s;
 701:ff.c          **** 	WCHAR wc, uc;
 702:ff.c          **** 
 703:ff.c          **** 
 704:ff.c          **** 	i = ((dir[LDIR_Ord] & 0x3F) - 1) * 13;	/* Offset in the LFN buffer */
 705:ff.c          **** 
 706:ff.c          **** 	s = 0; wc = 1;
 707:ff.c          **** 	do {
 708:ff.c          **** 		uc = LD_WORD(dir+LfnOfs[s]);			/* Pick an LFN character from the entry */
 709:ff.c          **** 		if (wc) {	/* Last char has not been processed */
 710:ff.c          **** 			if (i >= _MAX_LFN) return FALSE;	/* Buffer overflow? */
 711:ff.c          **** 			lfnbuf[i++] = wc = uc;				/* Store it */
 712:ff.c          **** 		} else {
 713:ff.c          **** 			if (uc != 0xFFFF) return FALSE;		/* Check filler */
 714:ff.c          **** 		}
 715:ff.c          **** 	} while (++s < 13);						/* Read all character in the entry */
 716:ff.c          **** 
 717:ff.c          **** 	if (dir[LDIR_Ord] & 0x40) {				/* Put terminator if it is the last LFN part */
 718:ff.c          **** 		if (i >= _MAX_LFN) return FALSE;	/* Buffer overflow? */
 719:ff.c          **** 		lfnbuf[i] = 0;
 720:ff.c          **** 	}
 721:ff.c          **** 
 722:ff.c          **** 	return TRUE;
 723:ff.c          **** }
 724:ff.c          **** 
 725:ff.c          **** 
 726:ff.c          **** #if !_FS_READONLY
 727:ff.c          **** static
 728:ff.c          **** void fit_lfn (
 729:ff.c          **** 	const WCHAR *lfnbuf,	/* Pointer to the LFN buffer */
 730:ff.c          **** 	BYTE *dir,				/* Pointer to the directory entry */
 731:ff.c          **** 	BYTE ord,				/* LFN order (1-20) */
 732:ff.c          **** 	BYTE sum				/* SFN sum */
 733:ff.c          **** )
 734:ff.c          **** {
 735:ff.c          **** 	int i, s;
 736:ff.c          **** 	WCHAR wc;
 737:ff.c          **** 
 738:ff.c          **** 
 739:ff.c          **** 	dir[LDIR_Chksum] = sum;			/* Set check sum */
 740:ff.c          **** 	dir[LDIR_Attr] = AM_LFN;		/* Set attribute. LFN entry */
 741:ff.c          **** 	dir[LDIR_Type] = 0;
 742:ff.c          **** 	ST_WORD(dir+LDIR_FstClusLO, 0);
 743:ff.c          **** 
 744:ff.c          **** 	i = (ord - 1) * 13;				/* Get offset in the LFN buffer */
 745:ff.c          **** 	s = wc = 0;
 746:ff.c          **** 	do {
 747:ff.c          **** 		if (wc != 0xFFFF) wc = lfnbuf[i++];	/* Get an effective char */
 748:ff.c          **** 		ST_WORD(dir+LfnOfs[s], wc);	/* Put it */
 749:ff.c          **** 		if (!wc) wc = 0xFFFF;		/* Padding chars following last char */
 750:ff.c          **** 	} while (++s < 13);
 751:ff.c          **** 	if (wc == 0xFFFF || !lfnbuf[i]) ord |= 0x40;	/* Bottom LFN part is the start of LFN sequence */
 752:ff.c          **** 	dir[LDIR_Ord] = ord;			/* Set the LFN order */
GAS LISTING /tmp/ccPugNTh.s 			page 17


 753:ff.c          **** }
 754:ff.c          **** 
 755:ff.c          **** #endif
 756:ff.c          **** #endif
 757:ff.c          **** 
 758:ff.c          **** 
 759:ff.c          **** 
 760:ff.c          **** /*-----------------------------------------------------------------------*/
 761:ff.c          **** /* Create numbered name                                                  */
 762:ff.c          **** /*-----------------------------------------------------------------------*/
 763:ff.c          **** #if _USE_LFN
 764:ff.c          **** void gen_numname (
 765:ff.c          **** 	BYTE *dst,			/* Pointer to genartated SFN */
 766:ff.c          **** 	const BYTE *src,	/* Pointer to source SFN to be modified */
 767:ff.c          **** 	const WCHAR *lfn,	/* Pointer to LFN */
 768:ff.c          **** 	WORD num			/* Sequense number */
 769:ff.c          **** )
 770:ff.c          **** {
 771:ff.c          **** 	char ns[8];
 772:ff.c          **** 	int i, j;
 773:ff.c          **** 
 774:ff.c          **** 
 775:ff.c          **** 	mem_cpy(dst, src, 11);
 776:ff.c          **** 
 777:ff.c          **** 	if (num > 5) {	/* On many collisions, generate a hash number instead of sequencial number */
 778:ff.c          **** 		do num = (num >> 1) + (num << 15) + (WORD)*lfn++; while (*lfn);
 779:ff.c          **** 	}
 780:ff.c          **** 
 781:ff.c          **** 	/* itoa */
 782:ff.c          **** 	i = 7;
 783:ff.c          **** 	do {
 784:ff.c          **** 		ns[i--] = (num % 10) + '0';
 785:ff.c          **** 		num /= 10;
 786:ff.c          **** 	} while (num);
 787:ff.c          **** 	ns[i] = '~';
 788:ff.c          **** 
 789:ff.c          **** 	/* Append the number */
 790:ff.c          **** 	for (j = 0; j < i && dst[j] != ' '; j++) {
 791:ff.c          **** 		if (IsDBCS1(dst[j])) {
 792:ff.c          **** 			if (j == i - 1) break;
 793:ff.c          **** 			j++;
 794:ff.c          **** 		}
 795:ff.c          **** 	}
 796:ff.c          **** 	do {
 797:ff.c          **** 		dst[j++] = (i < 8) ? ns[i++] : ' ';
 798:ff.c          **** 	} while (j < 8);
 799:ff.c          **** }
 800:ff.c          **** #endif
 801:ff.c          **** 
 802:ff.c          **** 
 803:ff.c          **** 
 804:ff.c          **** 
 805:ff.c          **** /*-----------------------------------------------------------------------*/
 806:ff.c          **** /* Calculate sum of an SFN                                               */
 807:ff.c          **** /*-----------------------------------------------------------------------*/
 808:ff.c          **** #if _USE_LFN
 809:ff.c          **** static
GAS LISTING /tmp/ccPugNTh.s 			page 18


 810:ff.c          **** BYTE sum_sfn (
 811:ff.c          **** 	const BYTE *dir		/* Ptr to directory entry */
 812:ff.c          **** )
 813:ff.c          **** {
 814:ff.c          **** 	BYTE sum = 0;
 815:ff.c          **** 	int n = 11;
 816:ff.c          **** 
 817:ff.c          **** 	do sum = (sum >> 1) + (sum << 7) + *dir++; while (--n);
 818:ff.c          **** 	return sum;
 819:ff.c          **** }
 820:ff.c          **** #endif
 821:ff.c          **** 
 822:ff.c          **** 
 823:ff.c          **** 
 824:ff.c          **** 
 825:ff.c          **** /*-----------------------------------------------------------------------*/
 826:ff.c          **** /* Directory handling - Find an object in the directory                  */
 827:ff.c          **** /*-----------------------------------------------------------------------*/
 828:ff.c          **** 
 829:ff.c          **** static
 830:ff.c          **** FRESULT dir_find (
 831:ff.c          **** 	DIR *dj			/* Pointer to the directory object linked to the file name */
 832:ff.c          **** )
 833:ff.c          **** {
 834:ff.c          **** 	FRESULT res;
 835:ff.c          **** 	BYTE c, *dir;
 836:ff.c          **** #if _USE_LFN
 837:ff.c          **** 	BYTE a, ord, sum;
 838:ff.c          **** #endif
 839:ff.c          **** 
 840:ff.c          **** 	res = dir_seek(dj, 0);			/* Rewind directory object */
 841:ff.c          **** 	if (res != FR_OK) return res;
 842:ff.c          **** 
 843:ff.c          **** #if _USE_LFN
 844:ff.c          **** 	ord = sum = 0xFF;
 845:ff.c          **** #endif
 846:ff.c          **** 	do {
 847:ff.c          **** 		res = move_window(dj->fs, dj->sect);
 848:ff.c          **** 		if (res != FR_OK) break;
 849:ff.c          **** 		dir = dj->dir;					/* Ptr to the directory entry of current index */
 850:ff.c          **** 		c = dir[DIR_Name];
 851:ff.c          **** 		if (c == 0) { res = FR_NO_FILE; break; }	/* Reached to end of table */
 852:ff.c          **** #if _USE_LFN	/* LFN configuration */
 853:ff.c          **** 		a = dir[DIR_Attr] & AM_MASK;
 854:ff.c          **** 		if (c == 0xE5 || ((a & AM_VOL) && a != AM_LFN)) {	/* An entry without valid data */
 855:ff.c          **** 			ord = 0xFF;
 856:ff.c          **** 		} else {
 857:ff.c          **** 			if (a == AM_LFN) {			/* An LFN entry is found */
 858:ff.c          **** 				if (dj->lfn) {
 859:ff.c          **** 					if (c & 0x40) {		/* Is it start of LFN sequence? */
 860:ff.c          **** 						sum = dir[LDIR_Chksum];
 861:ff.c          **** 						c &= 0xBF; ord = c;	/* LFN start order */
 862:ff.c          **** 						dj->lfn_idx = dj->index;
 863:ff.c          **** 					}
 864:ff.c          **** 					/* Check validity of the LFN entry and compare it with given name */
 865:ff.c          **** 					ord = (c == ord && sum == dir[LDIR_Chksum] && cmp_lfn(dj->lfn, dir)) ? ord - 1 : 0xFF;
 866:ff.c          **** 				}
GAS LISTING /tmp/ccPugNTh.s 			page 19


 867:ff.c          **** 			} else {					/* An SFN entry is found */
 868:ff.c          **** 				if (!ord && sum == sum_sfn(dir)) break;	/* LFN matched? */
 869:ff.c          **** 				ord = 0xFF; dj->lfn_idx = 0xFFFF;	/* Reset LFN sequence */
 870:ff.c          **** 				if (!(dj->fn[NS] & NS_LOSS) && !mem_cmp(dir, dj->fn, 11)) break;	/* SFN matched? */
 871:ff.c          **** 			}
 872:ff.c          **** 		}
 873:ff.c          **** #else		/* Non LFN configuration */
 874:ff.c          **** 		if (!(dir[DIR_Attr] & AM_VOL) && !mem_cmp(dir, dj->fn, 11)) /* Is it a valid entry? */
 875:ff.c          **** 			break;
 876:ff.c          **** #endif
 877:ff.c          **** 		res = dir_next(dj, FALSE);		/* Next entry */
 878:ff.c          **** 	} while (res == FR_OK);
 879:ff.c          **** 
 880:ff.c          **** 	return res;
 881:ff.c          **** }
 882:ff.c          **** 
 883:ff.c          **** 
 884:ff.c          **** 
 885:ff.c          **** 
 886:ff.c          **** /*-----------------------------------------------------------------------*/
 887:ff.c          **** /* Read an object from the directory                                     */
 888:ff.c          **** /*-----------------------------------------------------------------------*/
 889:ff.c          **** #if _FS_MINIMIZE <= 1
 890:ff.c          **** static
 891:ff.c          **** FRESULT dir_read (
 892:ff.c          **** 	DIR *dj			/* Pointer to the directory object that pointing the entry to be read */
 893:ff.c          **** )
 894:ff.c          **** {
 895:ff.c          **** 	FRESULT res;
 896:ff.c          **** 	BYTE c, *dir;
 897:ff.c          **** #if _USE_LFN
 898:ff.c          **** 	BYTE a, ord = 0xFF, sum = 0xFF;
 899:ff.c          **** #endif
 900:ff.c          **** 
 901:ff.c          **** 	res = FR_NO_FILE;
 902:ff.c          **** 	while (dj->sect) {
 903:ff.c          **** 		res = move_window(dj->fs, dj->sect);
 904:ff.c          **** 		if (res != FR_OK) break;
 905:ff.c          **** 		dir = dj->dir;					/* Ptr to the directory entry of current index */
 906:ff.c          **** 		c = dir[DIR_Name];
 907:ff.c          **** 		if (c == 0) { res = FR_NO_FILE; break; }	/* Reached to end of table */
 908:ff.c          **** #if _USE_LFN	/* LFN configuration */
 909:ff.c          **** 		a = dir[DIR_Attr] & AM_MASK;
 910:ff.c          **** 		if (c == 0xE5 || (!_FS_RPATH && c == '.') || ((a & AM_VOL) && a != AM_LFN)) {	/* An entry without
 911:ff.c          **** 			ord = 0xFF;
 912:ff.c          **** 		} else {
 913:ff.c          **** 			if (a == AM_LFN) {			/* An LFN entry is found */
 914:ff.c          **** 				if (c & 0x40) {			/* Is it start of LFN sequence? */
 915:ff.c          **** 					sum = dir[LDIR_Chksum];
 916:ff.c          **** 					c &= 0xBF; ord = c;
 917:ff.c          **** 					dj->lfn_idx = dj->index;
 918:ff.c          **** 				}
 919:ff.c          **** 				/* Check LFN validity and capture it */
 920:ff.c          **** 				ord = (c == ord && sum == dir[LDIR_Chksum] && pick_lfn(dj->lfn, dir)) ? ord - 1 : 0xFF;
 921:ff.c          **** 			} else {					/* An SFN entry is found */
 922:ff.c          **** 				if (ord || sum != sum_sfn(dir))	/* Is there a valid LFN? */
 923:ff.c          **** 					dj->lfn_idx = 0xFFFF;		/* It has no LFN. */
GAS LISTING /tmp/ccPugNTh.s 			page 20


 924:ff.c          **** 				break;
 925:ff.c          **** 			}
 926:ff.c          **** 		}
 927:ff.c          **** #else		/* Non LFN configuration */
 928:ff.c          **** 		if (c != 0xE5 && (_FS_RPATH || c != '.') && !(dir[DIR_Attr] & AM_VOL))	/* Is it a valid entry? */
 929:ff.c          **** 			break;
 930:ff.c          **** #endif
 931:ff.c          **** 		res = dir_next(dj, FALSE);				/* Next entry */
 932:ff.c          **** 		if (res != FR_OK) break;
 933:ff.c          **** 	}
 934:ff.c          **** 
 935:ff.c          **** 	if (res != FR_OK) dj->sect = 0;
 936:ff.c          **** 
 937:ff.c          **** 	return res;
 938:ff.c          **** }
 939:ff.c          **** #endif
 940:ff.c          **** 
 941:ff.c          **** 
 942:ff.c          **** 
 943:ff.c          **** /*-----------------------------------------------------------------------*/
 944:ff.c          **** /* Register an object to the directory                                   */
 945:ff.c          **** /*-----------------------------------------------------------------------*/
 946:ff.c          **** #if !_FS_READONLY
 947:ff.c          **** static
 948:ff.c          **** FRESULT dir_register (	/* FR_OK:Successful, FR_DENIED:No free entry or too many SFN collision, FR_D
 949:ff.c          **** 	DIR *dj				/* Target directory with object name to be created */
 950:ff.c          **** )
 951:ff.c          **** {
 952:ff.c          **** 	FRESULT res;
 953:ff.c          **** 	BYTE c, *dir;
 954:ff.c          **** #if _USE_LFN	/* LFN configuration */
 955:ff.c          **** 	WORD n, ne, is;
 956:ff.c          **** 	BYTE sn[12], *fn, sum;
 957:ff.c          **** 	WCHAR *lfn;
 958:ff.c          **** 
 959:ff.c          **** 
 960:ff.c          **** 	fn = dj->fn; lfn = dj->lfn;
 961:ff.c          **** 	mem_cpy(sn, fn, 12);
 962:ff.c          **** 
 963:ff.c          **** 	if (_FS_RPATH && (sn[NS] & NS_DOT)) return FR_INVALID_NAME;	/* Cannot create dot entry */
 964:ff.c          **** 
 965:ff.c          **** 	if (sn[NS] & NS_LOSS) {			/* When LFN is out of 8.3 format, generate a numbered name */
 966:ff.c          **** 		fn[NS] = 0; dj->lfn = NULL;			/* Find only SFN */
 967:ff.c          **** 		for (n = 1; n < 100; n++) {
 968:ff.c          **** 			gen_numname(fn, sn, lfn, n);	/* Generate a numbered name */
 969:ff.c          **** 			res = dir_find(dj);				/* Check if the name collides with existing SFN */
 970:ff.c          **** 			if (res != FR_OK) break;
 971:ff.c          **** 		}
 972:ff.c          **** 		if (n == 100) return FR_DENIED;		/* Abort if too many collisions */
 973:ff.c          **** 		if (res != FR_NO_FILE) return res;	/* Abort if the result is other than 'not collided' */
 974:ff.c          **** 		fn[NS] = sn[NS]; dj->lfn = lfn;
 975:ff.c          **** 	}
 976:ff.c          **** 
 977:ff.c          **** 	if (sn[NS] & NS_LFN) {			/* When LFN is to be created, reserve reserve an SFN + LFN entries. */
 978:ff.c          **** 		for (ne = 0; lfn[ne]; ne++) ;
 979:ff.c          **** 		ne = (ne + 25) / 13;
 980:ff.c          **** 	} else {						/* Otherwise reserve only an SFN entry. */
GAS LISTING /tmp/ccPugNTh.s 			page 21


 981:ff.c          **** 		ne = 1;
 982:ff.c          **** 	}
 983:ff.c          **** 
 984:ff.c          **** 	/* Reserve contiguous entries */
 985:ff.c          **** 	res = dir_seek(dj, 0);
 986:ff.c          **** 	if (res != FR_OK) return res;
 987:ff.c          **** 	n = is = 0;
 988:ff.c          **** 	do {
 989:ff.c          **** 		res = move_window(dj->fs, dj->sect);
 990:ff.c          **** 		if (res != FR_OK) break;
 991:ff.c          **** 		c = *dj->dir;				/* Check the entry status */
 992:ff.c          **** 		if (c == 0xE5 || c == 0) {	/* Is it a blank entry? */
 993:ff.c          **** 			if (n == 0) is = dj->index;	/* First index of the contigulus entry */
 994:ff.c          **** 			if (++n == ne) break;	/* A contiguous entry that requiered count is found */
 995:ff.c          **** 		} else {
 996:ff.c          **** 			n = 0;					/* Not a blank entry. Restart to search */
 997:ff.c          **** 		}
 998:ff.c          **** 		res = dir_next(dj, TRUE);	/* Next entry with table streach */
 999:ff.c          **** 	} while (res == FR_OK);
1000:ff.c          **** 
1001:ff.c          **** 	if (res == FR_OK && ne > 1) {	/* Initialize LFN entry if needed */
1002:ff.c          **** 		res = dir_seek(dj, is);
1003:ff.c          **** 		if (res == FR_OK) {
1004:ff.c          **** 			sum = sum_sfn(dj->fn);	/* Sum of the SFN tied to the LFN */
1005:ff.c          **** 			ne--;
1006:ff.c          **** 			do {					/* Store LFN entries in bottom first */
1007:ff.c          **** 				res = move_window(dj->fs, dj->sect);
1008:ff.c          **** 				if (res != FR_OK) break;
1009:ff.c          **** 				fit_lfn(dj->lfn, dj->dir, (BYTE)ne, sum);
1010:ff.c          **** 				dj->fs->wflag = 1;
1011:ff.c          **** 				res = dir_next(dj, FALSE);	/* Next entry */
1012:ff.c          **** 			} while (res == FR_OK && --ne);
1013:ff.c          **** 		}
1014:ff.c          **** 	}
1015:ff.c          **** 
1016:ff.c          **** #else	/* Non LFN configuration */
1017:ff.c          **** 	res = dir_seek(dj, 0);
1018:ff.c          **** 	if (res == FR_OK) {
1019:ff.c          **** 		do {	/* Find a blank entry for the SFN */
1020:ff.c          **** 			res = move_window(dj->fs, dj->sect);
1021:ff.c          **** 			if (res != FR_OK) break;
1022:ff.c          **** 			c = *dj->dir;
1023:ff.c          **** 			if (c == 0xE5 || c == 0) break;	/* Is it a blank entry? */
1024:ff.c          **** 			res = dir_next(dj, TRUE);		/* Next entry with table streach */
1025:ff.c          **** 		} while (res == FR_OK);
1026:ff.c          **** 	}
1027:ff.c          **** #endif
1028:ff.c          **** 
1029:ff.c          **** 	if (res == FR_OK) {		/* Initialize the SFN entry */
1030:ff.c          **** 		res = move_window(dj->fs, dj->sect);
1031:ff.c          **** 		if (res == FR_OK) {
1032:ff.c          **** 			dir = dj->dir;
1033:ff.c          **** 			mem_set(dir, 0, 32);		/* Clean the entry */
1034:ff.c          **** 			mem_cpy(dir, dj->fn, 11);	/* Put SFN */
1035:ff.c          **** 			dir[DIR_NTres] = *(dj->fn+NS) & (NS_BODY | NS_EXT);	/* Put NT flag */
1036:ff.c          **** 			dj->fs->wflag = 1;
1037:ff.c          **** 		}
GAS LISTING /tmp/ccPugNTh.s 			page 22


1038:ff.c          **** 	}
1039:ff.c          **** 
1040:ff.c          **** 	return res;
1041:ff.c          **** }
1042:ff.c          **** #endif /* !_FS_READONLY */
1043:ff.c          **** 
1044:ff.c          **** 
1045:ff.c          **** 
1046:ff.c          **** 
1047:ff.c          **** /*-----------------------------------------------------------------------*/
1048:ff.c          **** /* Remove an object from the directory                                   */
1049:ff.c          **** /*-----------------------------------------------------------------------*/
1050:ff.c          **** #if !_FS_READONLY && !_FS_MINIMIZE
1051:ff.c          **** static
1052:ff.c          **** FRESULT dir_remove (	/* FR_OK: Successful, FR_DISK_ERR: A disk error */
1053:ff.c          **** 	DIR *dj				/* Directory object pointing the entry to be removed */
1054:ff.c          **** )
1055:ff.c          **** {
1056:ff.c          **** 	FRESULT res;
1057:ff.c          **** #if _USE_LFN	/* LFN configuration */
1058:ff.c          **** 	WORD i;
1059:ff.c          **** 
1060:ff.c          **** 	i = dj->index;	/* SFN index */
1061:ff.c          **** 	res = dir_seek(dj, (WORD)((dj->lfn_idx == 0xFFFF) ? i : dj->lfn_idx));	/* Goto the SFN or top of t
1062:ff.c          **** 	if (res == FR_OK) {
1063:ff.c          **** 		do {
1064:ff.c          **** 			res = move_window(dj->fs, dj->sect);
1065:ff.c          **** 			if (res != FR_OK) break;
1066:ff.c          **** 			*dj->dir = 0xE5;			/* Mark the entry "deleted" */
1067:ff.c          **** 			dj->fs->wflag = 1;
1068:ff.c          **** 			if (dj->index >= i) break;	/* When reached SFN, all entries of the object has been deleted. */
1069:ff.c          **** 			res = dir_next(dj, FALSE);	/* Next entry */
1070:ff.c          **** 		} while (res == FR_OK);
1071:ff.c          **** 		if (res == FR_NO_FILE) res = FR_INT_ERR;
1072:ff.c          **** 	}
1073:ff.c          **** 
1074:ff.c          **** #else			/* Non LFN configuration */
1075:ff.c          **** 	res = dir_seek(dj, dj->index);
1076:ff.c          **** 	if (res == FR_OK) {
1077:ff.c          **** 		res = move_window(dj->fs, dj->sect);
1078:ff.c          **** 		if (res == FR_OK) {
1079:ff.c          **** 			*dj->dir = 0xE5;			/* Mark the entry "deleted" */
1080:ff.c          **** 			dj->fs->wflag = 1;
1081:ff.c          **** 		}
1082:ff.c          **** 	}
1083:ff.c          **** #endif
1084:ff.c          **** 
1085:ff.c          **** 	return res;
1086:ff.c          **** }
1087:ff.c          **** #endif /* !_FS_READONLY */
1088:ff.c          **** 
1089:ff.c          **** 
1090:ff.c          **** 
1091:ff.c          **** 
1092:ff.c          **** /*-----------------------------------------------------------------------*/
1093:ff.c          **** /* Pick a segment and create the object name in directory form           */
1094:ff.c          **** /*-----------------------------------------------------------------------*/
GAS LISTING /tmp/ccPugNTh.s 			page 23


1095:ff.c          **** 
1096:ff.c          **** static
1097:ff.c          **** FRESULT create_name (
1098:ff.c          **** 	DIR *dj,			/* Pointer to the directory object */
1099:ff.c          **** 	const XCHAR **path	/* Pointer to pointer to the segment in the path string */
1100:ff.c          **** )
1101:ff.c          **** {
1102:ff.c          **** #ifdef _EXCVT
1103:ff.c          **** 	static const BYTE cvt[] = _EXCVT;
1104:ff.c          **** #endif
1105:ff.c          **** 
1106:ff.c          **** #if _USE_LFN	/* LFN configuration */
1107:ff.c          **** 	BYTE b, cf;
1108:ff.c          **** 	WCHAR w, *lfn;
1109:ff.c          **** 	int i, ni, si, di;
1110:ff.c          **** 	const XCHAR *p;
1111:ff.c          **** 
1112:ff.c          **** 	/* Create LFN in Unicode */
1113:ff.c          **** 	si = di = 0;
1114:ff.c          **** 	p = *path;
1115:ff.c          **** 	lfn = dj->lfn;
1116:ff.c          **** 	for (;;) {
1117:ff.c          **** 		w = p[si++];					/* Get a character */
1118:ff.c          **** 		if (w < ' ' || w == '/' || w == '\\') break;	/* Break on end of segment */
1119:ff.c          **** 		if (di >= _MAX_LFN)				/* Reject too long name */
1120:ff.c          **** 			return FR_INVALID_NAME;
1121:ff.c          **** #if !_LFN_UNICODE
1122:ff.c          **** 		w &= 0xFF;
1123:ff.c          **** 		if (IsDBCS1(w)) {				/* If it is a DBC 1st byte */
1124:ff.c          **** 			b = p[si++];				/* Get 2nd byte */
1125:ff.c          **** 			if (!IsDBCS2(b))			/* Reject invalid code for DBC */
1126:ff.c          **** 				return FR_INVALID_NAME;
1127:ff.c          **** 			w = (w << 8) + b;
1128:ff.c          **** 		}
1129:ff.c          **** 		w = ff_convert(w, 1);			/* Convert OEM to Unicode */
1130:ff.c          **** 		if (!w) return FR_INVALID_NAME;	/* Reject invalid code */
1131:ff.c          **** #endif
1132:ff.c          **** 		if (w < 0x80 && chk_chr("\"*:<>\?|\x7F", w)) /* Reject illegal chars for LFN */
1133:ff.c          **** 			return FR_INVALID_NAME;
1134:ff.c          **** 		lfn[di++] = w;					/* Store the Unicode char */
1135:ff.c          **** 	}
1136:ff.c          **** 	*path = &p[si];						/* Rerurn pointer to the next segment */
1137:ff.c          **** 	cf = (w < ' ') ? NS_LAST : 0;		/* Set last segment flag if end of path */
1138:ff.c          **** #if _FS_RPATH
1139:ff.c          **** 	if ((di == 1 && lfn[di - 1] == '.') || /* Is this a dot entry? */
1140:ff.c          **** 		(di == 2 && lfn[di - 1] == '.' && lfn[di - 2] == '.')) {
1141:ff.c          **** 		lfn[di] = 0;
1142:ff.c          **** 		for (i = 0; i < 11; i++)
1143:ff.c          **** 			dj->fn[i] = (i < di) ? '.' : ' ';
1144:ff.c          **** 		dj->fn[i] = cf | NS_DOT;		/* This is a dot entry */
1145:ff.c          **** 		return FR_OK;
1146:ff.c          **** 	}
1147:ff.c          **** #endif
1148:ff.c          **** 	while (di) {						/* Strip trailing spaces and dots */
1149:ff.c          **** 		w = lfn[di - 1];
1150:ff.c          **** 		if (w != ' ' && w != '.') break;
1151:ff.c          **** 		di--;
GAS LISTING /tmp/ccPugNTh.s 			page 24


1152:ff.c          **** 	}
1153:ff.c          **** 	if (!di) return FR_INVALID_NAME;	/* Reject null string */
1154:ff.c          **** 
1155:ff.c          **** 	lfn[di] = 0;						/* LFN is created */
1156:ff.c          **** 
1157:ff.c          **** 	/* Create SFN in directory form */
1158:ff.c          **** 	mem_set(dj->fn, ' ', 11);
1159:ff.c          **** 	for (si = 0; lfn[si] == ' ' || lfn[si] == '.'; si++) ;	/* Strip leading spaces and dots */
1160:ff.c          **** 	if (si) cf |= NS_LOSS | NS_LFN;
1161:ff.c          **** 	while (di && lfn[di - 1] != '.') di--;	/* Find extension (di<=si: no extension) */
1162:ff.c          **** 
1163:ff.c          **** 	b = i = 0; ni = 8;
1164:ff.c          **** 	for (;;) {
1165:ff.c          **** 		w = lfn[si++];					/* Get an LFN char */
1166:ff.c          **** 		if (!w) break;					/* Break on enf of the LFN */
1167:ff.c          **** 		if (w == ' ' || (w == '.' && si != di)) {	/* Remove spaces and dots */
1168:ff.c          **** 			cf |= NS_LOSS | NS_LFN; continue;
1169:ff.c          **** 		}
1170:ff.c          **** 
1171:ff.c          **** 		if (i >= ni || si == di) {		/* Extension or end of SFN */
1172:ff.c          **** 			if (ni == 11) {				/* Long extension */
1173:ff.c          **** 				cf |= NS_LOSS | NS_LFN; break;
1174:ff.c          **** 			}
1175:ff.c          **** 			if (si != di) cf |= NS_LOSS | NS_LFN;	/* Out of 8.3 format */
1176:ff.c          **** 			if (si > di) break;			/* No extension */
1177:ff.c          **** 			si = di; i = 8; ni = 11;	/* Enter extension section */
1178:ff.c          **** 			b <<= 2; continue;
1179:ff.c          **** 		}
1180:ff.c          **** 
1181:ff.c          **** 		if (w >= 0x80) {				/* Non ASCII char */
1182:ff.c          **** #ifdef _EXCVT
1183:ff.c          **** 			w = ff_convert(w, 0);		/* Unicode -> OEM code */
1184:ff.c          **** 			if (w) w = cvt[w - 0x80];	/* Convert extended char to upper (SBCS) */
1185:ff.c          **** #else
1186:ff.c          **** 			w = ff_convert(ff_wtoupper(w), 0);	/* Upper converted Unicode -> OEM code */
1187:ff.c          **** #endif
1188:ff.c          **** 			cf |= NS_LFN;				/* Force create LFN entry */
1189:ff.c          **** 		}
1190:ff.c          **** 
1191:ff.c          **** 		if (_DF1S && w >= 0x100) {		/* Double byte char */
1192:ff.c          **** 			if (i >= ni - 1) {
1193:ff.c          **** 				cf |= NS_LOSS | NS_LFN; i = ni; continue;
1194:ff.c          **** 			}
1195:ff.c          **** 			dj->fn[i++] = (BYTE)(w >> 8);
1196:ff.c          **** 		} else {						/* Single byte char */
1197:ff.c          **** 			if (!w || chk_chr("+,;[=]", w)) {		/* Replace illegal chars for SFN */
1198:ff.c          **** 				w = '_'; cf |= NS_LOSS | NS_LFN;	/* Lossy conversion */
1199:ff.c          **** 			} else {
1200:ff.c          **** 				if (IsUpper(w)) {		/* ASCII large capital */
1201:ff.c          **** 					b |= 2;
1202:ff.c          **** 				} else {
1203:ff.c          **** 					if (IsLower(w)) {	/* ASCII small capital */
1204:ff.c          **** 						b |= 1; w -= 0x20;
1205:ff.c          **** 					}
1206:ff.c          **** 				}
1207:ff.c          **** 			}
1208:ff.c          **** 		}
GAS LISTING /tmp/ccPugNTh.s 			page 25


1209:ff.c          **** 		dj->fn[i++] = (BYTE)w;
1210:ff.c          **** 	}
1211:ff.c          **** 
1212:ff.c          **** 	if (dj->fn[0] == 0xE5) dj->fn[0] = 0x05;	/* If the first char collides with deleted mark, replace 
1213:ff.c          **** 
1214:ff.c          **** 	if (ni == 8) b <<= 2;
1215:ff.c          **** 	if ((b & 0x0C) == 0x0C || (b & 0x03) == 0x03)	/* Create LFN entry when there are composite capital
1216:ff.c          **** 		cf |= NS_LFN;
1217:ff.c          **** 	if (!(cf & NS_LFN)) {						/* When LFN is in 8.3 format without extended char, NT flags are create
1218:ff.c          **** 		if ((b & 0x03) == 0x01) cf |= NS_EXT;	/* NT flag (Extension has only small capital) */
1219:ff.c          **** 		if ((b & 0x0C) == 0x04) cf |= NS_BODY;	/* NT flag (Filename has only small capital) */
1220:ff.c          **** 	}
1221:ff.c          **** 
1222:ff.c          **** 	dj->fn[NS] = cf;	/* SFN is created */
1223:ff.c          **** 
1224:ff.c          **** 	return FR_OK;
1225:ff.c          **** 
1226:ff.c          **** 
1227:ff.c          **** #else	/* Non-LFN configuration */
1228:ff.c          **** 	BYTE b, c, d, *sfn;
1229:ff.c          **** 	int ni, si, i;
1230:ff.c          **** 	const char *p;
1231:ff.c          **** 
1232:ff.c          **** 	/* Create file name in directory form */
1233:ff.c          **** 	sfn = dj->fn;
1234:ff.c          **** 	mem_set(sfn, ' ', 11);
1235:ff.c          **** 	si = i = b = 0; ni = 8;
1236:ff.c          **** 	p = *path;
1237:ff.c          **** #if _FS_RPATH
1238:ff.c          **** 	if (p[si] == '.') { /* Is this a dot entry? */
1239:ff.c          **** 		for (;;) {
1240:ff.c          **** 			c = p[si++];
1241:ff.c          **** 			if (c != '.' || si >= 3) break;
1242:ff.c          **** 			sfn[i++] = c;
1243:ff.c          **** 		}
1244:ff.c          **** 		if (c != '/' && c != '\\' && c > ' ') return FR_INVALID_NAME;
1245:ff.c          **** 		*path = &p[si];									/* Rerurn pointer to the next segment */
1246:ff.c          **** 		sfn[NS] = (c <= ' ') ? NS_LAST | NS_DOT : NS_DOT;	/* Set last segment flag if end of path */
1247:ff.c          **** 		return FR_OK;
1248:ff.c          **** 	}
1249:ff.c          **** #endif
1250:ff.c          **** 	for (;;) {
1251:ff.c          **** 		c = p[si++];
1252:ff.c          **** 		if (c <= ' ' || c == '/' || c == '\\') break;	/* Break on end of segment */
1253:ff.c          **** 		if (c == '.' || i >= ni) {
1254:ff.c          **** 			if (ni != 8 || c != '.') return FR_INVALID_NAME;
1255:ff.c          **** 			i = 8; ni = 11;
1256:ff.c          **** 			b <<= 2; continue;
1257:ff.c          **** 		}
1258:ff.c          **** 		if (c >= 0x80) {				/* Extended char */
1259:ff.c          **** #ifdef _EXCVT
1260:ff.c          **** 			c = cvt[c - 0x80];			/* Convert extend char (SBCS) */
1261:ff.c          **** #else
1262:ff.c          **** 			b |= 3;						/* Eliminate NT flag if ext char is exist */
1263:ff.c          **** #if !_DF1S	/* ASCII only cfg */
1264:ff.c          **** 			return FR_INVALID_NAME;
1265:ff.c          **** #endif
GAS LISTING /tmp/ccPugNTh.s 			page 26


1266:ff.c          **** #endif
1267:ff.c          **** 		}
1268:ff.c          **** 		if (IsDBCS1(c)) {				/* DBC 1st byte? */
1269:ff.c          **** 			d = p[si++];				/* Get 2nd byte */
1270:ff.c          **** 			if (!IsDBCS2(d) || i >= ni - 1)	/* Reject invalid DBC */
1271:ff.c          **** 				return FR_INVALID_NAME;
1272:ff.c          **** 			sfn[i++] = c;
1273:ff.c          **** 			sfn[i++] = d;
1274:ff.c          **** 		} else {						/* Single byte code */
1275:ff.c          **** 			if (chk_chr(" \"*+,[=]|\x7F", c))	/* Reject illegal chrs for SFN */
1276:ff.c          **** 				return FR_INVALID_NAME;
1277:ff.c          **** 			if (IsUpper(c)) {			/* ASCII large capital? */
1278:ff.c          **** 				b |= 2;
1279:ff.c          **** 			} else {
1280:ff.c          **** 				if (IsLower(c)) {		/* ASCII small capital? */
1281:ff.c          **** 					b |= 1; c -= 0x20;
1282:ff.c          **** 				}
1283:ff.c          **** 			}
1284:ff.c          **** 			sfn[i++] = c;
1285:ff.c          **** 		}
1286:ff.c          **** 	}
1287:ff.c          **** 	*path = &p[si];						/* Rerurn pointer to the next segment */
1288:ff.c          **** 	c = (c <= ' ') ? NS_LAST : 0;		/* Set last segment flag if end of path */
1289:ff.c          **** 
1290:ff.c          **** 	if (!i) return FR_INVALID_NAME;		/* Reject null string */
1291:ff.c          **** 	if (sfn[0] == 0xE5) sfn[0] = 0x05;	/* When first char collides with 0xE5, replace it with 0x05 */
1292:ff.c          **** 
1293:ff.c          **** 	if (ni == 8) b <<= 2;
1294:ff.c          **** 	if ((b & 0x03) == 0x01) c |= NS_EXT;	/* NT flag (Extension has only small capital) */
1295:ff.c          **** 	if ((b & 0x0C) == 0x04) c |= NS_BODY;	/* NT flag (Filename has only small capital) */
1296:ff.c          **** 
1297:ff.c          **** 	sfn[NS] = c;		/* Store NT flag, File name is created */
1298:ff.c          **** 
1299:ff.c          **** 	return FR_OK;
1300:ff.c          **** #endif
1301:ff.c          **** }
1302:ff.c          **** 
1303:ff.c          **** 
1304:ff.c          **** 
1305:ff.c          **** 
1306:ff.c          **** /*-----------------------------------------------------------------------*/
1307:ff.c          **** /* Get file information from directory entry                             */
1308:ff.c          **** /*-----------------------------------------------------------------------*/
1309:ff.c          **** #if _FS_MINIMIZE <= 1
1310:ff.c          **** static
1311:ff.c          **** void get_fileinfo (		/* No return code */
1312:ff.c          **** 	DIR *dj,			/* Pointer to the directory object */
1313:ff.c          **** 	FILINFO *fno	 	/* Pointer to the file information to be filled */
1314:ff.c          **** )
1315:ff.c          **** {
 161               		.stabn	68,0,1315,.LM5-.LFBB2
 162               	.LM5:
 163               	.LFBB2:
 164 007a EF92      		push r14
 165 007c FF92      		push r15
 166 007e 0F93      		push r16
 167 0080 1F93      		push r17
GAS LISTING /tmp/ccPugNTh.s 			page 27


 168 0082 CF93      		push r28
 169 0084 DF93      		push r29
 170               	/* prologue: function */
 171               	/* frame size = 0 */
 172 0086 FC01      		movw r30,r24
 173 0088 7B01      		movw r14,r22
1316:ff.c          **** 	int i;
1317:ff.c          **** 	BYTE c, nt, *dir;
1318:ff.c          **** 	char *p;
1319:ff.c          **** 
1320:ff.c          **** 
1321:ff.c          **** 	p = fno->fname;
 174               		.stabn	68,0,1321,.LM6-.LFBB2
 175               	.LM6:
 176 008a EB01      		movw r28,r22
 177 008c 2996      		adiw r28,9
1322:ff.c          **** 	if (dj->sect) {
 178               		.stabn	68,0,1322,.LM7-.LFBB2
 179               	.LM7:
 180 008e 8685      		ldd r24,Z+14
 181 0090 9785      		ldd r25,Z+15
 182 0092 A089      		ldd r26,Z+16
 183 0094 B189      		ldd r27,Z+17
 184 0096 0097      		sbiw r24,0
 185 0098 A105      		cpc r26,__zero_reg__
 186 009a B105      		cpc r27,__zero_reg__
 187 009c 01F4      		brne .+2
 188 009e 00C0      		rjmp .L6
1323:ff.c          **** 		dir = dj->dir;
 189               		.stabn	68,0,1323,.LM8-.LFBB2
 190               	.LM8:
 191 00a0 6289      		ldd r22,Z+18
 192 00a2 7389      		ldd r23,Z+19
 193 00a4 80E0      		ldi r24,lo8(0)
 194 00a6 90E0      		ldi r25,hi8(0)
 195               	.L9:
1324:ff.c          **** 		nt = dir[DIR_NTres];		/* NT flag */
1325:ff.c          **** 		for (i = 0; i < 8; i++) {	/* Copy name body */
1326:ff.c          **** 			c = dir[i];
 196               		.stabn	68,0,1326,.LM9-.LFBB2
 197               	.LM9:
 198 00a8 FB01      		movw r30,r22
 199 00aa E80F      		add r30,r24
 200 00ac F91F      		adc r31,r25
 201 00ae E081      		ld r30,Z
1327:ff.c          **** 			if (c == ' ') break;
 202               		.stabn	68,0,1327,.LM10-.LFBB2
 203               	.LM10:
 204 00b0 E032      		cpi r30,lo8(32)
 205 00b2 01F0      		breq .L7
1328:ff.c          **** 			if (c == 0x05) c = 0xE5;
 206               		.stabn	68,0,1328,.LM11-.LFBB2
 207               	.LM11:
 208 00b4 E530      		cpi r30,lo8(5)
 209 00b6 01F4      		brne .L8
 210 00b8 E5EE      		ldi r30,lo8(-27)
 211               	.L8:
GAS LISTING /tmp/ccPugNTh.s 			page 28


1329:ff.c          **** 			if (_USE_LFN && (nt & NS_BODY) && IsUpper(c)) c += 0x20;
1330:ff.c          **** 			*p++ = c;
 212               		.stabn	68,0,1330,.LM12-.LFBB2
 213               	.LM12:
 214 00ba E993      		st Y+,r30
 215               		.stabn	68,0,1325,.LM13-.LFBB2
 216               	.LM13:
 217 00bc 0196      		adiw r24,1
 218 00be 8830      		cpi r24,8
 219 00c0 9105      		cpc r25,__zero_reg__
 220 00c2 01F4      		brne .L9
 221               	.L7:
1331:ff.c          **** 		}
1332:ff.c          **** 		if (dir[8] != ' ') {		/* Copy name extension */
 222               		.stabn	68,0,1332,.LM14-.LFBB2
 223               	.LM14:
 224 00c4 DB01      		movw r26,r22
 225 00c6 1896      		adiw r26,8
 226 00c8 8C91      		ld r24,X
 227 00ca 8032      		cpi r24,lo8(32)
 228 00cc 01F4      		brne .L10
 229 00ce 8E01      		movw r16,r28
 230 00d0 00C0      		rjmp .L11
 231               	.L10:
1333:ff.c          **** 			*p++ = '.';
 232               		.stabn	68,0,1333,.LM15-.LFBB2
 233               	.LM15:
 234 00d2 8EE2      		ldi r24,lo8(46)
 235 00d4 FE01      		movw r30,r28
 236 00d6 8193      		st Z+,r24
 237 00d8 8F01      		movw r16,r30
 238 00da FB01      		movw r30,r22
1334:ff.c          **** 			for (i = 8; i < 11; i++) {
 239               		.stabn	68,0,1334,.LM16-.LFBB2
 240               	.LM16:
 241 00dc 9E01      		movw r18,r28
 242 00de 2C5F      		subi r18,lo8(-(4))
 243 00e0 3F4F      		sbci r19,hi8(-(4))
 244               	.L12:
1335:ff.c          **** 				c = dir[i];
 245               		.stabn	68,0,1335,.LM17-.LFBB2
 246               	.LM17:
 247 00e2 8085      		ldd r24,Z+8
1336:ff.c          **** 				if (c == ' ') break;
 248               		.stabn	68,0,1336,.LM18-.LFBB2
 249               	.LM18:
 250 00e4 8032      		cpi r24,lo8(32)
 251 00e6 01F0      		breq .L11
1337:ff.c          **** 				if (_USE_LFN && (nt & NS_EXT) && IsUpper(c)) c += 0x20;
1338:ff.c          **** 				*p++ = c;
 252               		.stabn	68,0,1338,.LM19-.LFBB2
 253               	.LM19:
 254 00e8 D801      		movw r26,r16
 255 00ea 8D93      		st X+,r24
 256 00ec 8D01      		movw r16,r26
 257 00ee 3196      		adiw r30,1
 258               		.stabn	68,0,1334,.LM20-.LFBB2
GAS LISTING /tmp/ccPugNTh.s 			page 29


 259               	.LM20:
 260 00f0 A217      		cp r26,r18
 261 00f2 B307      		cpc r27,r19
 262 00f4 01F4      		brne .L12
 263               	.L11:
1339:ff.c          **** 			}
1340:ff.c          **** 		}
1341:ff.c          **** 		fno->fattrib = dir[DIR_Attr];				/* Attribute */
 264               		.stabn	68,0,1341,.LM21-.LFBB2
 265               	.LM21:
 266 00f6 FB01      		movw r30,r22
 267 00f8 8385      		ldd r24,Z+11
 268 00fa D701      		movw r26,r14
 269 00fc 1896      		adiw r26,8
 270 00fe 8C93      		st X,r24
1342:ff.c          **** 		fno->fsize = LD_DWORD(dir+DIR_FileSize);	/* Size */
 271               		.stabn	68,0,1342,.LM22-.LFBB2
 272               	.LM22:
 273 0100 278D      		ldd r18,Z+31
 274 0102 30E0      		ldi r19,lo8(0)
 275 0104 40E0      		ldi r20,lo8(0)
 276 0106 50E0      		ldi r21,hi8(0)
 277 0108 522F      		mov r21,r18
 278 010a 4427      		clr r20
 279 010c 3327      		clr r19
 280 010e 2227      		clr r18
 281 0110 868D      		ldd r24,Z+30
 282 0112 90E0      		ldi r25,lo8(0)
 283 0114 A0E0      		ldi r26,lo8(0)
 284 0116 B0E0      		ldi r27,hi8(0)
 285 0118 DC01      		movw r26,r24
 286 011a 9927      		clr r25
 287 011c 8827      		clr r24
 288 011e 282B      		or r18,r24
 289 0120 392B      		or r19,r25
 290 0122 4A2B      		or r20,r26
 291 0124 5B2B      		or r21,r27
 292 0126 848D      		ldd r24,Z+28
 293 0128 90E0      		ldi r25,lo8(0)
 294 012a A0E0      		ldi r26,lo8(0)
 295 012c B0E0      		ldi r27,hi8(0)
 296 012e 282B      		or r18,r24
 297 0130 392B      		or r19,r25
 298 0132 4A2B      		or r20,r26
 299 0134 5B2B      		or r21,r27
 300 0136 958D      		ldd r25,Z+29
 301 0138 80E0      		ldi r24,lo8(0)
 302 013a A0E0      		ldi r26,lo8(0)
 303 013c B0E0      		ldi r27,hi8(0)
 304 013e 282B      		or r18,r24
 305 0140 392B      		or r19,r25
 306 0142 4A2B      		or r20,r26
 307 0144 5B2B      		or r21,r27
 308 0146 F701      		movw r30,r14
 309 0148 2083      		st Z,r18
 310 014a 3183      		std Z+1,r19
 311 014c 4283      		std Z+2,r20
GAS LISTING /tmp/ccPugNTh.s 			page 30


 312 014e 5383      		std Z+3,r21
1343:ff.c          **** 		fno->fdate = LD_WORD(dir+DIR_WrtDate);		/* Date */
 313               		.stabn	68,0,1343,.LM23-.LFBB2
 314               	.LM23:
 315 0150 DB01      		movw r26,r22
 316 0152 5996      		adiw r26,25
 317 0154 9C91      		ld r25,X
 318 0156 5997      		sbiw r26,25
 319 0158 80E0      		ldi r24,lo8(0)
 320 015a 5896      		adiw r26,24
 321 015c 2C91      		ld r18,X
 322 015e 5897      		sbiw r26,24
 323 0160 30E0      		ldi r19,lo8(0)
 324 0162 822B      		or r24,r18
 325 0164 932B      		or r25,r19
 326 0166 9583      		std Z+5,r25
 327 0168 8483      		std Z+4,r24
1344:ff.c          **** 		fno->ftime = LD_WORD(dir+DIR_WrtTime);		/* Time */
 328               		.stabn	68,0,1344,.LM24-.LFBB2
 329               	.LM24:
 330 016a 5796      		adiw r26,23
 331 016c 9C91      		ld r25,X
 332 016e 5797      		sbiw r26,23
 333 0170 80E0      		ldi r24,lo8(0)
 334 0172 5696      		adiw r26,22
 335 0174 2C91      		ld r18,X
 336 0176 30E0      		ldi r19,lo8(0)
 337 0178 822B      		or r24,r18
 338 017a 932B      		or r25,r19
 339 017c 9783      		std Z+7,r25
 340 017e 8683      		std Z+6,r24
 341 0180 E801      		movw r28,r16
 342               	.L6:
1345:ff.c          **** 	}
1346:ff.c          **** 	*p = 0;
 343               		.stabn	68,0,1346,.LM25-.LFBB2
 344               	.LM25:
 345 0182 1882      		st Y,__zero_reg__
 346               	/* epilogue start */
1347:ff.c          **** 
1348:ff.c          **** #if _USE_LFN
1349:ff.c          **** 	if (fno->lfname) {
1350:ff.c          **** 		XCHAR *tp = fno->lfname;
1351:ff.c          **** 		WCHAR w, *lfn;
1352:ff.c          **** 
1353:ff.c          **** 		i = 0;
1354:ff.c          **** 		if (dj->sect && dj->lfn_idx != 0xFFFF) {/* Get LFN if available */
1355:ff.c          **** 			lfn = dj->lfn;
1356:ff.c          **** 			while ((w = *lfn++) != 0) {			/* Get an LFN char */
1357:ff.c          **** #if !_LFN_UNICODE
1358:ff.c          **** 				w = ff_convert(w, 0);			/* Unicode -> OEM conversion */
1359:ff.c          **** 				if (!w) { i = 0; break; }		/* Could not convert, no LFN */
1360:ff.c          **** 				if (_DF1S && w >= 0x100)		/* Put 1st byte if it is a DBC */
1361:ff.c          **** 					tp[i++] = (XCHAR)(w >> 8);
1362:ff.c          **** #endif
1363:ff.c          **** 				if (i >= fno->lfsize - 1) { i = 0; break; }	/* Buffer overrun, no LFN */
1364:ff.c          **** 				tp[i++] = (XCHAR)w;
GAS LISTING /tmp/ccPugNTh.s 			page 31


1365:ff.c          **** 			}
1366:ff.c          **** 		}
1367:ff.c          **** 		tp[i] = 0;	/* Terminator */
1368:ff.c          **** 	}
1369:ff.c          **** #endif
1370:ff.c          **** }
 347               		.stabn	68,0,1370,.LM26-.LFBB2
 348               	.LM26:
 349 0184 DF91      		pop r29
 350 0186 CF91      		pop r28
 351 0188 1F91      		pop r17
 352 018a 0F91      		pop r16
 353 018c FF90      		pop r15
 354 018e EF90      		pop r14
 355 0190 0895      		ret
 356               		.size	get_fileinfo, .-get_fileinfo
 357               		.stabs	"i:r(0,1)",64,0,1316,24
 358               		.stabs	"c:r(2,5)",64,0,1317,30
 359               		.stabs	"dir:r(1,8)",64,0,1317,22
 360               		.stabs	"p:r(0,18)=*(0,2)",64,0,1318,16
 361               		.stabn	192,0,0,.LFBB2-.LFBB2
 362               		.stabn	224,0,0,.Lscope2-.LFBB2
 363               	.Lscope2:
 364               		.stabs	"",36,0,0,.Lscope2-.LFBB2
 365               		.stabd	78,0,0
 366               		.stabs	"f_mount:F(1,16)",36,0,1632,f_mount
 367               		.stabs	"vol:P(2,5)",64,0,1629,24
 368               		.stabs	"fs:P(1,7)",64,0,1630,26
 369               	.global	f_mount
 370               		.type	f_mount, @function
 371               	f_mount:
 372               		.stabd	46,0,0
1371:ff.c          **** #endif /* _FS_MINIMIZE <= 1 */
1372:ff.c          **** 
1373:ff.c          **** 
1374:ff.c          **** 
1375:ff.c          **** 
1376:ff.c          **** /*-----------------------------------------------------------------------*/
1377:ff.c          **** /* Follow a file path                                                    */
1378:ff.c          **** /*-----------------------------------------------------------------------*/
1379:ff.c          **** 
1380:ff.c          **** static
1381:ff.c          **** FRESULT follow_path (	/* FR_OK(0): successful, !=0: error code */
1382:ff.c          **** 	DIR *dj,			/* Directory object to return last directory and found object */
1383:ff.c          **** 	const XCHAR *path	/* Full-path string to find a file or directory */
1384:ff.c          **** )
1385:ff.c          **** {
1386:ff.c          **** 	FRESULT res;
1387:ff.c          **** 	BYTE *dir, last;
1388:ff.c          **** 
1389:ff.c          **** 
1390:ff.c          **** 	while (!_USE_LFN && *path == ' ') path++;	/* Skip leading spaces */
1391:ff.c          **** #if _FS_RPATH
1392:ff.c          **** 	if (*path == '/' || *path == '\\') { /* There is a heading separator */
1393:ff.c          **** 		path++;	dj->sclust = 0;		/* Strip it and start from the root dir */
1394:ff.c          **** 	} else {							/* No heading saparator */
1395:ff.c          **** 		dj->sclust = dj->fs->cdir;	/* Start from the current dir */
GAS LISTING /tmp/ccPugNTh.s 			page 32


1396:ff.c          **** 	}
1397:ff.c          **** #else
1398:ff.c          **** 	if (*path == '/' || *path == '\\')	/* Strip heading separator if exist */
1399:ff.c          **** 		path++;
1400:ff.c          **** 	dj->sclust = 0;						/* Start from the root dir */
1401:ff.c          **** #endif
1402:ff.c          **** 
1403:ff.c          **** 	if ((UINT)*path < ' ') {			/* Null path means the start directory itself */
1404:ff.c          **** 		res = dir_seek(dj, 0);
1405:ff.c          **** 		dj->dir = NULL;
1406:ff.c          **** 
1407:ff.c          **** 	} else {							/* Follow path */
1408:ff.c          **** 		for (;;) {
1409:ff.c          **** 			res = create_name(dj, &path);	/* Get a segment */
1410:ff.c          **** 			if (res != FR_OK) break;
1411:ff.c          **** 			res = dir_find(dj);				/* Find it */
1412:ff.c          **** 			last = *(dj->fn+NS) & NS_LAST;
1413:ff.c          **** 			if (res != FR_OK) {				/* Could not find the object */
1414:ff.c          **** 				if (res == FR_NO_FILE && !last)
1415:ff.c          **** 					res = FR_NO_PATH;
1416:ff.c          **** 				break;
1417:ff.c          **** 			}
1418:ff.c          **** 			if (last) break;				/* Last segment match. Function completed. */
1419:ff.c          **** 			dir = dj->dir;					/* There is next segment. Follow the sub directory */
1420:ff.c          **** 			if (!(dir[DIR_Attr] & AM_DIR)) { /* Cannot follow because it is a file */
1421:ff.c          **** 				res = FR_NO_PATH; break;
1422:ff.c          **** 			}
1423:ff.c          **** 			dj->sclust = ((DWORD)LD_WORD(dir+DIR_FstClusHI) << 16) | LD_WORD(dir+DIR_FstClusLO);
1424:ff.c          **** 		}
1425:ff.c          **** 	}
1426:ff.c          **** 
1427:ff.c          **** 	return res;
1428:ff.c          **** }
1429:ff.c          **** 
1430:ff.c          **** 
1431:ff.c          **** 
1432:ff.c          **** 
1433:ff.c          **** /*-----------------------------------------------------------------------*/
1434:ff.c          **** /* Load boot record and check if it is an FAT boot record                */
1435:ff.c          **** /*-----------------------------------------------------------------------*/
1436:ff.c          **** 
1437:ff.c          **** static
1438:ff.c          **** BYTE check_fs (	/* 0:The FAT boot record, 1:Valid boot record but not an FAT, 2:Not a boot record, 
1439:ff.c          **** 	FATFS *fs,	/* File system object */
1440:ff.c          **** 	DWORD sect	/* Sector# (lba) to check if it is an FAT boot record or not */
1441:ff.c          **** )
1442:ff.c          **** {
1443:ff.c          **** 	if (disk_read(fs->drive, fs->win, sect, 1) != RES_OK)	/* Load boot record */
1444:ff.c          **** 		return 3;
1445:ff.c          **** 	if (LD_WORD(&fs->win[BS_55AA]) != 0xAA55)		/* Check record signature (always placed at offset 510 
1446:ff.c          **** 		return 2;
1447:ff.c          **** 
1448:ff.c          **** 	if ((LD_DWORD(&fs->win[BS_FilSysType]) & 0xFFFFFF) == 0x544146)	/* Check "FAT" string */
1449:ff.c          **** 		return 0;
1450:ff.c          **** 	if ((LD_DWORD(&fs->win[BS_FilSysType32]) & 0xFFFFFF) == 0x544146)
1451:ff.c          **** 		return 0;
1452:ff.c          **** 
GAS LISTING /tmp/ccPugNTh.s 			page 33


1453:ff.c          **** 	return 1;
1454:ff.c          **** }
1455:ff.c          **** 
1456:ff.c          **** 
1457:ff.c          **** 
1458:ff.c          **** 
1459:ff.c          **** /*-----------------------------------------------------------------------*/
1460:ff.c          **** /* Make sure that the file system is valid                               */
1461:ff.c          **** /*-----------------------------------------------------------------------*/
1462:ff.c          **** 
1463:ff.c          **** 
1464:ff.c          **** FRESULT chk_mounted (	/* FR_OK(0): successful, !=0: any error occured */
1465:ff.c          **** 	const XCHAR **path,	/* Pointer to pointer to the path name (drive number) */
1466:ff.c          **** 	FATFS **rfs,		/* Pointer to pointer to the found file system object */
1467:ff.c          **** 	BYTE chk_wp			/* !=0: Check media write protection for write access */
1468:ff.c          **** )
1469:ff.c          **** {
1470:ff.c          **** 	BYTE fmt, *tbl;
1471:ff.c          **** 	UINT vol;
1472:ff.c          **** 	DSTATUS stat;
1473:ff.c          **** 	DWORD bsect, fsize, tsect, mclst;
1474:ff.c          **** 	const XCHAR *p = *path;
1475:ff.c          **** 	FATFS *fs;
1476:ff.c          **** 
1477:ff.c          **** 	/* Get logical drive number from the path name */
1478:ff.c          **** 	vol = p[0] - '0';				/* Is there a drive number? */
1479:ff.c          **** 	if (vol <= 9 && p[1] == ':') {	/* Found a drive number, get and strip it */
1480:ff.c          **** 		p += 2; *path = p;			/* Return pointer to the path name */
1481:ff.c          **** 	} else {						/* No drive number is given */
1482:ff.c          **** #if _FS_RPATH
1483:ff.c          **** 		vol = Drive;				/* Use current drive */
1484:ff.c          **** #else
1485:ff.c          **** 		vol = 0;					/* Use drive 0 */
1486:ff.c          **** #endif
1487:ff.c          **** 	}
1488:ff.c          **** 
1489:ff.c          **** 	/* Check if the logical drive is valid or not */
1490:ff.c          **** 	if (vol >= _DRIVES) 			/* Is the drive number valid? */
1491:ff.c          **** 		return FR_INVALID_DRIVE;
1492:ff.c          **** 	*rfs = fs = FatFs[vol];			/* Returen pointer to the corresponding file system object */
1493:ff.c          **** 	if (!fs) return FR_NOT_ENABLED;	/* Is the file system object available? */
1494:ff.c          **** 
1495:ff.c          **** 	ENTER_FF(fs);					/* Lock file system */
1496:ff.c          **** 
1497:ff.c          **** 	if (fs->fs_type) {				/* If the logical drive has been mounted */
1498:ff.c          **** 		stat = disk_status(fs->drive);
1499:ff.c          **** 		if (!(stat & STA_NOINIT)) {	/* and the physical drive is kept initialized (has not been changed),
1500:ff.c          **** #if !_FS_READONLY
1501:ff.c          **** 			if (chk_wp && (stat & STA_PROTECT))	/* Check write protection if needed */
1502:ff.c          **** 				return FR_WRITE_PROTECTED;
1503:ff.c          **** #endif
1504:ff.c          **** 			return FR_OK;			/* The file system object is valid */
1505:ff.c          **** 		}
1506:ff.c          **** 	}
1507:ff.c          **** 
1508:ff.c          **** 	/* The logical drive must be mounted. Following code attempts to mount the volume */
1509:ff.c          **** 
GAS LISTING /tmp/ccPugNTh.s 			page 34


1510:ff.c          **** 	fs->fs_type = 0;					/* Clear the file system object */
1511:ff.c          **** 	fs->drive = (BYTE)LD2PD(vol);		/* Bind the logical drive and a physical drive */
1512:ff.c          **** 	stat = disk_initialize(fs->drive);	/* Initialize low level disk I/O layer */
1513:ff.c          **** 	if (stat & STA_NOINIT)				/* Check if the drive is ready */
1514:ff.c          **** 		return FR_NOT_READY;
1515:ff.c          **** #if _MAX_SS != 512						/* Get disk sector size if needed */
1516:ff.c          **** 	if (disk_ioctl(fs->drive, GET_SECTOR_SIZE, &SS(fs)) != RES_OK || SS(fs) > _MAX_SS)
1517:ff.c          **** 		return FR_NO_FILESYSTEM;
1518:ff.c          **** #endif
1519:ff.c          **** #if !_FS_READONLY
1520:ff.c          **** 	if (chk_wp && (stat & STA_PROTECT))	/* Check disk write protection if needed */
1521:ff.c          **** 		return FR_WRITE_PROTECTED;
1522:ff.c          **** #endif
1523:ff.c          **** 	/* Search FAT partition on the drive */
1524:ff.c          **** 	fmt = check_fs(fs, bsect = 0);		/* Check sector 0 as an SFD format */
1525:ff.c          **** 	if (fmt == 1) {						/* Not an FAT boot record, it may be patitioned */
1526:ff.c          **** 		/* Check a partition listed in top of the partition table */
1527:ff.c          **** 		tbl = &fs->win[MBR_Table + LD2PT(vol) * 16];	/* Partition table */
1528:ff.c          **** 		if (tbl[4]) {									/* Is the partition existing? */
1529:ff.c          **** 			bsect = LD_DWORD(&tbl[8]);					/* Partition offset in LBA */
1530:ff.c          **** 			fmt = check_fs(fs, bsect);					/* Check the partition */
1531:ff.c          **** 		}
1532:ff.c          **** 	}
1533:ff.c          **** 	if (fmt == 3) return FR_DISK_ERR;
1534:ff.c          **** 	if (fmt || LD_WORD(fs->win+BPB_BytsPerSec) != SS(fs))	/* No valid FAT patition is found */
1535:ff.c          **** 		return FR_NO_FILESYSTEM;
1536:ff.c          **** 
1537:ff.c          **** 	/* Initialize the file system object */
1538:ff.c          **** 	fsize = LD_WORD(fs->win+BPB_FATSz16);				/* Number of sectors per FAT */
1539:ff.c          **** 	if (!fsize) fsize = LD_DWORD(fs->win+BPB_FATSz32);
1540:ff.c          **** 	fs->sects_fat = fsize;
1541:ff.c          **** 	fs->n_fats = fs->win[BPB_NumFATs];					/* Number of FAT copies */
1542:ff.c          **** 	fsize *= fs->n_fats;								/* (Number of sectors in FAT area) */
1543:ff.c          **** 	fs->fatbase = bsect + LD_WORD(fs->win+BPB_RsvdSecCnt); /* FAT start sector (lba) */
1544:ff.c          **** 	fs->csize = fs->win[BPB_SecPerClus];				/* Number of sectors per cluster */
1545:ff.c          **** 	fs->n_rootdir = LD_WORD(fs->win+BPB_RootEntCnt);	/* Nmuber of root directory entries */
1546:ff.c          **** 	tsect = LD_WORD(fs->win+BPB_TotSec16);				/* Number of sectors on the volume */
1547:ff.c          **** 	if (!tsect) tsect = LD_DWORD(fs->win+BPB_TotSec32);
1548:ff.c          **** 	fs->max_clust = mclst = (tsect						/* Last cluster# + 1 (Number of clusters + 2) */
1549:ff.c          **** 		- LD_WORD(fs->win+BPB_RsvdSecCnt) - fsize - fs->n_rootdir / (SS(fs)/32)
1550:ff.c          **** 		) / fs->csize + 2;
1551:ff.c          **** 
1552:ff.c          **** 	fmt = FS_FAT12;										/* Determine the FAT sub type */
1553:ff.c          **** 	if (mclst >= 0xFF7) fmt = FS_FAT16;					/* Number of clusters >= 0xFF5 */
1554:ff.c          **** 	if (mclst >= 0xFFF7) fmt = FS_FAT32;				/* Number of clusters >= 0xFFF5 */
1555:ff.c          **** 
1556:ff.c          **** 	if (fmt == FS_FAT32)
1557:ff.c          **** 		fs->dirbase = LD_DWORD(fs->win+BPB_RootClus);	/* Root directory start cluster */
1558:ff.c          **** 	else
1559:ff.c          **** 		fs->dirbase = fs->fatbase + fsize;				/* Root directory start sector (lba) */
1560:ff.c          **** 	fs->database = fs->fatbase + fsize + fs->n_rootdir / (SS(fs)/32);	/* Data start sector (lba) */
1561:ff.c          **** 
1562:ff.c          **** #if !_FS_READONLY
1563:ff.c          **** 	/* Initialize allocation information */
1564:ff.c          **** 	fs->free_clust = 0xFFFFFFFF;
1565:ff.c          **** 	fs->wflag = 0;
1566:ff.c          **** 	/* Get fsinfo if needed */
GAS LISTING /tmp/ccPugNTh.s 			page 35


1567:ff.c          **** 	if (fmt == FS_FAT32) {
1568:ff.c          **** 	 	fs->fsi_flag = 0;
1569:ff.c          **** 		fs->fsi_sector = bsect + LD_WORD(fs->win+BPB_FSInfo);
1570:ff.c          **** 		if (disk_read(fs->drive, fs->win, fs->fsi_sector, 1) == RES_OK &&
1571:ff.c          **** 			LD_WORD(fs->win+BS_55AA) == 0xAA55 &&
1572:ff.c          **** 			LD_DWORD(fs->win+FSI_LeadSig) == 0x41615252 &&
1573:ff.c          **** 			LD_DWORD(fs->win+FSI_StrucSig) == 0x61417272) {
1574:ff.c          **** 			fs->last_clust = LD_DWORD(fs->win+FSI_Nxt_Free);
1575:ff.c          **** 			fs->free_clust = LD_DWORD(fs->win+FSI_Free_Count);
1576:ff.c          **** 		}
1577:ff.c          **** 	}
1578:ff.c          **** #endif
1579:ff.c          **** 	fs->fs_type = fmt;		/* FAT sub-type */
1580:ff.c          **** 	fs->winsect = 0;		/* Invalidate sector cache */
1581:ff.c          **** #if _FS_RPATH
1582:ff.c          **** 	fs->cdir = 0;			/* Current directory (root dir) */
1583:ff.c          **** #endif
1584:ff.c          **** 	fs->id = ++Fsid;		/* File system mount ID */
1585:ff.c          **** 
1586:ff.c          **** 	return FR_OK;
1587:ff.c          **** }
1588:ff.c          **** 
1589:ff.c          **** 
1590:ff.c          **** 
1591:ff.c          **** 
1592:ff.c          **** /*-----------------------------------------------------------------------*/
1593:ff.c          **** /* Check if the file/dir object is valid or not                          */
1594:ff.c          **** /*-----------------------------------------------------------------------*/
1595:ff.c          **** 
1596:ff.c          **** static
1597:ff.c          **** FRESULT validate (	/* FR_OK(0): The object is valid, !=0: Invalid */
1598:ff.c          **** 	FATFS *fs,		/* Pointer to the file system object */
1599:ff.c          **** 	WORD id			/* Member id of the target object to be checked */
1600:ff.c          **** )
1601:ff.c          **** {
1602:ff.c          **** 	if (!fs || !fs->fs_type || fs->id != id)
1603:ff.c          **** 		return FR_INVALID_OBJECT;
1604:ff.c          **** 
1605:ff.c          **** 	ENTER_FF(fs);		/* Lock file system */
1606:ff.c          **** 
1607:ff.c          **** 	if (disk_status(fs->drive) & STA_NOINIT)
1608:ff.c          **** 		return FR_NOT_READY;
1609:ff.c          **** 
1610:ff.c          **** 	return FR_OK;
1611:ff.c          **** }
1612:ff.c          **** 
1613:ff.c          **** 
1614:ff.c          **** 
1615:ff.c          **** 
1616:ff.c          **** /*--------------------------------------------------------------------------
1617:ff.c          **** 
1618:ff.c          ****    Public Functions
1619:ff.c          **** 
1620:ff.c          **** --------------------------------------------------------------------------*/
1621:ff.c          **** 
1622:ff.c          **** 
1623:ff.c          **** 
GAS LISTING /tmp/ccPugNTh.s 			page 36


1624:ff.c          **** /*-----------------------------------------------------------------------*/
1625:ff.c          **** /* Mount/Unmount a Locical Drive                                         */
1626:ff.c          **** /*-----------------------------------------------------------------------*/
1627:ff.c          **** 
1628:ff.c          **** FRESULT f_mount (
1629:ff.c          **** 	BYTE vol,		/* Logical drive number to be mounted/unmounted */
1630:ff.c          **** 	FATFS *fs		/* Pointer to new file system object (NULL for unmount)*/
1631:ff.c          **** )
1632:ff.c          **** {
 373               		.stabn	68,0,1632,.LM27-.LFBB3
 374               	.LM27:
 375               	.LFBB3:
 376               	/* prologue: function */
 377               	/* frame size = 0 */
 378 0192 DB01      		movw r26,r22
1633:ff.c          **** 	FATFS *rfs;
1634:ff.c          **** 
1635:ff.c          **** 
1636:ff.c          **** 	if (vol >= _DRIVES)				/* Check if the drive number is valid */
 379               		.stabn	68,0,1636,.LM28-.LFBB3
 380               	.LM28:
 381 0194 8823      		tst r24
 382 0196 01F0      		breq .L17
 383 0198 8BE0      		ldi r24,lo8(11)
 384 019a 0895      		ret
 385               	.L17:
1637:ff.c          **** 		return FR_INVALID_DRIVE;
1638:ff.c          **** 	rfs = FatFs[vol];				/* Get current fs object */
 386               		.stabn	68,0,1638,.LM29-.LFBB3
 387               	.LM29:
 388 019c E091 0000 		lds r30,FatFs
 389 01a0 F091 0000 		lds r31,(FatFs)+1
1639:ff.c          **** 
1640:ff.c          **** 	if (rfs) {
 390               		.stabn	68,0,1640,.LM30-.LFBB3
 391               	.LM30:
 392 01a4 3097      		sbiw r30,0
 393 01a6 01F0      		breq .L19
1641:ff.c          **** #if _FS_REENTRANT					/* Discard sync object of the current volume */
1642:ff.c          **** 		if (!ff_del_syncobj(rfs->sobj)) return FR_INT_ERR;
1643:ff.c          **** #endif
1644:ff.c          **** 		rfs->fs_type = 0;			/* Clear old fs object */
 394               		.stabn	68,0,1644,.LM31-.LFBB3
 395               	.LM31:
 396 01a8 1082      		st Z,__zero_reg__
 397               	.L19:
1645:ff.c          **** 	}
1646:ff.c          **** 
1647:ff.c          **** 	if (fs) {
 398               		.stabn	68,0,1647,.LM32-.LFBB3
 399               	.LM32:
 400 01aa 1097      		sbiw r26,0
 401 01ac 01F0      		breq .L20
1648:ff.c          **** 		fs->fs_type = 0;			/* Clear new fs object */
 402               		.stabn	68,0,1648,.LM33-.LFBB3
 403               	.LM33:
 404 01ae 1C92      		st X,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 37


 405               	.L20:
1649:ff.c          **** #if _FS_REENTRANT					/* Create sync object for the new volume */
1650:ff.c          **** 		if (!ff_cre_syncobj(vol, &fs->sobj)) return FR_INT_ERR;
1651:ff.c          **** #endif
1652:ff.c          **** 	}
1653:ff.c          **** 	FatFs[vol] = fs;				/* Register new fs object */
 406               		.stabn	68,0,1653,.LM34-.LFBB3
 407               	.LM34:
 408 01b0 B093 0000 		sts (FatFs)+1,r27
 409 01b4 A093 0000 		sts FatFs,r26
 410 01b8 80E0      		ldi r24,lo8(0)
1654:ff.c          **** 
1655:ff.c          **** 	return FR_OK;
1656:ff.c          **** }
 411               		.stabn	68,0,1656,.LM35-.LFBB3
 412               	.LM35:
 413 01ba 0895      		ret
 414               		.size	f_mount, .-f_mount
 415               		.stabs	"rfs:r(1,7)",64,0,1633,30
 416               		.stabn	192,0,0,.LFBB3-.LFBB3
 417               		.stabn	224,0,0,.Lscope3-.LFBB3
 418               	.Lscope3:
 419               		.stabs	"",36,0,0,.Lscope3-.LFBB3
 420               		.stabd	78,0,0
 421               		.stabs	"move_window:f(1,16)",36,0,247,move_window
 422               		.stabs	"fs:P(1,7)",64,0,244,28
 423               		.stabs	"sector:P(2,12)",64,0,245,8
 424               		.type	move_window, @function
 425               	move_window:
 426               		.stabd	46,0,0
 427               		.stabn	68,0,247,.LM36-.LFBB4
 428               	.LM36:
 429               	.LFBB4:
 430 01bc 6F92      		push r6
 431 01be 7F92      		push r7
 432 01c0 8F92      		push r8
 433 01c2 9F92      		push r9
 434 01c4 AF92      		push r10
 435 01c6 BF92      		push r11
 436 01c8 CF92      		push r12
 437 01ca DF92      		push r13
 438 01cc EF92      		push r14
 439 01ce FF92      		push r15
 440 01d0 0F93      		push r16
 441 01d2 1F93      		push r17
 442 01d4 CF93      		push r28
 443 01d6 DF93      		push r29
 444               	/* prologue: function */
 445               	/* frame size = 0 */
 446 01d8 EC01      		movw r28,r24
 447 01da 4A01      		movw r8,r20
 448 01dc 5B01      		movw r10,r22
 449               		.stabn	68,0,251,.LM37-.LFBB4
 450               	.LM37:
 451 01de CAA4      		ldd r12,Y+42
 452 01e0 DBA4      		ldd r13,Y+43
 453 01e2 ECA4      		ldd r14,Y+44
GAS LISTING /tmp/ccPugNTh.s 			page 38


 454 01e4 FDA4      		ldd r15,Y+45
 455               		.stabn	68,0,252,.LM38-.LFBB4
 456               	.LM38:
 457 01e6 C416      		cp r12,r20
 458 01e8 D506      		cpc r13,r21
 459 01ea E606      		cpc r14,r22
 460 01ec F706      		cpc r15,r23
 461 01ee 01F4      		brne .+2
 462 01f0 00C0      		rjmp .L23
 463               		.stabn	68,0,254,.LM39-.LFBB4
 464               	.LM39:
 465 01f2 8C81      		ldd r24,Y+4
 466 01f4 8823      		tst r24
 467 01f6 01F0      		breq .L24
 468               		.stabn	68,0,255,.LM40-.LFBB4
 469               	.LM40:
 470 01f8 9EE2      		ldi r25,lo8(46)
 471 01fa 692E      		mov r6,r25
 472 01fc 712C      		mov r7,__zero_reg__
 473 01fe 6C0E      		add r6,r28
 474 0200 7D1E      		adc r7,r29
 475 0202 8981      		ldd r24,Y+1
 476 0204 B301      		movw r22,r6
 477 0206 A701      		movw r20,r14
 478 0208 9601      		movw r18,r12
 479 020a 01E0      		ldi r16,lo8(1)
 480 020c 0E94 0000 		call disk_write
 481 0210 8823      		tst r24
 482 0212 01F4      		brne .L25
 483               		.stabn	68,0,257,.LM41-.LFBB4
 484               	.LM41:
 485 0214 1C82      		std Y+4,__zero_reg__
 486               		.stabn	68,0,258,.LM42-.LFBB4
 487               	.LM42:
 488 0216 8E89      		ldd r24,Y+22
 489 0218 9F89      		ldd r25,Y+23
 490 021a A88D      		ldd r26,Y+24
 491 021c B98D      		ldd r27,Y+25
 492 021e 2E8D      		ldd r18,Y+30
 493 0220 3F8D      		ldd r19,Y+31
 494 0222 48A1      		ldd r20,Y+32
 495 0224 59A1      		ldd r21,Y+33
 496 0226 820F      		add r24,r18
 497 0228 931F      		adc r25,r19
 498 022a A41F      		adc r26,r20
 499 022c B51F      		adc r27,r21
 500 022e C816      		cp r12,r24
 501 0230 D906      		cpc r13,r25
 502 0232 EA06      		cpc r14,r26
 503 0234 FB06      		cpc r15,r27
 504 0236 00F4      		brsh .L24
 505               	.LBB67:
 506               		.stabn	68,0,260,.LM43-.LFBB4
 507               	.LM43:
 508 0238 1B81      		ldd r17,Y+3
 509 023a 00C0      		rjmp .L26
 510               	.L27:
GAS LISTING /tmp/ccPugNTh.s 			page 39


 511               		.stabn	68,0,261,.LM44-.LFBB4
 512               	.LM44:
 513 023c 8E89      		ldd r24,Y+22
 514 023e 9F89      		ldd r25,Y+23
 515 0240 A88D      		ldd r26,Y+24
 516 0242 B98D      		ldd r27,Y+25
 517 0244 C80E      		add r12,r24
 518 0246 D91E      		adc r13,r25
 519 0248 EA1E      		adc r14,r26
 520 024a FB1E      		adc r15,r27
 521               		.stabn	68,0,262,.LM45-.LFBB4
 522               	.LM45:
 523 024c 8981      		ldd r24,Y+1
 524 024e B301      		movw r22,r6
 525 0250 A701      		movw r20,r14
 526 0252 9601      		movw r18,r12
 527 0254 01E0      		ldi r16,lo8(1)
 528 0256 0E94 0000 		call disk_write
 529               		.stabn	68,0,260,.LM46-.LFBB4
 530               	.LM46:
 531 025a 1150      		subi r17,lo8(-(-1))
 532               	.L26:
 533 025c 1230      		cpi r17,lo8(2)
 534 025e 00F4      		brsh .L27
 535               	.L24:
 536               	.LBE67:
 537               		.stabn	68,0,267,.LM47-.LFBB4
 538               	.LM47:
 539 0260 8114      		cp r8,__zero_reg__
 540 0262 9104      		cpc r9,__zero_reg__
 541 0264 A104      		cpc r10,__zero_reg__
 542 0266 B104      		cpc r11,__zero_reg__
 543 0268 01F0      		breq .L23
 544               		.stabn	68,0,268,.LM48-.LFBB4
 545               	.LM48:
 546 026a BE01      		movw r22,r28
 547 026c 625D      		subi r22,lo8(-(46))
 548 026e 7F4F      		sbci r23,hi8(-(46))
 549 0270 8981      		ldd r24,Y+1
 550 0272 A501      		movw r20,r10
 551 0274 9401      		movw r18,r8
 552 0276 01E0      		ldi r16,lo8(1)
 553 0278 0E94 0000 		call disk_read
 554 027c 8823      		tst r24
 555 027e 01F4      		brne .L25
 556               		.stabn	68,0,270,.LM49-.LFBB4
 557               	.LM49:
 558 0280 8AA6      		std Y+42,r8
 559 0282 9BA6      		std Y+43,r9
 560 0284 ACA6      		std Y+44,r10
 561 0286 BDA6      		std Y+45,r11
 562 0288 00C0      		rjmp .L28
 563               	.L25:
 564 028a 81E0      		ldi r24,lo8(1)
 565 028c 00C0      		rjmp .L28
 566               	.L23:
 567 028e 80E0      		ldi r24,lo8(0)
GAS LISTING /tmp/ccPugNTh.s 			page 40


 568               	.L28:
 569               	/* epilogue start */
 570               		.stabn	68,0,275,.LM50-.LFBB4
 571               	.LM50:
 572 0290 DF91      		pop r29
 573 0292 CF91      		pop r28
 574 0294 1F91      		pop r17
 575 0296 0F91      		pop r16
 576 0298 FF90      		pop r15
 577 029a EF90      		pop r14
 578 029c DF90      		pop r13
 579 029e CF90      		pop r12
 580 02a0 BF90      		pop r11
 581 02a2 AF90      		pop r10
 582 02a4 9F90      		pop r9
 583 02a6 8F90      		pop r8
 584 02a8 7F90      		pop r7
 585 02aa 6F90      		pop r6
 586 02ac 0895      		ret
 587               		.size	move_window, .-move_window
 588               		.stabs	"wsect:r(2,12)",64,0,248,12
 589               		.stabn	192,0,0,.LFBB4-.LFBB4
 590               		.stabs	"nf:r(2,5)",64,0,259,17
 591               		.stabn	192,0,0,.LBB67-.LFBB4
 592               		.stabn	224,0,0,.LBE67-.LFBB4
 593               		.stabn	224,0,0,.Lscope4-.LFBB4
 594               	.Lscope4:
 595               		.stabs	"",36,0,0,.Lscope4-.LFBB4
 596               		.stabd	78,0,0
 597               		.stabs	"put_fat:F(1,16)",36,0,370,put_fat
 598               		.stabs	"fs:P(1,7)",64,0,366,6
 599               		.stabs	"clst:P(2,12)",64,0,367,12
 600               		.stabs	"val:P(2,12)",64,0,368,8
 601               	.global	put_fat
 602               		.type	put_fat, @function
 603               	put_fat:
 604               		.stabd	46,0,0
 605               		.stabn	68,0,370,.LM51-.LFBB5
 606               	.LM51:
 607               	.LFBB5:
 608 02ae 2F92      		push r2
 609 02b0 3F92      		push r3
 610 02b2 4F92      		push r4
 611 02b4 5F92      		push r5
 612 02b6 6F92      		push r6
 613 02b8 7F92      		push r7
 614 02ba 8F92      		push r8
 615 02bc 9F92      		push r9
 616 02be AF92      		push r10
 617 02c0 BF92      		push r11
 618 02c2 CF92      		push r12
 619 02c4 DF92      		push r13
 620 02c6 EF92      		push r14
 621 02c8 FF92      		push r15
 622 02ca 0F93      		push r16
 623 02cc 1F93      		push r17
 624 02ce CF93      		push r28
GAS LISTING /tmp/ccPugNTh.s 			page 41


 625 02d0 DF93      		push r29
 626               	/* prologue: function */
 627               	/* frame size = 0 */
 628 02d2 3C01      		movw r6,r24
 629 02d4 6A01      		movw r12,r20
 630 02d6 7B01      		movw r14,r22
 631 02d8 4801      		movw r8,r16
 632 02da 5901      		movw r10,r18
 633               		.stabn	68,0,377,.LM52-.LFBB5
 634               	.LM52:
 635 02dc 4230      		cpi r20,lo8(2)
 636 02de 5105      		cpc r21,__zero_reg__
 637 02e0 6105      		cpc r22,__zero_reg__
 638 02e2 7105      		cpc r23,__zero_reg__
 639 02e4 00F4      		brsh .+2
 640 02e6 00C0      		rjmp .L31
 641 02e8 F301      		movw r30,r6
 642 02ea 828D      		ldd r24,Z+26
 643 02ec 938D      		ldd r25,Z+27
 644 02ee A48D      		ldd r26,Z+28
 645 02f0 B58D      		ldd r27,Z+29
 646 02f2 4817      		cp r20,r24
 647 02f4 5907      		cpc r21,r25
 648 02f6 6A07      		cpc r22,r26
 649 02f8 7B07      		cpc r23,r27
 650 02fa 00F0      		brlo .+2
 651 02fc 00C0      		rjmp .L31
 652               		.stabn	68,0,381,.LM53-.LFBB5
 653               	.LM53:
 654 02fe 268C      		ldd r2,Z+30
 655 0300 378C      		ldd r3,Z+31
 656 0302 40A0      		ldd r4,Z+32
 657 0304 51A0      		ldd r5,Z+33
 658               		.stabn	68,0,382,.LM54-.LFBB5
 659               	.LM54:
 660 0306 8081      		ld r24,Z
 661 0308 8230      		cpi r24,lo8(2)
 662 030a 01F4      		brne .+2
 663 030c 00C0      		rjmp .L34
 664 030e 8330      		cpi r24,lo8(3)
 665 0310 01F4      		brne .+2
 666 0312 00C0      		rjmp .L35
 667 0314 8130      		cpi r24,lo8(1)
 668 0316 01F0      		breq .L33
 669 0318 22E0      		ldi r18,lo8(2)
 670 031a 00C0      		rjmp .L36
 671               	.L33:
 672               		.stabn	68,0,384,.LM55-.LFBB5
 673               	.LM55:
 674 031c EA01      		movw r28,r20
 675 031e D695      		lsr r29
 676 0320 C795      		ror r28
 677 0322 C40F      		add r28,r20
 678 0324 D51F      		adc r29,r21
 679               		.stabn	68,0,385,.LM56-.LFBB5
 680               	.LM56:
 681 0326 AE01      		movw r20,r28
GAS LISTING /tmp/ccPugNTh.s 			page 42


 682 0328 452F      		mov r20,r21
 683 032a 5527      		clr r21
 684 032c 4695      		lsr r20
 685 032e 60E0      		ldi r22,lo8(0)
 686 0330 70E0      		ldi r23,hi8(0)
 687 0332 420D      		add r20,r2
 688 0334 531D      		adc r21,r3
 689 0336 641D      		adc r22,r4
 690 0338 751D      		adc r23,r5
 691 033a C301      		movw r24,r6
 692 033c 0E94 0000 		call move_window
 693 0340 282F      		mov r18,r24
 694               		.stabn	68,0,386,.LM57-.LFBB5
 695               	.LM57:
 696 0342 8823      		tst r24
 697 0344 01F0      		breq .+2
 698 0346 00C0      		rjmp .L36
 699               		.stabn	68,0,387,.LM58-.LFBB5
 700               	.LM58:
 701 0348 DE01      		movw r26,r28
 702 034a B170      		andi r27,hi8(511)
 703               		.stabn	68,0,388,.LM59-.LFBB5
 704               	.LM59:
 705 034c 8601      		movw r16,r12
 706 034e 0170      		andi r16,lo8(1)
 707 0350 1070      		andi r17,hi8(1)
 708 0352 0115      		cp r16,__zero_reg__
 709 0354 1105      		cpc r17,__zero_reg__
 710 0356 01F0      		breq .L37
 711 0358 F301      		movw r30,r6
 712 035a EA0F      		add r30,r26
 713 035c FB1F      		adc r31,r27
 714 035e 86A5      		ldd r24,Z+46
 715 0360 8F70      		andi r24,lo8(15)
 716 0362 982D      		mov r25,r8
 717 0364 9295      		swap r25
 718 0366 907F      		andi r25,lo8(-16)
 719 0368 982B      		or r25,r24
 720 036a 00C0      		rjmp .L38
 721               	.L37:
 722 036c 982D      		mov r25,r8
 723               	.L38:
 724 036e A60D      		add r26,r6
 725 0370 B71D      		adc r27,r7
 726 0372 9E96      		adiw r26,46
 727 0374 9C93      		st X,r25
 728               		.stabn	68,0,389,.LM60-.LFBB5
 729               	.LM60:
 730 0376 2196      		adiw r28,1
 731               		.stabn	68,0,390,.LM61-.LFBB5
 732               	.LM61:
 733 0378 81E0      		ldi r24,lo8(1)
 734 037a F301      		movw r30,r6
 735 037c 8483      		std Z+4,r24
 736               		.stabn	68,0,391,.LM62-.LFBB5
 737               	.LM62:
 738 037e AE01      		movw r20,r28
GAS LISTING /tmp/ccPugNTh.s 			page 43


 739 0380 452F      		mov r20,r21
 740 0382 5527      		clr r21
 741 0384 4695      		lsr r20
 742 0386 60E0      		ldi r22,lo8(0)
 743 0388 70E0      		ldi r23,hi8(0)
 744 038a 420D      		add r20,r2
 745 038c 531D      		adc r21,r3
 746 038e 641D      		adc r22,r4
 747 0390 751D      		adc r23,r5
 748 0392 C301      		movw r24,r6
 749 0394 0E94 0000 		call move_window
 750 0398 282F      		mov r18,r24
 751               		.stabn	68,0,392,.LM63-.LFBB5
 752               	.LM63:
 753 039a 8823      		tst r24
 754 039c 01F0      		breq .+2
 755 039e 00C0      		rjmp .L36
 756               		.stabn	68,0,393,.LM64-.LFBB5
 757               	.LM64:
 758 03a0 D170      		andi r29,hi8(511)
 759               		.stabn	68,0,394,.LM65-.LFBB5
 760               	.LM65:
 761 03a2 012B      		or r16,r17
 762 03a4 01F0      		breq .L39
 763 03a6 84E0      		ldi r24,4
 764 03a8 B694      	1:	lsr r11
 765 03aa A794      		ror r10
 766 03ac 9794      		ror r9
 767 03ae 8794      		ror r8
 768 03b0 8A95      		dec r24
 769 03b2 01F4      		brne 1b
 770 03b4 482D      		mov r20,r8
 771 03b6 00C0      		rjmp .L40
 772               	.L39:
 773 03b8 F301      		movw r30,r6
 774 03ba EC0F      		add r30,r28
 775 03bc FD1F      		adc r31,r29
 776 03be 46A5      		ldd r20,Z+46
 777 03c0 407F      		andi r20,lo8(-16)
 778 03c2 BB27      		clr r27
 779 03c4 AB2D      		mov r26,r11
 780 03c6 9A2D      		mov r25,r10
 781 03c8 892D      		mov r24,r9
 782 03ca 8F70      		andi r24,lo8(15)
 783 03cc 482B      		or r20,r24
 784               	.L40:
 785 03ce C60D      		add r28,r6
 786 03d0 D71D      		adc r29,r7
 787 03d2 4EA7      		std Y+46,r20
 788 03d4 00C0      		rjmp .L36
 789               	.L34:
 790               		.stabn	68,0,398,.LM66-.LFBB5
 791               	.LM66:
 792 03d6 452F      		mov r20,r21
 793 03d8 562F      		mov r21,r22
 794 03da 672F      		mov r22,r23
 795 03dc 7727      		clr r23
GAS LISTING /tmp/ccPugNTh.s 			page 44


 796 03de 420D      		add r20,r2
 797 03e0 531D      		adc r21,r3
 798 03e2 641D      		adc r22,r4
 799 03e4 751D      		adc r23,r5
 800 03e6 C301      		movw r24,r6
 801 03e8 0E94 0000 		call move_window
 802 03ec 282F      		mov r18,r24
 803               		.stabn	68,0,399,.LM67-.LFBB5
 804               	.LM67:
 805 03ee 8823      		tst r24
 806 03f0 01F4      		brne .L36
 807               		.stabn	68,0,400,.LM68-.LFBB5
 808               	.LM68:
 809 03f2 F601      		movw r30,r12
 810 03f4 EE0F      		lsl r30
 811 03f6 FF1F      		rol r31
 812 03f8 F170      		andi r31,hi8(511)
 813 03fa E60D      		add r30,r6
 814 03fc F71D      		adc r31,r7
 815 03fe 86A6      		std Z+46,r8
 816 0400 892D      		mov r24,r9
 817 0402 9927      		clr r25
 818 0404 87A7      		std Z+47,r24
 819 0406 00C0      		rjmp .L36
 820               	.L35:
 821               		.stabn	68,0,404,.LM69-.LFBB5
 822               	.LM69:
 823 0408 E7E0      		ldi r30,7
 824 040a 7695      	1:	lsr r23
 825 040c 6795      		ror r22
 826 040e 5795      		ror r21
 827 0410 4795      		ror r20
 828 0412 EA95      		dec r30
 829 0414 01F4      		brne 1b
 830 0416 420D      		add r20,r2
 831 0418 531D      		adc r21,r3
 832 041a 641D      		adc r22,r4
 833 041c 751D      		adc r23,r5
 834 041e C301      		movw r24,r6
 835 0420 0E94 0000 		call move_window
 836 0424 282F      		mov r18,r24
 837               		.stabn	68,0,405,.LM70-.LFBB5
 838               	.LM70:
 839 0426 8823      		tst r24
 840 0428 01F4      		brne .L36
 841               		.stabn	68,0,406,.LM71-.LFBB5
 842               	.LM71:
 843 042a F601      		movw r30,r12
 844 042c EE0F      		lsl r30
 845 042e FF1F      		rol r31
 846 0430 EE0F      		lsl r30
 847 0432 FF1F      		rol r31
 848 0434 F170      		andi r31,hi8(511)
 849 0436 E60D      		add r30,r6
 850 0438 F71D      		adc r31,r7
 851 043a 86A6      		std Z+46,r8
 852 043c 892D      		mov r24,r9
GAS LISTING /tmp/ccPugNTh.s 			page 45


 853 043e 9927      		clr r25
 854 0440 87A7      		std Z+47,r24
 855 0442 C501      		movw r24,r10
 856 0444 AA27      		clr r26
 857 0446 BB27      		clr r27
 858 0448 80AB      		std Z+48,r24
 859 044a 8B2D      		mov r24,r11
 860 044c 9927      		clr r25
 861 044e AA27      		clr r26
 862 0450 BB27      		clr r27
 863 0452 81AB      		std Z+49,r24
 864               	.L36:
 865               		.stabn	68,0,412,.LM72-.LFBB5
 866               	.LM72:
 867 0454 81E0      		ldi r24,lo8(1)
 868 0456 F301      		movw r30,r6
 869 0458 8483      		std Z+4,r24
 870 045a 00C0      		rjmp .L41
 871               	.L31:
 872 045c 22E0      		ldi r18,lo8(2)
 873               	.L41:
 874               		.stabn	68,0,416,.LM73-.LFBB5
 875               	.LM73:
 876 045e 822F      		mov r24,r18
 877               	/* epilogue start */
 878 0460 DF91      		pop r29
 879 0462 CF91      		pop r28
 880 0464 1F91      		pop r17
 881 0466 0F91      		pop r16
 882 0468 FF90      		pop r15
 883 046a EF90      		pop r14
 884 046c DF90      		pop r13
 885 046e CF90      		pop r12
 886 0470 BF90      		pop r11
 887 0472 AF90      		pop r10
 888 0474 9F90      		pop r9
 889 0476 8F90      		pop r8
 890 0478 7F90      		pop r7
 891 047a 6F90      		pop r6
 892 047c 5F90      		pop r5
 893 047e 4F90      		pop r4
 894 0480 3F90      		pop r3
 895 0482 2F90      		pop r2
 896 0484 0895      		ret
 897               		.size	put_fat, .-put_fat
 898               		.stabs	"bc:r(2,2)",64,0,371,24
 899               		.stabs	"fsect:r(2,12)",64,0,373,2
 900               		.stabs	"res:r(1,16)",64,0,374,18
 901               		.stabn	192,0,0,.LFBB5-.LFBB5
 902               		.stabn	224,0,0,.Lscope5-.LFBB5
 903               	.Lscope5:
 904               		.stabs	"",36,0,0,.Lscope5-.LFBB5
 905               		.stabd	78,0,0
 906               		.stabs	"get_fat:F(2,12)",36,0,327,get_fat
 907               		.stabs	"fs:P(1,7)",64,0,324,8
 908               		.stabs	"clst:P(2,12)",64,0,325,14
 909               	.global	get_fat
GAS LISTING /tmp/ccPugNTh.s 			page 46


 910               		.type	get_fat, @function
 911               	get_fat:
 912               		.stabd	46,0,0
 913               		.stabn	68,0,327,.LM74-.LFBB6
 914               	.LM74:
 915               	.LFBB6:
 916 0486 7F92      		push r7
 917 0488 8F92      		push r8
 918 048a 9F92      		push r9
 919 048c AF92      		push r10
 920 048e BF92      		push r11
 921 0490 CF92      		push r12
 922 0492 DF92      		push r13
 923 0494 EF92      		push r14
 924 0496 FF92      		push r15
 925 0498 0F93      		push r16
 926 049a 1F93      		push r17
 927 049c CF93      		push r28
 928 049e DF93      		push r29
 929               	/* prologue: function */
 930               	/* frame size = 0 */
 931 04a0 4C01      		movw r8,r24
 932 04a2 7A01      		movw r14,r20
 933 04a4 8B01      		movw r16,r22
 934               		.stabn	68,0,332,.LM75-.LFBB6
 935               	.LM75:
 936 04a6 4230      		cpi r20,lo8(2)
 937 04a8 5105      		cpc r21,__zero_reg__
 938 04aa 6105      		cpc r22,__zero_reg__
 939 04ac 7105      		cpc r23,__zero_reg__
 940 04ae 00F4      		brsh .+2
 941 04b0 00C0      		rjmp .L44
 942 04b2 F401      		movw r30,r8
 943 04b4 828D      		ldd r24,Z+26
 944 04b6 938D      		ldd r25,Z+27
 945 04b8 A48D      		ldd r26,Z+28
 946 04ba B58D      		ldd r27,Z+29
 947 04bc 4817      		cp r20,r24
 948 04be 5907      		cpc r21,r25
 949 04c0 6A07      		cpc r22,r26
 950 04c2 7B07      		cpc r23,r27
 951 04c4 00F0      		brlo .+2
 952 04c6 00C0      		rjmp .L44
 953               		.stabn	68,0,335,.LM76-.LFBB6
 954               	.LM76:
 955 04c8 A68C      		ldd r10,Z+30
 956 04ca B78C      		ldd r11,Z+31
 957 04cc C0A0      		ldd r12,Z+32
 958 04ce D1A0      		ldd r13,Z+33
 959               		.stabn	68,0,336,.LM77-.LFBB6
 960               	.LM77:
 961 04d0 8081      		ld r24,Z
 962 04d2 8230      		cpi r24,lo8(2)
 963 04d4 01F4      		brne .+2
 964 04d6 00C0      		rjmp .L47
 965 04d8 8330      		cpi r24,lo8(3)
 966 04da 01F4      		brne .+2
GAS LISTING /tmp/ccPugNTh.s 			page 47


 967 04dc 00C0      		rjmp .L48
 968 04de 8130      		cpi r24,lo8(1)
 969 04e0 01F0      		breq .+2
 970 04e2 00C0      		rjmp .L45
 971               		.stabn	68,0,338,.LM78-.LFBB6
 972               	.LM78:
 973 04e4 EA01      		movw r28,r20
 974 04e6 D695      		lsr r29
 975 04e8 C795      		ror r28
 976 04ea CE0D      		add r28,r14
 977 04ec DF1D      		adc r29,r15
 978               		.stabn	68,0,339,.LM79-.LFBB6
 979               	.LM79:
 980 04ee AE01      		movw r20,r28
 981 04f0 452F      		mov r20,r21
 982 04f2 5527      		clr r21
 983 04f4 4695      		lsr r20
 984 04f6 60E0      		ldi r22,lo8(0)
 985 04f8 70E0      		ldi r23,hi8(0)
 986 04fa 4A0D      		add r20,r10
 987 04fc 5B1D      		adc r21,r11
 988 04fe 6C1D      		adc r22,r12
 989 0500 7D1D      		adc r23,r13
 990 0502 C401      		movw r24,r8
 991 0504 0E94 0000 		call move_window
 992 0508 8823      		tst r24
 993 050a 01F0      		breq .+2
 994 050c 00C0      		rjmp .L45
 995               		.stabn	68,0,340,.LM80-.LFBB6
 996               	.LM80:
 997 050e FE01      		movw r30,r28
 998 0510 F170      		andi r31,hi8(511)
 999 0512 E80D      		add r30,r8
 1000 0514 F91D      		adc r31,r9
 1001 0516 76A4      		ldd r7,Z+46
 1002 0518 2196      		adiw r28,1
 1003               		.stabn	68,0,341,.LM81-.LFBB6
 1004               	.LM81:
 1005 051a AE01      		movw r20,r28
 1006 051c 452F      		mov r20,r21
 1007 051e 5527      		clr r21
 1008 0520 4695      		lsr r20
 1009 0522 60E0      		ldi r22,lo8(0)
 1010 0524 70E0      		ldi r23,hi8(0)
 1011 0526 4A0D      		add r20,r10
 1012 0528 5B1D      		adc r21,r11
 1013 052a 6C1D      		adc r22,r12
 1014 052c 7D1D      		adc r23,r13
 1015 052e C401      		movw r24,r8
 1016 0530 0E94 0000 		call move_window
 1017 0534 8823      		tst r24
 1018 0536 01F0      		breq .+2
 1019 0538 00C0      		rjmp .L45
 1020               		.stabn	68,0,340,.LM82-.LFBB6
 1021               	.LM82:
 1022 053a 672D      		mov r22,r7
 1023 053c 70E0      		ldi r23,lo8(0)
GAS LISTING /tmp/ccPugNTh.s 			page 48


 1024               		.stabn	68,0,342,.LM83-.LFBB6
 1025               	.LM83:
 1026 053e D170      		andi r29,hi8(511)
 1027 0540 C80D      		add r28,r8
 1028 0542 D91D      		adc r29,r9
 1029 0544 9EA5      		ldd r25,Y+46
 1030 0546 80E0      		ldi r24,lo8(0)
 1031 0548 682B      		or r22,r24
 1032 054a 792B      		or r23,r25
 1033               		.stabn	68,0,343,.LM84-.LFBB6
 1034               	.LM84:
 1035 054c C701      		movw r24,r14
 1036 054e 8170      		andi r24,lo8(1)
 1037 0550 9070      		andi r25,hi8(1)
 1038 0552 892B      		or r24,r25
 1039 0554 01F0      		breq .L49
 1040 0556 94E0      		ldi r25,4
 1041 0558 7695      	1:	lsr r23
 1042 055a 6795      		ror r22
 1043 055c 9A95      		dec r25
 1044 055e 01F4      		brne 1b
 1045 0560 9B01      		movw r18,r22
 1046 0562 00C0      		rjmp .L52
 1047               	.L49:
 1048 0564 9B01      		movw r18,r22
 1049 0566 40E0      		ldi r20,lo8(0)
 1050 0568 50E0      		ldi r21,hi8(0)
 1051 056a 3F70      		andi r19,hi8(4095)
 1052 056c 4070      		andi r20,hlo8(4095)
 1053 056e 5070      		andi r21,hhi8(4095)
 1054 0570 00C0      		rjmp .L50
 1055               	.L47:
 1056               		.stabn	68,0,346,.LM85-.LFBB6
 1057               	.LM85:
 1058 0572 452F      		mov r20,r21
 1059 0574 562F      		mov r21,r22
 1060 0576 672F      		mov r22,r23
 1061 0578 7727      		clr r23
 1062 057a 4A0D      		add r20,r10
 1063 057c 5B1D      		adc r21,r11
 1064 057e 6C1D      		adc r22,r12
 1065 0580 7D1D      		adc r23,r13
 1066 0582 C401      		movw r24,r8
 1067 0584 0E94 0000 		call move_window
 1068 0588 8823      		tst r24
 1069 058a 01F0      		breq .+2
 1070 058c 00C0      		rjmp .L45
 1071               		.stabn	68,0,347,.LM86-.LFBB6
 1072               	.LM86:
 1073 058e F701      		movw r30,r14
 1074 0590 EE0F      		lsl r30
 1075 0592 FF1F      		rol r31
 1076 0594 F170      		andi r31,hi8(511)
 1077 0596 E80D      		add r30,r8
 1078 0598 F91D      		adc r31,r9
 1079 059a 97A5      		ldd r25,Z+47
 1080 059c 80E0      		ldi r24,lo8(0)
GAS LISTING /tmp/ccPugNTh.s 			page 49


 1081 059e 26A5      		ldd r18,Z+46
 1082 05a0 30E0      		ldi r19,lo8(0)
 1083 05a2 822B      		or r24,r18
 1084 05a4 932B      		or r25,r19
 1085 05a6 9C01      		movw r18,r24
 1086               	.L52:
 1087 05a8 40E0      		ldi r20,lo8(0)
 1088 05aa 50E0      		ldi r21,hi8(0)
 1089 05ac 00C0      		rjmp .L50
 1090               	.L48:
 1091               		.stabn	68,0,350,.LM87-.LFBB6
 1092               	.LM87:
 1093 05ae B7E0      		ldi r27,7
 1094 05b0 7695      	1:	lsr r23
 1095 05b2 6795      		ror r22
 1096 05b4 5795      		ror r21
 1097 05b6 4795      		ror r20
 1098 05b8 BA95      		dec r27
 1099 05ba 01F4      		brne 1b
 1100 05bc 4A0D      		add r20,r10
 1101 05be 5B1D      		adc r21,r11
 1102 05c0 6C1D      		adc r22,r12
 1103 05c2 7D1D      		adc r23,r13
 1104 05c4 C401      		movw r24,r8
 1105 05c6 0E94 0000 		call move_window
 1106 05ca 8823      		tst r24
 1107 05cc 01F4      		brne .L45
 1108               		.stabn	68,0,351,.LM88-.LFBB6
 1109               	.LM88:
 1110 05ce F701      		movw r30,r14
 1111 05d0 EE0F      		lsl r30
 1112 05d2 FF1F      		rol r31
 1113 05d4 EE0F      		lsl r30
 1114 05d6 FF1F      		rol r31
 1115 05d8 F170      		andi r31,hi8(511)
 1116 05da E80D      		add r30,r8
 1117 05dc F91D      		adc r31,r9
 1118 05de 81A9      		ldd r24,Z+49
 1119 05e0 90E0      		ldi r25,lo8(0)
 1120 05e2 A0E0      		ldi r26,lo8(0)
 1121 05e4 B0E0      		ldi r27,hi8(0)
 1122 05e6 582F      		mov r21,r24
 1123 05e8 4427      		clr r20
 1124 05ea 3327      		clr r19
 1125 05ec 2227      		clr r18
 1126 05ee 80A9      		ldd r24,Z+48
 1127 05f0 90E0      		ldi r25,lo8(0)
 1128 05f2 A0E0      		ldi r26,lo8(0)
 1129 05f4 B0E0      		ldi r27,hi8(0)
 1130 05f6 DC01      		movw r26,r24
 1131 05f8 9927      		clr r25
 1132 05fa 8827      		clr r24
 1133 05fc 282B      		or r18,r24
 1134 05fe 392B      		or r19,r25
 1135 0600 4A2B      		or r20,r26
 1136 0602 5B2B      		or r21,r27
 1137 0604 86A5      		ldd r24,Z+46
GAS LISTING /tmp/ccPugNTh.s 			page 50


 1138 0606 90E0      		ldi r25,lo8(0)
 1139 0608 A0E0      		ldi r26,lo8(0)
 1140 060a B0E0      		ldi r27,hi8(0)
 1141 060c 282B      		or r18,r24
 1142 060e 392B      		or r19,r25
 1143 0610 4A2B      		or r20,r26
 1144 0612 5B2B      		or r21,r27
 1145 0614 97A5      		ldd r25,Z+47
 1146 0616 80E0      		ldi r24,lo8(0)
 1147 0618 A0E0      		ldi r26,lo8(0)
 1148 061a B0E0      		ldi r27,hi8(0)
 1149 061c 282B      		or r18,r24
 1150 061e 392B      		or r19,r25
 1151 0620 4A2B      		or r20,r26
 1152 0622 5B2B      		or r21,r27
 1153 0624 5F70      		andi r21,hhi8(268435455)
 1154 0626 00C0      		rjmp .L50
 1155               	.L44:
 1156 0628 21E0      		ldi r18,lo8(1)
 1157 062a 30E0      		ldi r19,hi8(1)
 1158 062c 40E0      		ldi r20,hlo8(1)
 1159 062e 50E0      		ldi r21,hhi8(1)
 1160 0630 00C0      		rjmp .L50
 1161               	.L45:
 1162 0632 2FEF      		ldi r18,lo8(-1)
 1163 0634 3FEF      		ldi r19,hi8(-1)
 1164 0636 4FEF      		ldi r20,hlo8(-1)
 1165 0638 5FEF      		ldi r21,hhi8(-1)
 1166               	.L50:
 1167               		.stabn	68,0,355,.LM89-.LFBB6
 1168               	.LM89:
 1169 063a B901      		movw r22,r18
 1170 063c CA01      		movw r24,r20
 1171               	/* epilogue start */
 1172 063e DF91      		pop r29
 1173 0640 CF91      		pop r28
 1174 0642 1F91      		pop r17
 1175 0644 0F91      		pop r16
 1176 0646 FF90      		pop r15
 1177 0648 EF90      		pop r14
 1178 064a DF90      		pop r13
 1179 064c CF90      		pop r12
 1180 064e BF90      		pop r11
 1181 0650 AF90      		pop r10
 1182 0652 9F90      		pop r9
 1183 0654 8F90      		pop r8
 1184 0656 7F90      		pop r7
 1185 0658 0895      		ret
 1186               		.size	get_fat, .-get_fat
 1187               		.stabs	"bc:r(2,2)",64,0,328,24
 1188               		.stabs	"fsect:r(2,12)",64,0,329,10
 1189               		.stabn	192,0,0,.LFBB6-.LFBB6
 1190               		.stabn	224,0,0,.Lscope6-.LFBB6
 1191               	.Lscope6:
 1192               		.stabs	"",36,0,0,.Lscope6-.LFBB6
 1193               		.stabd	78,0,0
 1194               		.stabs	"dir_seek:f(1,16)",36,0,549,dir_seek
GAS LISTING /tmp/ccPugNTh.s 			page 51


 1195               		.stabs	"dj:P(0,16)",64,0,546,10
 1196               		.stabs	"idx:P(2,8)",64,0,547,12
 1197               		.type	dir_seek, @function
 1198               	dir_seek:
 1199               		.stabd	46,0,0
 1200               		.stabn	68,0,549,.LM90-.LFBB7
 1201               	.LM90:
 1202               	.LFBB7:
 1203 065a AF92      		push r10
 1204 065c BF92      		push r11
 1205 065e CF92      		push r12
 1206 0660 DF92      		push r13
 1207 0662 EF92      		push r14
 1208 0664 FF92      		push r15
 1209 0666 0F93      		push r16
 1210 0668 1F93      		push r17
 1211 066a CF93      		push r28
 1212 066c DF93      		push r29
 1213               	/* prologue: function */
 1214               	/* frame size = 0 */
 1215 066e 5C01      		movw r10,r24
 1216 0670 6B01      		movw r12,r22
 1217               		.stabn	68,0,554,.LM91-.LFBB7
 1218               	.LM91:
 1219 0672 DC01      		movw r26,r24
 1220 0674 1596      		adiw r26,4+1
 1221 0676 7C93      		st X,r23
 1222 0678 6E93      		st -X,r22
 1223 067a 1497      		sbiw r26,4
 1224               		.stabn	68,0,555,.LM92-.LFBB7
 1225               	.LM92:
 1226 067c 1696      		adiw r26,6
 1227 067e 4D91      		ld r20,X+
 1228 0680 5D91      		ld r21,X+
 1229 0682 6D91      		ld r22,X+
 1230 0684 7C91      		ld r23,X
 1231 0686 1997      		sbiw r26,6+3
 1232               		.stabn	68,0,556,.LM93-.LFBB7
 1233               	.LM93:
 1234 0688 4130      		cpi r20,lo8(1)
 1235 068a 5105      		cpc r21,__zero_reg__
 1236 068c 6105      		cpc r22,__zero_reg__
 1237 068e 7105      		cpc r23,__zero_reg__
 1238 0690 01F4      		brne .+2
 1239 0692 00C0      		rjmp .L54
 1240 0694 ED91      		ld r30,X+
 1241 0696 FC91      		ld r31,X
 1242 0698 828D      		ldd r24,Z+26
 1243 069a 938D      		ldd r25,Z+27
 1244 069c A48D      		ldd r26,Z+28
 1245 069e B58D      		ldd r27,Z+29
 1246 06a0 4817      		cp r20,r24
 1247 06a2 5907      		cpc r21,r25
 1248 06a4 6A07      		cpc r22,r26
 1249 06a6 7B07      		cpc r23,r27
 1250 06a8 00F0      		brlo .+2
 1251 06aa 00C0      		rjmp .L54
GAS LISTING /tmp/ccPugNTh.s 			page 52


 1252               		.stabn	68,0,558,.LM94-.LFBB7
 1253               	.LM94:
 1254 06ac 4115      		cp r20,__zero_reg__
 1255 06ae 5105      		cpc r21,__zero_reg__
 1256 06b0 6105      		cpc r22,__zero_reg__
 1257 06b2 7105      		cpc r23,__zero_reg__
 1258 06b4 01F4      		brne .L55
 1259 06b6 8081      		ld r24,Z
 1260 06b8 8330      		cpi r24,lo8(3)
 1261 06ba 01F4      		brne .L56
 1262               		.stabn	68,0,559,.LM95-.LFBB7
 1263               	.LM95:
 1264 06bc 42A1      		ldd r20,Z+34
 1265 06be 53A1      		ldd r21,Z+35
 1266 06c0 64A1      		ldd r22,Z+36
 1267 06c2 75A1      		ldd r23,Z+37
 1268               		.stabn	68,0,561,.LM96-.LFBB7
 1269               	.LM96:
 1270 06c4 4115      		cp r20,__zero_reg__
 1271 06c6 5105      		cpc r21,__zero_reg__
 1272 06c8 6105      		cpc r22,__zero_reg__
 1273 06ca 7105      		cpc r23,__zero_reg__
 1274 06cc 01F4      		brne .L55
 1275               	.L56:
 1276               		.stabn	68,0,562,.LM97-.LFBB7
 1277               	.LM97:
 1278 06ce F501      		movw r30,r10
 1279 06d0 1286      		std Z+10,__zero_reg__
 1280 06d2 1386      		std Z+11,__zero_reg__
 1281 06d4 1486      		std Z+12,__zero_reg__
 1282 06d6 1586      		std Z+13,__zero_reg__
 1283               		.stabn	68,0,563,.LM98-.LFBB7
 1284               	.LM98:
 1285 06d8 0190      		ld __tmp_reg__,Z+
 1286 06da F081      		ld r31,Z
 1287 06dc E02D      		mov r30,__tmp_reg__
 1288 06de 8085      		ldd r24,Z+8
 1289 06e0 9185      		ldd r25,Z+9
 1290 06e2 C816      		cp r12,r24
 1291 06e4 D906      		cpc r13,r25
 1292 06e6 00F0      		brlo .+2
 1293 06e8 00C0      		rjmp .L54
 1294               		.stabn	68,0,565,.LM99-.LFBB7
 1295               	.LM99:
 1296 06ea C601      		movw r24,r12
 1297 06ec A4E0      		ldi r26,4
 1298 06ee 9695      	1:	lsr r25
 1299 06f0 8795      		ror r24
 1300 06f2 AA95      		dec r26
 1301 06f4 01F4      		brne 1b
 1302 06f6 A0E0      		ldi r26,lo8(0)
 1303 06f8 B0E0      		ldi r27,hi8(0)
 1304 06fa 22A1      		ldd r18,Z+34
 1305 06fc 33A1      		ldd r19,Z+35
 1306 06fe 44A1      		ldd r20,Z+36
 1307 0700 55A1      		ldd r21,Z+37
 1308 0702 820F      		add r24,r18
GAS LISTING /tmp/ccPugNTh.s 			page 53


 1309 0704 931F      		adc r25,r19
 1310 0706 A41F      		adc r26,r20
 1311 0708 B51F      		adc r27,r21
 1312 070a F501      		movw r30,r10
 1313 070c 8687      		std Z+14,r24
 1314 070e 9787      		std Z+15,r25
 1315 0710 A08B      		std Z+16,r26
 1316 0712 B18B      		std Z+17,r27
 1317 0714 00C0      		rjmp .L57
 1318               	.L55:
 1319               		.stabn	68,0,568,.LM100-.LFBB7
 1320               	.LM100:
 1321 0716 8281      		ldd r24,Z+2
 1322 0718 082F      		mov r16,r24
 1323 071a 10E0      		ldi r17,lo8(0)
 1324 071c F4E0      		ldi r31,4
 1325 071e 000F      	1:	lsl r16
 1326 0720 111F      		rol r17
 1327 0722 FA95      		dec r31
 1328 0724 01F4      		brne 1b
 1329 0726 00C0      		rjmp .L58
 1330               	.L61:
 1331               		.stabn	68,0,570,.LM101-.LFBB7
 1332               	.LM101:
 1333 0728 CE01      		movw r24,r28
 1334 072a 0E94 0000 		call get_fat
 1335 072e AB01      		movw r20,r22
 1336 0730 BC01      		movw r22,r24
 1337               		.stabn	68,0,571,.LM102-.LFBB7
 1338               	.LM102:
 1339 0732 4F3F      		cpi r20,lo8(-1)
 1340 0734 FFEF      		ldi r31,hi8(-1)
 1341 0736 5F07      		cpc r21,r31
 1342 0738 FFEF      		ldi r31,hlo8(-1)
 1343 073a 6F07      		cpc r22,r31
 1344 073c FFEF      		ldi r31,hhi8(-1)
 1345 073e 7F07      		cpc r23,r31
 1346 0740 01F4      		brne .L59
 1347 0742 81E0      		ldi r24,lo8(1)
 1348 0744 00C0      		rjmp .L60
 1349               	.L59:
 1350               		.stabn	68,0,572,.LM103-.LFBB7
 1351               	.LM103:
 1352 0746 4230      		cpi r20,lo8(2)
 1353 0748 5105      		cpc r21,__zero_reg__
 1354 074a 6105      		cpc r22,__zero_reg__
 1355 074c 7105      		cpc r23,__zero_reg__
 1356 074e 00F4      		brsh .+2
 1357 0750 00C0      		rjmp .L54
 1358 0752 D501      		movw r26,r10
 1359 0754 ED91      		ld r30,X+
 1360 0756 FC91      		ld r31,X
 1361 0758 828D      		ldd r24,Z+26
 1362 075a 938D      		ldd r25,Z+27
 1363 075c A48D      		ldd r26,Z+28
 1364 075e B58D      		ldd r27,Z+29
 1365 0760 4817      		cp r20,r24
GAS LISTING /tmp/ccPugNTh.s 			page 54


 1366 0762 5907      		cpc r21,r25
 1367 0764 6A07      		cpc r22,r26
 1368 0766 7B07      		cpc r23,r27
 1369 0768 00F0      		brlo .+2
 1370 076a 00C0      		rjmp .L54
 1371               		.stabn	68,0,574,.LM104-.LFBB7
 1372               	.LM104:
 1373 076c C01A      		sub r12,r16
 1374 076e D10A      		sbc r13,r17
 1375               	.L58:
 1376 0770 F501      		movw r30,r10
 1377 0772 C081      		ld r28,Z
 1378 0774 D181      		ldd r29,Z+1
 1379               		.stabn	68,0,569,.LM105-.LFBB7
 1380               	.LM105:
 1381 0776 C016      		cp r12,r16
 1382 0778 D106      		cpc r13,r17
 1383 077a 00F4      		brsh .L61
 1384               		.stabn	68,0,576,.LM106-.LFBB7
 1385               	.LM106:
 1386 077c D501      		movw r26,r10
 1387 077e 1A96      		adiw r26,10
 1388 0780 4D93      		st X+,r20
 1389 0782 5D93      		st X+,r21
 1390 0784 6D93      		st X+,r22
 1391 0786 7C93      		st X,r23
 1392 0788 1D97      		sbiw r26,10+3
 1393               	.LBB68:
 1394               	.LBB69:
 1395               		.stabn	68,0,532,.LM107-.LFBB7
 1396               	.LM107:
 1397 078a EEEF      		ldi r30,lo8(-2)
 1398 078c EE2E      		mov r14,r30
 1399 078e EFEF      		ldi r30,hi8(-2)
 1400 0790 FE2E      		mov r15,r30
 1401 0792 EFEF      		ldi r30,hlo8(-2)
 1402 0794 0E2F      		mov r16,r30
 1403 0796 EFEF      		ldi r30,hhi8(-2)
 1404 0798 1E2F      		mov r17,r30
 1405 079a E40E      		add r14,r20
 1406 079c F51E      		adc r15,r21
 1407 079e 061F      		adc r16,r22
 1408 07a0 171F      		adc r17,r23
 1409               		.stabn	68,0,533,.LM108-.LFBB7
 1410               	.LM108:
 1411 07a2 8A8D      		ldd r24,Y+26
 1412 07a4 9B8D      		ldd r25,Y+27
 1413 07a6 AC8D      		ldd r26,Y+28
 1414 07a8 BD8D      		ldd r27,Y+29
 1415 07aa 0297      		sbiw r24,2
 1416 07ac A109      		sbc r26,__zero_reg__
 1417 07ae B109      		sbc r27,__zero_reg__
 1418 07b0 E816      		cp r14,r24
 1419 07b2 F906      		cpc r15,r25
 1420 07b4 0A07      		cpc r16,r26
 1421 07b6 1B07      		cpc r17,r27
 1422 07b8 00F0      		brlo .L62
GAS LISTING /tmp/ccPugNTh.s 			page 55


 1423 07ba 20E0      		ldi r18,lo8(0)
 1424 07bc 30E0      		ldi r19,hi8(0)
 1425 07be 40E0      		ldi r20,hlo8(0)
 1426 07c0 50E0      		ldi r21,hhi8(0)
 1427 07c2 00C0      		rjmp .L63
 1428               	.L62:
 1429               		.stabn	68,0,534,.LM109-.LFBB7
 1430               	.LM109:
 1431 07c4 2A81      		ldd r18,Y+2
 1432 07c6 30E0      		ldi r19,lo8(0)
 1433 07c8 40E0      		ldi r20,lo8(0)
 1434 07ca 50E0      		ldi r21,hi8(0)
 1435 07cc C801      		movw r24,r16
 1436 07ce B701      		movw r22,r14
 1437 07d0 0E94 0000 		call __mulsi3
 1438 07d4 9B01      		movw r18,r22
 1439 07d6 AC01      		movw r20,r24
 1440 07d8 8EA1      		ldd r24,Y+38
 1441 07da 9FA1      		ldd r25,Y+39
 1442 07dc A8A5      		ldd r26,Y+40
 1443 07de B9A5      		ldd r27,Y+41
 1444 07e0 280F      		add r18,r24
 1445 07e2 391F      		adc r19,r25
 1446 07e4 4A1F      		adc r20,r26
 1447 07e6 5B1F      		adc r21,r27
 1448               	.L63:
 1449               	.LBE69:
 1450               	.LBE68:
 1451               		.stabn	68,0,577,.LM110-.LFBB7
 1452               	.LM110:
 1453 07e8 C601      		movw r24,r12
 1454 07ea 64E0      		ldi r22,4
 1455 07ec 9695      	1:	lsr r25
 1456 07ee 8795      		ror r24
 1457 07f0 6A95      		dec r22
 1458 07f2 01F4      		brne 1b
 1459 07f4 A0E0      		ldi r26,lo8(0)
 1460 07f6 B0E0      		ldi r27,hi8(0)
 1461 07f8 280F      		add r18,r24
 1462 07fa 391F      		adc r19,r25
 1463 07fc 4A1F      		adc r20,r26
 1464 07fe 5B1F      		adc r21,r27
 1465 0800 F501      		movw r30,r10
 1466 0802 2687      		std Z+14,r18
 1467 0804 3787      		std Z+15,r19
 1468 0806 408B      		std Z+16,r20
 1469 0808 518B      		std Z+17,r21
 1470               	.L57:
 1471               		.stabn	68,0,580,.LM111-.LFBB7
 1472               	.LM111:
 1473 080a FFE0      		ldi r31,lo8(15)
 1474 080c CF22      		and r12,r31
 1475 080e DD24      		clr r13
 1476 0810 55E0      		ldi r21,5
 1477 0812 CC0C      	1:	lsl r12
 1478 0814 DD1C      		rol r13
 1479 0816 5A95      		dec r21
GAS LISTING /tmp/ccPugNTh.s 			page 56


 1480 0818 01F4      		brne 1b
 1481 081a 8EE2      		ldi r24,lo8(46)
 1482 081c 90E0      		ldi r25,hi8(46)
 1483 081e C80E      		add r12,r24
 1484 0820 D91E      		adc r13,r25
 1485 0822 D501      		movw r26,r10
 1486 0824 8D91      		ld r24,X+
 1487 0826 9C91      		ld r25,X
 1488 0828 1197      		sbiw r26,1
 1489 082a 8C0D      		add r24,r12
 1490 082c 9D1D      		adc r25,r13
 1491 082e 5396      		adiw r26,18+1
 1492 0830 9C93      		st X,r25
 1493 0832 8E93      		st -X,r24
 1494 0834 5297      		sbiw r26,18
 1495 0836 80E0      		ldi r24,lo8(0)
 1496 0838 00C0      		rjmp .L60
 1497               	.L54:
 1498               		.stabn	68,0,582,.LM112-.LFBB7
 1499               	.LM112:
 1500 083a 82E0      		ldi r24,lo8(2)
 1501               	.L60:
 1502               	/* epilogue start */
 1503               		.stabn	68,0,583,.LM113-.LFBB7
 1504               	.LM113:
 1505 083c DF91      		pop r29
 1506 083e CF91      		pop r28
 1507 0840 1F91      		pop r17
 1508 0842 0F91      		pop r16
 1509 0844 FF90      		pop r15
 1510 0846 EF90      		pop r14
 1511 0848 DF90      		pop r13
 1512 084a CF90      		pop r12
 1513 084c BF90      		pop r11
 1514 084e AF90      		pop r10
 1515 0850 0895      		ret
 1516               		.size	dir_seek, .-dir_seek
 1517               		.stabs	"clst:r(2,12)",64,0,550,20
 1518               		.stabs	"ic:r(2,8)",64,0,551,16
 1519               		.stabn	192,0,0,.LFBB7-.LFBB7
 1520               		.stabs	"clst:r(2,12)",64,0,577,14
 1521               		.stabn	192,0,0,.LBB68-.LFBB7
 1522               		.stabn	224,0,0,.LBE68-.LFBB7
 1523               		.stabn	224,0,0,.Lscope7-.LFBB7
 1524               	.Lscope7:
 1525               		.stabs	"",36,0,0,.Lscope7-.LFBB7
 1526               		.stabd	78,0,0
 1527               		.stabs	"create_chain:f(2,12)",36,0,472,create_chain
 1528               		.stabs	"fs:P(1,7)",64,0,469,2
 1529               		.stabs	"clst:P(2,12)",64,0,470,4
 1530               		.type	create_chain, @function
 1531               	create_chain:
 1532               		.stabd	46,0,0
 1533               		.stabn	68,0,472,.LM114-.LFBB8
 1534               	.LM114:
 1535               	.LFBB8:
 1536 0852 2F92      		push r2
GAS LISTING /tmp/ccPugNTh.s 			page 57


 1537 0854 3F92      		push r3
 1538 0856 4F92      		push r4
 1539 0858 5F92      		push r5
 1540 085a 6F92      		push r6
 1541 085c 7F92      		push r7
 1542 085e 8F92      		push r8
 1543 0860 9F92      		push r9
 1544 0862 AF92      		push r10
 1545 0864 BF92      		push r11
 1546 0866 CF92      		push r12
 1547 0868 DF92      		push r13
 1548 086a EF92      		push r14
 1549 086c FF92      		push r15
 1550 086e 0F93      		push r16
 1551 0870 1F93      		push r17
 1552 0872 DF93      		push r29
 1553 0874 CF93      		push r28
 1554 0876 00D0      		rcall .
 1555 0878 00D0      		rcall .
 1556 087a CDB7      		in r28,__SP_L__
 1557 087c DEB7      		in r29,__SP_H__
 1558               	/* prologue: function */
 1559               	/* frame size = 4 */
 1560 087e 1C01      		movw r2,r24
 1561 0880 2A01      		movw r4,r20
 1562 0882 3B01      		movw r6,r22
 1563               		.stabn	68,0,476,.LM115-.LFBB8
 1564               	.LM115:
 1565 0884 DC01      		movw r26,r24
 1566 0886 5A96      		adiw r26,26
 1567 0888 8D91      		ld r24,X+
 1568 088a 9D91      		ld r25,X+
 1569 088c 0D90      		ld __tmp_reg__,X+
 1570 088e BC91      		ld r27,X
 1571 0890 A02D      		mov r26,__tmp_reg__
 1572 0892 8983      		std Y+1,r24
 1573 0894 9A83      		std Y+2,r25
 1574 0896 AB83      		std Y+3,r26
 1575 0898 BC83      		std Y+4,r27
 1576               		.stabn	68,0,477,.LM116-.LFBB8
 1577               	.LM116:
 1578 089a 4115      		cp r20,__zero_reg__
 1579 089c 5105      		cpc r21,__zero_reg__
 1580 089e 6105      		cpc r22,__zero_reg__
 1581 08a0 7105      		cpc r23,__zero_reg__
 1582 08a2 01F4      		brne .L66
 1583               		.stabn	68,0,478,.LM117-.LFBB8
 1584               	.LM117:
 1585 08a4 F101      		movw r30,r2
 1586 08a6 8284      		ldd r8,Z+10
 1587 08a8 9384      		ldd r9,Z+11
 1588 08aa A484      		ldd r10,Z+12
 1589 08ac B584      		ldd r11,Z+13
 1590               		.stabn	68,0,479,.LM118-.LFBB8
 1591               	.LM118:
 1592 08ae 8114      		cp r8,__zero_reg__
 1593 08b0 9104      		cpc r9,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 58


 1594 08b2 A104      		cpc r10,__zero_reg__
 1595 08b4 B104      		cpc r11,__zero_reg__
 1596 08b6 01F0      		breq .L67
 1597 08b8 8816      		cp r8,r24
 1598 08ba 9906      		cpc r9,r25
 1599 08bc AA06      		cpc r10,r26
 1600 08be BB06      		cpc r11,r27
 1601 08c0 00F4      		brsh .L67
 1602 08c2 00C0      		rjmp .L68
 1603               	.L66:
 1604               		.stabn	68,0,482,.LM119-.LFBB8
 1605               	.LM119:
 1606 08c4 C101      		movw r24,r2
 1607 08c6 0E94 0000 		call get_fat
 1608 08ca 9B01      		movw r18,r22
 1609 08cc AC01      		movw r20,r24
 1610               		.stabn	68,0,483,.LM120-.LFBB8
 1611               	.LM120:
 1612 08ce 6230      		cpi r22,lo8(2)
 1613 08d0 7105      		cpc r23,__zero_reg__
 1614 08d2 8105      		cpc r24,__zero_reg__
 1615 08d4 9105      		cpc r25,__zero_reg__
 1616 08d6 00F4      		brsh .L69
 1617 08d8 21E0      		ldi r18,lo8(1)
 1618 08da 30E0      		ldi r19,hi8(1)
 1619 08dc 40E0      		ldi r20,hlo8(1)
 1620 08de 50E0      		ldi r21,hhi8(1)
 1621 08e0 00C0      		rjmp .L70
 1622               	.L69:
 1623               		.stabn	68,0,484,.LM121-.LFBB8
 1624               	.LM121:
 1625 08e2 8981      		ldd r24,Y+1
 1626 08e4 9A81      		ldd r25,Y+2
 1627 08e6 AB81      		ldd r26,Y+3
 1628 08e8 BC81      		ldd r27,Y+4
 1629 08ea 2817      		cp r18,r24
 1630 08ec 3907      		cpc r19,r25
 1631 08ee 4A07      		cpc r20,r26
 1632 08f0 5B07      		cpc r21,r27
 1633 08f2 00F4      		brsh .+2
 1634 08f4 00C0      		rjmp .L70
 1635 08f6 5301      		movw r10,r6
 1636 08f8 4201      		movw r8,r4
 1637 08fa 00C0      		rjmp .L68
 1638               	.L67:
 1639 08fc 11E0      		ldi r17,lo8(1)
 1640 08fe 812E      		mov r8,r17
 1641 0900 912C      		mov r9,__zero_reg__
 1642 0902 A12C      		mov r10,__zero_reg__
 1643 0904 B12C      		mov r11,__zero_reg__
 1644               	.L68:
 1645 0906 7501      		movw r14,r10
 1646 0908 6401      		movw r12,r8
 1647               	.L74:
 1648               		.stabn	68,0,490,.LM122-.LFBB8
 1649               	.LM122:
 1650 090a 0894      		sec
GAS LISTING /tmp/ccPugNTh.s 			page 59


 1651 090c C11C      		adc r12,__zero_reg__
 1652 090e D11C      		adc r13,__zero_reg__
 1653 0910 E11C      		adc r14,__zero_reg__
 1654 0912 F11C      		adc r15,__zero_reg__
 1655               		.stabn	68,0,491,.LM123-.LFBB8
 1656               	.LM123:
 1657 0914 8981      		ldd r24,Y+1
 1658 0916 9A81      		ldd r25,Y+2
 1659 0918 AB81      		ldd r26,Y+3
 1660 091a BC81      		ldd r27,Y+4
 1661 091c C816      		cp r12,r24
 1662 091e D906      		cpc r13,r25
 1663 0920 EA06      		cpc r14,r26
 1664 0922 FB06      		cpc r15,r27
 1665 0924 00F0      		brlo .L71
 1666               		.stabn	68,0,493,.LM124-.LFBB8
 1667               	.LM124:
 1668 0926 92E0      		ldi r25,lo8(2)
 1669 0928 8916      		cp r8,r25
 1670 092a 9104      		cpc r9,__zero_reg__
 1671 092c A104      		cpc r10,__zero_reg__
 1672 092e B104      		cpc r11,__zero_reg__
 1673 0930 00F4      		brsh .+2
 1674 0932 00C0      		rjmp .L72
 1675 0934 B2E0      		ldi r27,lo8(2)
 1676 0936 CB2E      		mov r12,r27
 1677 0938 D12C      		mov r13,__zero_reg__
 1678 093a E12C      		mov r14,__zero_reg__
 1679 093c F12C      		mov r15,__zero_reg__
 1680               	.L71:
 1681               		.stabn	68,0,495,.LM125-.LFBB8
 1682               	.LM125:
 1683 093e C101      		movw r24,r2
 1684 0940 B701      		movw r22,r14
 1685 0942 A601      		movw r20,r12
 1686 0944 0E94 0000 		call get_fat
 1687 0948 9B01      		movw r18,r22
 1688 094a AC01      		movw r20,r24
 1689               		.stabn	68,0,496,.LM126-.LFBB8
 1690               	.LM126:
 1691 094c 6115      		cp r22,__zero_reg__
 1692 094e 7105      		cpc r23,__zero_reg__
 1693 0950 8105      		cpc r24,__zero_reg__
 1694 0952 9105      		cpc r25,__zero_reg__
 1695 0954 01F0      		breq .L73
 1696               		.stabn	68,0,497,.LM127-.LFBB8
 1697               	.LM127:
 1698 0956 6F3F      		cpi r22,lo8(-1)
 1699 0958 AFEF      		ldi r26,hi8(-1)
 1700 095a 7A07      		cpc r23,r26
 1701 095c AFEF      		ldi r26,hlo8(-1)
 1702 095e 8A07      		cpc r24,r26
 1703 0960 AFEF      		ldi r26,hhi8(-1)
 1704 0962 9A07      		cpc r25,r26
 1705 0964 01F4      		brne .+2
 1706 0966 00C0      		rjmp .L70
 1707 0968 6130      		cpi r22,lo8(1)
GAS LISTING /tmp/ccPugNTh.s 			page 60


 1708 096a 7105      		cpc r23,__zero_reg__
 1709 096c 8105      		cpc r24,__zero_reg__
 1710 096e 9105      		cpc r25,__zero_reg__
 1711 0970 01F4      		brne .+2
 1712 0972 00C0      		rjmp .L70
 1713               		.stabn	68,0,499,.LM128-.LFBB8
 1714               	.LM128:
 1715 0974 C814      		cp r12,r8
 1716 0976 D904      		cpc r13,r9
 1717 0978 EA04      		cpc r14,r10
 1718 097a FB04      		cpc r15,r11
 1719 097c 01F4      		brne .L74
 1720 097e 00C0      		rjmp .L72
 1721               	.L73:
 1722 0980 BC2C      		mov r11,r12
 1723 0982 AD2C      		mov r10,r13
 1724 0984 9E2C      		mov r9,r14
 1725 0986 8F2C      		mov r8,r15
 1726               		.stabn	68,0,502,.LM129-.LFBB8
 1727               	.LM129:
 1728 0988 C101      		movw r24,r2
 1729 098a A601      		movw r20,r12
 1730 098c B701      		movw r22,r14
 1731 098e 0FEF      		ldi r16,lo8(268435455)
 1732 0990 1FEF      		ldi r17,hi8(268435455)
 1733 0992 2FEF      		ldi r18,hlo8(268435455)
 1734 0994 3FE0      		ldi r19,hhi8(268435455)
 1735 0996 0E94 0000 		call put_fat
 1736 099a 8823      		tst r24
 1737 099c 01F4      		brne .L75
 1738               		.stabn	68,0,504,.LM130-.LFBB8
 1739               	.LM130:
 1740 099e 4114      		cp r4,__zero_reg__
 1741 09a0 5104      		cpc r5,__zero_reg__
 1742 09a2 6104      		cpc r6,__zero_reg__
 1743 09a4 7104      		cpc r7,__zero_reg__
 1744 09a6 01F0      		breq .L76
 1745               		.stabn	68,0,505,.LM131-.LFBB8
 1746               	.LM131:
 1747 09a8 C101      		movw r24,r2
 1748 09aa B301      		movw r22,r6
 1749 09ac A201      		movw r20,r4
 1750 09ae 8601      		movw r16,r12
 1751 09b0 9701      		movw r18,r14
 1752 09b2 0E94 0000 		call put_fat
 1753 09b6 8823      		tst r24
 1754 09b8 01F4      		brne .L75
 1755               	.L76:
 1756               		.stabn	68,0,509,.LM132-.LFBB8
 1757               	.LM132:
 1758 09ba F101      		movw r30,r2
 1759 09bc B286      		std Z+10,r11
 1760 09be A386      		std Z+11,r10
 1761 09c0 9486      		std Z+12,r9
 1762 09c2 8586      		std Z+13,r8
 1763               		.stabn	68,0,510,.LM133-.LFBB8
 1764               	.LM133:
GAS LISTING /tmp/ccPugNTh.s 			page 61


 1765 09c4 8685      		ldd r24,Z+14
 1766 09c6 9785      		ldd r25,Z+15
 1767 09c8 A089      		ldd r26,Z+16
 1768 09ca B189      		ldd r27,Z+17
 1769 09cc 8F3F      		cpi r24,lo8(-1)
 1770 09ce FFEF      		ldi r31,hi8(-1)
 1771 09d0 9F07      		cpc r25,r31
 1772 09d2 FFEF      		ldi r31,hlo8(-1)
 1773 09d4 AF07      		cpc r26,r31
 1774 09d6 FFEF      		ldi r31,hhi8(-1)
 1775 09d8 BF07      		cpc r27,r31
 1776 09da 01F0      		breq .L79
 1777               	.L77:
 1778               		.stabn	68,0,511,.LM134-.LFBB8
 1779               	.LM134:
 1780 09dc 0197      		sbiw r24,1
 1781 09de A109      		sbc r26,__zero_reg__
 1782 09e0 B109      		sbc r27,__zero_reg__
 1783 09e2 F101      		movw r30,r2
 1784 09e4 8687      		std Z+14,r24
 1785 09e6 9787      		std Z+15,r25
 1786 09e8 A08B      		std Z+16,r26
 1787 09ea B18B      		std Z+17,r27
 1788               		.stabn	68,0,512,.LM135-.LFBB8
 1789               	.LM135:
 1790 09ec 81E0      		ldi r24,lo8(1)
 1791 09ee 8583      		std Z+5,r24
 1792               	.L79:
 1793 09f0 A701      		movw r20,r14
 1794 09f2 9601      		movw r18,r12
 1795 09f4 00C0      		rjmp .L70
 1796               	.L72:
 1797 09f6 20E0      		ldi r18,lo8(0)
 1798 09f8 30E0      		ldi r19,hi8(0)
 1799 09fa 40E0      		ldi r20,hlo8(0)
 1800 09fc 50E0      		ldi r21,hhi8(0)
 1801 09fe 00C0      		rjmp .L70
 1802               	.L75:
 1803 0a00 2FEF      		ldi r18,lo8(-1)
 1804 0a02 3FEF      		ldi r19,hi8(-1)
 1805 0a04 4FEF      		ldi r20,hlo8(-1)
 1806 0a06 5FEF      		ldi r21,hhi8(-1)
 1807               	.L70:
 1808               		.stabn	68,0,516,.LM136-.LFBB8
 1809               	.LM136:
 1810 0a08 B901      		movw r22,r18
 1811 0a0a CA01      		movw r24,r20
 1812               	/* epilogue start */
 1813 0a0c 0F90      		pop __tmp_reg__
 1814 0a0e 0F90      		pop __tmp_reg__
 1815 0a10 0F90      		pop __tmp_reg__
 1816 0a12 0F90      		pop __tmp_reg__
 1817 0a14 CF91      		pop r28
 1818 0a16 DF91      		pop r29
 1819 0a18 1F91      		pop r17
 1820 0a1a 0F91      		pop r16
 1821 0a1c FF90      		pop r15
GAS LISTING /tmp/ccPugNTh.s 			page 62


 1822 0a1e EF90      		pop r14
 1823 0a20 DF90      		pop r13
 1824 0a22 CF90      		pop r12
 1825 0a24 BF90      		pop r11
 1826 0a26 AF90      		pop r10
 1827 0a28 9F90      		pop r9
 1828 0a2a 8F90      		pop r8
 1829 0a2c 7F90      		pop r7
 1830 0a2e 6F90      		pop r6
 1831 0a30 5F90      		pop r5
 1832 0a32 4F90      		pop r4
 1833 0a34 3F90      		pop r3
 1834 0a36 2F90      		pop r2
 1835 0a38 0895      		ret
 1836               		.size	create_chain, .-create_chain
 1837               		.stabs	"cs:r(2,12)",64,0,473,18
 1838               		.stabs	"ncl:r(2,12)",64,0,473,12
 1839               		.stabs	"scl:r(2,12)",64,0,473,8
 1840               		.stabs	"mcl:(2,12)",128,0,473,1
 1841               		.stabn	192,0,0,.LFBB8-.LFBB8
 1842               		.stabn	224,0,0,.Lscope8-.LFBB8
 1843               	.Lscope8:
 1844               		.stabs	"",36,0,0,.Lscope8-.LFBB8
 1845               		.stabd	78,0,0
 1846               		.stabs	"remove_chain:f(1,16)",36,0,431,remove_chain
 1847               		.stabs	"fs:P(1,7)",64,0,428,28
 1848               		.stabs	"clst:P(2,12)",64,0,429,14
 1849               		.type	remove_chain, @function
 1850               	remove_chain:
 1851               		.stabd	46,0,0
 1852               		.stabn	68,0,431,.LM137-.LFBB9
 1853               	.LM137:
 1854               	.LFBB9:
 1855 0a3a 9F92      		push r9
 1856 0a3c AF92      		push r10
 1857 0a3e BF92      		push r11
 1858 0a40 CF92      		push r12
 1859 0a42 DF92      		push r13
 1860 0a44 EF92      		push r14
 1861 0a46 FF92      		push r15
 1862 0a48 0F93      		push r16
 1863 0a4a 1F93      		push r17
 1864 0a4c CF93      		push r28
 1865 0a4e DF93      		push r29
 1866               	/* prologue: function */
 1867               	/* frame size = 0 */
 1868 0a50 EC01      		movw r28,r24
 1869 0a52 7A01      		movw r14,r20
 1870 0a54 8B01      		movw r16,r22
 1871               		.stabn	68,0,436,.LM138-.LFBB9
 1872               	.LM138:
 1873 0a56 4230      		cpi r20,lo8(2)
 1874 0a58 5105      		cpc r21,__zero_reg__
 1875 0a5a 6105      		cpc r22,__zero_reg__
 1876 0a5c 7105      		cpc r23,__zero_reg__
 1877 0a5e 00F4      		brsh .+2
 1878 0a60 00C0      		rjmp .L81
GAS LISTING /tmp/ccPugNTh.s 			page 63


 1879 0a62 8A8D      		ldd r24,Y+26
 1880 0a64 9B8D      		ldd r25,Y+27
 1881 0a66 AC8D      		ldd r26,Y+28
 1882 0a68 BD8D      		ldd r27,Y+29
 1883 0a6a 4817      		cp r20,r24
 1884 0a6c 5907      		cpc r21,r25
 1885 0a6e 6A07      		cpc r22,r26
 1886 0a70 7B07      		cpc r23,r27
 1887 0a72 00F4      		brsh .+2
 1888 0a74 00C0      		rjmp .L89
 1889 0a76 00C0      		rjmp .L81
 1890               	.L87:
 1891               		.stabn	68,0,442,.LM139-.LFBB9
 1892               	.LM139:
 1893 0a78 CE01      		movw r24,r28
 1894 0a7a B801      		movw r22,r16
 1895 0a7c A701      		movw r20,r14
 1896 0a7e 0E94 0000 		call get_fat
 1897 0a82 5B01      		movw r10,r22
 1898 0a84 6C01      		movw r12,r24
 1899               		.stabn	68,0,443,.LM140-.LFBB9
 1900               	.LM140:
 1901 0a86 6115      		cp r22,__zero_reg__
 1902 0a88 7105      		cpc r23,__zero_reg__
 1903 0a8a 8105      		cpc r24,__zero_reg__
 1904 0a8c 9105      		cpc r25,__zero_reg__
 1905 0a8e 01F4      		brne .+2
 1906 0a90 00C0      		rjmp .L83
 1907               		.stabn	68,0,444,.LM141-.LFBB9
 1908               	.LM141:
 1909 0a92 81E0      		ldi r24,lo8(1)
 1910 0a94 A816      		cp r10,r24
 1911 0a96 B104      		cpc r11,__zero_reg__
 1912 0a98 C104      		cpc r12,__zero_reg__
 1913 0a9a D104      		cpc r13,__zero_reg__
 1914 0a9c 01F0      		breq .L81
 1915               		.stabn	68,0,445,.LM142-.LFBB9
 1916               	.LM142:
 1917 0a9e 2FEF      		ldi r18,lo8(-1)
 1918 0aa0 A216      		cp r10,r18
 1919 0aa2 2FEF      		ldi r18,hi8(-1)
 1920 0aa4 B206      		cpc r11,r18
 1921 0aa6 2FEF      		ldi r18,hlo8(-1)
 1922 0aa8 C206      		cpc r12,r18
 1923 0aaa 2FEF      		ldi r18,hhi8(-1)
 1924 0aac D206      		cpc r13,r18
 1925 0aae 01F4      		brne .L84
 1926 0ab0 81E0      		ldi r24,lo8(1)
 1927 0ab2 00C0      		rjmp .L85
 1928               	.L84:
 1929               		.stabn	68,0,446,.LM143-.LFBB9
 1930               	.LM143:
 1931 0ab4 CE01      		movw r24,r28
 1932 0ab6 B801      		movw r22,r16
 1933 0ab8 A701      		movw r20,r14
 1934 0aba 00E0      		ldi r16,lo8(0)
 1935 0abc 10E0      		ldi r17,hi8(0)
GAS LISTING /tmp/ccPugNTh.s 			page 64


 1936 0abe 20E0      		ldi r18,hlo8(0)
 1937 0ac0 30E0      		ldi r19,hhi8(0)
 1938 0ac2 0E94 0000 		call put_fat
 1939               		.stabn	68,0,447,.LM144-.LFBB9
 1940               	.LM144:
 1941 0ac6 8823      		tst r24
 1942 0ac8 01F4      		brne .L85
 1943               		.stabn	68,0,448,.LM145-.LFBB9
 1944               	.LM145:
 1945 0aca 8E85      		ldd r24,Y+14
 1946 0acc 9F85      		ldd r25,Y+15
 1947 0ace A889      		ldd r26,Y+16
 1948 0ad0 B989      		ldd r27,Y+17
 1949 0ad2 8F3F      		cpi r24,lo8(-1)
 1950 0ad4 2FEF      		ldi r18,hi8(-1)
 1951 0ad6 9207      		cpc r25,r18
 1952 0ad8 2FEF      		ldi r18,hlo8(-1)
 1953 0ada A207      		cpc r26,r18
 1954 0adc 2FEF      		ldi r18,hhi8(-1)
 1955 0ade B207      		cpc r27,r18
 1956 0ae0 01F0      		breq .L86
 1957               		.stabn	68,0,449,.LM146-.LFBB9
 1958               	.LM146:
 1959 0ae2 0196      		adiw r24,1
 1960 0ae4 A11D      		adc r26,__zero_reg__
 1961 0ae6 B11D      		adc r27,__zero_reg__
 1962 0ae8 8E87      		std Y+14,r24
 1963 0aea 9F87      		std Y+15,r25
 1964 0aec A88B      		std Y+16,r26
 1965 0aee B98B      		std Y+17,r27
 1966               		.stabn	68,0,450,.LM147-.LFBB9
 1967               	.LM147:
 1968 0af0 9D82      		std Y+5,r9
 1969               	.L86:
 1970 0af2 8601      		movw r16,r12
 1971 0af4 7501      		movw r14,r10
 1972 0af6 00C0      		rjmp .L90
 1973               	.L89:
 1974 0af8 9924      		clr r9
 1975 0afa 9394      		inc r9
 1976               	.L90:
 1977               		.stabn	68,0,441,.LM148-.LFBB9
 1978               	.LM148:
 1979 0afc 8A8D      		ldd r24,Y+26
 1980 0afe 9B8D      		ldd r25,Y+27
 1981 0b00 AC8D      		ldd r26,Y+28
 1982 0b02 BD8D      		ldd r27,Y+29
 1983 0b04 E816      		cp r14,r24
 1984 0b06 F906      		cpc r15,r25
 1985 0b08 0A07      		cpc r16,r26
 1986 0b0a 1B07      		cpc r17,r27
 1987 0b0c 00F4      		brsh .+2
 1988 0b0e 00C0      		rjmp .L87
 1989 0b10 00C0      		rjmp .L83
 1990               	.L81:
 1991 0b12 82E0      		ldi r24,lo8(2)
 1992 0b14 00C0      		rjmp .L85
GAS LISTING /tmp/ccPugNTh.s 			page 65


 1993               	.L83:
 1994 0b16 80E0      		ldi r24,lo8(0)
 1995               	.L85:
 1996               	/* epilogue start */
 1997               		.stabn	68,0,457,.LM149-.LFBB9
 1998               	.LM149:
 1999 0b18 DF91      		pop r29
 2000 0b1a CF91      		pop r28
 2001 0b1c 1F91      		pop r17
 2002 0b1e 0F91      		pop r16
 2003 0b20 FF90      		pop r15
 2004 0b22 EF90      		pop r14
 2005 0b24 DF90      		pop r13
 2006 0b26 CF90      		pop r12
 2007 0b28 BF90      		pop r11
 2008 0b2a AF90      		pop r10
 2009 0b2c 9F90      		pop r9
 2010 0b2e 0895      		ret
 2011               		.size	remove_chain, .-remove_chain
 2012               		.stabs	"res:r(1,16)",64,0,432,24
 2013               		.stabs	"nxt:r(2,12)",64,0,433,10
 2014               		.stabn	192,0,0,.LFBB9-.LFBB9
 2015               		.stabn	224,0,0,.Lscope9-.LFBB9
 2016               	.Lscope9:
 2017               		.stabs	"",36,0,0,.Lscope9-.LFBB9
 2018               		.stabd	78,0,0
 2019               		.stabs	"dir_remove:f(1,16)",36,0,1055,dir_remove
 2020               		.stabs	"dj:P(0,16)",64,0,1053,28
 2021               		.type	dir_remove, @function
 2022               	dir_remove:
 2023               		.stabd	46,0,0
 2024               		.stabn	68,0,1055,.LM150-.LFBB10
 2025               	.LM150:
 2026               	.LFBB10:
 2027 0b30 CF93      		push r28
 2028 0b32 DF93      		push r29
 2029               	/* prologue: function */
 2030               	/* frame size = 0 */
 2031 0b34 EC01      		movw r28,r24
 2032               		.stabn	68,0,1075,.LM151-.LFBB10
 2033               	.LM151:
 2034 0b36 6C81      		ldd r22,Y+4
 2035 0b38 7D81      		ldd r23,Y+5
 2036 0b3a 0E94 0000 		call dir_seek
 2037 0b3e 982F      		mov r25,r24
 2038               		.stabn	68,0,1076,.LM152-.LFBB10
 2039               	.LM152:
 2040 0b40 8823      		tst r24
 2041 0b42 01F4      		brne .L92
 2042               		.stabn	68,0,1077,.LM153-.LFBB10
 2043               	.LM153:
 2044 0b44 4E85      		ldd r20,Y+14
 2045 0b46 5F85      		ldd r21,Y+15
 2046 0b48 6889      		ldd r22,Y+16
 2047 0b4a 7989      		ldd r23,Y+17
 2048 0b4c 8881      		ld r24,Y
 2049 0b4e 9981      		ldd r25,Y+1
GAS LISTING /tmp/ccPugNTh.s 			page 66


 2050 0b50 0E94 0000 		call move_window
 2051 0b54 982F      		mov r25,r24
 2052               		.stabn	68,0,1078,.LM154-.LFBB10
 2053               	.LM154:
 2054 0b56 8823      		tst r24
 2055 0b58 01F4      		brne .L92
 2056               		.stabn	68,0,1079,.LM155-.LFBB10
 2057               	.LM155:
 2058 0b5a EA89      		ldd r30,Y+18
 2059 0b5c FB89      		ldd r31,Y+19
 2060 0b5e 85EE      		ldi r24,lo8(-27)
 2061 0b60 8083      		st Z,r24
 2062               		.stabn	68,0,1080,.LM156-.LFBB10
 2063               	.LM156:
 2064 0b62 E881      		ld r30,Y
 2065 0b64 F981      		ldd r31,Y+1
 2066 0b66 81E0      		ldi r24,lo8(1)
 2067 0b68 8483      		std Z+4,r24
 2068               	.L92:
 2069               		.stabn	68,0,1086,.LM157-.LFBB10
 2070               	.LM157:
 2071 0b6a 892F      		mov r24,r25
 2072               	/* epilogue start */
 2073 0b6c DF91      		pop r29
 2074 0b6e CF91      		pop r28
 2075 0b70 0895      		ret
 2076               		.size	dir_remove, .-dir_remove
 2077               		.stabs	"res:r(1,16)",64,0,1056,25
 2078               		.stabn	192,0,0,.LFBB10-.LFBB10
 2079               		.stabn	224,0,0,.Lscope10-.LFBB10
 2080               	.Lscope10:
 2081               		.stabs	"",36,0,0,.Lscope10-.LFBB10
 2082               		.stabd	78,0,0
 2083               		.stabs	"dir_next:f(1,16)",36,0,597,dir_next
 2084               		.stabs	"dj:P(0,16)",64,0,594,28
 2085               		.stabs	"streach:P(2,14)",64,0,595,13
 2086               		.type	dir_next, @function
 2087               	dir_next:
 2088               		.stabd	46,0,0
 2089               		.stabn	68,0,597,.LM158-.LFBB11
 2090               	.LM158:
 2091               	.LFBB11:
 2092 0b72 4F92      		push r4
 2093 0b74 5F92      		push r5
 2094 0b76 6F92      		push r6
 2095 0b78 7F92      		push r7
 2096 0b7a 8F92      		push r8
 2097 0b7c 9F92      		push r9
 2098 0b7e AF92      		push r10
 2099 0b80 BF92      		push r11
 2100 0b82 CF92      		push r12
 2101 0b84 DF92      		push r13
 2102 0b86 EF92      		push r14
 2103 0b88 FF92      		push r15
 2104 0b8a 0F93      		push r16
 2105 0b8c 1F93      		push r17
 2106 0b8e CF93      		push r28
GAS LISTING /tmp/ccPugNTh.s 			page 67


 2107 0b90 DF93      		push r29
 2108               	/* prologue: function */
 2109               	/* frame size = 0 */
 2110 0b92 EC01      		movw r28,r24
 2111 0b94 D62E      		mov r13,r22
 2112               		.stabn	68,0,602,.LM159-.LFBB11
 2113               	.LM159:
 2114 0b96 6C80      		ldd r6,Y+4
 2115 0b98 7D80      		ldd r7,Y+5
 2116 0b9a 0894      		sec
 2117 0b9c 611C      		adc r6,__zero_reg__
 2118 0b9e 711C      		adc r7,__zero_reg__
 2119               		.stabn	68,0,603,.LM160-.LFBB11
 2120               	.LM160:
 2121 0ba0 6114      		cp r6,__zero_reg__
 2122 0ba2 7104      		cpc r7,__zero_reg__
 2123 0ba4 01F4      		brne .+2
 2124 0ba6 00C0      		rjmp .L95
 2125 0ba8 8E85      		ldd r24,Y+14
 2126 0baa 9F85      		ldd r25,Y+15
 2127 0bac A889      		ldd r26,Y+16
 2128 0bae B989      		ldd r27,Y+17
 2129 0bb0 0097      		sbiw r24,0
 2130 0bb2 A105      		cpc r26,__zero_reg__
 2131 0bb4 B105      		cpc r27,__zero_reg__
 2132 0bb6 01F4      		brne .+2
 2133 0bb8 00C0      		rjmp .L95
 2134               		.stabn	68,0,606,.LM161-.LFBB11
 2135               	.LM161:
 2136 0bba 1FE0      		ldi r17,lo8(15)
 2137 0bbc 412E      		mov r4,r17
 2138 0bbe 512C      		mov r5,__zero_reg__
 2139 0bc0 4620      		and r4,r6
 2140 0bc2 5720      		and r5,r7
 2141 0bc4 4114      		cp r4,__zero_reg__
 2142 0bc6 5104      		cpc r5,__zero_reg__
 2143 0bc8 01F0      		breq .+2
 2144 0bca 00C0      		rjmp .L96
 2145               		.stabn	68,0,607,.LM162-.LFBB11
 2146               	.LM162:
 2147 0bcc 0196      		adiw r24,1
 2148 0bce A11D      		adc r26,__zero_reg__
 2149 0bd0 B11D      		adc r27,__zero_reg__
 2150 0bd2 8E87      		std Y+14,r24
 2151 0bd4 9F87      		std Y+15,r25
 2152 0bd6 A88B      		std Y+16,r26
 2153 0bd8 B98B      		std Y+17,r27
 2154               		.stabn	68,0,609,.LM163-.LFBB11
 2155               	.LM163:
 2156 0bda 4A85      		ldd r20,Y+10
 2157 0bdc 5B85      		ldd r21,Y+11
 2158 0bde 6C85      		ldd r22,Y+12
 2159 0be0 7D85      		ldd r23,Y+13
 2160 0be2 E881      		ld r30,Y
 2161 0be4 F981      		ldd r31,Y+1
 2162 0be6 4115      		cp r20,__zero_reg__
 2163 0be8 5105      		cpc r21,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 68


 2164 0bea 6105      		cpc r22,__zero_reg__
 2165 0bec 7105      		cpc r23,__zero_reg__
 2166 0bee 01F4      		brne .L97
 2167               		.stabn	68,0,610,.LM164-.LFBB11
 2168               	.LM164:
 2169 0bf0 8085      		ldd r24,Z+8
 2170 0bf2 9185      		ldd r25,Z+9
 2171 0bf4 6816      		cp r6,r24
 2172 0bf6 7906      		cpc r7,r25
 2173 0bf8 00F4      		brsh .+2
 2174 0bfa 00C0      		rjmp .L96
 2175 0bfc 00C0      		rjmp .L95
 2176               	.L97:
 2177               		.stabn	68,0,614,.LM165-.LFBB11
 2178               	.LM165:
 2179 0bfe 8281      		ldd r24,Z+2
 2180 0c00 90E0      		ldi r25,lo8(0)
 2181 0c02 0197      		sbiw r24,1
 2182 0c04 9301      		movw r18,r6
 2183 0c06 A4E0      		ldi r26,4
 2184 0c08 3695      	1:	lsr r19
 2185 0c0a 2795      		ror r18
 2186 0c0c AA95      		dec r26
 2187 0c0e 01F4      		brne 1b
 2188 0c10 8223      		and r24,r18
 2189 0c12 9323      		and r25,r19
 2190 0c14 892B      		or r24,r25
 2191 0c16 01F0      		breq .+2
 2192 0c18 00C0      		rjmp .L96
 2193               		.stabn	68,0,615,.LM166-.LFBB11
 2194               	.LM166:
 2195 0c1a CF01      		movw r24,r30
 2196 0c1c 0E94 0000 		call get_fat
 2197 0c20 7B01      		movw r14,r22
 2198 0c22 8C01      		movw r16,r24
 2199               		.stabn	68,0,616,.LM167-.LFBB11
 2200               	.LM167:
 2201 0c24 6230      		cpi r22,lo8(2)
 2202 0c26 7105      		cpc r23,__zero_reg__
 2203 0c28 8105      		cpc r24,__zero_reg__
 2204 0c2a 9105      		cpc r25,__zero_reg__
 2205 0c2c 00F4      		brsh .+2
 2206 0c2e 00C0      		rjmp .L98
 2207               		.stabn	68,0,617,.LM168-.LFBB11
 2208               	.LM168:
 2209 0c30 8FEF      		ldi r24,lo8(-1)
 2210 0c32 E816      		cp r14,r24
 2211 0c34 8FEF      		ldi r24,hi8(-1)
 2212 0c36 F806      		cpc r15,r24
 2213 0c38 8FEF      		ldi r24,hlo8(-1)
 2214 0c3a 0807      		cpc r16,r24
 2215 0c3c 8FEF      		ldi r24,hhi8(-1)
 2216 0c3e 1807      		cpc r17,r24
 2217 0c40 01F4      		brne .+2
 2218 0c42 00C0      		rjmp .L99
 2219               		.stabn	68,0,618,.LM169-.LFBB11
 2220               	.LM169:
GAS LISTING /tmp/ccPugNTh.s 			page 69


 2221 0c44 E881      		ld r30,Y
 2222 0c46 F981      		ldd r31,Y+1
 2223 0c48 828D      		ldd r24,Z+26
 2224 0c4a 938D      		ldd r25,Z+27
 2225 0c4c A48D      		ldd r26,Z+28
 2226 0c4e B58D      		ldd r27,Z+29
 2227 0c50 E816      		cp r14,r24
 2228 0c52 F906      		cpc r15,r25
 2229 0c54 0A07      		cpc r16,r26
 2230 0c56 1B07      		cpc r17,r27
 2231 0c58 00F4      		brsh .+2
 2232 0c5a 00C0      		rjmp .L100
 2233               	.LBB70:
 2234               		.stabn	68,0,621,.LM170-.LFBB11
 2235               	.LM170:
 2236 0c5c DD20      		tst r13
 2237 0c5e 01F4      		brne .+2
 2238 0c60 00C0      		rjmp .L95
 2239               		.stabn	68,0,622,.LM171-.LFBB11
 2240               	.LM171:
 2241 0c62 4A85      		ldd r20,Y+10
 2242 0c64 5B85      		ldd r21,Y+11
 2243 0c66 6C85      		ldd r22,Y+12
 2244 0c68 7D85      		ldd r23,Y+13
 2245 0c6a CF01      		movw r24,r30
 2246 0c6c 0E94 0000 		call create_chain
 2247 0c70 7B01      		movw r14,r22
 2248 0c72 8C01      		movw r16,r24
 2249               		.stabn	68,0,623,.LM172-.LFBB11
 2250               	.LM172:
 2251 0c74 6115      		cp r22,__zero_reg__
 2252 0c76 7105      		cpc r23,__zero_reg__
 2253 0c78 8105      		cpc r24,__zero_reg__
 2254 0c7a 9105      		cpc r25,__zero_reg__
 2255 0c7c 01F4      		brne .L101
 2256 0c7e 87E0      		ldi r24,lo8(7)
 2257 0c80 00C0      		rjmp .L102
 2258               	.L101:
 2259               		.stabn	68,0,624,.LM173-.LFBB11
 2260               	.LM173:
 2261 0c82 91E0      		ldi r25,lo8(1)
 2262 0c84 E916      		cp r14,r25
 2263 0c86 F104      		cpc r15,__zero_reg__
 2264 0c88 0105      		cpc r16,__zero_reg__
 2265 0c8a 1105      		cpc r17,__zero_reg__
 2266 0c8c 01F4      		brne .+2
 2267 0c8e 00C0      		rjmp .L98
 2268               		.stabn	68,0,625,.LM174-.LFBB11
 2269               	.LM174:
 2270 0c90 AFEF      		ldi r26,lo8(-1)
 2271 0c92 EA16      		cp r14,r26
 2272 0c94 AFEF      		ldi r26,hi8(-1)
 2273 0c96 FA06      		cpc r15,r26
 2274 0c98 AFEF      		ldi r26,hlo8(-1)
 2275 0c9a 0A07      		cpc r16,r26
 2276 0c9c AFEF      		ldi r26,hhi8(-1)
 2277 0c9e 1A07      		cpc r17,r26
GAS LISTING /tmp/ccPugNTh.s 			page 70


 2278 0ca0 01F4      		brne .+2
 2279 0ca2 00C0      		rjmp .L99
 2280               		.stabn	68,0,627,.LM175-.LFBB11
 2281               	.LM175:
 2282 0ca4 8881      		ld r24,Y
 2283 0ca6 9981      		ldd r25,Y+1
 2284 0ca8 40E0      		ldi r20,lo8(0)
 2285 0caa 50E0      		ldi r21,hi8(0)
 2286 0cac 60E0      		ldi r22,hlo8(0)
 2287 0cae 70E0      		ldi r23,hhi8(0)
 2288 0cb0 0E94 0000 		call move_window
 2289 0cb4 8823      		tst r24
 2290 0cb6 01F0      		breq .+2
 2291 0cb8 00C0      		rjmp .L99
 2292               	.LBB71:
 2293               	.LBB72:
 2294               		.stabn	68,0,185,.LM176-.LFBB11
 2295               	.LM176:
 2296 0cba E881      		ld r30,Y
 2297 0cbc F981      		ldd r31,Y+1
 2298 0cbe BE96      		adiw r30,46
 2299 0cc0 80E0      		ldi r24,lo8(512)
 2300 0cc2 92E0      		ldi r25,hi8(512)
 2301 0cc4 00C0      		rjmp .L103
 2302               	.L104:
 2303               		.stabn	68,0,186,.LM177-.LFBB11
 2304               	.LM177:
 2305 0cc6 1192      		st Z+,__zero_reg__
 2306               	.L103:
 2307 0cc8 0197      		sbiw r24,1
 2308 0cca BFEF      		ldi r27,hi8(-1)
 2309 0ccc 8F3F      		cpi r24,lo8(-1)
 2310 0cce 9B07      		cpc r25,r27
 2311 0cd0 01F4      		brne .L104
 2312               	.LBE72:
 2313               	.LBE71:
 2314               		.stabn	68,0,629,.LM178-.LFBB11
 2315               	.LM178:
 2316 0cd2 8880      		ld r8,Y
 2317 0cd4 9980      		ldd r9,Y+1
 2318               	.LBB73:
 2319               	.LBB74:
 2320               		.stabn	68,0,532,.LM179-.LFBB11
 2321               	.LM179:
 2322 0cd6 8EEF      		ldi r24,lo8(-2)
 2323 0cd8 A82E      		mov r10,r24
 2324 0cda 8FEF      		ldi r24,hi8(-2)
 2325 0cdc B82E      		mov r11,r24
 2326 0cde 8FEF      		ldi r24,hlo8(-2)
 2327 0ce0 C82E      		mov r12,r24
 2328 0ce2 8FEF      		ldi r24,hhi8(-2)
 2329 0ce4 D82E      		mov r13,r24
 2330 0ce6 AE0C      		add r10,r14
 2331 0ce8 BF1C      		adc r11,r15
 2332 0cea C01E      		adc r12,r16
 2333 0cec D11E      		adc r13,r17
 2334               		.stabn	68,0,533,.LM180-.LFBB11
GAS LISTING /tmp/ccPugNTh.s 			page 71


 2335               	.LM180:
 2336 0cee F401      		movw r30,r8
 2337 0cf0 828D      		ldd r24,Z+26
 2338 0cf2 938D      		ldd r25,Z+27
 2339 0cf4 A48D      		ldd r26,Z+28
 2340 0cf6 B58D      		ldd r27,Z+29
 2341 0cf8 0297      		sbiw r24,2
 2342 0cfa A109      		sbc r26,__zero_reg__
 2343 0cfc B109      		sbc r27,__zero_reg__
 2344 0cfe A816      		cp r10,r24
 2345 0d00 B906      		cpc r11,r25
 2346 0d02 CA06      		cpc r12,r26
 2347 0d04 DB06      		cpc r13,r27
 2348 0d06 00F0      		brlo .L105
 2349 0d08 20E0      		ldi r18,lo8(0)
 2350 0d0a 30E0      		ldi r19,hi8(0)
 2351 0d0c 40E0      		ldi r20,hlo8(0)
 2352 0d0e 50E0      		ldi r21,hhi8(0)
 2353 0d10 00C0      		rjmp .L106
 2354               	.L105:
 2355               		.stabn	68,0,534,.LM181-.LFBB11
 2356               	.LM181:
 2357 0d12 D401      		movw r26,r8
 2358 0d14 1296      		adiw r26,2
 2359 0d16 2C91      		ld r18,X
 2360 0d18 30E0      		ldi r19,lo8(0)
 2361 0d1a 40E0      		ldi r20,lo8(0)
 2362 0d1c 50E0      		ldi r21,hi8(0)
 2363 0d1e C601      		movw r24,r12
 2364 0d20 B501      		movw r22,r10
 2365 0d22 0E94 0000 		call __mulsi3
 2366 0d26 9B01      		movw r18,r22
 2367 0d28 AC01      		movw r20,r24
 2368 0d2a F401      		movw r30,r8
 2369 0d2c 86A1      		ldd r24,Z+38
 2370 0d2e 97A1      		ldd r25,Z+39
 2371 0d30 A0A5      		ldd r26,Z+40
 2372 0d32 B1A5      		ldd r27,Z+41
 2373 0d34 280F      		add r18,r24
 2374 0d36 391F      		adc r19,r25
 2375 0d38 4A1F      		adc r20,r26
 2376 0d3a 5B1F      		adc r21,r27
 2377               	.L106:
 2378               	.LBE74:
 2379               	.LBE73:
 2380               		.stabn	68,0,629,.LM182-.LFBB11
 2381               	.LM182:
 2382 0d3c D401      		movw r26,r8
 2383 0d3e 9A96      		adiw r26,42
 2384 0d40 2D93      		st X+,r18
 2385 0d42 3D93      		st X+,r19
 2386 0d44 4D93      		st X+,r20
 2387 0d46 5C93      		st X,r21
 2388 0d48 9D97      		sbiw r26,42+3
 2389 0d4a DD24      		clr r13
 2390               		.stabn	68,0,631,.LM183-.LFBB11
 2391               	.LM183:
GAS LISTING /tmp/ccPugNTh.s 			page 72


 2392 0d4c CC24      		clr r12
 2393 0d4e C394      		inc r12
 2394 0d50 00C0      		rjmp .L107
 2395               	.L108:
 2396 0d52 C482      		std Z+4,r12
 2397               		.stabn	68,0,632,.LM184-.LFBB11
 2398               	.LM184:
 2399 0d54 8881      		ld r24,Y
 2400 0d56 9981      		ldd r25,Y+1
 2401 0d58 40E0      		ldi r20,lo8(0)
 2402 0d5a 50E0      		ldi r21,hi8(0)
 2403 0d5c 60E0      		ldi r22,hlo8(0)
 2404 0d5e 70E0      		ldi r23,hhi8(0)
 2405 0d60 0E94 0000 		call move_window
 2406 0d64 8823      		tst r24
 2407 0d66 01F0      		breq .+2
 2408 0d68 00C0      		rjmp .L99
 2409               		.stabn	68,0,633,.LM185-.LFBB11
 2410               	.LM185:
 2411 0d6a E881      		ld r30,Y
 2412 0d6c F981      		ldd r31,Y+1
 2413 0d6e 82A5      		ldd r24,Z+42
 2414 0d70 93A5      		ldd r25,Z+43
 2415 0d72 A4A5      		ldd r26,Z+44
 2416 0d74 B5A5      		ldd r27,Z+45
 2417 0d76 0196      		adiw r24,1
 2418 0d78 A11D      		adc r26,__zero_reg__
 2419 0d7a B11D      		adc r27,__zero_reg__
 2420 0d7c 82A7      		std Z+42,r24
 2421 0d7e 93A7      		std Z+43,r25
 2422 0d80 A4A7      		std Z+44,r26
 2423 0d82 B5A7      		std Z+45,r27
 2424               		.stabn	68,0,630,.LM186-.LFBB11
 2425               	.LM186:
 2426 0d84 D394      		inc r13
 2427               	.L107:
 2428 0d86 E881      		ld r30,Y
 2429 0d88 F981      		ldd r31,Y+1
 2430 0d8a 8281      		ldd r24,Z+2
 2431 0d8c D816      		cp r13,r24
 2432 0d8e 00F0      		brlo .L108
 2433               		.stabn	68,0,635,.LM187-.LFBB11
 2434               	.LM187:
 2435 0d90 82A5      		ldd r24,Z+42
 2436 0d92 93A5      		ldd r25,Z+43
 2437 0d94 A4A5      		ldd r26,Z+44
 2438 0d96 B5A5      		ldd r27,Z+45
 2439 0d98 8D19      		sub r24,r13
 2440 0d9a 9109      		sbc r25,__zero_reg__
 2441 0d9c A109      		sbc r26,__zero_reg__
 2442 0d9e B109      		sbc r27,__zero_reg__
 2443 0da0 82A7      		std Z+42,r24
 2444 0da2 93A7      		std Z+43,r25
 2445 0da4 A4A7      		std Z+44,r26
 2446 0da6 B5A7      		std Z+45,r27
 2447               	.L100:
 2448               	.LBE70:
GAS LISTING /tmp/ccPugNTh.s 			page 73


 2449               		.stabn	68,0,640,.LM188-.LFBB11
 2450               	.LM188:
 2451 0da8 EA86      		std Y+10,r14
 2452 0daa FB86      		std Y+11,r15
 2453 0dac 0C87      		std Y+12,r16
 2454 0dae 1D87      		std Y+13,r17
 2455               		.stabn	68,0,641,.LM189-.LFBB11
 2456               	.LM189:
 2457 0db0 C880      		ld r12,Y
 2458 0db2 D980      		ldd r13,Y+1
 2459               	.LBB75:
 2460               	.LBB76:
 2461               		.stabn	68,0,532,.LM190-.LFBB11
 2462               	.LM190:
 2463 0db4 8EEF      		ldi r24,lo8(-2)
 2464 0db6 9FEF      		ldi r25,hi8(-2)
 2465 0db8 AFEF      		ldi r26,hlo8(-2)
 2466 0dba BFEF      		ldi r27,hhi8(-2)
 2467 0dbc E80E      		add r14,r24
 2468 0dbe F91E      		adc r15,r25
 2469 0dc0 0A1F      		adc r16,r26
 2470 0dc2 1B1F      		adc r17,r27
 2471               		.stabn	68,0,533,.LM191-.LFBB11
 2472               	.LM191:
 2473 0dc4 F601      		movw r30,r12
 2474 0dc6 828D      		ldd r24,Z+26
 2475 0dc8 938D      		ldd r25,Z+27
 2476 0dca A48D      		ldd r26,Z+28
 2477 0dcc B58D      		ldd r27,Z+29
 2478 0dce 0297      		sbiw r24,2
 2479 0dd0 A109      		sbc r26,__zero_reg__
 2480 0dd2 B109      		sbc r27,__zero_reg__
 2481 0dd4 E816      		cp r14,r24
 2482 0dd6 F906      		cpc r15,r25
 2483 0dd8 0A07      		cpc r16,r26
 2484 0dda 1B07      		cpc r17,r27
 2485 0ddc 00F0      		brlo .L109
 2486 0dde 20E0      		ldi r18,lo8(0)
 2487 0de0 30E0      		ldi r19,hi8(0)
 2488 0de2 40E0      		ldi r20,hlo8(0)
 2489 0de4 50E0      		ldi r21,hhi8(0)
 2490 0de6 00C0      		rjmp .L110
 2491               	.L109:
 2492               		.stabn	68,0,534,.LM192-.LFBB11
 2493               	.LM192:
 2494 0de8 D601      		movw r26,r12
 2495 0dea 1296      		adiw r26,2
 2496 0dec 2C91      		ld r18,X
 2497 0dee 30E0      		ldi r19,lo8(0)
 2498 0df0 40E0      		ldi r20,lo8(0)
 2499 0df2 50E0      		ldi r21,hi8(0)
 2500 0df4 C801      		movw r24,r16
 2501 0df6 B701      		movw r22,r14
 2502 0df8 0E94 0000 		call __mulsi3
 2503 0dfc 9B01      		movw r18,r22
 2504 0dfe AC01      		movw r20,r24
 2505 0e00 F601      		movw r30,r12
GAS LISTING /tmp/ccPugNTh.s 			page 74


 2506 0e02 86A1      		ldd r24,Z+38
 2507 0e04 97A1      		ldd r25,Z+39
 2508 0e06 A0A5      		ldd r26,Z+40
 2509 0e08 B1A5      		ldd r27,Z+41
 2510 0e0a 280F      		add r18,r24
 2511 0e0c 391F      		adc r19,r25
 2512 0e0e 4A1F      		adc r20,r26
 2513 0e10 5B1F      		adc r21,r27
 2514               	.L110:
 2515               	.LBE76:
 2516               	.LBE75:
 2517               		.stabn	68,0,641,.LM193-.LFBB11
 2518               	.LM193:
 2519 0e12 2E87      		std Y+14,r18
 2520 0e14 3F87      		std Y+15,r19
 2521 0e16 488B      		std Y+16,r20
 2522 0e18 598B      		std Y+17,r21
 2523               	.L96:
 2524               		.stabn	68,0,646,.LM194-.LFBB11
 2525               	.LM194:
 2526 0e1a 7D82      		std Y+5,r7
 2527 0e1c 6C82      		std Y+4,r6
 2528               		.stabn	68,0,647,.LM195-.LFBB11
 2529               	.LM195:
 2530 0e1e 05E0      		ldi r16,5
 2531 0e20 440C      	1:	lsl r4
 2532 0e22 551C      		rol r5
 2533 0e24 0A95      		dec r16
 2534 0e26 01F4      		brne 1b
 2535 0e28 8EE2      		ldi r24,lo8(46)
 2536 0e2a 90E0      		ldi r25,hi8(46)
 2537 0e2c 480E      		add r4,r24
 2538 0e2e 591E      		adc r5,r25
 2539 0e30 8881      		ld r24,Y
 2540 0e32 9981      		ldd r25,Y+1
 2541 0e34 840D      		add r24,r4
 2542 0e36 951D      		adc r25,r5
 2543 0e38 9B8B      		std Y+19,r25
 2544 0e3a 8A8B      		std Y+18,r24
 2545 0e3c 80E0      		ldi r24,lo8(0)
 2546 0e3e 00C0      		rjmp .L102
 2547               	.L95:
 2548               		.stabn	68,0,649,.LM196-.LFBB11
 2549               	.LM196:
 2550 0e40 84E0      		ldi r24,lo8(4)
 2551 0e42 00C0      		rjmp .L102
 2552               	.L98:
 2553 0e44 82E0      		ldi r24,lo8(2)
 2554 0e46 00C0      		rjmp .L102
 2555               	.L99:
 2556 0e48 81E0      		ldi r24,lo8(1)
 2557               	.L102:
 2558               	/* epilogue start */
 2559               		.stabn	68,0,650,.LM197-.LFBB11
 2560               	.LM197:
 2561 0e4a DF91      		pop r29
 2562 0e4c CF91      		pop r28
GAS LISTING /tmp/ccPugNTh.s 			page 75


 2563 0e4e 1F91      		pop r17
 2564 0e50 0F91      		pop r16
 2565 0e52 FF90      		pop r15
 2566 0e54 EF90      		pop r14
 2567 0e56 DF90      		pop r13
 2568 0e58 CF90      		pop r12
 2569 0e5a BF90      		pop r11
 2570 0e5c AF90      		pop r10
 2571 0e5e 9F90      		pop r9
 2572 0e60 8F90      		pop r8
 2573 0e62 7F90      		pop r7
 2574 0e64 6F90      		pop r6
 2575 0e66 5F90      		pop r5
 2576 0e68 4F90      		pop r4
 2577 0e6a 0895      		ret
 2578               		.size	dir_next, .-dir_next
 2579               		.stabs	"clst:r(2,12)",64,0,598,14
 2580               		.stabs	"i:r(2,8)",64,0,599,6
 2581               		.stabn	192,0,0,.LFBB11-.LFBB11
 2582               		.stabs	"c:r(2,5)",64,0,620,13
 2583               		.stabn	192,0,0,.LBB70-.LFBB11
 2584               		.stabs	"cnt:r(0,1)",64,0,628,24
 2585               		.stabn	192,0,0,.LBB71-.LFBB11
 2586               		.stabs	"d:r(0,18)",64,0,185,30
 2587               		.stabn	192,0,0,.LBB72-.LFBB11
 2588               		.stabn	224,0,0,.LBE72-.LFBB11
 2589               		.stabn	224,0,0,.LBE71-.LFBB11
 2590               		.stabs	"clst:r(2,12)",64,0,629,10
 2591               		.stabn	192,0,0,.LBB73-.LFBB11
 2592               		.stabn	224,0,0,.LBE73-.LFBB11
 2593               		.stabn	224,0,0,.LBE70-.LFBB11
 2594               		.stabs	"clst:r(2,12)",64,0,641,14
 2595               		.stabn	192,0,0,.LBB75-.LFBB11
 2596               		.stabn	224,0,0,.LBE75-.LFBB11
 2597               		.stabn	224,0,0,.Lscope11-.LFBB11
 2598               	.Lscope11:
 2599               		.stabs	"",36,0,0,.Lscope11-.LFBB11
 2600               		.stabd	78,0,0
 2601               		.data
 2602               	.LC0:
 2603 0000 2022 2A2B 		.string	" \"*+,[=]|\177"
 2603      2C5B 3D5D 
 2603      7C7F 00
 2604               		.text
 2605               		.stabs	"follow_path:f(1,16)",36,0,1385,follow_path
 2606               		.stabs	"dj:P(0,16)",64,0,1382,28
 2607               		.stabs	"path:P(0,19)=*(0,20)=k(1,1)",64,0,1383,16
 2608               		.type	follow_path, @function
 2609               	follow_path:
 2610               		.stabd	46,0,0
 2611               		.stabn	68,0,1385,.LM198-.LFBB12
 2612               	.LM198:
 2613               	.LFBB12:
 2614 0e6c 6F92      		push r6
 2615 0e6e 7F92      		push r7
 2616 0e70 8F92      		push r8
 2617 0e72 9F92      		push r9
GAS LISTING /tmp/ccPugNTh.s 			page 76


 2618 0e74 AF92      		push r10
 2619 0e76 BF92      		push r11
 2620 0e78 CF92      		push r12
 2621 0e7a DF92      		push r13
 2622 0e7c EF92      		push r14
 2623 0e7e FF92      		push r15
 2624 0e80 0F93      		push r16
 2625 0e82 1F93      		push r17
 2626 0e84 CF93      		push r28
 2627 0e86 DF93      		push r29
 2628               	/* prologue: function */
 2629               	/* frame size = 0 */
 2630 0e88 EC01      		movw r28,r24
 2631 0e8a 8B01      		movw r16,r22
 2632 0e8c 00C0      		rjmp .L113
 2633               	.L114:
 2634               		.stabn	68,0,1390,.LM199-.LFBB12
 2635               	.LM199:
 2636 0e8e 0F5F      		subi r16,lo8(-(1))
 2637 0e90 1F4F      		sbci r17,hi8(-(1))
 2638               	.L113:
 2639 0e92 F801      		movw r30,r16
 2640 0e94 8081      		ld r24,Z
 2641 0e96 8032      		cpi r24,lo8(32)
 2642 0e98 01F0      		breq .L114
 2643               		.stabn	68,0,1398,.LM200-.LFBB12
 2644               	.LM200:
 2645 0e9a 8F32      		cpi r24,lo8(47)
 2646 0e9c 01F0      		breq .L115
 2647 0e9e 8C35      		cpi r24,lo8(92)
 2648 0ea0 01F4      		brne .L116
 2649               	.L115:
 2650               		.stabn	68,0,1399,.LM201-.LFBB12
 2651               	.LM201:
 2652 0ea2 0F5F      		subi r16,lo8(-(1))
 2653 0ea4 1F4F      		sbci r17,hi8(-(1))
 2654               	.L116:
 2655               		.stabn	68,0,1400,.LM202-.LFBB12
 2656               	.LM202:
 2657 0ea6 1E82      		std Y+6,__zero_reg__
 2658 0ea8 1F82      		std Y+7,__zero_reg__
 2659 0eaa 1886      		std Y+8,__zero_reg__
 2660 0eac 1986      		std Y+9,__zero_reg__
 2661               		.stabn	68,0,1403,.LM203-.LFBB12
 2662               	.LM203:
 2663 0eae F801      		movw r30,r16
 2664 0eb0 8081      		ld r24,Z
 2665 0eb2 8032      		cpi r24,lo8(32)
 2666 0eb4 00F4      		brsh .L117
 2667               		.stabn	68,0,1404,.LM204-.LFBB12
 2668               	.LM204:
 2669 0eb6 CE01      		movw r24,r28
 2670 0eb8 60E0      		ldi r22,lo8(0)
 2671 0eba 70E0      		ldi r23,hi8(0)
 2672 0ebc 0E94 0000 		call dir_seek
 2673               		.stabn	68,0,1405,.LM205-.LFBB12
 2674               	.LM205:
GAS LISTING /tmp/ccPugNTh.s 			page 77


 2675 0ec0 1B8A      		std Y+19,__zero_reg__
 2676 0ec2 1A8A      		std Y+18,__zero_reg__
 2677 0ec4 00C0      		rjmp .L118
 2678               	.L117:
 2679               	.LBB77:
 2680               	.LBB78:
 2681               	.LBB82:
 2682               	.LBB83:
 2683               		.stabn	68,0,186,.LM206-.LFBB12
 2684               	.LM206:
 2685 0ec6 20E2      		ldi r18,lo8(32)
 2686 0ec8 722E      		mov r7,r18
 2687               	.LBE83:
 2688               	.LBE82:
 2689               		.stabn	68,0,1291,.LM207-.LFBB12
 2690               	.LM207:
 2691 0eca 95E0      		ldi r25,lo8(5)
 2692 0ecc 692E      		mov r6,r25
 2693               	.L150:
 2694               		.stabn	68,0,1233,.LM208-.LFBB12
 2695               	.LM208:
 2696 0ece EC88      		ldd r14,Y+20
 2697 0ed0 FD88      		ldd r15,Y+21
 2698 0ed2 F701      		movw r30,r14
 2699 0ed4 8BE0      		ldi r24,lo8(11)
 2700 0ed6 90E0      		ldi r25,hi8(11)
 2701 0ed8 00C0      		rjmp .L119
 2702               	.L120:
 2703               	.LBB81:
 2704               	.LBB84:
 2705               		.stabn	68,0,186,.LM209-.LFBB12
 2706               	.LM209:
 2707 0eda 7192      		st Z+,r7
 2708               	.L119:
 2709 0edc 0197      		sbiw r24,1
 2710 0ede 2FEF      		ldi r18,hi8(-1)
 2711 0ee0 8F3F      		cpi r24,lo8(-1)
 2712 0ee2 9207      		cpc r25,r18
 2713 0ee4 01F4      		brne .L120
 2714 0ee6 60E0      		ldi r22,lo8(0)
 2715 0ee8 70E0      		ldi r23,hi8(0)
 2716 0eea CC24      		clr r12
 2717 0eec DD24      		clr r13
 2718 0eee A8E0      		ldi r26,lo8(8)
 2719 0ef0 B0E0      		ldi r27,hi8(8)
 2720 0ef2 30E0      		ldi r19,lo8(0)
 2721               	.L149:
 2722               	.LBE84:
 2723               	.LBE81:
 2724               		.stabn	68,0,1251,.LM210-.LFBB12
 2725               	.LM210:
 2726 0ef4 F801      		movw r30,r16
 2727 0ef6 EC0D      		add r30,r12
 2728 0ef8 FD1D      		adc r31,r13
 2729 0efa 2081      		ld r18,Z
 2730 0efc 0894      		sec
 2731 0efe C11C      		adc r12,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 78


 2732 0f00 D11C      		adc r13,__zero_reg__
 2733               		.stabn	68,0,1252,.LM211-.LFBB12
 2734               	.LM211:
 2735 0f02 2132      		cpi r18,lo8(33)
 2736 0f04 00F4      		brsh .+2
 2737 0f06 00C0      		rjmp .L121
 2738 0f08 2F32      		cpi r18,lo8(47)
 2739 0f0a 01F4      		brne .+2
 2740 0f0c 00C0      		rjmp .L122
 2741 0f0e 2C35      		cpi r18,lo8(92)
 2742 0f10 01F4      		brne .+2
 2743 0f12 00C0      		rjmp .L122
 2744               		.stabn	68,0,1253,.LM212-.LFBB12
 2745               	.LM212:
 2746 0f14 2E32      		cpi r18,lo8(46)
 2747 0f16 01F0      		breq .L123
 2748 0f18 6A17      		cp r22,r26
 2749 0f1a 7B07      		cpc r23,r27
 2750 0f1c 04F0      		brlt .L124
 2751               	.L123:
 2752               		.stabn	68,0,1254,.LM213-.LFBB12
 2753               	.LM213:
 2754 0f1e 1897      		sbiw r26,8
 2755 0f20 01F0      		breq .+2
 2756 0f22 00C0      		rjmp .L125
 2757 0f24 2E32      		cpi r18,lo8(46)
 2758 0f26 01F0      		breq .+2
 2759 0f28 00C0      		rjmp .L125
 2760               		.stabn	68,0,1256,.LM214-.LFBB12
 2761               	.LM214:
 2762 0f2a 330F      		lsl r19
 2763 0f2c 330F      		lsl r19
 2764 0f2e 68E0      		ldi r22,lo8(8)
 2765 0f30 70E0      		ldi r23,hi8(8)
 2766 0f32 ABE0      		ldi r26,lo8(11)
 2767 0f34 B0E0      		ldi r27,hi8(11)
 2768 0f36 00C0      		rjmp .L149
 2769               	.L124:
 2770               		.stabn	68,0,1258,.LM215-.LFBB12
 2771               	.LM215:
 2772 0f38 27FF      		sbrs r18,7
 2773 0f3a 00C0      		rjmp .L127
 2774               		.stabn	68,0,1260,.LM216-.LFBB12
 2775               	.LM216:
 2776 0f3c E22F      		mov r30,r18
 2777 0f3e F0E0      		ldi r31,lo8(0)
 2778 0f40 E050      		subi r30,lo8(-(cvt.1849-128))
 2779 0f42 F040      		sbci r31,hi8(-(cvt.1849-128))
 2780 0f44 2081      		ld r18,Z
 2781               	.L127:
 2782               		.stabn	68,0,1275,.LM217-.LFBB12
 2783               	.LM217:
 2784 0f46 422F      		mov r20,r18
 2785 0f48 50E0      		ldi r21,lo8(0)
 2786 0f4a E0E0      		ldi r30,lo8(.LC0)
 2787 0f4c F0E0      		ldi r31,hi8(.LC0)
 2788 0f4e 00C0      		rjmp .L128
GAS LISTING /tmp/ccPugNTh.s 			page 79


 2789               	.L130:
 2790               	.LBB79:
 2791               	.LBB80:
 2792               		.stabn	68,0,201,.LM218-.LFBB12
 2793               	.LM218:
 2794 0f50 3196      		adiw r30,1
 2795               	.L128:
 2796 0f52 8081      		ld r24,Z
 2797 0f54 8823      		tst r24
 2798 0f56 01F0      		breq .L129
 2799 0f58 90E0      		ldi r25,lo8(0)
 2800 0f5a 8417      		cp r24,r20
 2801 0f5c 9507      		cpc r25,r21
 2802 0f5e 01F4      		brne .L130
 2803 0f60 00C0      		rjmp .L125
 2804               	.L129:
 2805               	.LBE80:
 2806               	.LBE79:
 2807               		.stabn	68,0,1277,.LM219-.LFBB12
 2808               	.LM219:
 2809 0f62 822F      		mov r24,r18
 2810 0f64 8154      		subi r24,lo8(-(-65))
 2811 0f66 8A31      		cpi r24,lo8(26)
 2812 0f68 00F4      		brsh .L131
 2813               		.stabn	68,0,1278,.LM220-.LFBB12
 2814               	.LM220:
 2815 0f6a 3260      		ori r19,lo8(2)
 2816 0f6c 00C0      		rjmp .L132
 2817               	.L131:
 2818               		.stabn	68,0,1280,.LM221-.LFBB12
 2819               	.LM221:
 2820 0f6e 822F      		mov r24,r18
 2821 0f70 8156      		subi r24,lo8(-(-97))
 2822 0f72 8A31      		cpi r24,lo8(26)
 2823 0f74 00F4      		brsh .L132
 2824               		.stabn	68,0,1281,.LM222-.LFBB12
 2825               	.LM222:
 2826 0f76 3160      		ori r19,lo8(1)
 2827 0f78 2052      		subi r18,lo8(-(-32))
 2828               	.L132:
 2829               		.stabn	68,0,1284,.LM223-.LFBB12
 2830               	.LM223:
 2831 0f7a F701      		movw r30,r14
 2832 0f7c E60F      		add r30,r22
 2833 0f7e F71F      		adc r31,r23
 2834 0f80 2083      		st Z,r18
 2835 0f82 6F5F      		subi r22,lo8(-(1))
 2836 0f84 7F4F      		sbci r23,hi8(-(1))
 2837 0f86 00C0      		rjmp .L149
 2838               	.L121:
 2839 0f88 44E0      		ldi r20,lo8(4)
 2840               	.L145:
 2841               		.stabn	68,0,1290,.LM224-.LFBB12
 2842               	.LM224:
 2843 0f8a 672B      		or r22,r23
 2844 0f8c 01F4      		brne .+2
 2845 0f8e 00C0      		rjmp .L125
GAS LISTING /tmp/ccPugNTh.s 			page 80


 2846               		.stabn	68,0,1291,.LM225-.LFBB12
 2847               	.LM225:
 2848 0f90 F701      		movw r30,r14
 2849 0f92 8081      		ld r24,Z
 2850 0f94 853E      		cpi r24,lo8(-27)
 2851 0f96 01F4      		brne .L133
 2852 0f98 6082      		st Z,r6
 2853               	.L133:
 2854               		.stabn	68,0,1293,.LM226-.LFBB12
 2855               	.LM226:
 2856 0f9a 1897      		sbiw r26,8
 2857 0f9c 01F4      		brne .L134
 2858 0f9e 330F      		lsl r19
 2859 0fa0 330F      		lsl r19
 2860               	.L134:
 2861               		.stabn	68,0,1294,.LM227-.LFBB12
 2862               	.LM227:
 2863 0fa2 232F      		mov r18,r19
 2864 0fa4 30E0      		ldi r19,lo8(0)
 2865 0fa6 C901      		movw r24,r18
 2866 0fa8 8370      		andi r24,lo8(3)
 2867 0faa 9070      		andi r25,hi8(3)
 2868 0fac 0197      		sbiw r24,1
 2869 0fae 01F4      		brne .L135
 2870 0fb0 4061      		ori r20,lo8(16)
 2871               	.L135:
 2872               		.stabn	68,0,1295,.LM228-.LFBB12
 2873               	.LM228:
 2874 0fb2 2C70      		andi r18,lo8(12)
 2875 0fb4 3070      		andi r19,hi8(12)
 2876 0fb6 2430      		cpi r18,4
 2877 0fb8 3105      		cpc r19,__zero_reg__
 2878 0fba 01F4      		brne .L136
 2879 0fbc 4860      		ori r20,lo8(8)
 2880               	.L136:
 2881               		.stabn	68,0,1297,.LM229-.LFBB12
 2882               	.LM229:
 2883 0fbe F701      		movw r30,r14
 2884 0fc0 4387      		std Z+11,r20
 2885               	.LBE78:
 2886               	.LBE77:
 2887               	.LBB86:
 2888               		.stabn	68,0,840,.LM230-.LFBB12
 2889               	.LM230:
 2890 0fc2 CE01      		movw r24,r28
 2891 0fc4 60E0      		ldi r22,lo8(0)
 2892 0fc6 70E0      		ldi r23,hi8(0)
 2893 0fc8 0E94 0000 		call dir_seek
 2894               	.L151:
 2895 0fcc 482F      		mov r20,r24
 2896               	.LBB87:
 2897               		.stabn	68,0,841,.LM231-.LFBB12
 2898               	.LM231:
 2899 0fce 8823      		tst r24
 2900 0fd0 01F4      		brne .L137
 2901               	.LBE87:
 2902               		.stabn	68,0,847,.LM232-.LFBB12
GAS LISTING /tmp/ccPugNTh.s 			page 81


 2903               	.LM232:
 2904 0fd2 4E85      		ldd r20,Y+14
 2905 0fd4 5F85      		ldd r21,Y+15
 2906 0fd6 6889      		ldd r22,Y+16
 2907 0fd8 7989      		ldd r23,Y+17
 2908 0fda 8881      		ld r24,Y
 2909 0fdc 9981      		ldd r25,Y+1
 2910 0fde 0E94 0000 		call move_window
 2911 0fe2 482F      		mov r20,r24
 2912               	.LBB90:
 2913               		.stabn	68,0,848,.LM233-.LFBB12
 2914               	.LM233:
 2915 0fe4 8823      		tst r24
 2916 0fe6 01F4      		brne .L137
 2917               		.stabn	68,0,849,.LM234-.LFBB12
 2918               	.LM234:
 2919 0fe8 EA89      		ldd r30,Y+18
 2920 0fea FB89      		ldd r31,Y+19
 2921               		.stabn	68,0,851,.LM235-.LFBB12
 2922               	.LM235:
 2923 0fec 8081      		ld r24,Z
 2924 0fee 8823      		tst r24
 2925 0ff0 01F4      		brne .L138
 2926 0ff2 44E0      		ldi r20,lo8(4)
 2927 0ff4 00C0      		rjmp .L137
 2928               	.L138:
 2929               		.stabn	68,0,874,.LM236-.LFBB12
 2930               	.LM236:
 2931 0ff6 8385      		ldd r24,Z+11
 2932 0ff8 83FD      		sbrc r24,3
 2933 0ffa 00C0      		rjmp .L139
 2934 0ffc DF01      		movw r26,r30
 2935 0ffe 8C89      		ldd r24,Y+20
 2936 1000 9D89      		ldd r25,Y+21
 2937 1002 9C01      		movw r18,r24
 2938 1004 F901      		movw r30,r18
 2939 1006 2BE0      		ldi r18,lo8(11)
 2940 1008 30E0      		ldi r19,hi8(11)
 2941               	.L140:
 2942               	.LBB88:
 2943               	.LBB89:
 2944               		.stabn	68,0,194,.LM237-.LFBB12
 2945               	.LM237:
 2946 100a 2150      		subi r18,lo8(-(-1))
 2947 100c 3040      		sbci r19,hi8(-(-1))
 2948 100e 8FEF      		ldi r24,hi8(-1)
 2949 1010 2F3F      		cpi r18,lo8(-1)
 2950 1012 3807      		cpc r19,r24
 2951 1014 01F0      		breq .L137
 2952 1016 9C91      		ld r25,X
 2953 1018 8081      		ld r24,Z
 2954 101a 9817      		cp r25,r24
 2955 101c 01F4      		brne .L139
 2956 101e 1196      		adiw r26,1
 2957 1020 3196      		adiw r30,1
 2958 1022 00C0      		rjmp .L140
 2959               	.L139:
GAS LISTING /tmp/ccPugNTh.s 			page 82


 2960               	.LBE89:
 2961               	.LBE88:
 2962               	.LBE90:
 2963               		.stabn	68,0,877,.LM238-.LFBB12
 2964               	.LM238:
 2965 1024 CE01      		movw r24,r28
 2966 1026 60E0      		ldi r22,lo8(0)
 2967 1028 0E94 0000 		call dir_next
 2968 102c 00C0      		rjmp .L151
 2969               	.L137:
 2970               	.LBE86:
 2971               		.stabn	68,0,1412,.LM239-.LFBB12
 2972               	.LM239:
 2973 102e EC89      		ldd r30,Y+20
 2974 1030 FD89      		ldd r31,Y+21
 2975 1032 9385      		ldd r25,Z+11
 2976 1034 9470      		andi r25,lo8(4)
 2977               		.stabn	68,0,1413,.LM240-.LFBB12
 2978               	.LM240:
 2979 1036 4423      		tst r20
 2980 1038 01F0      		breq .L142
 2981 103a 842F      		mov r24,r20
 2982               		.stabn	68,0,1414,.LM241-.LFBB12
 2983               	.LM241:
 2984 103c 4430      		cpi r20,lo8(4)
 2985 103e 01F4      		brne .L143
 2986 1040 9923      		tst r25
 2987 1042 01F0      		breq .L144
 2988 1044 00C0      		rjmp .L118
 2989               	.L142:
 2990               		.stabn	68,0,1418,.LM242-.LFBB12
 2991               	.LM242:
 2992 1046 9923      		tst r25
 2993 1048 01F4      		brne .L143
 2994               		.stabn	68,0,1419,.LM243-.LFBB12
 2995               	.LM243:
 2996 104a EA89      		ldd r30,Y+18
 2997 104c FB89      		ldd r31,Y+19
 2998               		.stabn	68,0,1420,.LM244-.LFBB12
 2999               	.LM244:
 3000 104e 8385      		ldd r24,Z+11
 3001 1050 84FF      		sbrs r24,4
 3002 1052 00C0      		rjmp .L144
 3003               	.LBB91:
 3004               	.LBB85:
 3005               		.stabn	68,0,1287,.LM245-.LFBB12
 3006               	.LM245:
 3007 1054 0C0D      		add r16,r12
 3008 1056 1D1D      		adc r17,r13
 3009               	.LBE85:
 3010               	.LBE91:
 3011               		.stabn	68,0,1423,.LM246-.LFBB12
 3012               	.LM246:
 3013 1058 9588      		ldd r9,Z+21
 3014 105a 8824      		clr r8
 3015 105c 2489      		ldd r18,Z+20
 3016 105e 30E0      		ldi r19,lo8(0)
GAS LISTING /tmp/ccPugNTh.s 			page 83


 3017 1060 2829      		or r18,r8
 3018 1062 3929      		or r19,r9
 3019 1064 40E0      		ldi r20,lo8(0)
 3020 1066 50E0      		ldi r21,hi8(0)
 3021 1068 A901      		movw r20,r18
 3022 106a 3327      		clr r19
 3023 106c 2227      		clr r18
 3024 106e B38C      		ldd r11,Z+27
 3025 1070 AA24      		clr r10
 3026 1072 828D      		ldd r24,Z+26
 3027 1074 90E0      		ldi r25,lo8(0)
 3028 1076 8A29      		or r24,r10
 3029 1078 9B29      		or r25,r11
 3030 107a A0E0      		ldi r26,lo8(0)
 3031 107c B0E0      		ldi r27,hi8(0)
 3032 107e 282B      		or r18,r24
 3033 1080 392B      		or r19,r25
 3034 1082 4A2B      		or r20,r26
 3035 1084 5B2B      		or r21,r27
 3036 1086 2E83      		std Y+6,r18
 3037 1088 3F83      		std Y+7,r19
 3038 108a 4887      		std Y+8,r20
 3039 108c 5987      		std Y+9,r21
 3040 108e 00C0      		rjmp .L150
 3041               	.L125:
 3042               		.stabn	68,0,1424,.LM247-.LFBB12
 3043               	.LM247:
 3044 1090 86E0      		ldi r24,lo8(6)
 3045 1092 00C0      		rjmp .L118
 3046               	.L143:
 3047 1094 842F      		mov r24,r20
 3048 1096 00C0      		rjmp .L118
 3049               	.L144:
 3050 1098 85E0      		ldi r24,lo8(5)
 3051               	.L118:
 3052               	/* epilogue start */
 3053               		.stabn	68,0,1428,.LM248-.LFBB12
 3054               	.LM248:
 3055 109a DF91      		pop r29
 3056 109c CF91      		pop r28
 3057 109e 1F91      		pop r17
 3058 10a0 0F91      		pop r16
 3059 10a2 FF90      		pop r15
 3060 10a4 EF90      		pop r14
 3061 10a6 DF90      		pop r13
 3062 10a8 CF90      		pop r12
 3063 10aa BF90      		pop r11
 3064 10ac AF90      		pop r10
 3065 10ae 9F90      		pop r9
 3066 10b0 8F90      		pop r8
 3067 10b2 7F90      		pop r7
 3068 10b4 6F90      		pop r6
 3069 10b6 0895      		ret
 3070               	.L122:
 3071               		.stabn	68,0,1424,.LM249-.LFBB12
 3072               	.LM249:
 3073 10b8 40E0      		ldi r20,lo8(0)
GAS LISTING /tmp/ccPugNTh.s 			page 84


 3074 10ba 00C0      		rjmp .L145
 3075               		.size	follow_path, .-follow_path
 3076               		.stabs	"res:r(1,16)",64,0,1386,24
 3077               		.stabs	"dir:r(1,8)",64,0,1387,30
 3078               		.stabs	"last:r(2,5)",64,0,1387,25
 3079               		.stabn	192,0,0,.LFBB12-.LFBB12
 3080               		.stabs	"b:r(2,5)",64,0,1228,19
 3081               		.stabs	"c:r(2,5)",64,0,1228,18
 3082               		.stabs	"sfn:r(1,8)",64,0,1228,14
 3083               		.stabs	"ni:r(0,1)",64,0,1229,26
 3084               		.stabs	"si:r(0,1)",64,0,1229,12
 3085               		.stabs	"i:r(0,1)",64,0,1229,22
 3086               		.stabn	192,0,0,.LBB78-.LFBB12
 3087               		.stabs	"str:r(0,21)=*(0,22)=k(0,2)",64,0,1275,30
 3088               		.stabn	192,0,0,.LBB79-.LFBB12
 3089               		.stabn	224,0,0,.LBE79-.LFBB12
 3090               		.stabs	"cnt:r(0,1)",64,0,1234,24
 3091               		.stabn	192,0,0,.LBB81-.LFBB12
 3092               		.stabn	224,0,0,.LBE81-.LFBB12
 3093               		.stabs	"cnt:r(0,1)",64,0,1234,24
 3094               		.stabn	192,0,0,.LBB82-.LFBB12
 3095               		.stabn	224,0,0,.LBE82-.LFBB12
 3096               		.stabn	224,0,0,.LBE78-.LFBB12
 3097               		.stabs	"b:r(2,5)",64,0,1228,19
 3098               		.stabs	"c:r(2,5)",64,0,1228,18
 3099               		.stabs	"sfn:r(1,8)",64,0,1228,14
 3100               		.stabs	"ni:r(0,1)",64,0,1229,26
 3101               		.stabs	"si:r(0,1)",64,0,1229,12
 3102               		.stabs	"i:r(0,1)",64,0,1229,22
 3103               		.stabn	192,0,0,.LBB85-.LFBB12
 3104               		.stabn	224,0,0,.LBE85-.LFBB12
 3105               		.stabs	"dir:r(1,8)",64,0,835,30
 3106               		.stabn	192,0,0,.LBB87-.LFBB12
 3107               		.stabs	"cnt:r(0,1)",64,0,874,18
 3108               		.stabn	192,0,0,.LBB88-.LFBB12
 3109               		.stabs	"d:r(0,21)",64,0,192,26
 3110               		.stabs	"s:r(0,21)",64,0,192,30
 3111               		.stabn	192,0,0,.LBB89-.LFBB12
 3112               		.stabn	224,0,0,.LBE89-.LFBB12
 3113               		.stabn	224,0,0,.LBE88-.LFBB12
 3114               		.stabn	224,0,0,.LBE87-.LFBB12
 3115               		.stabs	"dir:r(1,8)",64,0,835,30
 3116               		.stabn	192,0,0,.LBB90-.LFBB12
 3117               		.stabn	224,0,0,.LBE90-.LFBB12
 3118               		.stabn	224,0,0,.Lscope12-.LFBB12
 3119               	.Lscope12:
 3120               		.stabs	"",36,0,0,.Lscope12-.LFBB12
 3121               		.stabd	78,0,0
 3122               		.stabs	"dir_register:f(1,16)",36,0,951,dir_register
 3123               		.stabs	"dj:P(0,16)",64,0,949,28
 3124               		.type	dir_register, @function
 3125               	dir_register:
 3126               		.stabd	46,0,0
 3127               		.stabn	68,0,951,.LM250-.LFBB13
 3128               	.LM250:
 3129               	.LFBB13:
 3130 10bc CF93      		push r28
GAS LISTING /tmp/ccPugNTh.s 			page 85


 3131 10be DF93      		push r29
 3132               	/* prologue: function */
 3133               	/* frame size = 0 */
 3134 10c0 EC01      		movw r28,r24
 3135               		.stabn	68,0,1017,.LM251-.LFBB13
 3136               	.LM251:
 3137 10c2 60E0      		ldi r22,lo8(0)
 3138 10c4 70E0      		ldi r23,hi8(0)
 3139 10c6 0E94 0000 		call dir_seek
 3140               	.L164:
 3141 10ca 482F      		mov r20,r24
 3142               		.stabn	68,0,1018,.LM252-.LFBB13
 3143               	.LM252:
 3144 10cc 8823      		tst r24
 3145 10ce 01F4      		brne .L153
 3146               		.stabn	68,0,1020,.LM253-.LFBB13
 3147               	.LM253:
 3148 10d0 4E85      		ldd r20,Y+14
 3149 10d2 5F85      		ldd r21,Y+15
 3150 10d4 6889      		ldd r22,Y+16
 3151 10d6 7989      		ldd r23,Y+17
 3152 10d8 8881      		ld r24,Y
 3153 10da 9981      		ldd r25,Y+1
 3154 10dc 0E94 0000 		call move_window
 3155 10e0 482F      		mov r20,r24
 3156               		.stabn	68,0,1021,.LM254-.LFBB13
 3157               	.LM254:
 3158 10e2 8823      		tst r24
 3159 10e4 01F4      		brne .L153
 3160               		.stabn	68,0,1022,.LM255-.LFBB13
 3161               	.LM255:
 3162 10e6 EA89      		ldd r30,Y+18
 3163 10e8 FB89      		ldd r31,Y+19
 3164 10ea E081      		ld r30,Z
 3165               		.stabn	68,0,1023,.LM256-.LFBB13
 3166               	.LM256:
 3167 10ec E53E      		cpi r30,lo8(-27)
 3168 10ee 01F0      		breq .L154
 3169 10f0 EE23      		tst r30
 3170 10f2 01F0      		breq .L154
 3171               		.stabn	68,0,1024,.LM257-.LFBB13
 3172               	.LM257:
 3173 10f4 CE01      		movw r24,r28
 3174 10f6 61E0      		ldi r22,lo8(1)
 3175 10f8 0E94 0000 		call dir_next
 3176 10fc 00C0      		rjmp .L164
 3177               	.L160:
 3178               		.stabn	68,0,1032,.LM258-.LFBB13
 3179               	.LM258:
 3180 10fe 6A89      		ldd r22,Y+18
 3181 1100 7B89      		ldd r23,Y+19
 3182 1102 FB01      		movw r30,r22
 3183 1104 80E2      		ldi r24,lo8(32)
 3184 1106 90E0      		ldi r25,hi8(32)
 3185 1108 00C0      		rjmp .L156
 3186               	.L157:
 3187               	.LBB92:
GAS LISTING /tmp/ccPugNTh.s 			page 86


 3188               	.LBB93:
 3189               		.stabn	68,0,186,.LM259-.LFBB13
 3190               	.LM259:
 3191 110a 1192      		st Z+,__zero_reg__
 3192               	.L156:
 3193 110c 0197      		sbiw r24,1
 3194 110e 2FEF      		ldi r18,hi8(-1)
 3195 1110 8F3F      		cpi r24,lo8(-1)
 3196 1112 9207      		cpc r25,r18
 3197 1114 01F4      		brne .L157
 3198               	.LBE93:
 3199               	.LBE92:
 3200               		.stabn	68,0,1034,.LM260-.LFBB13
 3201               	.LM260:
 3202 1116 8C89      		ldd r24,Y+20
 3203 1118 9D89      		ldd r25,Y+21
 3204 111a 9C01      		movw r18,r24
 3205 111c D901      		movw r26,r18
 3206 111e FB01      		movw r30,r22
 3207 1120 2BE0      		ldi r18,lo8(11)
 3208 1122 30E0      		ldi r19,hi8(11)
 3209 1124 00C0      		rjmp .L158
 3210               	.L159:
 3211               	.LBB94:
 3212               	.LBB95:
 3213               		.stabn	68,0,179,.LM261-.LFBB13
 3214               	.LM261:
 3215 1126 8D91      		ld r24,X+
 3216 1128 8193      		st Z+,r24
 3217               	.L158:
 3218 112a 2150      		subi r18,lo8(-(-1))
 3219 112c 3040      		sbci r19,hi8(-(-1))
 3220 112e 8FEF      		ldi r24,hi8(-1)
 3221 1130 2F3F      		cpi r18,lo8(-1)
 3222 1132 3807      		cpc r19,r24
 3223 1134 01F4      		brne .L159
 3224               	.LBE95:
 3225               	.LBE94:
 3226               		.stabn	68,0,1035,.LM262-.LFBB13
 3227               	.LM262:
 3228 1136 EC89      		ldd r30,Y+20
 3229 1138 FD89      		ldd r31,Y+21
 3230 113a 8385      		ldd r24,Z+11
 3231 113c 8871      		andi r24,lo8(24)
 3232 113e FB01      		movw r30,r22
 3233 1140 8487      		std Z+12,r24
 3234               		.stabn	68,0,1036,.LM263-.LFBB13
 3235               	.LM263:
 3236 1142 E881      		ld r30,Y
 3237 1144 F981      		ldd r31,Y+1
 3238 1146 81E0      		ldi r24,lo8(1)
 3239 1148 8483      		std Z+4,r24
 3240               	.L153:
 3241               		.stabn	68,0,1041,.LM264-.LFBB13
 3242               	.LM264:
 3243 114a 842F      		mov r24,r20
 3244               	/* epilogue start */
GAS LISTING /tmp/ccPugNTh.s 			page 87


 3245 114c DF91      		pop r29
 3246 114e CF91      		pop r28
 3247 1150 0895      		ret
 3248               	.L154:
 3249               		.stabn	68,0,1030,.LM265-.LFBB13
 3250               	.LM265:
 3251 1152 4E85      		ldd r20,Y+14
 3252 1154 5F85      		ldd r21,Y+15
 3253 1156 6889      		ldd r22,Y+16
 3254 1158 7989      		ldd r23,Y+17
 3255 115a 8881      		ld r24,Y
 3256 115c 9981      		ldd r25,Y+1
 3257 115e 0E94 0000 		call move_window
 3258 1162 482F      		mov r20,r24
 3259               		.stabn	68,0,1031,.LM266-.LFBB13
 3260               	.LM266:
 3261 1164 8823      		tst r24
 3262 1166 01F0      		breq .L160
 3263 1168 00C0      		rjmp .L153
 3264               		.size	dir_register, .-dir_register
 3265               		.stabs	"res:r(1,16)",64,0,952,20
 3266               		.stabs	"c:r(2,5)",64,0,953,30
 3267               		.stabs	"dir:r(1,8)",64,0,953,22
 3268               		.stabn	192,0,0,.LFBB13-.LFBB13
 3269               		.stabs	"cnt:r(0,1)",64,0,1033,24
 3270               		.stabn	192,0,0,.LBB92-.LFBB13
 3271               		.stabn	224,0,0,.LBE92-.LFBB13
 3272               		.stabs	"cnt:r(0,1)",64,0,1034,18
 3273               		.stabn	192,0,0,.LBB94-.LFBB13
 3274               		.stabs	"s:r(0,21)",64,0,178,26
 3275               		.stabn	192,0,0,.LBB95-.LFBB13
 3276               		.stabn	224,0,0,.LBE95-.LFBB13
 3277               		.stabn	224,0,0,.LBE94-.LFBB13
 3278               		.stabn	224,0,0,.Lscope13-.LFBB13
 3279               	.Lscope13:
 3280               		.stabs	"",36,0,0,.Lscope13-.LFBB13
 3281               		.stabd	78,0,0
 3282               		.stabs	"dir_read:f(1,16)",36,0,894,dir_read
 3283               		.stabs	"dj:P(0,16)",64,0,892,28
 3284               		.type	dir_read, @function
 3285               	dir_read:
 3286               		.stabd	46,0,0
 3287               		.stabn	68,0,894,.LM267-.LFBB14
 3288               	.LM267:
 3289               	.LFBB14:
 3290 116a CF93      		push r28
 3291 116c DF93      		push r29
 3292               	/* prologue: function */
 3293               	/* frame size = 0 */
 3294 116e EC01      		movw r28,r24
 3295               		.stabn	68,0,894,.LM268-.LFBB14
 3296               	.LM268:
 3297 1170 94E0      		ldi r25,lo8(4)
 3298 1172 00C0      		rjmp .L166
 3299               	.L171:
 3300               		.stabn	68,0,903,.LM269-.LFBB14
 3301               	.LM269:
GAS LISTING /tmp/ccPugNTh.s 			page 88


 3302 1174 8881      		ld r24,Y
 3303 1176 9981      		ldd r25,Y+1
 3304 1178 0E94 0000 		call move_window
 3305 117c 982F      		mov r25,r24
 3306               		.stabn	68,0,904,.LM270-.LFBB14
 3307               	.LM270:
 3308 117e 8823      		tst r24
 3309 1180 01F4      		brne .L167
 3310               		.stabn	68,0,905,.LM271-.LFBB14
 3311               	.LM271:
 3312 1182 EA89      		ldd r30,Y+18
 3313 1184 FB89      		ldd r31,Y+19
 3314               		.stabn	68,0,906,.LM272-.LFBB14
 3315               	.LM272:
 3316 1186 8081      		ld r24,Z
 3317               		.stabn	68,0,907,.LM273-.LFBB14
 3318               	.LM273:
 3319 1188 8823      		tst r24
 3320 118a 01F0      		breq .L168
 3321               		.stabn	68,0,928,.LM274-.LFBB14
 3322               	.LM274:
 3323 118c 853E      		cpi r24,lo8(-27)
 3324 118e 01F0      		breq .L169
 3325 1190 8E32      		cpi r24,lo8(46)
 3326 1192 01F0      		breq .L169
 3327 1194 8385      		ldd r24,Z+11
 3328 1196 83FF      		sbrs r24,3
 3329 1198 00C0      		rjmp .L170
 3330               	.L169:
 3331               		.stabn	68,0,931,.LM275-.LFBB14
 3332               	.LM275:
 3333 119a CE01      		movw r24,r28
 3334 119c 60E0      		ldi r22,lo8(0)
 3335 119e 0E94 0000 		call dir_next
 3336 11a2 982F      		mov r25,r24
 3337               		.stabn	68,0,932,.LM276-.LFBB14
 3338               	.LM276:
 3339 11a4 8823      		tst r24
 3340 11a6 01F4      		brne .L167
 3341               	.L166:
 3342               		.stabn	68,0,902,.LM277-.LFBB14
 3343               	.LM277:
 3344 11a8 4E85      		ldd r20,Y+14
 3345 11aa 5F85      		ldd r21,Y+15
 3346 11ac 6889      		ldd r22,Y+16
 3347 11ae 7989      		ldd r23,Y+17
 3348 11b0 4115      		cp r20,__zero_reg__
 3349 11b2 5105      		cpc r21,__zero_reg__
 3350 11b4 6105      		cpc r22,__zero_reg__
 3351 11b6 7105      		cpc r23,__zero_reg__
 3352 11b8 01F4      		brne .L171
 3353               		.stabn	68,0,935,.LM278-.LFBB14
 3354               	.LM278:
 3355 11ba 9923      		tst r25
 3356 11bc 01F0      		breq .L170
 3357               	.L167:
 3358 11be 1E86      		std Y+14,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 89


 3359 11c0 1F86      		std Y+15,__zero_reg__
 3360 11c2 188A      		std Y+16,__zero_reg__
 3361 11c4 198A      		std Y+17,__zero_reg__
 3362               	.L170:
 3363               		.stabn	68,0,938,.LM279-.LFBB14
 3364               	.LM279:
 3365 11c6 892F      		mov r24,r25
 3366               	/* epilogue start */
 3367 11c8 DF91      		pop r29
 3368 11ca CF91      		pop r28
 3369 11cc 0895      		ret
 3370               	.L168:
 3371               		.stabn	68,0,935,.LM280-.LFBB14
 3372               	.LM280:
 3373 11ce 94E0      		ldi r25,lo8(4)
 3374 11d0 00C0      		rjmp .L167
 3375               		.size	dir_read, .-dir_read
 3376               		.stabs	"res:r(1,16)",64,0,895,25
 3377               		.stabs	"c:r(2,5)",64,0,896,24
 3378               		.stabs	"dir:r(1,8)",64,0,896,30
 3379               		.stabn	192,0,0,.LFBB14-.LFBB14
 3380               		.stabn	224,0,0,.Lscope14-.LFBB14
 3381               	.Lscope14:
 3382               		.stabs	"",36,0,0,.Lscope14-.LFBB14
 3383               		.stabd	78,0,0
 3384               		.stabs	"check_fs:f(2,5)",36,0,1442,check_fs
 3385               		.stabs	"fs:P(1,7)",64,0,1439,28
 3386               		.stabs	"sect:P(2,12)",64,0,1440,18
 3387               		.type	check_fs, @function
 3388               	check_fs:
 3389               		.stabd	46,0,0
 3390               		.stabn	68,0,1442,.LM281-.LFBB15
 3391               	.LM281:
 3392               	.LFBB15:
 3393 11d2 0F93      		push r16
 3394 11d4 CF93      		push r28
 3395 11d6 DF93      		push r29
 3396               	/* prologue: function */
 3397               	/* frame size = 0 */
 3398 11d8 EC01      		movw r28,r24
 3399 11da 9A01      		movw r18,r20
 3400 11dc AB01      		movw r20,r22
 3401               		.stabn	68,0,1443,.LM282-.LFBB15
 3402               	.LM282:
 3403 11de BC01      		movw r22,r24
 3404 11e0 625D      		subi r22,lo8(-(46))
 3405 11e2 7F4F      		sbci r23,hi8(-(46))
 3406 11e4 8981      		ldd r24,Y+1
 3407 11e6 01E0      		ldi r16,lo8(1)
 3408 11e8 0E94 0000 		call disk_read
 3409 11ec 8823      		tst r24
 3410 11ee 01F0      		breq .L174
 3411 11f0 63E0      		ldi r22,lo8(3)
 3412 11f2 00C0      		rjmp .L175
 3413               	.L174:
 3414               		.stabn	68,0,1445,.LM283-.LFBB15
 3415               	.LM283:
GAS LISTING /tmp/ccPugNTh.s 			page 90


 3416 11f4 C35D      		subi r28,lo8(-(557))
 3417 11f6 DD4F      		sbci r29,hi8(-(557))
 3418 11f8 9881      		ld r25,Y
 3419 11fa 80E0      		ldi r24,lo8(0)
 3420 11fc 2A91      		ld r18,-Y
 3421 11fe CC52      		subi r28,lo8(-(-556))
 3422 1200 D240      		sbci r29,hi8(-(-556))
 3423 1202 30E0      		ldi r19,lo8(0)
 3424 1204 822B      		or r24,r18
 3425 1206 932B      		or r25,r19
 3426 1208 8555      		subi r24,lo8(-21931)
 3427 120a 9A4A      		sbci r25,hi8(-21931)
 3428 120c 01F0      		breq .L176
 3429 120e 62E0      		ldi r22,lo8(2)
 3430 1210 00C0      		rjmp .L175
 3431               	.L176:
 3432               		.stabn	68,0,1448,.LM284-.LFBB15
 3433               	.LM284:
 3434 1212 C959      		subi r28,lo8(-(103))
 3435 1214 DF4F      		sbci r29,hi8(-(103))
 3436 1216 2881      		ld r18,Y
 3437 1218 30E0      		ldi r19,lo8(0)
 3438 121a 40E0      		ldi r20,lo8(0)
 3439 121c 50E0      		ldi r21,hi8(0)
 3440 121e 522F      		mov r21,r18
 3441 1220 4427      		clr r20
 3442 1222 3327      		clr r19
 3443 1224 2227      		clr r18
 3444 1226 8A91      		ld r24,-Y
 3445 1228 90E0      		ldi r25,lo8(0)
 3446 122a A0E0      		ldi r26,lo8(0)
 3447 122c B0E0      		ldi r27,hi8(0)
 3448 122e DC01      		movw r26,r24
 3449 1230 9927      		clr r25
 3450 1232 8827      		clr r24
 3451 1234 282B      		or r18,r24
 3452 1236 392B      		or r19,r25
 3453 1238 4A2B      		or r20,r26
 3454 123a 5B2B      		or r21,r27
 3455 123c 2297      		sbiw r28,2
 3456 123e 8991      		ld r24,Y+
 3457 1240 90E0      		ldi r25,lo8(0)
 3458 1242 A0E0      		ldi r26,lo8(0)
 3459 1244 B0E0      		ldi r27,hi8(0)
 3460 1246 282B      		or r18,r24
 3461 1248 392B      		or r19,r25
 3462 124a 4A2B      		or r20,r26
 3463 124c 5B2B      		or r21,r27
 3464 124e 9881      		ld r25,Y
 3465 1250 C556      		subi r28,lo8(-(-101))
 3466 1252 D040      		sbci r29,hi8(-(-101))
 3467 1254 80E0      		ldi r24,lo8(0)
 3468 1256 A0E0      		ldi r26,lo8(0)
 3469 1258 B0E0      		ldi r27,hi8(0)
 3470 125a 282B      		or r18,r24
 3471 125c 392B      		or r19,r25
 3472 125e 4A2B      		or r20,r26
GAS LISTING /tmp/ccPugNTh.s 			page 91


 3473 1260 5B2B      		or r21,r27
 3474 1262 5070      		andi r21,hhi8(16777215)
 3475 1264 2654      		subi r18,lo8(5521734)
 3476 1266 3144      		sbci r19,hi8(5521734)
 3477 1268 4445      		sbci r20,hlo8(5521734)
 3478 126a 5040      		sbci r21,hhi8(5521734)
 3479 126c 01F4      		brne .L177
 3480 126e 60E0      		ldi r22,lo8(0)
 3481 1270 00C0      		rjmp .L175
 3482               	.L177:
 3483 1272 60E0      		ldi r22,lo8(0)
 3484 1274 CD57      		subi r28,lo8(-(131))
 3485 1276 DF4F      		sbci r29,hi8(-(131))
 3486 1278 2881      		ld r18,Y
 3487 127a 30E0      		ldi r19,lo8(0)
 3488 127c 40E0      		ldi r20,lo8(0)
 3489 127e 50E0      		ldi r21,hi8(0)
 3490 1280 522F      		mov r21,r18
 3491 1282 4427      		clr r20
 3492 1284 3327      		clr r19
 3493 1286 2227      		clr r18
 3494 1288 8A91      		ld r24,-Y
 3495 128a 90E0      		ldi r25,lo8(0)
 3496 128c A0E0      		ldi r26,lo8(0)
 3497 128e B0E0      		ldi r27,hi8(0)
 3498 1290 DC01      		movw r26,r24
 3499 1292 9927      		clr r25
 3500 1294 8827      		clr r24
 3501 1296 282B      		or r18,r24
 3502 1298 392B      		or r19,r25
 3503 129a 4A2B      		or r20,r26
 3504 129c 5B2B      		or r21,r27
 3505 129e 2297      		sbiw r28,2
 3506 12a0 8991      		ld r24,Y+
 3507 12a2 90E0      		ldi r25,lo8(0)
 3508 12a4 A0E0      		ldi r26,lo8(0)
 3509 12a6 B0E0      		ldi r27,hi8(0)
 3510 12a8 282B      		or r18,r24
 3511 12aa 392B      		or r19,r25
 3512 12ac 4A2B      		or r20,r26
 3513 12ae 5B2B      		or r21,r27
 3514 12b0 9881      		ld r25,Y
 3515 12b2 80E0      		ldi r24,lo8(0)
 3516 12b4 A0E0      		ldi r26,lo8(0)
 3517 12b6 B0E0      		ldi r27,hi8(0)
 3518 12b8 282B      		or r18,r24
 3519 12ba 392B      		or r19,r25
 3520 12bc 4A2B      		or r20,r26
 3521 12be 5B2B      		or r21,r27
 3522 12c0 5070      		andi r21,hhi8(16777215)
 3523 12c2 2654      		subi r18,lo8(5521734)
 3524 12c4 3144      		sbci r19,hi8(5521734)
 3525 12c6 4445      		sbci r20,hlo8(5521734)
 3526 12c8 5040      		sbci r21,hhi8(5521734)
 3527 12ca 01F0      		breq .L175
 3528 12cc 61E0      		ldi r22,lo8(1)
 3529               	.L175:
GAS LISTING /tmp/ccPugNTh.s 			page 92


 3530               		.stabn	68,0,1454,.LM285-.LFBB15
 3531               	.LM285:
 3532 12ce 862F      		mov r24,r22
 3533               	/* epilogue start */
 3534 12d0 DF91      		pop r29
 3535 12d2 CF91      		pop r28
 3536 12d4 0F91      		pop r16
 3537 12d6 0895      		ret
 3538               		.size	check_fs, .-check_fs
 3539               	.Lscope15:
 3540               		.stabs	"",36,0,0,.Lscope15-.LFBB15
 3541               		.stabd	78,0,0
 3542               		.stabs	"sync:f(1,16)",36,0,288,sync
 3543               		.stabs	"fs:P(1,7)",64,0,286,28
 3544               		.type	sync, @function
 3545               	sync:
 3546               		.stabd	46,0,0
 3547               		.stabn	68,0,288,.LM286-.LFBB16
 3548               	.LM286:
 3549               	.LFBB16:
 3550 12d8 0F93      		push r16
 3551 12da CF93      		push r28
 3552 12dc DF93      		push r29
 3553               	/* prologue: function */
 3554               	/* frame size = 0 */
 3555 12de EC01      		movw r28,r24
 3556               		.stabn	68,0,292,.LM287-.LFBB16
 3557               	.LM287:
 3558 12e0 40E0      		ldi r20,lo8(0)
 3559 12e2 50E0      		ldi r21,hi8(0)
 3560 12e4 60E0      		ldi r22,hlo8(0)
 3561 12e6 70E0      		ldi r23,hhi8(0)
 3562 12e8 0E94 0000 		call move_window
 3563               		.stabn	68,0,293,.LM288-.LFBB16
 3564               	.LM288:
 3565 12ec 8823      		tst r24
 3566 12ee 01F0      		breq .+2
 3567 12f0 00C0      		rjmp .L181
 3568               		.stabn	68,0,295,.LM289-.LFBB16
 3569               	.LM289:
 3570 12f2 8881      		ld r24,Y
 3571 12f4 8330      		cpi r24,lo8(3)
 3572 12f6 01F0      		breq .+2
 3573 12f8 00C0      		rjmp .L182
 3574 12fa 8D81      		ldd r24,Y+5
 3575 12fc 8823      		tst r24
 3576 12fe 01F4      		brne .+2
 3577 1300 00C0      		rjmp .L182
 3578               		.stabn	68,0,296,.LM290-.LFBB16
 3579               	.LM290:
 3580 1302 1AA6      		std Y+42,__zero_reg__
 3581 1304 1BA6      		std Y+43,__zero_reg__
 3582 1306 1CA6      		std Y+44,__zero_reg__
 3583 1308 1DA6      		std Y+45,__zero_reg__
 3584               	.LBB96:
 3585               	.LBB97:
 3586               		.stabn	68,0,185,.LM291-.LFBB16
GAS LISTING /tmp/ccPugNTh.s 			page 93


 3587               	.LM291:
 3588 130a BE01      		movw r22,r28
 3589 130c 625D      		subi r22,lo8(-(46))
 3590 130e 7F4F      		sbci r23,hi8(-(46))
 3591 1310 FB01      		movw r30,r22
 3592 1312 80E0      		ldi r24,lo8(512)
 3593 1314 92E0      		ldi r25,hi8(512)
 3594 1316 00C0      		rjmp .L183
 3595               	.L184:
 3596               		.stabn	68,0,186,.LM292-.LFBB16
 3597               	.LM292:
 3598 1318 1192      		st Z+,__zero_reg__
 3599               	.L183:
 3600 131a 0197      		sbiw r24,1
 3601 131c 2FEF      		ldi r18,hi8(-1)
 3602 131e 8F3F      		cpi r24,lo8(-1)
 3603 1320 9207      		cpc r25,r18
 3604 1322 01F4      		brne .L184
 3605               	.LBE97:
 3606               	.LBE96:
 3607               		.stabn	68,0,298,.LM293-.LFBB16
 3608               	.LM293:
 3609 1324 C45D      		subi r28,lo8(-(556))
 3610 1326 DD4F      		sbci r29,hi8(-(556))
 3611 1328 85E5      		ldi r24,lo8(85)
 3612 132a 8993      		st Y+,r24
 3613 132c 8AEA      		ldi r24,lo8(-86)
 3614 132e 8883      		st Y,r24
 3615 1330 CD52      		subi r28,lo8(-(-557))
 3616 1332 D240      		sbci r29,hi8(-(-557))
 3617               		.stabn	68,0,299,.LM294-.LFBB16
 3618               	.LM294:
 3619 1334 82E5      		ldi r24,lo8(82)
 3620 1336 8EA7      		std Y+46,r24
 3621 1338 8FA7      		std Y+47,r24
 3622 133a 21E6      		ldi r18,lo8(97)
 3623 133c 28AB      		std Y+48,r18
 3624 133e 91E4      		ldi r25,lo8(65)
 3625 1340 99AB      		std Y+49,r25
 3626               		.stabn	68,0,300,.LM295-.LFBB16
 3627               	.LM295:
 3628 1342 CE5E      		subi r28,lo8(-(530))
 3629 1344 DD4F      		sbci r29,hi8(-(530))
 3630 1346 82E7      		ldi r24,lo8(114)
 3631 1348 8993      		st Y+,r24
 3632 134a 8993      		st Y+,r24
 3633 134c 9993      		st Y+,r25
 3634 134e 2883      		st Y,r18
 3635 1350 C551      		subi r28,lo8(-(-533))
 3636 1352 D240      		sbci r29,hi8(-(-533))
 3637               		.stabn	68,0,301,.LM296-.LFBB16
 3638               	.LM296:
 3639 1354 8E85      		ldd r24,Y+14
 3640 1356 CA5E      		subi r28,lo8(-(534))
 3641 1358 DD4F      		sbci r29,hi8(-(534))
 3642 135a 8883      		st Y,r24
 3643 135c C651      		subi r28,lo8(-(-534))
GAS LISTING /tmp/ccPugNTh.s 			page 94


 3644 135e D240      		sbci r29,hi8(-(-534))
 3645 1360 8F85      		ldd r24,Y+15
 3646 1362 C95E      		subi r28,lo8(-(535))
 3647 1364 DD4F      		sbci r29,hi8(-(535))
 3648 1366 8883      		st Y,r24
 3649 1368 C751      		subi r28,lo8(-(-535))
 3650 136a D240      		sbci r29,hi8(-(-535))
 3651 136c 8E85      		ldd r24,Y+14
 3652 136e 9F85      		ldd r25,Y+15
 3653 1370 A889      		ldd r26,Y+16
 3654 1372 B989      		ldd r27,Y+17
 3655 1374 9D01      		movw r18,r26
 3656 1376 4427      		clr r20
 3657 1378 5527      		clr r21
 3658 137a C85E      		subi r28,lo8(-(536))
 3659 137c DD4F      		sbci r29,hi8(-(536))
 3660 137e 2883      		st Y,r18
 3661 1380 2196      		adiw r28,1
 3662 1382 8B2F      		mov r24,r27
 3663 1384 9927      		clr r25
 3664 1386 AA27      		clr r26
 3665 1388 BB27      		clr r27
 3666 138a 8883      		st Y,r24
 3667 138c C951      		subi r28,lo8(-(-537))
 3668 138e D240      		sbci r29,hi8(-(-537))
 3669               		.stabn	68,0,302,.LM297-.LFBB16
 3670               	.LM297:
 3671 1390 8A85      		ldd r24,Y+10
 3672 1392 C65E      		subi r28,lo8(-(538))
 3673 1394 DD4F      		sbci r29,hi8(-(538))
 3674 1396 8883      		st Y,r24
 3675 1398 CA51      		subi r28,lo8(-(-538))
 3676 139a D240      		sbci r29,hi8(-(-538))
 3677 139c 8B85      		ldd r24,Y+11
 3678 139e C55E      		subi r28,lo8(-(539))
 3679 13a0 DD4F      		sbci r29,hi8(-(539))
 3680 13a2 8883      		st Y,r24
 3681 13a4 CB51      		subi r28,lo8(-(-539))
 3682 13a6 D240      		sbci r29,hi8(-(-539))
 3683 13a8 8A85      		ldd r24,Y+10
 3684 13aa 9B85      		ldd r25,Y+11
 3685 13ac AC85      		ldd r26,Y+12
 3686 13ae BD85      		ldd r27,Y+13
 3687 13b0 9D01      		movw r18,r26
 3688 13b2 4427      		clr r20
 3689 13b4 5527      		clr r21
 3690 13b6 C45E      		subi r28,lo8(-(540))
 3691 13b8 DD4F      		sbci r29,hi8(-(540))
 3692 13ba 2883      		st Y,r18
 3693 13bc 2196      		adiw r28,1
 3694 13be 8B2F      		mov r24,r27
 3695 13c0 9927      		clr r25
 3696 13c2 AA27      		clr r26
 3697 13c4 BB27      		clr r27
 3698 13c6 8883      		st Y,r24
 3699 13c8 CD51      		subi r28,lo8(-(-541))
 3700 13ca D240      		sbci r29,hi8(-(-541))
GAS LISTING /tmp/ccPugNTh.s 			page 95


 3701               		.stabn	68,0,303,.LM298-.LFBB16
 3702               	.LM298:
 3703 13cc 2A89      		ldd r18,Y+18
 3704 13ce 3B89      		ldd r19,Y+19
 3705 13d0 4C89      		ldd r20,Y+20
 3706 13d2 5D89      		ldd r21,Y+21
 3707 13d4 8981      		ldd r24,Y+1
 3708 13d6 01E0      		ldi r16,lo8(1)
 3709 13d8 0E94 0000 		call disk_write
 3710               		.stabn	68,0,304,.LM299-.LFBB16
 3711               	.LM299:
 3712 13dc 1D82      		std Y+5,__zero_reg__
 3713               	.L182:
 3714               		.stabn	68,0,307,.LM300-.LFBB16
 3715               	.LM300:
 3716 13de 8981      		ldd r24,Y+1
 3717 13e0 60E0      		ldi r22,lo8(0)
 3718 13e2 40E0      		ldi r20,lo8(0)
 3719 13e4 50E0      		ldi r21,hi8(0)
 3720 13e6 0E94 0000 		call disk_ioctl
 3721 13ea 8111      		cpse r24,__zero_reg__
 3722 13ec 81E0      		ldi r24,lo8(1)
 3723               	.L181:
 3724               	/* epilogue start */
 3725               		.stabn	68,0,312,.LM301-.LFBB16
 3726               	.LM301:
 3727 13ee DF91      		pop r29
 3728 13f0 CF91      		pop r28
 3729 13f2 0F91      		pop r16
 3730 13f4 0895      		ret
 3731               		.size	sync, .-sync
 3732               		.stabs	"res:r(1,16)",64,0,289,24
 3733               		.stabn	192,0,0,.LFBB16-.LFBB16
 3734               		.stabs	"cnt:r(0,1)",64,0,297,24
 3735               		.stabn	192,0,0,.LBB96-.LFBB16
 3736               		.stabs	"d:r(0,18)",64,0,185,22
 3737               		.stabn	192,0,0,.LBB97-.LFBB16
 3738               		.stabn	224,0,0,.LBE97-.LFBB16
 3739               		.stabn	224,0,0,.LBE96-.LFBB16
 3740               		.stabn	224,0,0,.Lscope16-.LFBB16
 3741               	.Lscope16:
 3742               		.stabs	"",36,0,0,.Lscope16-.LFBB16
 3743               		.stabd	78,0,0
 3744               		.stabs	"validate:f(1,16)",36,0,1601,validate
 3745               		.stabs	"fs:P(1,7)",64,0,1598,30
 3746               		.stabs	"id:P(2,8)",64,0,1599,22
 3747               		.type	validate, @function
 3748               	validate:
 3749               		.stabd	46,0,0
 3750               		.stabn	68,0,1601,.LM302-.LFBB17
 3751               	.LM302:
 3752               	.LFBB17:
 3753               	/* prologue: function */
 3754               	/* frame size = 0 */
 3755 13f6 FC01      		movw r30,r24
 3756               		.stabn	68,0,1602,.LM303-.LFBB17
 3757               	.LM303:
GAS LISTING /tmp/ccPugNTh.s 			page 96


 3758 13f8 0097      		sbiw r24,0
 3759 13fa 01F0      		breq .L188
 3760 13fc 8081      		ld r24,Z
 3761 13fe 8823      		tst r24
 3762 1400 01F0      		breq .L188
 3763 1402 8681      		ldd r24,Z+6
 3764 1404 9781      		ldd r25,Z+7
 3765 1406 8617      		cp r24,r22
 3766 1408 9707      		cpc r25,r23
 3767 140a 01F4      		brne .L188
 3768               		.stabn	68,0,1607,.LM304-.LFBB17
 3769               	.LM304:
 3770 140c 8181      		ldd r24,Z+1
 3771 140e 0E94 0000 		call disk_status
 3772 1412 80FD      		sbrc r24,0
 3773 1414 00C0      		rjmp .L189
 3774 1416 80E0      		ldi r24,lo8(0)
 3775 1418 0895      		ret
 3776               	.L189:
 3777 141a 83E0      		ldi r24,lo8(3)
 3778 141c 0895      		ret
 3779               	.L188:
 3780 141e 89E0      		ldi r24,lo8(9)
 3781               		.stabn	68,0,1611,.LM305-.LFBB17
 3782               	.LM305:
 3783 1420 0895      		ret
 3784               		.size	validate, .-validate
 3785               	.Lscope17:
 3786               		.stabs	"",36,0,0,.Lscope17-.LFBB17
 3787               		.stabd	78,0,0
 3788               		.stabs	"f_truncate:F(1,16)",36,0,2386,f_truncate
 3789               		.stabs	"fp:P(0,23)=*(1,11)",64,0,2384,28
 3790               	.global	f_truncate
 3791               		.type	f_truncate, @function
 3792               	f_truncate:
 3793               		.stabd	46,0,0
1657:ff.c          **** 
1658:ff.c          **** 
1659:ff.c          **** 
1660:ff.c          **** 
1661:ff.c          **** /*-----------------------------------------------------------------------*/
1662:ff.c          **** /* Open or Create a File                                                 */
1663:ff.c          **** /*-----------------------------------------------------------------------*/
1664:ff.c          **** 
1665:ff.c          **** FRESULT f_open (
1666:ff.c          **** 	FIL *fp,			/* Pointer to the blank file object */
1667:ff.c          **** 	const XCHAR *path,	/* Pointer to the file name */
1668:ff.c          **** 	BYTE mode			/* Access mode and file open mode flags */
1669:ff.c          **** )
1670:ff.c          **** {
1671:ff.c          **** 	FRESULT res;
1672:ff.c          **** 	DIR dj;
1673:ff.c          **** 	NAMEBUF(sfn, lfn);
1674:ff.c          **** 	BYTE *dir;
1675:ff.c          **** 
1676:ff.c          **** 
1677:ff.c          **** 	fp->fs = NULL;		/* Clear file object */
GAS LISTING /tmp/ccPugNTh.s 			page 97


1678:ff.c          **** #if !_FS_READONLY
1679:ff.c          **** 	mode &= (FA_READ | FA_WRITE | FA_CREATE_ALWAYS | FA_OPEN_ALWAYS | FA_CREATE_NEW);
1680:ff.c          **** 	res = chk_mounted(&path, &dj.fs, (BYTE)(mode & (FA_WRITE | FA_CREATE_ALWAYS | FA_OPEN_ALWAYS | FA_
1681:ff.c          **** #else
1682:ff.c          **** 	mode &= FA_READ;
1683:ff.c          **** 	res = chk_mounted(&path, &dj.fs, 0);
1684:ff.c          **** #endif
1685:ff.c          **** 	if (res != FR_OK) LEAVE_FF(dj.fs, res);
1686:ff.c          **** 	INITBUF(dj, sfn, lfn);
1687:ff.c          **** 	res = follow_path(&dj, path);	/* Follow the file path */
1688:ff.c          **** 
1689:ff.c          **** #if !_FS_READONLY
1690:ff.c          **** 	/* Create or Open a file */
1691:ff.c          **** 	if (mode & (FA_CREATE_ALWAYS | FA_OPEN_ALWAYS | FA_CREATE_NEW)) {
1692:ff.c          **** 		DWORD ps, cl;
1693:ff.c          **** 
1694:ff.c          **** 		if (res != FR_OK) {			/* No file, create new */
1695:ff.c          **** 			if (res == FR_NO_FILE)	/* There is no file to open, create a new entry */
1696:ff.c          **** 				res = dir_register(&dj);
1697:ff.c          **** 			if (res != FR_OK) LEAVE_FF(dj.fs, res);
1698:ff.c          **** 			mode |= FA_CREATE_ALWAYS;
1699:ff.c          **** 			dir = dj.dir;			/* Created entry (SFN entry) */
1700:ff.c          **** 		}
1701:ff.c          **** 		else {						/* Any object is already existing */
1702:ff.c          **** 			if (mode & FA_CREATE_NEW)			/* Cannot create new */
1703:ff.c          **** 				LEAVE_FF(dj.fs, FR_EXIST);
1704:ff.c          **** 			dir = dj.dir;
1705:ff.c          **** 			if (!dir || (dir[DIR_Attr] & (AM_RDO | AM_DIR)))	/* Cannot overwrite it (R/O or DIR) */
1706:ff.c          **** 				LEAVE_FF(dj.fs, FR_DENIED);
1707:ff.c          **** 			if (mode & FA_CREATE_ALWAYS) {		/* Resize it to zero on over write mode */
1708:ff.c          **** 				cl = ((DWORD)LD_WORD(dir+DIR_FstClusHI) << 16) | LD_WORD(dir+DIR_FstClusLO);	/* Get start clust
1709:ff.c          **** 				ST_WORD(dir+DIR_FstClusHI, 0);	/* cluster = 0 */
1710:ff.c          **** 				ST_WORD(dir+DIR_FstClusLO, 0);
1711:ff.c          **** 				ST_DWORD(dir+DIR_FileSize, 0);	/* size = 0 */
1712:ff.c          **** 				dj.fs->wflag = 1;
1713:ff.c          **** 				ps = dj.fs->winsect;			/* Remove the cluster chain */
1714:ff.c          **** 				if (cl) {
1715:ff.c          **** 					res = remove_chain(dj.fs, cl);
1716:ff.c          **** 					if (res) LEAVE_FF(dj.fs, res);
1717:ff.c          **** 					dj.fs->last_clust = cl - 1;	/* Reuse the cluster hole */
1718:ff.c          **** 				}
1719:ff.c          **** 				res = move_window(dj.fs, ps);
1720:ff.c          **** 				if (res != FR_OK) LEAVE_FF(dj.fs, res);
1721:ff.c          **** 			}
1722:ff.c          **** 		}
1723:ff.c          **** 		if (mode & FA_CREATE_ALWAYS) {
1724:ff.c          **** 			dir[DIR_Attr] = 0;					/* Reset attribute */
1725:ff.c          **** 			ps = get_fattime();
1726:ff.c          **** 			ST_DWORD(dir+DIR_CrtTime, ps);		/* Created time */
1727:ff.c          **** 			dj.fs->wflag = 1;
1728:ff.c          **** 			mode |= FA__WRITTEN;				/* Set file changed flag */
1729:ff.c          **** 		}
1730:ff.c          **** 	}
1731:ff.c          **** 	/* Open an existing file */
1732:ff.c          **** 	else {
1733:ff.c          **** #endif /* !_FS_READONLY */
1734:ff.c          **** 		if (res != FR_OK) LEAVE_FF(dj.fs, res);	/* Follow failed */
GAS LISTING /tmp/ccPugNTh.s 			page 98


1735:ff.c          **** 		dir = dj.dir;
1736:ff.c          **** 		if (!dir || (dir[DIR_Attr] & AM_DIR))	/* It is a directory */
1737:ff.c          **** 			LEAVE_FF(dj.fs, FR_NO_FILE);
1738:ff.c          **** #if !_FS_READONLY
1739:ff.c          **** 		if ((mode & FA_WRITE) && (dir[DIR_Attr] & AM_RDO)) /* R/O violation */
1740:ff.c          **** 			LEAVE_FF(dj.fs, FR_DENIED);
1741:ff.c          **** 	}
1742:ff.c          **** 	fp->dir_sect = dj.fs->winsect;		/* Pointer to the directory entry */
1743:ff.c          **** 	fp->dir_ptr = dj.dir;
1744:ff.c          **** #endif
1745:ff.c          **** 	fp->flag = mode;					/* File access mode */
1746:ff.c          **** 	fp->org_clust =						/* File start cluster */
1747:ff.c          **** 		((DWORD)LD_WORD(dir+DIR_FstClusHI) << 16) | LD_WORD(dir+DIR_FstClusLO);
1748:ff.c          **** 	fp->fsize = LD_DWORD(dir+DIR_FileSize);	/* File size */
1749:ff.c          **** 	fp->fptr = 0; fp->csect = 255;		/* File pointer */
1750:ff.c          **** 	fp->dsect = 0;
1751:ff.c          **** 	fp->fs = dj.fs; fp->id = dj.fs->id;	/* Owner file system object of the file */
1752:ff.c          **** 
1753:ff.c          **** 	LEAVE_FF(dj.fs, FR_OK);
1754:ff.c          **** }
1755:ff.c          **** 
1756:ff.c          **** 
1757:ff.c          **** 
1758:ff.c          **** 
1759:ff.c          **** /*-----------------------------------------------------------------------*/
1760:ff.c          **** /* Read File                                                             */
1761:ff.c          **** /*-----------------------------------------------------------------------*/
1762:ff.c          **** 
1763:ff.c          **** FRESULT f_read (
1764:ff.c          **** 	FIL *fp, 		/* Pointer to the file object */
1765:ff.c          **** 	void *buff,		/* Pointer to data buffer */
1766:ff.c          **** 	UINT btr,		/* Number of bytes to read */
1767:ff.c          **** 	UINT *br		/* Pointer to number of bytes read */
1768:ff.c          **** )
1769:ff.c          **** {
1770:ff.c          **** 	FRESULT res;
1771:ff.c          **** 	DWORD clst, sect, remain;
1772:ff.c          **** 	UINT rcnt, cc;
1773:ff.c          **** 	BYTE *rbuff = buff;
1774:ff.c          **** 
1775:ff.c          **** 
1776:ff.c          **** 	*br = 0;	/* Initialize bytes read */
1777:ff.c          **** 
1778:ff.c          **** 	res = validate(fp->fs, fp->id);					/* Check validity of the object */
1779:ff.c          **** 	if (res != FR_OK) LEAVE_FF(fp->fs, res);
1780:ff.c          **** 	if (fp->flag & FA__ERROR)						/* Check abort flag */
1781:ff.c          **** 		LEAVE_FF(fp->fs, FR_INT_ERR);
1782:ff.c          **** 	if (!(fp->flag & FA_READ)) 						/* Check access mode */
1783:ff.c          **** 		LEAVE_FF(fp->fs, FR_DENIED);
1784:ff.c          **** 	remain = fp->fsize - fp->fptr;
1785:ff.c          **** 	if (btr > remain) btr = (UINT)remain;			/* Truncate btr by remaining bytes */
1786:ff.c          **** 
1787:ff.c          **** 	for ( ;  btr;									/* Repeat until all data transferred */
1788:ff.c          **** 		rbuff += rcnt, fp->fptr += rcnt, *br += rcnt, btr -= rcnt) {
1789:ff.c          **** 		if ((fp->fptr % SS(fp->fs)) == 0) {			/* On the sector boundary? */
1790:ff.c          **** 			if (fp->csect >= fp->fs->csize) {		/* On the cluster boundary? */
1791:ff.c          **** 				clst = (fp->fptr == 0) ?			/* On the top of the file? */
GAS LISTING /tmp/ccPugNTh.s 			page 99


1792:ff.c          **** 					fp->org_clust : get_fat(fp->fs, fp->curr_clust);
1793:ff.c          **** 				if (clst <= 1) ABORT(fp->fs, FR_INT_ERR);
1794:ff.c          **** 				if (clst == 0xFFFFFFFF) ABORT(fp->fs, FR_DISK_ERR);
1795:ff.c          **** 				fp->curr_clust = clst;				/* Update current cluster */
1796:ff.c          **** 				fp->csect = 0;						/* Reset sector offset in the cluster */
1797:ff.c          **** 			}
1798:ff.c          **** 			sect = clust2sect(fp->fs, fp->curr_clust);	/* Get current sector */
1799:ff.c          **** 			if (!sect) ABORT(fp->fs, FR_INT_ERR);
1800:ff.c          **** 			sect += fp->csect;
1801:ff.c          **** 			cc = btr / SS(fp->fs);					/* When remaining bytes >= sector size, */
1802:ff.c          **** 			if (cc) {								/* Read maximum contiguous sectors directly */
1803:ff.c          **** 				if (fp->csect + cc > fp->fs->csize)	/* Clip at cluster boundary */
1804:ff.c          **** 					cc = fp->fs->csize - fp->csect;
1805:ff.c          **** 				if (disk_read(fp->fs->drive, rbuff, sect, (BYTE)cc) != RES_OK)
1806:ff.c          **** 					ABORT(fp->fs, FR_DISK_ERR);
1807:ff.c          **** #if !_FS_READONLY && _FS_MINIMIZE <= 2
1808:ff.c          **** #if _FS_TINY
1809:ff.c          **** 				if (fp->fs->wflag && fp->fs->winsect - sect < cc)		/* Replace one of the read sectors with cach
1810:ff.c          **** 					mem_cpy(rbuff + ((fp->fs->winsect - sect) * SS(fp->fs)), fp->fs->win, SS(fp->fs));
1811:ff.c          **** #else
1812:ff.c          **** 				if ((fp->flag & FA__DIRTY) && fp->dsect - sect < cc)	/* Replace one of the read sectors with ca
1813:ff.c          **** 					mem_cpy(rbuff + ((fp->dsect - sect) * SS(fp->fs)), fp->buf, SS(fp->fs));
1814:ff.c          **** #endif
1815:ff.c          **** #endif
1816:ff.c          **** 				fp->csect += (BYTE)cc;				/* Next sector address in the cluster */
1817:ff.c          **** 				rcnt = SS(fp->fs) * cc;				/* Number of bytes transferred */
1818:ff.c          **** 				continue;
1819:ff.c          **** 			}
1820:ff.c          **** #if !_FS_TINY
1821:ff.c          **** #if !_FS_READONLY
1822:ff.c          **** 			if (fp->flag & FA__DIRTY) {			/* Write sector I/O buffer if needed */
1823:ff.c          **** 				if (disk_write(fp->fs->drive, fp->buf, fp->dsect, 1) != RES_OK)
1824:ff.c          **** 					ABORT(fp->fs, FR_DISK_ERR);
1825:ff.c          **** 				fp->flag &= ~FA__DIRTY;
1826:ff.c          **** 			}
1827:ff.c          **** #endif
1828:ff.c          **** 			if (fp->dsect != sect) {			/* Fill sector buffer with file data */
1829:ff.c          **** 				if (disk_read(fp->fs->drive, fp->buf, sect, 1) != RES_OK)
1830:ff.c          **** 					ABORT(fp->fs, FR_DISK_ERR);
1831:ff.c          **** 			}
1832:ff.c          **** #endif
1833:ff.c          **** 			fp->dsect = sect;
1834:ff.c          **** 			fp->csect++;							/* Next sector address in the cluster */
1835:ff.c          **** 		}
1836:ff.c          **** 		rcnt = SS(fp->fs) - (fp->fptr % SS(fp->fs));	/* Get partial sector data from sector buffer */
1837:ff.c          **** 		if (rcnt > btr) rcnt = btr;
1838:ff.c          **** #if _FS_TINY
1839:ff.c          **** 		if (move_window(fp->fs, fp->dsect))			/* Move sector window */
1840:ff.c          **** 			ABORT(fp->fs, FR_DISK_ERR);
1841:ff.c          **** 		mem_cpy(rbuff, &fp->fs->win[fp->fptr % SS(fp->fs)], rcnt);	/* Pick partial sector */
1842:ff.c          **** #else
1843:ff.c          **** 		mem_cpy(rbuff, &fp->buf[fp->fptr % SS(fp->fs)], rcnt);	/* Pick partial sector */
1844:ff.c          **** #endif
1845:ff.c          **** 	}
1846:ff.c          **** 
1847:ff.c          **** 	LEAVE_FF(fp->fs, FR_OK);
1848:ff.c          **** }
GAS LISTING /tmp/ccPugNTh.s 			page 100


1849:ff.c          **** 
1850:ff.c          **** 
1851:ff.c          **** 
1852:ff.c          **** 
1853:ff.c          **** #if !_FS_READONLY
1854:ff.c          **** /*-----------------------------------------------------------------------*/
1855:ff.c          **** /* Write File                                                            */
1856:ff.c          **** /*-----------------------------------------------------------------------*/
1857:ff.c          **** 
1858:ff.c          **** FRESULT f_write (
1859:ff.c          **** 	FIL *fp,			/* Pointer to the file object */
1860:ff.c          **** 	const void *buff,	/* Pointer to the data to be written */
1861:ff.c          **** 	UINT btw,			/* Number of bytes to write */
1862:ff.c          **** 	UINT *bw			/* Pointer to number of bytes written */
1863:ff.c          **** )
1864:ff.c          **** {
1865:ff.c          **** 	FRESULT res;
1866:ff.c          **** 	DWORD clst, sect;
1867:ff.c          **** 	UINT wcnt, cc;
1868:ff.c          **** 	const BYTE *wbuff = buff;
1869:ff.c          **** 
1870:ff.c          **** 
1871:ff.c          **** 	*bw = 0;	/* Initialize bytes written */
1872:ff.c          **** 
1873:ff.c          **** 	res = validate(fp->fs, fp->id);					/* Check validity of the object */
1874:ff.c          **** 	if (res != FR_OK) LEAVE_FF(fp->fs, res);
1875:ff.c          **** 	if (fp->flag & FA__ERROR)						/* Check abort flag */
1876:ff.c          **** 		LEAVE_FF(fp->fs, FR_INT_ERR);
1877:ff.c          **** 	if (!(fp->flag & FA_WRITE))						/* Check access mode */
1878:ff.c          **** 		LEAVE_FF(fp->fs, FR_DENIED);
1879:ff.c          **** 	if (fp->fsize + btw < fp->fsize) btw = 0;		/* File size cannot reach 4GB */
1880:ff.c          **** 
1881:ff.c          **** 	for ( ;  btw;									/* Repeat until all data transferred */
1882:ff.c          **** 		wbuff += wcnt, fp->fptr += wcnt, *bw += wcnt, btw -= wcnt) {
1883:ff.c          **** 		if ((fp->fptr % SS(fp->fs)) == 0) {			/* On the sector boundary? */
1884:ff.c          **** 			if (fp->csect >= fp->fs->csize) {		/* On the cluster boundary? */
1885:ff.c          **** 				if (fp->fptr == 0) {				/* On the top of the file? */
1886:ff.c          **** 					clst = fp->org_clust;			/* Follow from the origin */
1887:ff.c          **** 					if (clst == 0)					/* When there is no cluster chain, */
1888:ff.c          **** 						fp->org_clust = clst = create_chain(fp->fs, 0);	/* Create a new cluster chain */
1889:ff.c          **** 				} else {							/* Middle or end of the file */
1890:ff.c          **** 					clst = create_chain(fp->fs, fp->curr_clust);			/* Follow or streach cluster chain */
1891:ff.c          **** 				}
1892:ff.c          **** 				if (clst == 0) break;				/* Could not allocate a new cluster (disk full) */
1893:ff.c          **** 				if (clst == 1) ABORT(fp->fs, FR_INT_ERR);
1894:ff.c          **** 				if (clst == 0xFFFFFFFF) ABORT(fp->fs, FR_DISK_ERR);
1895:ff.c          **** 				fp->curr_clust = clst;				/* Update current cluster */
1896:ff.c          **** 				fp->csect = 0;						/* Reset sector address in the cluster */
1897:ff.c          **** 			}
1898:ff.c          **** #if _FS_TINY
1899:ff.c          **** 			if (fp->fs->winsect == fp->dsect && move_window(fp->fs, 0))	/* Write back data buffer prior to f
1900:ff.c          **** 				ABORT(fp->fs, FR_DISK_ERR);
1901:ff.c          **** #else
1902:ff.c          **** 			if (fp->flag & FA__DIRTY) {		/* Write back data buffer prior to following direct transfer */
1903:ff.c          **** 				if (disk_write(fp->fs->drive, fp->buf, fp->dsect, 1) != RES_OK)
1904:ff.c          **** 					ABORT(fp->fs, FR_DISK_ERR);
1905:ff.c          **** 				fp->flag &= ~FA__DIRTY;
GAS LISTING /tmp/ccPugNTh.s 			page 101


1906:ff.c          **** 			}
1907:ff.c          **** #endif
1908:ff.c          **** 			sect = clust2sect(fp->fs, fp->curr_clust);	/* Get current sector */
1909:ff.c          **** 			if (!sect) ABORT(fp->fs, FR_INT_ERR);
1910:ff.c          **** 			sect += fp->csect;
1911:ff.c          **** 			cc = btw / SS(fp->fs);					/* When remaining bytes >= sector size, */
1912:ff.c          **** 			if (cc) {								/* Write maximum contiguous sectors directly */
1913:ff.c          **** 				if (fp->csect + cc > fp->fs->csize)	/* Clip at cluster boundary */
1914:ff.c          **** 					cc = fp->fs->csize - fp->csect;
1915:ff.c          **** 				if (disk_write(fp->fs->drive, wbuff, sect, (BYTE)cc) != RES_OK)
1916:ff.c          **** 					ABORT(fp->fs, FR_DISK_ERR);
1917:ff.c          **** #if _FS_TINY
1918:ff.c          **** 				if (fp->fs->winsect - sect < cc) {	/* Refill sector cache if it gets dirty by the direct write 
1919:ff.c          **** 					mem_cpy(fp->fs->win, wbuff + ((fp->fs->winsect - sect) * SS(fp->fs)), SS(fp->fs));
1920:ff.c          **** 					fp->fs->wflag = 0;
1921:ff.c          **** 				}
1922:ff.c          **** #else
1923:ff.c          **** 				if (fp->dsect - sect < cc) {		/* Refill sector cache if it gets dirty by the direct write */
1924:ff.c          **** 					mem_cpy(fp->buf, wbuff + ((fp->dsect - sect) * SS(fp->fs)), SS(fp->fs));
1925:ff.c          **** 					fp->flag &= ~FA__DIRTY;
1926:ff.c          **** 				}
1927:ff.c          **** #endif
1928:ff.c          **** 				fp->csect += (BYTE)cc;				/* Next sector address in the cluster */
1929:ff.c          **** 				wcnt = SS(fp->fs) * cc;				/* Number of bytes transferred */
1930:ff.c          **** 				continue;
1931:ff.c          **** 			}
1932:ff.c          **** #if _FS_TINY
1933:ff.c          **** 			if (fp->fptr >= fp->fsize) {			/* Avoid silly buffer filling at growing edge */
1934:ff.c          **** 				if (move_window(fp->fs, 0)) ABORT(fp->fs, FR_DISK_ERR);
1935:ff.c          **** 				fp->fs->winsect = sect;
1936:ff.c          **** 			}
1937:ff.c          **** #else
1938:ff.c          **** 			if (fp->dsect != sect) {				/* Fill sector buffer with file data */
1939:ff.c          **** 				if (fp->fptr < fp->fsize &&
1940:ff.c          **** 					disk_read(fp->fs->drive, fp->buf, sect, 1) != RES_OK)
1941:ff.c          **** 						ABORT(fp->fs, FR_DISK_ERR);
1942:ff.c          **** 			}
1943:ff.c          **** #endif
1944:ff.c          **** 			fp->dsect = sect;
1945:ff.c          **** 			fp->csect++;							/* Next sector address in the cluster */
1946:ff.c          **** 		}
1947:ff.c          **** 		wcnt = SS(fp->fs) - (fp->fptr % SS(fp->fs));	/* Put partial sector into file I/O buffer */
1948:ff.c          **** 		if (wcnt > btw) wcnt = btw;
1949:ff.c          **** #if _FS_TINY
1950:ff.c          **** 		if (move_window(fp->fs, fp->dsect))			/* Move sector window */
1951:ff.c          **** 			ABORT(fp->fs, FR_DISK_ERR);
1952:ff.c          **** 		mem_cpy(&fp->fs->win[fp->fptr % SS(fp->fs)], wbuff, wcnt);	/* Fit partial sector */
1953:ff.c          **** 		fp->fs->wflag = 1;
1954:ff.c          **** #else
1955:ff.c          **** 		mem_cpy(&fp->buf[fp->fptr % SS(fp->fs)], wbuff, wcnt);	/* Fit partial sector */
1956:ff.c          **** 		fp->flag |= FA__DIRTY;
1957:ff.c          **** #endif
1958:ff.c          **** 	}
1959:ff.c          **** 
1960:ff.c          **** 	if (fp->fptr > fp->fsize) fp->fsize = fp->fptr;	/* Update file size if needed */
1961:ff.c          **** 	fp->flag |= FA__WRITTEN;						/* Set file changed flag */
1962:ff.c          **** 
GAS LISTING /tmp/ccPugNTh.s 			page 102


1963:ff.c          **** 	LEAVE_FF(fp->fs, FR_OK);
1964:ff.c          **** }
1965:ff.c          **** 
1966:ff.c          **** 
1967:ff.c          **** 
1968:ff.c          **** 
1969:ff.c          **** /*-----------------------------------------------------------------------*/
1970:ff.c          **** /* Synchronize the File Object                                           */
1971:ff.c          **** /*-----------------------------------------------------------------------*/
1972:ff.c          **** 
1973:ff.c          **** FRESULT f_sync (
1974:ff.c          **** 	FIL *fp		/* Pointer to the file object */
1975:ff.c          **** )
1976:ff.c          **** {
1977:ff.c          **** 	FRESULT res;
1978:ff.c          **** 	DWORD tim;
1979:ff.c          **** 	BYTE *dir;
1980:ff.c          **** 
1981:ff.c          **** 
1982:ff.c          **** 	res = validate(fp->fs, fp->id);		/* Check validity of the object */
1983:ff.c          **** 	if (res == FR_OK) {
1984:ff.c          **** 		if (fp->flag & FA__WRITTEN) {	/* Has the file been written? */
1985:ff.c          **** #if !_FS_TINY	/* Write-back dirty buffer */
1986:ff.c          **** 			if (fp->flag & FA__DIRTY) {
1987:ff.c          **** 				if (disk_write(fp->fs->drive, fp->buf, fp->dsect, 1) != RES_OK)
1988:ff.c          **** 					LEAVE_FF(fp->fs, FR_DISK_ERR);
1989:ff.c          **** 				fp->flag &= ~FA__DIRTY;
1990:ff.c          **** 			}
1991:ff.c          **** #endif
1992:ff.c          **** 			/* Update the directory entry */
1993:ff.c          **** 			res = move_window(fp->fs, fp->dir_sect);
1994:ff.c          **** 			if (res == FR_OK) {
1995:ff.c          **** 				dir = fp->dir_ptr;
1996:ff.c          **** 				dir[DIR_Attr] |= AM_ARC;					/* Set archive bit */
1997:ff.c          **** 				ST_DWORD(dir+DIR_FileSize, fp->fsize);		/* Update file size */
1998:ff.c          **** 				ST_WORD(dir+DIR_FstClusLO, fp->org_clust);	/* Update start cluster */
1999:ff.c          **** 				ST_WORD(dir+DIR_FstClusHI, fp->org_clust >> 16);
2000:ff.c          **** 				tim = get_fattime();			/* Updated time */
2001:ff.c          **** 				ST_DWORD(dir+DIR_WrtTime, tim);
2002:ff.c          **** 				fp->flag &= ~FA__WRITTEN;
2003:ff.c          **** 				fp->fs->wflag = 1;
2004:ff.c          **** 				res = sync(fp->fs);
2005:ff.c          **** 			}
2006:ff.c          **** 		}
2007:ff.c          **** 	}
2008:ff.c          **** 
2009:ff.c          **** 	LEAVE_FF(fp->fs, res);
2010:ff.c          **** }
2011:ff.c          **** 
2012:ff.c          **** #endif /* !_FS_READONLY */
2013:ff.c          **** 
2014:ff.c          **** 
2015:ff.c          **** 
2016:ff.c          **** 
2017:ff.c          **** /*-----------------------------------------------------------------------*/
2018:ff.c          **** /* Close File                                                            */
2019:ff.c          **** /*-----------------------------------------------------------------------*/
GAS LISTING /tmp/ccPugNTh.s 			page 103


2020:ff.c          **** 
2021:ff.c          **** FRESULT f_close (
2022:ff.c          **** 	FIL *fp		/* Pointer to the file object to be closed */
2023:ff.c          **** )
2024:ff.c          **** {
2025:ff.c          **** 	FRESULT res;
2026:ff.c          **** 
2027:ff.c          **** 
2028:ff.c          **** #if _FS_READONLY
2029:ff.c          **** 	res = validate(fp->fs, fp->id);
2030:ff.c          **** 	if (res == FR_OK) fp->fs = NULL;
2031:ff.c          **** 	LEAVE_FF(fp->fs, res);
2032:ff.c          **** #else
2033:ff.c          **** 	res = f_sync(fp);
2034:ff.c          **** 	if (res == FR_OK) fp->fs = NULL;
2035:ff.c          **** 	return res;
2036:ff.c          **** #endif
2037:ff.c          **** }
2038:ff.c          **** 
2039:ff.c          **** 
2040:ff.c          **** 
2041:ff.c          **** 
2042:ff.c          **** /*-----------------------------------------------------------------------*/
2043:ff.c          **** /* Change Current Drive/Directory                                        */
2044:ff.c          **** /*-----------------------------------------------------------------------*/
2045:ff.c          **** 
2046:ff.c          **** #if _FS_RPATH
2047:ff.c          **** 
2048:ff.c          **** FRESULT f_chdrive (
2049:ff.c          **** 	BYTE drv		/* Drive number */
2050:ff.c          **** )
2051:ff.c          **** {
2052:ff.c          **** 	if (drv >= _DRIVES) return FR_INVALID_DRIVE;
2053:ff.c          **** 
2054:ff.c          **** 	Drive = drv;
2055:ff.c          **** 
2056:ff.c          **** 	return FR_OK;
2057:ff.c          **** }
2058:ff.c          **** 
2059:ff.c          **** 
2060:ff.c          **** 
2061:ff.c          **** 
2062:ff.c          **** FRESULT f_chdir (
2063:ff.c          **** 	const XCHAR *path	/* Pointer to the directory path */
2064:ff.c          **** )
2065:ff.c          **** {
2066:ff.c          **** 	FRESULT res;
2067:ff.c          **** 	DIR dj;
2068:ff.c          **** 	NAMEBUF(sfn, lfn);
2069:ff.c          **** 	BYTE *dir;
2070:ff.c          **** 
2071:ff.c          **** 
2072:ff.c          **** 	res = chk_mounted(&path, &dj.fs, 0);
2073:ff.c          **** 	if (res == FR_OK) {
2074:ff.c          **** 		INITBUF(dj, sfn, lfn);
2075:ff.c          **** 		res = follow_path(&dj, path);		/* Follow the file path */
2076:ff.c          **** 		if (res == FR_OK) {					/* Follow completed */
GAS LISTING /tmp/ccPugNTh.s 			page 104


2077:ff.c          **** 			dir = dj.dir;					/* Pointer to the entry */
2078:ff.c          **** 			if (!dir) {
2079:ff.c          **** 				dj.fs->cdir = 0;			/* No entry (root dir) */
2080:ff.c          **** 			} else {
2081:ff.c          **** 				if (dir[DIR_Attr] & AM_DIR)	/* Reached to the dir */
2082:ff.c          **** 					dj.fs->cdir = ((DWORD)LD_WORD(dir+DIR_FstClusHI) << 16) | LD_WORD(dir+DIR_FstClusLO);
2083:ff.c          **** 				else
2084:ff.c          **** 					res = FR_NO_PATH;		/* Could not reach the dir (it is a file) */
2085:ff.c          **** 			}
2086:ff.c          **** 		}
2087:ff.c          **** 		if (res == FR_NO_FILE) res = FR_NO_PATH;
2088:ff.c          **** 	}
2089:ff.c          **** 
2090:ff.c          **** 	LEAVE_FF(dj.fs, res);
2091:ff.c          **** }
2092:ff.c          **** 
2093:ff.c          **** #endif
2094:ff.c          **** 
2095:ff.c          **** 
2096:ff.c          **** 
2097:ff.c          **** #if _FS_MINIMIZE <= 2
2098:ff.c          **** /*-----------------------------------------------------------------------*/
2099:ff.c          **** /* Seek File R/W Pointer                                                 */
2100:ff.c          **** /*-----------------------------------------------------------------------*/
2101:ff.c          **** 
2102:ff.c          **** FRESULT f_lseek (
2103:ff.c          **** 	FIL *fp,		/* Pointer to the file object */
2104:ff.c          **** 	DWORD ofs		/* File pointer from top of file */
2105:ff.c          **** )
2106:ff.c          **** {
2107:ff.c          **** 	FRESULT res;
2108:ff.c          **** 	DWORD clst, bcs, nsect, ifptr;
2109:ff.c          **** 
2110:ff.c          **** 
2111:ff.c          **** 	res = validate(fp->fs, fp->id);		/* Check validity of the object */
2112:ff.c          **** 	if (res != FR_OK) LEAVE_FF(fp->fs, res);
2113:ff.c          **** 	if (fp->flag & FA__ERROR)			/* Check abort flag */
2114:ff.c          **** 		LEAVE_FF(fp->fs, FR_INT_ERR);
2115:ff.c          **** 	if (ofs > fp->fsize					/* In read-only mode, clip offset with the file size */
2116:ff.c          **** #if !_FS_READONLY
2117:ff.c          **** 		 && !(fp->flag & FA_WRITE)
2118:ff.c          **** #endif
2119:ff.c          **** 		) ofs = fp->fsize;
2120:ff.c          **** 
2121:ff.c          **** 	ifptr = fp->fptr;
2122:ff.c          **** 	fp->fptr = nsect = 0; fp->csect = 255;
2123:ff.c          **** 	if (ofs > 0) {
2124:ff.c          **** 		bcs = (DWORD)fp->fs->csize * SS(fp->fs);	/* Cluster size (byte) */
2125:ff.c          **** 		if (ifptr > 0 &&
2126:ff.c          **** 			(ofs - 1) / bcs >= (ifptr - 1) / bcs) {	/* When seek to same or following cluster, */
2127:ff.c          **** 			fp->fptr = (ifptr - 1) & ~(bcs - 1);	/* start from the current cluster */
2128:ff.c          **** 			ofs -= fp->fptr;
2129:ff.c          **** 			clst = fp->curr_clust;
2130:ff.c          **** 		} else {									/* When seek to back cluster, */
2131:ff.c          **** 			clst = fp->org_clust;					/* start from the first cluster */
2132:ff.c          **** #if !_FS_READONLY
2133:ff.c          **** 			if (clst == 0) {						/* If no cluster chain, create a new chain */
GAS LISTING /tmp/ccPugNTh.s 			page 105


2134:ff.c          **** 				clst = create_chain(fp->fs, 0);
2135:ff.c          **** 				if (clst == 1) ABORT(fp->fs, FR_INT_ERR);
2136:ff.c          **** 				if (clst == 0xFFFFFFFF) ABORT(fp->fs, FR_DISK_ERR);
2137:ff.c          **** 				fp->org_clust = clst;
2138:ff.c          **** 			}
2139:ff.c          **** #endif
2140:ff.c          **** 			fp->curr_clust = clst;
2141:ff.c          **** 		}
2142:ff.c          **** 		if (clst != 0) {
2143:ff.c          **** 			while (ofs > bcs) {						/* Cluster following loop */
2144:ff.c          **** #if !_FS_READONLY
2145:ff.c          **** 				if (fp->flag & FA_WRITE) {			/* Check if in write mode or not */
2146:ff.c          **** 					clst = create_chain(fp->fs, clst);	/* Force streached if in write mode */
2147:ff.c          **** 					if (clst == 0) {				/* When disk gets full, clip file size */
2148:ff.c          **** 						ofs = bcs; break;
2149:ff.c          **** 					}
2150:ff.c          **** 				} else
2151:ff.c          **** #endif
2152:ff.c          **** 					clst = get_fat(fp->fs, clst);	/* Follow cluster chain if not in write mode */
2153:ff.c          **** 				if (clst == 0xFFFFFFFF) ABORT(fp->fs, FR_DISK_ERR);
2154:ff.c          **** 				if (clst <= 1 || clst >= fp->fs->max_clust) ABORT(fp->fs, FR_INT_ERR);
2155:ff.c          **** 				fp->curr_clust = clst;
2156:ff.c          **** 				fp->fptr += bcs;
2157:ff.c          **** 				ofs -= bcs;
2158:ff.c          **** 			}
2159:ff.c          **** 			fp->fptr += ofs;
2160:ff.c          **** 			fp->csect = (BYTE)(ofs / SS(fp->fs));	/* Sector offset in the cluster */
2161:ff.c          **** 			if (ofs % SS(fp->fs)) {
2162:ff.c          **** 				nsect = clust2sect(fp->fs, clst);	/* Current sector */
2163:ff.c          **** 				if (!nsect) ABORT(fp->fs, FR_INT_ERR);
2164:ff.c          **** 				nsect += fp->csect;
2165:ff.c          **** 				fp->csect++;
2166:ff.c          **** 			}
2167:ff.c          **** 		}
2168:ff.c          **** 	}
2169:ff.c          **** 	if (fp->fptr % SS(fp->fs) && nsect != fp->dsect) {
2170:ff.c          **** #if !_FS_TINY
2171:ff.c          **** #if !_FS_READONLY
2172:ff.c          **** 		if (fp->flag & FA__DIRTY) {			/* Write-back dirty buffer if needed */
2173:ff.c          **** 			if (disk_write(fp->fs->drive, fp->buf, fp->dsect, 1) != RES_OK)
2174:ff.c          **** 				ABORT(fp->fs, FR_DISK_ERR);
2175:ff.c          **** 			fp->flag &= ~FA__DIRTY;
2176:ff.c          **** 		}
2177:ff.c          **** #endif
2178:ff.c          **** 		if (disk_read(fp->fs->drive, fp->buf, nsect, 1) != RES_OK)
2179:ff.c          **** 			ABORT(fp->fs, FR_DISK_ERR);
2180:ff.c          **** #endif
2181:ff.c          **** 		fp->dsect = nsect;
2182:ff.c          **** 	}
2183:ff.c          **** #if !_FS_READONLY
2184:ff.c          **** 	if (fp->fptr > fp->fsize) {			/* Set changed flag if the file size is extended */
2185:ff.c          **** 		fp->fsize = fp->fptr;
2186:ff.c          **** 		fp->flag |= FA__WRITTEN;
2187:ff.c          **** 	}
2188:ff.c          **** #endif
2189:ff.c          **** 
2190:ff.c          **** 	LEAVE_FF(fp->fs, res);
GAS LISTING /tmp/ccPugNTh.s 			page 106


2191:ff.c          **** }
2192:ff.c          **** 
2193:ff.c          **** 
2194:ff.c          **** 
2195:ff.c          **** 
2196:ff.c          **** #if _FS_MINIMIZE <= 1
2197:ff.c          **** /*-----------------------------------------------------------------------*/
2198:ff.c          **** /* Create a Directroy Object                                             */
2199:ff.c          **** /*-----------------------------------------------------------------------*/
2200:ff.c          **** 
2201:ff.c          **** FRESULT f_opendir (
2202:ff.c          **** 	DIR *dj,			/* Pointer to directory object to create */
2203:ff.c          **** 	const XCHAR *path	/* Pointer to the directory path */
2204:ff.c          **** )
2205:ff.c          **** {
2206:ff.c          **** 	FRESULT res;
2207:ff.c          **** 	NAMEBUF(sfn, lfn);
2208:ff.c          **** 	BYTE *dir;
2209:ff.c          **** 
2210:ff.c          **** 
2211:ff.c          **** 	res = chk_mounted(&path, &dj->fs, 0);
2212:ff.c          **** 	if (res == FR_OK) {
2213:ff.c          **** 		INITBUF((*dj), sfn, lfn);
2214:ff.c          **** 		res = follow_path(dj, path);			/* Follow the path to the directory */
2215:ff.c          **** 		if (res == FR_OK) {						/* Follow completed */
2216:ff.c          **** 			dir = dj->dir;
2217:ff.c          **** 			if (dir) {							/* It is not the root dir */
2218:ff.c          **** 				if (dir[DIR_Attr] & AM_DIR) {	/* The object is a directory */
2219:ff.c          **** 					dj->sclust = ((DWORD)LD_WORD(dir+DIR_FstClusHI) << 16) | LD_WORD(dir+DIR_FstClusLO);
2220:ff.c          **** 				} else {						/* The object is not a directory */
2221:ff.c          **** 					res = FR_NO_PATH;
2222:ff.c          **** 				}
2223:ff.c          **** 			}
2224:ff.c          **** 			if (res == FR_OK) {
2225:ff.c          **** 				dj->id = dj->fs->id;
2226:ff.c          **** 				res = dir_seek(dj, 0);			/* Rewind dir */
2227:ff.c          **** 			}
2228:ff.c          **** 		}
2229:ff.c          **** 		if (res == FR_NO_FILE) res = FR_NO_PATH;
2230:ff.c          **** 	}
2231:ff.c          **** 
2232:ff.c          **** 	LEAVE_FF(dj->fs, res);
2233:ff.c          **** }
2234:ff.c          **** 
2235:ff.c          **** 
2236:ff.c          **** 
2237:ff.c          **** 
2238:ff.c          **** /*-----------------------------------------------------------------------*/
2239:ff.c          **** /* Read Directory Entry in Sequense                                      */
2240:ff.c          **** /*-----------------------------------------------------------------------*/
2241:ff.c          **** 
2242:ff.c          **** FRESULT f_readdir (
2243:ff.c          **** 	DIR *dj,			/* Pointer to the open directory object */
2244:ff.c          **** 	FILINFO *fno		/* Pointer to file information to return */
2245:ff.c          **** )
2246:ff.c          **** {
2247:ff.c          **** 	FRESULT res;
GAS LISTING /tmp/ccPugNTh.s 			page 107


2248:ff.c          **** 	NAMEBUF(sfn, lfn);
2249:ff.c          **** 
2250:ff.c          **** 
2251:ff.c          **** 	res = validate(dj->fs, dj->id);			/* Check validity of the object */
2252:ff.c          **** 	if (res == FR_OK) {
2253:ff.c          **** 		INITBUF((*dj), sfn, lfn);
2254:ff.c          **** 		if (!fno) {
2255:ff.c          **** 			res = dir_seek(dj, 0);
2256:ff.c          **** 		} else {
2257:ff.c          **** 			res = dir_read(dj);
2258:ff.c          **** 			if (res == FR_NO_FILE) {
2259:ff.c          **** 				dj->sect = 0;
2260:ff.c          **** 				res = FR_OK;
2261:ff.c          **** 			}
2262:ff.c          **** 			if (res == FR_OK) {				/* A valid entry is found */
2263:ff.c          **** 				get_fileinfo(dj, fno);		/* Get the object information */
2264:ff.c          **** 				res = dir_next(dj, FALSE);	/* Increment index for next */
2265:ff.c          **** 				if (res == FR_NO_FILE) {
2266:ff.c          **** 					dj->sect = 0;
2267:ff.c          **** 					res = FR_OK;
2268:ff.c          **** 				}
2269:ff.c          **** 			}
2270:ff.c          **** 		}
2271:ff.c          **** 	}
2272:ff.c          **** 
2273:ff.c          **** 	LEAVE_FF(dj->fs, res);
2274:ff.c          **** }
2275:ff.c          **** 
2276:ff.c          **** 
2277:ff.c          **** 
2278:ff.c          **** #if _FS_MINIMIZE == 0
2279:ff.c          **** /*-----------------------------------------------------------------------*/
2280:ff.c          **** /* Get File Status                                                       */
2281:ff.c          **** /*-----------------------------------------------------------------------*/
2282:ff.c          **** 
2283:ff.c          **** FRESULT f_stat (
2284:ff.c          **** 	const XCHAR *path,	/* Pointer to the file path */
2285:ff.c          **** 	FILINFO *fno		/* Pointer to file information to return */
2286:ff.c          **** )
2287:ff.c          **** {
2288:ff.c          **** 	FRESULT res;
2289:ff.c          **** 	DIR dj;
2290:ff.c          **** 	NAMEBUF(sfn, lfn);
2291:ff.c          **** 
2292:ff.c          **** 
2293:ff.c          **** 	res = chk_mounted(&path, &dj.fs, 0);
2294:ff.c          **** 	if (res == FR_OK) {
2295:ff.c          **** 		INITBUF(dj, sfn, lfn);
2296:ff.c          **** 		res = follow_path(&dj, path);	/* Follow the file path */
2297:ff.c          **** 		if (res == FR_OK) {				/* Follwo completed */
2298:ff.c          **** 			if (dj.dir)	/* Found an object */
2299:ff.c          **** 				get_fileinfo(&dj, fno);
2300:ff.c          **** 			else		/* It is root dir */
2301:ff.c          **** 				res = FR_INVALID_NAME;
2302:ff.c          **** 		}
2303:ff.c          **** 	}
2304:ff.c          **** 
GAS LISTING /tmp/ccPugNTh.s 			page 108


2305:ff.c          **** 	LEAVE_FF(dj.fs, res);
2306:ff.c          **** }
2307:ff.c          **** 
2308:ff.c          **** 
2309:ff.c          **** 
2310:ff.c          **** #if !_FS_READONLY
2311:ff.c          **** /*-----------------------------------------------------------------------*/
2312:ff.c          **** /* Get Number of Free Clusters                                           */
2313:ff.c          **** /*-----------------------------------------------------------------------*/
2314:ff.c          **** 
2315:ff.c          **** FRESULT f_getfree (
2316:ff.c          **** 	const XCHAR *path,	/* Pointer to the logical drive number (root dir) */
2317:ff.c          **** 	DWORD *nclst,		/* Pointer to the variable to return number of free clusters */
2318:ff.c          **** 	FATFS **fatfs		/* Pointer to pointer to corresponding file system object to return */
2319:ff.c          **** )
2320:ff.c          **** {
2321:ff.c          **** 	FRESULT res;
2322:ff.c          **** 	DWORD n, clst, sect, stat;
2323:ff.c          **** 	UINT i;
2324:ff.c          **** 	BYTE fat, *p;
2325:ff.c          **** 
2326:ff.c          **** 
2327:ff.c          **** 	/* Get drive number */
2328:ff.c          **** 	res = chk_mounted(&path, fatfs, 0);
2329:ff.c          **** 	if (res != FR_OK) LEAVE_FF(*fatfs, res);
2330:ff.c          **** 
2331:ff.c          **** 	/* If number of free cluster is valid, return it without cluster scan. */
2332:ff.c          **** 	if ((*fatfs)->free_clust <= (*fatfs)->max_clust - 2) {
2333:ff.c          **** 		*nclst = (*fatfs)->free_clust;
2334:ff.c          **** 		LEAVE_FF(*fatfs, FR_OK);
2335:ff.c          **** 	}
2336:ff.c          **** 
2337:ff.c          **** 	/* Get number of free clusters */
2338:ff.c          **** 	fat = (*fatfs)->fs_type;
2339:ff.c          **** 	n = 0;
2340:ff.c          **** 	if (fat == FS_FAT12) {
2341:ff.c          **** 		clst = 2;
2342:ff.c          **** 		do {
2343:ff.c          **** 			stat = get_fat(*fatfs, clst);
2344:ff.c          **** 			if (stat == 0xFFFFFFFF) LEAVE_FF(*fatfs, FR_DISK_ERR);
2345:ff.c          **** 			if (stat == 1) LEAVE_FF(*fatfs, FR_INT_ERR);
2346:ff.c          **** 			if (stat == 0) n++;
2347:ff.c          **** 		} while (++clst < (*fatfs)->max_clust);
2348:ff.c          **** 	} else {
2349:ff.c          **** 		clst = (*fatfs)->max_clust;
2350:ff.c          **** 		sect = (*fatfs)->fatbase;
2351:ff.c          **** 		i = 0; p = 0;
2352:ff.c          **** 		do {
2353:ff.c          **** 			if (!i) {
2354:ff.c          **** 				res = move_window(*fatfs, sect++);
2355:ff.c          **** 				if (res != FR_OK)
2356:ff.c          **** 					LEAVE_FF(*fatfs, res);
2357:ff.c          **** 				p = (*fatfs)->win;
2358:ff.c          **** 				i = SS(*fatfs);
2359:ff.c          **** 			}
2360:ff.c          **** 			if (fat == FS_FAT16) {
2361:ff.c          **** 				if (LD_WORD(p) == 0) n++;
GAS LISTING /tmp/ccPugNTh.s 			page 109


2362:ff.c          **** 				p += 2; i -= 2;
2363:ff.c          **** 			} else {
2364:ff.c          **** 				if ((LD_DWORD(p) & 0x0FFFFFFF) == 0) n++;
2365:ff.c          **** 				p += 4; i -= 4;
2366:ff.c          **** 			}
2367:ff.c          **** 		} while (--clst);
2368:ff.c          **** 	}
2369:ff.c          **** 	(*fatfs)->free_clust = n;
2370:ff.c          **** 	if (fat == FS_FAT32) (*fatfs)->fsi_flag = 1;
2371:ff.c          **** 	*nclst = n;
2372:ff.c          **** 
2373:ff.c          **** 	LEAVE_FF(*fatfs, FR_OK);
2374:ff.c          **** }
2375:ff.c          **** 
2376:ff.c          **** 
2377:ff.c          **** 
2378:ff.c          **** 
2379:ff.c          **** /*-----------------------------------------------------------------------*/
2380:ff.c          **** /* Truncate File                                                         */
2381:ff.c          **** /*-----------------------------------------------------------------------*/
2382:ff.c          **** 
2383:ff.c          **** FRESULT f_truncate (
2384:ff.c          **** 	FIL *fp		/* Pointer to the file object */
2385:ff.c          **** )
2386:ff.c          **** {
 3794               		.stabn	68,0,2386,.LM306-.LFBB18
 3795               	.LM306:
 3796               	.LFBB18:
 3797 1422 CF92      		push r12
 3798 1424 DF92      		push r13
 3799 1426 EF92      		push r14
 3800 1428 FF92      		push r15
 3801 142a 0F93      		push r16
 3802 142c 1F93      		push r17
 3803 142e CF93      		push r28
 3804 1430 DF93      		push r29
 3805               	/* prologue: function */
 3806               	/* frame size = 0 */
 3807 1432 EC01      		movw r28,r24
2387:ff.c          **** 	FRESULT res;
2388:ff.c          **** 	DWORD ncl;
2389:ff.c          **** 
2390:ff.c          **** 
2391:ff.c          **** 	res = validate(fp->fs, fp->id);		/* Check validity of the object */
 3808               		.stabn	68,0,2391,.LM307-.LFBB18
 3809               	.LM307:
 3810 1434 6A81      		ldd r22,Y+2
 3811 1436 7B81      		ldd r23,Y+3
 3812 1438 8881      		ld r24,Y
 3813 143a 9981      		ldd r25,Y+1
 3814 143c 0E94 0000 		call validate
 3815 1440 182F      		mov r17,r24
2392:ff.c          **** 	if (res != FR_OK) LEAVE_FF(fp->fs, res);
 3816               		.stabn	68,0,2392,.LM308-.LFBB18
 3817               	.LM308:
 3818 1442 8823      		tst r24
 3819 1444 01F0      		breq .+2
GAS LISTING /tmp/ccPugNTh.s 			page 110


 3820 1446 00C0      		rjmp .L193
2393:ff.c          **** 	if (fp->flag & FA__ERROR)			/* Check abort flag */
 3821               		.stabn	68,0,2393,.LM309-.LFBB18
 3822               	.LM309:
 3823 1448 6C81      		ldd r22,Y+4
 3824 144a 67FF      		sbrs r22,7
 3825 144c 00C0      		rjmp .L194
 3826 144e 12E0      		ldi r17,lo8(2)
 3827 1450 00C0      		rjmp .L193
 3828               	.L194:
2394:ff.c          **** 		LEAVE_FF(fp->fs, FR_INT_ERR);
2395:ff.c          **** 	if (!(fp->flag & FA_WRITE))			/* Check access mode */
 3829               		.stabn	68,0,2395,.LM310-.LFBB18
 3830               	.LM310:
 3831 1452 61FD      		sbrc r22,1
 3832 1454 00C0      		rjmp .L195
 3833 1456 17E0      		ldi r17,lo8(7)
 3834 1458 00C0      		rjmp .L193
 3835               	.L195:
2396:ff.c          **** 		LEAVE_FF(fp->fs, FR_DENIED);
2397:ff.c          **** 
2398:ff.c          **** 	if (fp->fsize > fp->fptr) {
 3836               		.stabn	68,0,2398,.LM311-.LFBB18
 3837               	.LM311:
 3838 145a 2E81      		ldd r18,Y+6
 3839 145c 3F81      		ldd r19,Y+7
 3840 145e 4885      		ldd r20,Y+8
 3841 1460 5985      		ldd r21,Y+9
 3842 1462 8A85      		ldd r24,Y+10
 3843 1464 9B85      		ldd r25,Y+11
 3844 1466 AC85      		ldd r26,Y+12
 3845 1468 BD85      		ldd r27,Y+13
 3846 146a 2817      		cp r18,r24
 3847 146c 3907      		cpc r19,r25
 3848 146e 4A07      		cpc r20,r26
 3849 1470 5B07      		cpc r21,r27
 3850 1472 00F0      		brlo .+2
 3851 1474 00C0      		rjmp .L193
2399:ff.c          **** 		fp->fsize = fp->fptr;	/* Set file size to current R/W point */
 3852               		.stabn	68,0,2399,.LM312-.LFBB18
 3853               	.LM312:
 3854 1476 2A87      		std Y+10,r18
 3855 1478 3B87      		std Y+11,r19
 3856 147a 4C87      		std Y+12,r20
 3857 147c 5D87      		std Y+13,r21
2400:ff.c          **** 		fp->flag |= FA__WRITTEN;
 3858               		.stabn	68,0,2400,.LM313-.LFBB18
 3859               	.LM313:
 3860 147e 6062      		ori r22,lo8(32)
 3861 1480 6C83      		std Y+4,r22
 3862 1482 8881      		ld r24,Y
 3863 1484 9981      		ldd r25,Y+1
2401:ff.c          **** 		if (fp->fptr == 0) {	/* When set file size to zero, remove entire cluster chain */
 3864               		.stabn	68,0,2401,.LM314-.LFBB18
 3865               	.LM314:
 3866 1486 2115      		cp r18,__zero_reg__
 3867 1488 3105      		cpc r19,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 111


 3868 148a 4105      		cpc r20,__zero_reg__
 3869 148c 5105      		cpc r21,__zero_reg__
 3870 148e 01F4      		brne .L196
2402:ff.c          **** 			res = remove_chain(fp->fs, fp->org_clust);
 3871               		.stabn	68,0,2402,.LM315-.LFBB18
 3872               	.LM315:
 3873 1490 4E85      		ldd r20,Y+14
 3874 1492 5F85      		ldd r21,Y+15
 3875 1494 6889      		ldd r22,Y+16
 3876 1496 7989      		ldd r23,Y+17
 3877 1498 0E94 0000 		call remove_chain
 3878 149c 182F      		mov r17,r24
2403:ff.c          **** 			fp->org_clust = 0;
 3879               		.stabn	68,0,2403,.LM316-.LFBB18
 3880               	.LM316:
 3881 149e 1E86      		std Y+14,__zero_reg__
 3882 14a0 1F86      		std Y+15,__zero_reg__
 3883 14a2 188A      		std Y+16,__zero_reg__
 3884 14a4 198A      		std Y+17,__zero_reg__
 3885 14a6 00C0      		rjmp .L197
 3886               	.L196:
2404:ff.c          **** 		} else {				/* When truncate a part of the file, remove remaining clusters */
2405:ff.c          **** 			ncl = get_fat(fp->fs, fp->curr_clust);
 3887               		.stabn	68,0,2405,.LM317-.LFBB18
 3888               	.LM317:
 3889 14a8 4A89      		ldd r20,Y+18
 3890 14aa 5B89      		ldd r21,Y+19
 3891 14ac 6C89      		ldd r22,Y+20
 3892 14ae 7D89      		ldd r23,Y+21
 3893 14b0 0E94 0000 		call get_fat
 3894 14b4 6B01      		movw r12,r22
 3895 14b6 7C01      		movw r14,r24
2406:ff.c          **** 			res = FR_OK;
2407:ff.c          **** 			if (ncl == 0xFFFFFFFF) res = FR_DISK_ERR;
 3896               		.stabn	68,0,2407,.LM318-.LFBB18
 3897               	.LM318:
 3898 14b8 8FEF      		ldi r24,lo8(-1)
 3899 14ba C816      		cp r12,r24
 3900 14bc 8FEF      		ldi r24,hi8(-1)
 3901 14be D806      		cpc r13,r24
 3902 14c0 8FEF      		ldi r24,hlo8(-1)
 3903 14c2 E806      		cpc r14,r24
 3904 14c4 8FEF      		ldi r24,hhi8(-1)
 3905 14c6 F806      		cpc r15,r24
 3906 14c8 01F0      		breq .L198
2408:ff.c          **** 			if (ncl == 1) res = FR_INT_ERR;
 3907               		.stabn	68,0,2408,.LM319-.LFBB18
 3908               	.LM319:
 3909 14ca 81E0      		ldi r24,lo8(1)
 3910 14cc C816      		cp r12,r24
 3911 14ce D104      		cpc r13,__zero_reg__
 3912 14d0 E104      		cpc r14,__zero_reg__
 3913 14d2 F104      		cpc r15,__zero_reg__
 3914 14d4 01F4      		brne .L199
 3915 14d6 12E0      		ldi r17,lo8(2)
 3916 14d8 00C0      		rjmp .L200
 3917               	.L199:
GAS LISTING /tmp/ccPugNTh.s 			page 112


2409:ff.c          **** 			if (res == FR_OK && ncl < fp->fs->max_clust) {
 3918               		.stabn	68,0,2409,.LM320-.LFBB18
 3919               	.LM320:
 3920 14da E881      		ld r30,Y
 3921 14dc F981      		ldd r31,Y+1
 3922 14de 828D      		ldd r24,Z+26
 3923 14e0 938D      		ldd r25,Z+27
 3924 14e2 A48D      		ldd r26,Z+28
 3925 14e4 B58D      		ldd r27,Z+29
 3926 14e6 C816      		cp r12,r24
 3927 14e8 D906      		cpc r13,r25
 3928 14ea EA06      		cpc r14,r26
 3929 14ec FB06      		cpc r15,r27
 3930 14ee 00F4      		brsh .L193
2410:ff.c          **** 				res = put_fat(fp->fs, fp->curr_clust, 0x0FFFFFFF);
 3931               		.stabn	68,0,2410,.LM321-.LFBB18
 3932               	.LM321:
 3933 14f0 4A89      		ldd r20,Y+18
 3934 14f2 5B89      		ldd r21,Y+19
 3935 14f4 6C89      		ldd r22,Y+20
 3936 14f6 7D89      		ldd r23,Y+21
 3937 14f8 CF01      		movw r24,r30
 3938 14fa 0FEF      		ldi r16,lo8(268435455)
 3939 14fc 1FEF      		ldi r17,hi8(268435455)
 3940 14fe 2FEF      		ldi r18,hlo8(268435455)
 3941 1500 3FE0      		ldi r19,hhi8(268435455)
 3942 1502 0E94 0000 		call put_fat
 3943 1506 182F      		mov r17,r24
2411:ff.c          **** 				if (res == FR_OK) res = remove_chain(fp->fs, ncl);
 3944               		.stabn	68,0,2411,.LM322-.LFBB18
 3945               	.LM322:
 3946 1508 8823      		tst r24
 3947 150a 01F4      		brne .L200
 3948 150c 8881      		ld r24,Y
 3949 150e 9981      		ldd r25,Y+1
 3950 1510 B701      		movw r22,r14
 3951 1512 A601      		movw r20,r12
 3952 1514 0E94 0000 		call remove_chain
 3953 1518 182F      		mov r17,r24
 3954               	.L197:
2412:ff.c          **** 			}
2413:ff.c          **** 		}
2414:ff.c          **** 	}
2415:ff.c          **** 	if (res != FR_OK) fp->flag |= FA__ERROR;
 3955               		.stabn	68,0,2415,.LM323-.LFBB18
 3956               	.LM323:
 3957 151a 1123      		tst r17
 3958 151c 01F0      		breq .L193
 3959               	.L200:
 3960 151e 8C81      		ldd r24,Y+4
 3961 1520 8068      		ori r24,lo8(-128)
 3962 1522 8C83      		std Y+4,r24
 3963               	.L193:
2416:ff.c          **** 
2417:ff.c          **** 	LEAVE_FF(fp->fs, res);
2418:ff.c          **** }
 3964               		.stabn	68,0,2418,.LM324-.LFBB18
GAS LISTING /tmp/ccPugNTh.s 			page 113


 3965               	.LM324:
 3966 1524 812F      		mov r24,r17
 3967               	/* epilogue start */
 3968 1526 DF91      		pop r29
 3969 1528 CF91      		pop r28
 3970 152a 1F91      		pop r17
 3971 152c 0F91      		pop r16
 3972 152e FF90      		pop r15
 3973 1530 EF90      		pop r14
 3974 1532 DF90      		pop r13
 3975 1534 CF90      		pop r12
 3976 1536 0895      		ret
 3977               	.L198:
 3978               		.stabn	68,0,2415,.LM325-.LFBB18
 3979               	.LM325:
 3980 1538 11E0      		ldi r17,lo8(1)
 3981 153a 00C0      		rjmp .L200
 3982               		.size	f_truncate, .-f_truncate
 3983               		.stabs	"res:r(1,16)",64,0,2387,17
 3984               		.stabs	"ncl:r(2,12)",64,0,2388,12
 3985               		.stabn	192,0,0,.LFBB18-.LFBB18
 3986               		.stabn	224,0,0,.Lscope18-.LFBB18
 3987               	.Lscope18:
 3988               		.stabs	"",36,0,0,.Lscope18-.LFBB18
 3989               		.stabd	78,0,0
 3990               		.stabs	"f_readdir:F(1,16)",36,0,2246,f_readdir
 3991               		.stabs	"dj:P(0,16)",64,0,2243,16
 3992               		.stabs	"fno:P(0,17)",64,0,2244,14
 3993               	.global	f_readdir
 3994               		.type	f_readdir, @function
 3995               	f_readdir:
 3996               		.stabd	46,0,0
 3997               		.stabn	68,0,2246,.LM326-.LFBB19
 3998               	.LM326:
 3999               	.LFBB19:
 4000 153c EF92      		push r14
 4001 153e FF92      		push r15
 4002 1540 0F93      		push r16
 4003 1542 1F93      		push r17
 4004 1544 DF93      		push r29
 4005 1546 CF93      		push r28
 4006 1548 CDB7      		in r28,__SP_L__
 4007 154a DEB7      		in r29,__SP_H__
 4008 154c 2C97      		sbiw r28,12
 4009 154e 0FB6      		in __tmp_reg__,__SREG__
 4010 1550 F894      		cli
 4011 1552 DEBF      		out __SP_H__,r29
 4012 1554 0FBE      		out __SREG__,__tmp_reg__
 4013 1556 CDBF      		out __SP_L__,r28
 4014               	/* prologue: function */
 4015               	/* frame size = 12 */
 4016 1558 8C01      		movw r16,r24
 4017 155a 7B01      		movw r14,r22
 4018               		.stabn	68,0,2251,.LM327-.LFBB19
 4019               	.LM327:
 4020 155c FC01      		movw r30,r24
 4021 155e 6281      		ldd r22,Z+2
GAS LISTING /tmp/ccPugNTh.s 			page 114


 4022 1560 7381      		ldd r23,Z+3
 4023 1562 8081      		ld r24,Z
 4024 1564 9181      		ldd r25,Z+1
 4025 1566 0E94 0000 		call validate
 4026               		.stabn	68,0,2252,.LM328-.LFBB19
 4027               	.LM328:
 4028 156a 8823      		tst r24
 4029 156c 01F4      		brne .L204
 4030               		.stabn	68,0,2253,.LM329-.LFBB19
 4031               	.LM329:
 4032 156e CE01      		movw r24,r28
 4033 1570 0196      		adiw r24,1
 4034 1572 F801      		movw r30,r16
 4035 1574 958B      		std Z+21,r25
 4036 1576 848B      		std Z+20,r24
 4037               		.stabn	68,0,2254,.LM330-.LFBB19
 4038               	.LM330:
 4039 1578 E114      		cp r14,__zero_reg__
 4040 157a F104      		cpc r15,__zero_reg__
 4041 157c 01F4      		brne .L205
 4042               		.stabn	68,0,2255,.LM331-.LFBB19
 4043               	.LM331:
 4044 157e C801      		movw r24,r16
 4045 1580 60E0      		ldi r22,lo8(0)
 4046 1582 70E0      		ldi r23,hi8(0)
 4047 1584 0E94 0000 		call dir_seek
 4048 1588 00C0      		rjmp .L204
 4049               	.L205:
 4050               		.stabn	68,0,2257,.LM332-.LFBB19
 4051               	.LM332:
 4052 158a C801      		movw r24,r16
 4053 158c 0E94 0000 		call dir_read
 4054               		.stabn	68,0,2258,.LM333-.LFBB19
 4055               	.LM333:
 4056 1590 8430      		cpi r24,lo8(4)
 4057 1592 01F4      		brne .L206
 4058               		.stabn	68,0,2259,.LM334-.LFBB19
 4059               	.LM334:
 4060 1594 F801      		movw r30,r16
 4061 1596 1686      		std Z+14,__zero_reg__
 4062 1598 1786      		std Z+15,__zero_reg__
 4063 159a 108A      		std Z+16,__zero_reg__
 4064 159c 118A      		std Z+17,__zero_reg__
 4065 159e 00C0      		rjmp .L207
 4066               	.L206:
 4067               		.stabn	68,0,2262,.LM335-.LFBB19
 4068               	.LM335:
 4069 15a0 8823      		tst r24
 4070 15a2 01F4      		brne .L204
 4071               	.L207:
 4072               		.stabn	68,0,2263,.LM336-.LFBB19
 4073               	.LM336:
 4074 15a4 C801      		movw r24,r16
 4075 15a6 B701      		movw r22,r14
 4076 15a8 0E94 0000 		call get_fileinfo
 4077               		.stabn	68,0,2264,.LM337-.LFBB19
 4078               	.LM337:
GAS LISTING /tmp/ccPugNTh.s 			page 115


 4079 15ac C801      		movw r24,r16
 4080 15ae 60E0      		ldi r22,lo8(0)
 4081 15b0 0E94 0000 		call dir_next
 4082               		.stabn	68,0,2265,.LM338-.LFBB19
 4083               	.LM338:
 4084 15b4 8430      		cpi r24,lo8(4)
 4085 15b6 01F4      		brne .L204
 4086               		.stabn	68,0,2266,.LM339-.LFBB19
 4087               	.LM339:
 4088 15b8 F801      		movw r30,r16
 4089 15ba 1686      		std Z+14,__zero_reg__
 4090 15bc 1786      		std Z+15,__zero_reg__
 4091 15be 108A      		std Z+16,__zero_reg__
 4092 15c0 118A      		std Z+17,__zero_reg__
 4093 15c2 80E0      		ldi r24,lo8(0)
 4094               	.L204:
 4095               	/* epilogue start */
 4096               		.stabn	68,0,2274,.LM340-.LFBB19
 4097               	.LM340:
 4098 15c4 2C96      		adiw r28,12
 4099 15c6 0FB6      		in __tmp_reg__,__SREG__
 4100 15c8 F894      		cli
 4101 15ca DEBF      		out __SP_H__,r29
 4102 15cc 0FBE      		out __SREG__,__tmp_reg__
 4103 15ce CDBF      		out __SP_L__,r28
 4104 15d0 CF91      		pop r28
 4105 15d2 DF91      		pop r29
 4106 15d4 1F91      		pop r17
 4107 15d6 0F91      		pop r16
 4108 15d8 FF90      		pop r15
 4109 15da EF90      		pop r14
 4110 15dc 0895      		ret
 4111               		.size	f_readdir, .-f_readdir
 4112               		.stabs	"res:r(1,16)",64,0,2247,24
 4113               		.stabs	"sfn:(0,24)=ar(1,4);0;11;(2,5)",128,0,2248,1
 4114               		.stabn	192,0,0,.LFBB19-.LFBB19
 4115               		.stabn	224,0,0,.Lscope19-.LFBB19
 4116               	.Lscope19:
 4117               		.stabs	"",36,0,0,.Lscope19-.LFBB19
 4118               		.stabd	78,0,0
 4119               		.stabs	"f_lseek:F(1,16)",36,0,2106,f_lseek
 4120               		.stabs	"fp:p(0,23)",160,0,2103,4
 4121               		.stabs	"ofs:P(2,12)",64,0,2104,6
 4122               	.global	f_lseek
 4123               		.type	f_lseek, @function
 4124               	f_lseek:
 4125               		.stabd	46,0,0
 4126               		.stabn	68,0,2106,.LM341-.LFBB20
 4127               	.LM341:
 4128               	.LFBB20:
 4129 15de 2F92      		push r2
 4130 15e0 3F92      		push r3
 4131 15e2 4F92      		push r4
 4132 15e4 5F92      		push r5
 4133 15e6 6F92      		push r6
 4134 15e8 7F92      		push r7
 4135 15ea 8F92      		push r8
GAS LISTING /tmp/ccPugNTh.s 			page 116


 4136 15ec 9F92      		push r9
 4137 15ee AF92      		push r10
 4138 15f0 BF92      		push r11
 4139 15f2 CF92      		push r12
 4140 15f4 DF92      		push r13
 4141 15f6 EF92      		push r14
 4142 15f8 FF92      		push r15
 4143 15fa 0F93      		push r16
 4144 15fc 1F93      		push r17
 4145 15fe DF93      		push r29
 4146 1600 CF93      		push r28
 4147 1602 00D0      		rcall .
 4148 1604 00D0      		rcall .
 4149 1606 0F92      		push __tmp_reg__
 4150 1608 CDB7      		in r28,__SP_L__
 4151 160a DEB7      		in r29,__SP_H__
 4152               	/* prologue: function */
 4153               	/* frame size = 5 */
 4154 160c 9D83      		std Y+5,r25
 4155 160e 8C83      		std Y+4,r24
 4156 1610 3A01      		movw r6,r20
 4157 1612 4B01      		movw r8,r22
 4158               		.stabn	68,0,2111,.LM342-.LFBB20
 4159               	.LM342:
 4160 1614 DC01      		movw r26,r24
 4161 1616 1296      		adiw r26,2
 4162 1618 6D91      		ld r22,X+
 4163 161a 7C91      		ld r23,X
 4164 161c 1397      		sbiw r26,2+1
 4165 161e 8D91      		ld r24,X+
 4166 1620 9C91      		ld r25,X
 4167 1622 0E94 0000 		call validate
 4168 1626 8B83      		std Y+3,r24
 4169               		.stabn	68,0,2112,.LM343-.LFBB20
 4170               	.LM343:
 4171 1628 8823      		tst r24
 4172 162a 01F0      		breq .+2
 4173 162c 00C0      		rjmp .L210
 4174               		.stabn	68,0,2113,.LM344-.LFBB20
 4175               	.LM344:
 4176 162e EC81      		ldd r30,Y+4
 4177 1630 FD81      		ldd r31,Y+5
 4178 1632 8481      		ldd r24,Z+4
 4179 1634 87FD      		sbrc r24,7
 4180 1636 00C0      		rjmp .L234
 4181               	.L211:
 4182               		.stabn	68,0,2115,.LM345-.LFBB20
 4183               	.LM345:
 4184 1638 AC81      		ldd r26,Y+4
 4185 163a BD81      		ldd r27,Y+5
 4186 163c 1A96      		adiw r26,10
 4187 163e AD90      		ld r10,X+
 4188 1640 BD90      		ld r11,X+
 4189 1642 CD90      		ld r12,X+
 4190 1644 DC90      		ld r13,X
 4191 1646 1D97      		sbiw r26,10+3
 4192 1648 A614      		cp r10,r6
GAS LISTING /tmp/ccPugNTh.s 			page 117


 4193 164a B704      		cpc r11,r7
 4194 164c C804      		cpc r12,r8
 4195 164e D904      		cpc r13,r9
 4196 1650 00F4      		brsh .L212
 4197 1652 81FF      		sbrs r24,1
 4198 1654 00C0      		rjmp .L213
 4199               	.L212:
 4200 1656 6401      		movw r12,r8
 4201 1658 5301      		movw r10,r6
 4202               	.L213:
 4203               		.stabn	68,0,2121,.LM346-.LFBB20
 4204               	.LM346:
 4205 165a EC81      		ldd r30,Y+4
 4206 165c FD81      		ldd r31,Y+5
 4207 165e 2681      		ldd r18,Z+6
 4208 1660 3781      		ldd r19,Z+7
 4209 1662 4085      		ldd r20,Z+8
 4210 1664 5185      		ldd r21,Z+9
 4211               		.stabn	68,0,2122,.LM347-.LFBB20
 4212               	.LM347:
 4213 1666 1682      		std Z+6,__zero_reg__
 4214 1668 1782      		std Z+7,__zero_reg__
 4215 166a 1086      		std Z+8,__zero_reg__
 4216 166c 1186      		std Z+9,__zero_reg__
 4217 166e 8FEF      		ldi r24,lo8(-1)
 4218 1670 8583      		std Z+5,r24
 4219               		.stabn	68,0,2123,.LM348-.LFBB20
 4220               	.LM348:
 4221 1672 A114      		cp r10,__zero_reg__
 4222 1674 B104      		cpc r11,__zero_reg__
 4223 1676 C104      		cpc r12,__zero_reg__
 4224 1678 D104      		cpc r13,__zero_reg__
 4225 167a 01F4      		brne .+2
 4226 167c 00C0      		rjmp .L214
 4227               		.stabn	68,0,2124,.LM349-.LFBB20
 4228               	.LM349:
 4229 167e 0190      		ld __tmp_reg__,Z+
 4230 1680 F081      		ld r31,Z
 4231 1682 E02D      		mov r30,__tmp_reg__
 4232 1684 FA83      		std Y+2,r31
 4233 1686 E983      		std Y+1,r30
 4234 1688 8281      		ldd r24,Z+2
 4235 168a 682E      		mov r6,r24
 4236 168c 7724      		clr r7
 4237 168e 8824      		clr r8
 4238 1690 9924      		clr r9
 4239 1692 09E0      		ldi r16,9
 4240 1694 660C      	1:	lsl r6
 4241 1696 771C      		rol r7
 4242 1698 881C      		rol r8
 4243 169a 991C      		rol r9
 4244 169c 0A95      		dec r16
 4245 169e 01F4      		brne 1b
 4246               		.stabn	68,0,2125,.LM350-.LFBB20
 4247               	.LM350:
 4248 16a0 2115      		cp r18,__zero_reg__
 4249 16a2 3105      		cpc r19,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 118


 4250 16a4 4105      		cpc r20,__zero_reg__
 4251 16a6 5105      		cpc r21,__zero_reg__
 4252 16a8 01F0      		breq .L215
 4253 16aa 1901      		movw r2,r18
 4254 16ac 2A01      		movw r4,r20
 4255 16ae 0894      		sec
 4256 16b0 2108      		sbc r2,__zero_reg__
 4257 16b2 3108      		sbc r3,__zero_reg__
 4258 16b4 4108      		sbc r4,__zero_reg__
 4259 16b6 5108      		sbc r5,__zero_reg__
 4260 16b8 C601      		movw r24,r12
 4261 16ba B501      		movw r22,r10
 4262 16bc 6150      		subi r22,lo8(-(-1))
 4263 16be 7040      		sbci r23,hi8(-(-1))
 4264 16c0 8040      		sbci r24,hlo8(-(-1))
 4265 16c2 9040      		sbci r25,hhi8(-(-1))
 4266 16c4 A401      		movw r20,r8
 4267 16c6 9301      		movw r18,r6
 4268 16c8 0E94 0000 		call __udivmodsi4
 4269 16cc 7901      		movw r14,r18
 4270 16ce 8A01      		movw r16,r20
 4271 16d0 C201      		movw r24,r4
 4272 16d2 B101      		movw r22,r2
 4273 16d4 A401      		movw r20,r8
 4274 16d6 9301      		movw r18,r6
 4275 16d8 0E94 0000 		call __udivmodsi4
 4276 16dc E216      		cp r14,r18
 4277 16de F306      		cpc r15,r19
 4278 16e0 0407      		cpc r16,r20
 4279 16e2 1507      		cpc r17,r21
 4280 16e4 00F0      		brlo .L215
 4281               		.stabn	68,0,2127,.LM351-.LFBB20
 4282               	.LM351:
 4283 16e6 8827      		clr r24
 4284 16e8 9927      		clr r25
 4285 16ea DC01      		movw r26,r24
 4286 16ec 8619      		sub r24,r6
 4287 16ee 9709      		sbc r25,r7
 4288 16f0 A809      		sbc r26,r8
 4289 16f2 B909      		sbc r27,r9
 4290 16f4 8221      		and r24,r2
 4291 16f6 9321      		and r25,r3
 4292 16f8 A421      		and r26,r4
 4293 16fa B521      		and r27,r5
 4294 16fc EC81      		ldd r30,Y+4
 4295 16fe FD81      		ldd r31,Y+5
 4296 1700 8683      		std Z+6,r24
 4297 1702 9783      		std Z+7,r25
 4298 1704 A087      		std Z+8,r26
 4299 1706 B187      		std Z+9,r27
 4300               		.stabn	68,0,2128,.LM352-.LFBB20
 4301               	.LM352:
 4302 1708 A81A      		sub r10,r24
 4303 170a B90A      		sbc r11,r25
 4304 170c CA0A      		sbc r12,r26
 4305 170e DB0A      		sbc r13,r27
 4306               		.stabn	68,0,2129,.LM353-.LFBB20
GAS LISTING /tmp/ccPugNTh.s 			page 119


 4307               	.LM353:
 4308 1710 4289      		ldd r20,Z+18
 4309 1712 5389      		ldd r21,Z+19
 4310 1714 6489      		ldd r22,Z+20
 4311 1716 7589      		ldd r23,Z+21
 4312 1718 00C0      		rjmp .L216
 4313               	.L215:
 4314               		.stabn	68,0,2131,.LM354-.LFBB20
 4315               	.LM354:
 4316 171a AC81      		ldd r26,Y+4
 4317 171c BD81      		ldd r27,Y+5
 4318 171e 1E96      		adiw r26,14
 4319 1720 4D91      		ld r20,X+
 4320 1722 5D91      		ld r21,X+
 4321 1724 6D91      		ld r22,X+
 4322 1726 7C91      		ld r23,X
 4323 1728 5197      		sbiw r26,14+3
 4324               		.stabn	68,0,2133,.LM355-.LFBB20
 4325               	.LM355:
 4326 172a 4115      		cp r20,__zero_reg__
 4327 172c 5105      		cpc r21,__zero_reg__
 4328 172e 6105      		cpc r22,__zero_reg__
 4329 1730 7105      		cpc r23,__zero_reg__
 4330 1732 01F4      		brne .L217
 4331               		.stabn	68,0,2134,.LM356-.LFBB20
 4332               	.LM356:
 4333 1734 8981      		ldd r24,Y+1
 4334 1736 9A81      		ldd r25,Y+2
 4335 1738 40E0      		ldi r20,lo8(0)
 4336 173a 50E0      		ldi r21,hi8(0)
 4337 173c 60E0      		ldi r22,hlo8(0)
 4338 173e 70E0      		ldi r23,hhi8(0)
 4339 1740 0E94 0000 		call create_chain
 4340 1744 AB01      		movw r20,r22
 4341 1746 BC01      		movw r22,r24
 4342               		.stabn	68,0,2135,.LM357-.LFBB20
 4343               	.LM357:
 4344 1748 4130      		cpi r20,lo8(1)
 4345 174a 5105      		cpc r21,__zero_reg__
 4346 174c 6105      		cpc r22,__zero_reg__
 4347 174e 7105      		cpc r23,__zero_reg__
 4348 1750 01F4      		brne .L218
 4349               	.L236:
 4350 1752 EC81      		ldd r30,Y+4
 4351 1754 FD81      		ldd r31,Y+5
 4352 1756 8481      		ldd r24,Z+4
 4353 1758 8068      		ori r24,lo8(-128)
 4354 175a 8483      		std Z+4,r24
 4355               	.L234:
 4356 175c F2E0      		ldi r31,lo8(2)
 4357 175e FB83      		std Y+3,r31
 4358 1760 00C0      		rjmp .L210
 4359               	.L218:
 4360               		.stabn	68,0,2136,.LM358-.LFBB20
 4361               	.LM358:
 4362 1762 4F3F      		cpi r20,lo8(-1)
 4363 1764 8FEF      		ldi r24,hi8(-1)
GAS LISTING /tmp/ccPugNTh.s 			page 120


 4364 1766 5807      		cpc r21,r24
 4365 1768 8FEF      		ldi r24,hlo8(-1)
 4366 176a 6807      		cpc r22,r24
 4367 176c 8FEF      		ldi r24,hhi8(-1)
 4368 176e 7807      		cpc r23,r24
 4369 1770 01F0      		breq .L237
 4370               	.L219:
 4371               		.stabn	68,0,2137,.LM359-.LFBB20
 4372               	.LM359:
 4373 1772 EC81      		ldd r30,Y+4
 4374 1774 FD81      		ldd r31,Y+5
 4375 1776 4687      		std Z+14,r20
 4376 1778 5787      		std Z+15,r21
 4377 177a 608B      		std Z+16,r22
 4378 177c 718B      		std Z+17,r23
 4379               	.L217:
 4380               		.stabn	68,0,2140,.LM360-.LFBB20
 4381               	.LM360:
 4382 177e AC81      		ldd r26,Y+4
 4383 1780 BD81      		ldd r27,Y+5
 4384 1782 5296      		adiw r26,18
 4385 1784 4D93      		st X+,r20
 4386 1786 5D93      		st X+,r21
 4387 1788 6D93      		st X+,r22
 4388 178a 7C93      		st X,r23
 4389 178c 5597      		sbiw r26,18+3
 4390               	.L216:
 4391               		.stabn	68,0,2142,.LM361-.LFBB20
 4392               	.LM361:
 4393 178e 4115      		cp r20,__zero_reg__
 4394 1790 5105      		cpc r21,__zero_reg__
 4395 1792 6105      		cpc r22,__zero_reg__
 4396 1794 7105      		cpc r23,__zero_reg__
 4397 1796 01F0      		breq .+2
 4398 1798 00C0      		rjmp .L233
 4399 179a 00C0      		rjmp .L214
 4400               	.L227:
 4401               		.stabn	68,0,2145,.LM362-.LFBB20
 4402               	.LM362:
 4403 179c EC81      		ldd r30,Y+4
 4404 179e FD81      		ldd r31,Y+5
 4405 17a0 8481      		ldd r24,Z+4
 4406 17a2 2081      		ld r18,Z
 4407 17a4 3181      		ldd r19,Z+1
 4408 17a6 81FF      		sbrs r24,1
 4409 17a8 00C0      		rjmp .L221
 4410               		.stabn	68,0,2146,.LM363-.LFBB20
 4411               	.LM363:
 4412 17aa C901      		movw r24,r18
 4413 17ac 0E94 0000 		call create_chain
 4414 17b0 AB01      		movw r20,r22
 4415 17b2 BC01      		movw r22,r24
 4416               		.stabn	68,0,2147,.LM364-.LFBB20
 4417               	.LM364:
 4418 17b4 4115      		cp r20,__zero_reg__
 4419 17b6 5105      		cpc r21,__zero_reg__
 4420 17b8 6105      		cpc r22,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 121


 4421 17ba 7105      		cpc r23,__zero_reg__
 4422 17bc 01F4      		brne .L222
 4423 17be 6401      		movw r12,r8
 4424 17c0 5301      		movw r10,r6
 4425 17c2 00C0      		rjmp .L223
 4426               	.L221:
 4427               		.stabn	68,0,2152,.LM365-.LFBB20
 4428               	.LM365:
 4429 17c4 C901      		movw r24,r18
 4430 17c6 0E94 0000 		call get_fat
 4431 17ca AB01      		movw r20,r22
 4432 17cc BC01      		movw r22,r24
 4433               	.L222:
 4434               		.stabn	68,0,2153,.LM366-.LFBB20
 4435               	.LM366:
 4436 17ce 4F3F      		cpi r20,lo8(-1)
 4437 17d0 FFEF      		ldi r31,hi8(-1)
 4438 17d2 5F07      		cpc r21,r31
 4439 17d4 FFEF      		ldi r31,hlo8(-1)
 4440 17d6 6F07      		cpc r22,r31
 4441 17d8 FFEF      		ldi r31,hhi8(-1)
 4442 17da 7F07      		cpc r23,r31
 4443 17dc 01F4      		brne .L224
 4444               	.L237:
 4445 17de AC81      		ldd r26,Y+4
 4446 17e0 BD81      		ldd r27,Y+5
 4447 17e2 1496      		adiw r26,4
 4448 17e4 8C91      		ld r24,X
 4449 17e6 1497      		sbiw r26,4
 4450 17e8 8068      		ori r24,lo8(-128)
 4451 17ea 1496      		adiw r26,4
 4452 17ec 8C93      		st X,r24
 4453 17ee B1E0      		ldi r27,lo8(1)
 4454 17f0 00C0      		rjmp .L235
 4455               	.L224:
 4456               		.stabn	68,0,2154,.LM367-.LFBB20
 4457               	.LM367:
 4458 17f2 4230      		cpi r20,lo8(2)
 4459 17f4 5105      		cpc r21,__zero_reg__
 4460 17f6 6105      		cpc r22,__zero_reg__
 4461 17f8 7105      		cpc r23,__zero_reg__
 4462 17fa 00F4      		brsh .+2
 4463 17fc 00C0      		rjmp .L236
 4464 17fe AC81      		ldd r26,Y+4
 4465 1800 BD81      		ldd r27,Y+5
 4466 1802 ED91      		ld r30,X+
 4467 1804 FC91      		ld r31,X
 4468 1806 828D      		ldd r24,Z+26
 4469 1808 938D      		ldd r25,Z+27
 4470 180a A48D      		ldd r26,Z+28
 4471 180c B58D      		ldd r27,Z+29
 4472 180e 4817      		cp r20,r24
 4473 1810 5907      		cpc r21,r25
 4474 1812 6A07      		cpc r22,r26
 4475 1814 7B07      		cpc r23,r27
 4476 1816 00F0      		brlo .+2
 4477 1818 00C0      		rjmp .L236
GAS LISTING /tmp/ccPugNTh.s 			page 122


 4478               	.L226:
 4479               		.stabn	68,0,2155,.LM368-.LFBB20
 4480               	.LM368:
 4481 181a AC81      		ldd r26,Y+4
 4482 181c BD81      		ldd r27,Y+5
 4483 181e 5296      		adiw r26,18
 4484 1820 4D93      		st X+,r20
 4485 1822 5D93      		st X+,r21
 4486 1824 6D93      		st X+,r22
 4487 1826 7C93      		st X,r23
 4488 1828 5597      		sbiw r26,18+3
 4489               		.stabn	68,0,2156,.LM369-.LFBB20
 4490               	.LM369:
 4491 182a FD01      		movw r30,r26
 4492 182c 8681      		ldd r24,Z+6
 4493 182e 9781      		ldd r25,Z+7
 4494 1830 A085      		ldd r26,Z+8
 4495 1832 B185      		ldd r27,Z+9
 4496 1834 860D      		add r24,r6
 4497 1836 971D      		adc r25,r7
 4498 1838 A81D      		adc r26,r8
 4499 183a B91D      		adc r27,r9
 4500 183c 8683      		std Z+6,r24
 4501 183e 9783      		std Z+7,r25
 4502 1840 A087      		std Z+8,r26
 4503 1842 B187      		std Z+9,r27
 4504               		.stabn	68,0,2157,.LM370-.LFBB20
 4505               	.LM370:
 4506 1844 A618      		sub r10,r6
 4507 1846 B708      		sbc r11,r7
 4508 1848 C808      		sbc r12,r8
 4509 184a D908      		sbc r13,r9
 4510               	.L233:
 4511               		.stabn	68,0,2143,.LM371-.LFBB20
 4512               	.LM371:
 4513 184c 6A14      		cp r6,r10
 4514 184e 7B04      		cpc r7,r11
 4515 1850 8C04      		cpc r8,r12
 4516 1852 9D04      		cpc r9,r13
 4517 1854 00F4      		brsh .+2
 4518 1856 00C0      		rjmp .L227
 4519               	.L223:
 4520               		.stabn	68,0,2159,.LM372-.LFBB20
 4521               	.LM372:
 4522 1858 EC81      		ldd r30,Y+4
 4523 185a FD81      		ldd r31,Y+5
 4524 185c 8681      		ldd r24,Z+6
 4525 185e 9781      		ldd r25,Z+7
 4526 1860 A085      		ldd r26,Z+8
 4527 1862 B185      		ldd r27,Z+9
 4528 1864 8A0D      		add r24,r10
 4529 1866 9B1D      		adc r25,r11
 4530 1868 AC1D      		adc r26,r12
 4531 186a BD1D      		adc r27,r13
 4532 186c 8683      		std Z+6,r24
 4533 186e 9783      		std Z+7,r25
 4534 1870 A087      		std Z+8,r26
GAS LISTING /tmp/ccPugNTh.s 			page 123


 4535 1872 B187      		std Z+9,r27
 4536               		.stabn	68,0,2160,.LM373-.LFBB20
 4537               	.LM373:
 4538 1874 D601      		movw r26,r12
 4539 1876 C501      		movw r24,r10
 4540 1878 19E0      		ldi r17,9
 4541 187a B695      	1:	lsr r27
 4542 187c A795      		ror r26
 4543 187e 9795      		ror r25
 4544 1880 8795      		ror r24
 4545 1882 1A95      		dec r17
 4546 1884 01F4      		brne 1b
 4547 1886 E82E      		mov r14,r24
 4548 1888 8583      		std Z+5,r24
 4549               		.stabn	68,0,2161,.LM374-.LFBB20
 4550               	.LM374:
 4551 188a 8FEF      		ldi r24,lo8(511)
 4552 188c 91E0      		ldi r25,hi8(511)
 4553 188e A0E0      		ldi r26,hlo8(511)
 4554 1890 B0E0      		ldi r27,hhi8(511)
 4555 1892 A822      		and r10,r24
 4556 1894 B922      		and r11,r25
 4557 1896 CA22      		and r12,r26
 4558 1898 DB22      		and r13,r27
 4559 189a A114      		cp r10,__zero_reg__
 4560 189c B104      		cpc r11,__zero_reg__
 4561 189e C104      		cpc r12,__zero_reg__
 4562 18a0 D104      		cpc r13,__zero_reg__
 4563 18a2 01F4      		brne .+2
 4564 18a4 00C0      		rjmp .L214
 4565               		.stabn	68,0,2162,.LM375-.LFBB20
 4566               	.LM375:
 4567 18a6 8080      		ld r8,Z
 4568 18a8 9180      		ldd r9,Z+1
 4569               	.LBB98:
 4570               	.LBB99:
 4571               		.stabn	68,0,532,.LM376-.LFBB20
 4572               	.LM376:
 4573 18aa EEEF      		ldi r30,lo8(-2)
 4574 18ac AE2E      		mov r10,r30
 4575 18ae EFEF      		ldi r30,hi8(-2)
 4576 18b0 BE2E      		mov r11,r30
 4577 18b2 EFEF      		ldi r30,hlo8(-2)
 4578 18b4 CE2E      		mov r12,r30
 4579 18b6 EFEF      		ldi r30,hhi8(-2)
 4580 18b8 DE2E      		mov r13,r30
 4581 18ba A40E      		add r10,r20
 4582 18bc B51E      		adc r11,r21
 4583 18be C61E      		adc r12,r22
 4584 18c0 D71E      		adc r13,r23
 4585               		.stabn	68,0,533,.LM377-.LFBB20
 4586               	.LM377:
 4587 18c2 F401      		movw r30,r8
 4588 18c4 828D      		ldd r24,Z+26
 4589 18c6 938D      		ldd r25,Z+27
 4590 18c8 A48D      		ldd r26,Z+28
 4591 18ca B58D      		ldd r27,Z+29
GAS LISTING /tmp/ccPugNTh.s 			page 124


 4592 18cc 0297      		sbiw r24,2
 4593 18ce A109      		sbc r26,__zero_reg__
 4594 18d0 B109      		sbc r27,__zero_reg__
 4595 18d2 A816      		cp r10,r24
 4596 18d4 B906      		cpc r11,r25
 4597 18d6 CA06      		cpc r12,r26
 4598 18d8 DB06      		cpc r13,r27
 4599 18da 00F4      		brsh .L228
 4600               		.stabn	68,0,534,.LM378-.LFBB20
 4601               	.LM378:
 4602 18dc 2281      		ldd r18,Z+2
 4603 18de 30E0      		ldi r19,lo8(0)
 4604 18e0 40E0      		ldi r20,lo8(0)
 4605 18e2 50E0      		ldi r21,hi8(0)
 4606 18e4 C601      		movw r24,r12
 4607 18e6 B501      		movw r22,r10
 4608 18e8 0E94 0000 		call __mulsi3
 4609 18ec 9B01      		movw r18,r22
 4610 18ee AC01      		movw r20,r24
 4611 18f0 F401      		movw r30,r8
 4612 18f2 86A1      		ldd r24,Z+38
 4613 18f4 97A1      		ldd r25,Z+39
 4614 18f6 A0A5      		ldd r26,Z+40
 4615 18f8 B1A5      		ldd r27,Z+41
 4616 18fa 280F      		add r18,r24
 4617 18fc 391F      		adc r19,r25
 4618 18fe 4A1F      		adc r20,r26
 4619 1900 5B1F      		adc r21,r27
 4620               	.LBE99:
 4621               	.LBE98:
 4622               		.stabn	68,0,2163,.LM379-.LFBB20
 4623               	.LM379:
 4624 1902 2115      		cp r18,__zero_reg__
 4625 1904 3105      		cpc r19,__zero_reg__
 4626 1906 4105      		cpc r20,__zero_reg__
 4627 1908 5105      		cpc r21,__zero_reg__
 4628 190a 01F4      		brne .L229
 4629               	.L228:
 4630 190c AC81      		ldd r26,Y+4
 4631 190e BD81      		ldd r27,Y+5
 4632 1910 1496      		adiw r26,4
 4633 1912 8C91      		ld r24,X
 4634 1914 1497      		sbiw r26,4
 4635 1916 8068      		ori r24,lo8(-128)
 4636 1918 1496      		adiw r26,4
 4637 191a 8C93      		st X,r24
 4638 191c B2E0      		ldi r27,lo8(2)
 4639               	.L235:
 4640 191e BB83      		std Y+3,r27
 4641 1920 00C0      		rjmp .L210
 4642               	.L229:
 4643               		.stabn	68,0,2164,.LM380-.LFBB20
 4644               	.LM380:
 4645 1922 2E0D      		add r18,r14
 4646 1924 311D      		adc r19,__zero_reg__
 4647 1926 411D      		adc r20,__zero_reg__
 4648 1928 511D      		adc r21,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 125


 4649               		.stabn	68,0,2165,.LM381-.LFBB20
 4650               	.LM381:
 4651 192a E394      		inc r14
 4652 192c EC81      		ldd r30,Y+4
 4653 192e FD81      		ldd r31,Y+5
 4654 1930 E582      		std Z+5,r14
 4655 1932 00C0      		rjmp .L230
 4656               	.L214:
 4657 1934 20E0      		ldi r18,lo8(0)
 4658 1936 30E0      		ldi r19,hi8(0)
 4659 1938 40E0      		ldi r20,hlo8(0)
 4660 193a 50E0      		ldi r21,hhi8(0)
 4661               	.L230:
 4662               		.stabn	68,0,2169,.LM382-.LFBB20
 4663               	.LM382:
 4664 193c EC81      		ldd r30,Y+4
 4665 193e FD81      		ldd r31,Y+5
 4666 1940 8681      		ldd r24,Z+6
 4667 1942 9781      		ldd r25,Z+7
 4668 1944 A085      		ldd r26,Z+8
 4669 1946 B185      		ldd r27,Z+9
 4670 1948 9170      		andi r25,hi8(511)
 4671 194a A070      		andi r26,hlo8(511)
 4672 194c B070      		andi r27,hhi8(511)
 4673 194e 0097      		sbiw r24,0
 4674 1950 A105      		cpc r26,__zero_reg__
 4675 1952 B105      		cpc r27,__zero_reg__
 4676 1954 01F0      		breq .L231
 4677 1956 8689      		ldd r24,Z+22
 4678 1958 9789      		ldd r25,Z+23
 4679 195a A08D      		ldd r26,Z+24
 4680 195c B18D      		ldd r27,Z+25
 4681 195e 2817      		cp r18,r24
 4682 1960 3907      		cpc r19,r25
 4683 1962 4A07      		cpc r20,r26
 4684 1964 5B07      		cpc r21,r27
 4685 1966 01F0      		breq .L231
 4686               		.stabn	68,0,2181,.LM383-.LFBB20
 4687               	.LM383:
 4688 1968 268B      		std Z+22,r18
 4689 196a 378B      		std Z+23,r19
 4690 196c 408F      		std Z+24,r20
 4691 196e 518F      		std Z+25,r21
 4692               	.L231:
 4693               		.stabn	68,0,2184,.LM384-.LFBB20
 4694               	.LM384:
 4695 1970 EC81      		ldd r30,Y+4
 4696 1972 FD81      		ldd r31,Y+5
 4697 1974 2681      		ldd r18,Z+6
 4698 1976 3781      		ldd r19,Z+7
 4699 1978 4085      		ldd r20,Z+8
 4700 197a 5185      		ldd r21,Z+9
 4701 197c 8285      		ldd r24,Z+10
 4702 197e 9385      		ldd r25,Z+11
 4703 1980 A485      		ldd r26,Z+12
 4704 1982 B585      		ldd r27,Z+13
 4705 1984 8217      		cp r24,r18
GAS LISTING /tmp/ccPugNTh.s 			page 126


 4706 1986 9307      		cpc r25,r19
 4707 1988 A407      		cpc r26,r20
 4708 198a B507      		cpc r27,r21
 4709 198c 00F4      		brsh .L210
 4710               		.stabn	68,0,2185,.LM385-.LFBB20
 4711               	.LM385:
 4712 198e 2287      		std Z+10,r18
 4713 1990 3387      		std Z+11,r19
 4714 1992 4487      		std Z+12,r20
 4715 1994 5587      		std Z+13,r21
 4716               		.stabn	68,0,2186,.LM386-.LFBB20
 4717               	.LM386:
 4718 1996 8481      		ldd r24,Z+4
 4719 1998 8062      		ori r24,lo8(32)
 4720 199a 8483      		std Z+4,r24
 4721               	.L210:
 4722               		.stabn	68,0,2191,.LM387-.LFBB20
 4723               	.LM387:
 4724 199c 8B81      		ldd r24,Y+3
 4725               	/* epilogue start */
 4726 199e 0F90      		pop __tmp_reg__
 4727 19a0 0F90      		pop __tmp_reg__
 4728 19a2 0F90      		pop __tmp_reg__
 4729 19a4 0F90      		pop __tmp_reg__
 4730 19a6 0F90      		pop __tmp_reg__
 4731 19a8 CF91      		pop r28
 4732 19aa DF91      		pop r29
 4733 19ac 1F91      		pop r17
 4734 19ae 0F91      		pop r16
 4735 19b0 FF90      		pop r15
 4736 19b2 EF90      		pop r14
 4737 19b4 DF90      		pop r13
 4738 19b6 CF90      		pop r12
 4739 19b8 BF90      		pop r11
 4740 19ba AF90      		pop r10
 4741 19bc 9F90      		pop r9
 4742 19be 8F90      		pop r8
 4743 19c0 7F90      		pop r7
 4744 19c2 6F90      		pop r6
 4745 19c4 5F90      		pop r5
 4746 19c6 4F90      		pop r4
 4747 19c8 3F90      		pop r3
 4748 19ca 2F90      		pop r2
 4749 19cc 0895      		ret
 4750               		.size	f_lseek, .-f_lseek
 4751               		.stabs	"res:(1,16)",128,0,2107,3
 4752               		.stabs	"clst:r(2,12)",64,0,2108,20
 4753               		.stabs	"bcs:r(2,12)",64,0,2108,6
 4754               		.stabs	"nsect:r(2,12)",64,0,2108,18
 4755               		.stabs	"ifptr:r(2,12)",64,0,2108,18
 4756               		.stabn	192,0,0,.LFBB20-.LFBB20
 4757               		.stabs	"clst:r(2,12)",64,0,2162,10
 4758               		.stabn	192,0,0,.LBB98-.LFBB20
 4759               		.stabn	224,0,0,.LBE98-.LFBB20
 4760               		.stabn	224,0,0,.Lscope20-.LFBB20
 4761               	.Lscope20:
 4762               		.stabs	"",36,0,0,.Lscope20-.LFBB20
GAS LISTING /tmp/ccPugNTh.s 			page 127


 4763               		.stabd	78,0,0
 4764               		.stabs	"f_sync:F(1,16)",36,0,1976,f_sync
 4765               		.stabs	"fp:P(0,23)",64,0,1974,28
 4766               	.global	f_sync
 4767               		.type	f_sync, @function
 4768               	f_sync:
 4769               		.stabd	46,0,0
 4770               		.stabn	68,0,1976,.LM388-.LFBB21
 4771               	.LM388:
 4772               	.LFBB21:
 4773 19ce 0F93      		push r16
 4774 19d0 1F93      		push r17
 4775 19d2 CF93      		push r28
 4776 19d4 DF93      		push r29
 4777               	/* prologue: function */
 4778               	/* frame size = 0 */
 4779 19d6 EC01      		movw r28,r24
 4780               		.stabn	68,0,1982,.LM389-.LFBB21
 4781               	.LM389:
 4782 19d8 6A81      		ldd r22,Y+2
 4783 19da 7B81      		ldd r23,Y+3
 4784 19dc 8881      		ld r24,Y
 4785 19de 9981      		ldd r25,Y+1
 4786 19e0 0E94 0000 		call validate
 4787 19e4 982F      		mov r25,r24
 4788               		.stabn	68,0,1983,.LM390-.LFBB21
 4789               	.LM390:
 4790 19e6 8823      		tst r24
 4791 19e8 01F0      		breq .+2
 4792 19ea 00C0      		rjmp .L239
 4793               		.stabn	68,0,1984,.LM391-.LFBB21
 4794               	.LM391:
 4795 19ec 8C81      		ldd r24,Y+4
 4796 19ee 85FF      		sbrs r24,5
 4797 19f0 00C0      		rjmp .L239
 4798               		.stabn	68,0,1993,.LM392-.LFBB21
 4799               	.LM392:
 4800 19f2 4A8D      		ldd r20,Y+26
 4801 19f4 5B8D      		ldd r21,Y+27
 4802 19f6 6C8D      		ldd r22,Y+28
 4803 19f8 7D8D      		ldd r23,Y+29
 4804 19fa 8881      		ld r24,Y
 4805 19fc 9981      		ldd r25,Y+1
 4806 19fe 0E94 0000 		call move_window
 4807 1a02 982F      		mov r25,r24
 4808               		.stabn	68,0,1994,.LM393-.LFBB21
 4809               	.LM393:
 4810 1a04 8823      		tst r24
 4811 1a06 01F0      		breq .+2
 4812 1a08 00C0      		rjmp .L239
 4813               		.stabn	68,0,1995,.LM394-.LFBB21
 4814               	.LM394:
 4815 1a0a 0E8D      		ldd r16,Y+30
 4816 1a0c 1F8D      		ldd r17,Y+31
 4817               		.stabn	68,0,1996,.LM395-.LFBB21
 4818               	.LM395:
 4819 1a0e F801      		movw r30,r16
GAS LISTING /tmp/ccPugNTh.s 			page 128


 4820 1a10 8385      		ldd r24,Z+11
 4821 1a12 8062      		ori r24,lo8(32)
 4822 1a14 8387      		std Z+11,r24
 4823               		.stabn	68,0,1997,.LM396-.LFBB21
 4824               	.LM396:
 4825 1a16 8A85      		ldd r24,Y+10
 4826 1a18 848F      		std Z+28,r24
 4827 1a1a 8B85      		ldd r24,Y+11
 4828 1a1c 858F      		std Z+29,r24
 4829 1a1e 8A85      		ldd r24,Y+10
 4830 1a20 9B85      		ldd r25,Y+11
 4831 1a22 AC85      		ldd r26,Y+12
 4832 1a24 BD85      		ldd r27,Y+13
 4833 1a26 CD01      		movw r24,r26
 4834 1a28 AA27      		clr r26
 4835 1a2a BB27      		clr r27
 4836 1a2c 868F      		std Z+30,r24
 4837 1a2e 8A85      		ldd r24,Y+10
 4838 1a30 9B85      		ldd r25,Y+11
 4839 1a32 AC85      		ldd r26,Y+12
 4840 1a34 BD85      		ldd r27,Y+13
 4841 1a36 8B2F      		mov r24,r27
 4842 1a38 9927      		clr r25
 4843 1a3a AA27      		clr r26
 4844 1a3c BB27      		clr r27
 4845 1a3e 878F      		std Z+31,r24
 4846               		.stabn	68,0,1998,.LM397-.LFBB21
 4847               	.LM397:
 4848 1a40 8E85      		ldd r24,Y+14
 4849 1a42 828F      		std Z+26,r24
 4850 1a44 8F85      		ldd r24,Y+15
 4851 1a46 838F      		std Z+27,r24
 4852               		.stabn	68,0,1999,.LM398-.LFBB21
 4853               	.LM398:
 4854 1a48 8E85      		ldd r24,Y+14
 4855 1a4a 9F85      		ldd r25,Y+15
 4856 1a4c A889      		ldd r26,Y+16
 4857 1a4e B989      		ldd r27,Y+17
 4858 1a50 CD01      		movw r24,r26
 4859 1a52 AA27      		clr r26
 4860 1a54 BB27      		clr r27
 4861 1a56 848B      		std Z+20,r24
 4862 1a58 8E85      		ldd r24,Y+14
 4863 1a5a 9F85      		ldd r25,Y+15
 4864 1a5c A889      		ldd r26,Y+16
 4865 1a5e B989      		ldd r27,Y+17
 4866 1a60 CD01      		movw r24,r26
 4867 1a62 AA27      		clr r26
 4868 1a64 BB27      		clr r27
 4869 1a66 892F      		mov r24,r25
 4870 1a68 9927      		clr r25
 4871 1a6a 858B      		std Z+21,r24
 4872               		.stabn	68,0,2000,.LM399-.LFBB21
 4873               	.LM399:
 4874 1a6c 0E94 0000 		call get_fattime
 4875               		.stabn	68,0,2001,.LM400-.LFBB21
 4876               	.LM400:
GAS LISTING /tmp/ccPugNTh.s 			page 129


 4877 1a70 F801      		movw r30,r16
 4878 1a72 668B      		std Z+22,r22
 4879 1a74 272F      		mov r18,r23
 4880 1a76 3327      		clr r19
 4881 1a78 278B      		std Z+23,r18
 4882 1a7a 9C01      		movw r18,r24
 4883 1a7c 4427      		clr r20
 4884 1a7e 5527      		clr r21
 4885 1a80 208F      		std Z+24,r18
 4886 1a82 692F      		mov r22,r25
 4887 1a84 7727      		clr r23
 4888 1a86 8827      		clr r24
 4889 1a88 9927      		clr r25
 4890 1a8a 618F      		std Z+25,r22
 4891               		.stabn	68,0,2002,.LM401-.LFBB21
 4892               	.LM401:
 4893 1a8c 8C81      		ldd r24,Y+4
 4894 1a8e 8F7D      		andi r24,lo8(-33)
 4895 1a90 8C83      		std Y+4,r24
 4896               		.stabn	68,0,2003,.LM402-.LFBB21
 4897               	.LM402:
 4898 1a92 E881      		ld r30,Y
 4899 1a94 F981      		ldd r31,Y+1
 4900 1a96 81E0      		ldi r24,lo8(1)
 4901 1a98 8483      		std Z+4,r24
 4902               		.stabn	68,0,2004,.LM403-.LFBB21
 4903               	.LM403:
 4904 1a9a 8881      		ld r24,Y
 4905 1a9c 9981      		ldd r25,Y+1
 4906 1a9e 0E94 0000 		call sync
 4907 1aa2 982F      		mov r25,r24
 4908               	.L239:
 4909               		.stabn	68,0,2010,.LM404-.LFBB21
 4910               	.LM404:
 4911 1aa4 892F      		mov r24,r25
 4912               	/* epilogue start */
 4913 1aa6 DF91      		pop r29
 4914 1aa8 CF91      		pop r28
 4915 1aaa 1F91      		pop r17
 4916 1aac 0F91      		pop r16
 4917 1aae 0895      		ret
 4918               		.size	f_sync, .-f_sync
 4919               		.stabs	"res:r(1,16)",64,0,1977,25
 4920               		.stabs	"tim:r(2,12)",64,0,1978,22
 4921               		.stabs	"dir:r(1,8)",64,0,1979,16
 4922               		.stabn	192,0,0,.LFBB21-.LFBB21
 4923               		.stabn	224,0,0,.Lscope21-.LFBB21
 4924               	.Lscope21:
 4925               		.stabs	"",36,0,0,.Lscope21-.LFBB21
 4926               		.stabd	78,0,0
 4927               		.stabs	"f_close:F(1,16)",36,0,2024,f_close
 4928               		.stabs	"fp:P(0,23)",64,0,2022,28
 4929               	.global	f_close
 4930               		.type	f_close, @function
 4931               	f_close:
 4932               		.stabd	46,0,0
 4933               		.stabn	68,0,2024,.LM405-.LFBB22
GAS LISTING /tmp/ccPugNTh.s 			page 130


 4934               	.LM405:
 4935               	.LFBB22:
 4936 1ab0 CF93      		push r28
 4937 1ab2 DF93      		push r29
 4938               	/* prologue: function */
 4939               	/* frame size = 0 */
 4940 1ab4 EC01      		movw r28,r24
 4941               		.stabn	68,0,2033,.LM406-.LFBB22
 4942               	.LM406:
 4943 1ab6 0E94 0000 		call f_sync
 4944               		.stabn	68,0,2034,.LM407-.LFBB22
 4945               	.LM407:
 4946 1aba 8823      		tst r24
 4947 1abc 01F4      		brne .L242
 4948 1abe 1982      		std Y+1,__zero_reg__
 4949 1ac0 1882      		st Y,__zero_reg__
 4950               	.L242:
 4951               	/* epilogue start */
 4952               		.stabn	68,0,2037,.LM408-.LFBB22
 4953               	.LM408:
 4954 1ac2 DF91      		pop r29
 4955 1ac4 CF91      		pop r28
 4956 1ac6 0895      		ret
 4957               		.size	f_close, .-f_close
 4958               		.stabs	"res:r(1,16)",64,0,2025,24
 4959               		.stabn	192,0,0,.LFBB22-.LFBB22
 4960               		.stabn	224,0,0,.Lscope22-.LFBB22
 4961               	.Lscope22:
 4962               		.stabs	"",36,0,0,.Lscope22-.LFBB22
 4963               		.stabd	78,0,0
 4964               		.stabs	"f_write:F(1,16)",36,0,1864,f_write
 4965               		.stabs	"fp:P(0,23)",64,0,1859,28
 4966               		.stabs	"btw:P(2,2)",64,0,1861,8
 4967               		.stabs	"bw:P(0,25)=*(2,2)",64,0,1862,2
 4968               	.global	f_write
 4969               		.type	f_write, @function
 4970               	f_write:
 4971               		.stabd	46,0,0
 4972               		.stabn	68,0,1864,.LM409-.LFBB23
 4973               	.LM409:
 4974               	.LFBB23:
 4975 1ac8 2F92      		push r2
 4976 1aca 3F92      		push r3
 4977 1acc 4F92      		push r4
 4978 1ace 5F92      		push r5
 4979 1ad0 6F92      		push r6
 4980 1ad2 7F92      		push r7
 4981 1ad4 8F92      		push r8
 4982 1ad6 9F92      		push r9
 4983 1ad8 AF92      		push r10
 4984 1ada BF92      		push r11
 4985 1adc CF92      		push r12
 4986 1ade DF92      		push r13
 4987 1ae0 EF92      		push r14
 4988 1ae2 FF92      		push r15
 4989 1ae4 0F93      		push r16
 4990 1ae6 1F93      		push r17
GAS LISTING /tmp/ccPugNTh.s 			page 131


 4991 1ae8 CF93      		push r28
 4992 1aea DF93      		push r29
 4993               	/* prologue: function */
 4994               	/* frame size = 0 */
 4995 1aec EC01      		movw r28,r24
 4996 1aee 162F      		mov r17,r22
 4997 1af0 072F      		mov r16,r23
 4998 1af2 4A01      		movw r8,r20
 4999 1af4 1901      		movw r2,r18
 5000               		.stabn	68,0,1871,.LM410-.LFBB23
 5001               	.LM410:
 5002 1af6 F901      		movw r30,r18
 5003 1af8 1182      		std Z+1,__zero_reg__
 5004 1afa 1082      		st Z,__zero_reg__
 5005               		.stabn	68,0,1873,.LM411-.LFBB23
 5006               	.LM411:
 5007 1afc 6A81      		ldd r22,Y+2
 5008 1afe 7B81      		ldd r23,Y+3
 5009 1b00 8881      		ld r24,Y
 5010 1b02 9981      		ldd r25,Y+1
 5011 1b04 0E94 0000 		call validate
 5012 1b08 782E      		mov r7,r24
 5013               		.stabn	68,0,1874,.LM412-.LFBB23
 5014               	.LM412:
 5015 1b0a 8823      		tst r24
 5016 1b0c 01F0      		breq .+2
 5017 1b0e 00C0      		rjmp .L245
 5018               		.stabn	68,0,1875,.LM413-.LFBB23
 5019               	.LM413:
 5020 1b10 8C81      		ldd r24,Y+4
 5021 1b12 87FD      		sbrc r24,7
 5022 1b14 00C0      		rjmp .L277
 5023               	.L246:
 5024               		.stabn	68,0,1877,.LM414-.LFBB23
 5025               	.LM414:
 5026 1b16 81FD      		sbrc r24,1
 5027 1b18 00C0      		rjmp .L247
 5028 1b1a F7E0      		ldi r31,lo8(7)
 5029 1b1c 7F2E      		mov r7,r31
 5030 1b1e 00C0      		rjmp .L245
 5031               	.L247:
 5032               		.stabn	68,0,1879,.LM415-.LFBB23
 5033               	.LM415:
 5034 1b20 2A85      		ldd r18,Y+10
 5035 1b22 3B85      		ldd r19,Y+11
 5036 1b24 4C85      		ldd r20,Y+12
 5037 1b26 5D85      		ldd r21,Y+13
 5038 1b28 C401      		movw r24,r8
 5039 1b2a A0E0      		ldi r26,lo8(0)
 5040 1b2c B0E0      		ldi r27,hi8(0)
 5041 1b2e 820F      		add r24,r18
 5042 1b30 931F      		adc r25,r19
 5043 1b32 A41F      		adc r26,r20
 5044 1b34 B51F      		adc r27,r21
 5045 1b36 8217      		cp r24,r18
 5046 1b38 9307      		cpc r25,r19
 5047 1b3a A407      		cpc r26,r20
GAS LISTING /tmp/ccPugNTh.s 			page 132


 5048 1b3c B507      		cpc r27,r21
 5049 1b3e 00F4      		brsh .L248
 5050 1b40 8824      		clr r8
 5051 1b42 9924      		clr r9
 5052               	.L248:
 5053               		.stabn	68,0,1868,.LM416-.LFBB23
 5054               	.LM416:
 5055 1b44 812F      		mov r24,r17
 5056 1b46 902F      		mov r25,r16
 5057 1b48 9C01      		movw r18,r24
 5058 1b4a 2901      		movw r4,r18
 5059 1b4c 00C0      		rjmp .L249
 5060               	.L274:
 5061               		.stabn	68,0,1883,.LM417-.LFBB23
 5062               	.LM417:
 5063 1b4e 2E81      		ldd r18,Y+6
 5064 1b50 3F81      		ldd r19,Y+7
 5065 1b52 4885      		ldd r20,Y+8
 5066 1b54 5985      		ldd r21,Y+9
 5067 1b56 DA01      		movw r26,r20
 5068 1b58 C901      		movw r24,r18
 5069 1b5a 9170      		andi r25,hi8(511)
 5070 1b5c A070      		andi r26,hlo8(511)
 5071 1b5e B070      		andi r27,hhi8(511)
 5072 1b60 0097      		sbiw r24,0
 5073 1b62 A105      		cpc r26,__zero_reg__
 5074 1b64 B105      		cpc r27,__zero_reg__
 5075 1b66 01F0      		breq .+2
 5076 1b68 00C0      		rjmp .L250
 5077               		.stabn	68,0,1884,.LM418-.LFBB23
 5078               	.LM418:
 5079 1b6a E881      		ld r30,Y
 5080 1b6c F981      		ldd r31,Y+1
 5081 1b6e 9D81      		ldd r25,Y+5
 5082 1b70 8281      		ldd r24,Z+2
 5083 1b72 9817      		cp r25,r24
 5084 1b74 00F4      		brsh .+2
 5085 1b76 00C0      		rjmp .L251
 5086               		.stabn	68,0,1885,.LM419-.LFBB23
 5087               	.LM419:
 5088 1b78 2115      		cp r18,__zero_reg__
 5089 1b7a 3105      		cpc r19,__zero_reg__
 5090 1b7c 4105      		cpc r20,__zero_reg__
 5091 1b7e 5105      		cpc r21,__zero_reg__
 5092 1b80 01F4      		brne .L252
 5093               		.stabn	68,0,1886,.LM420-.LFBB23
 5094               	.LM420:
 5095 1b82 6E85      		ldd r22,Y+14
 5096 1b84 7F85      		ldd r23,Y+15
 5097 1b86 8889      		ldd r24,Y+16
 5098 1b88 9989      		ldd r25,Y+17
 5099               		.stabn	68,0,1887,.LM421-.LFBB23
 5100               	.LM421:
 5101 1b8a 6115      		cp r22,__zero_reg__
 5102 1b8c 7105      		cpc r23,__zero_reg__
 5103 1b8e 8105      		cpc r24,__zero_reg__
 5104 1b90 9105      		cpc r25,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 133


 5105 1b92 01F4      		brne .L253
 5106               		.stabn	68,0,1888,.LM422-.LFBB23
 5107               	.LM422:
 5108 1b94 CF01      		movw r24,r30
 5109 1b96 40E0      		ldi r20,lo8(0)
 5110 1b98 50E0      		ldi r21,hi8(0)
 5111 1b9a 60E0      		ldi r22,hlo8(0)
 5112 1b9c 70E0      		ldi r23,hhi8(0)
 5113 1b9e 0E94 0000 		call create_chain
 5114 1ba2 6E87      		std Y+14,r22
 5115 1ba4 7F87      		std Y+15,r23
 5116 1ba6 888B      		std Y+16,r24
 5117 1ba8 998B      		std Y+17,r25
 5118 1baa 00C0      		rjmp .L254
 5119               	.L252:
 5120               		.stabn	68,0,1890,.LM423-.LFBB23
 5121               	.LM423:
 5122 1bac 4A89      		ldd r20,Y+18
 5123 1bae 5B89      		ldd r21,Y+19
 5124 1bb0 6C89      		ldd r22,Y+20
 5125 1bb2 7D89      		ldd r23,Y+21
 5126 1bb4 CF01      		movw r24,r30
 5127 1bb6 0E94 0000 		call create_chain
 5128               	.L254:
 5129               		.stabn	68,0,1892,.LM424-.LFBB23
 5130               	.LM424:
 5131 1bba 6115      		cp r22,__zero_reg__
 5132 1bbc 7105      		cpc r23,__zero_reg__
 5133 1bbe 8105      		cpc r24,__zero_reg__
 5134 1bc0 9105      		cpc r25,__zero_reg__
 5135 1bc2 01F4      		brne .+2
 5136 1bc4 00C0      		rjmp .L255
 5137               	.L253:
 5138               		.stabn	68,0,1893,.LM425-.LFBB23
 5139               	.LM425:
 5140 1bc6 6130      		cpi r22,lo8(1)
 5141 1bc8 7105      		cpc r23,__zero_reg__
 5142 1bca 8105      		cpc r24,__zero_reg__
 5143 1bcc 9105      		cpc r25,__zero_reg__
 5144 1bce 01F4      		brne .L256
 5145               	.L279:
 5146 1bd0 8C81      		ldd r24,Y+4
 5147 1bd2 8068      		ori r24,lo8(-128)
 5148 1bd4 8C83      		std Y+4,r24
 5149               	.L277:
 5150 1bd6 E2E0      		ldi r30,lo8(2)
 5151 1bd8 7E2E      		mov r7,r30
 5152 1bda 00C0      		rjmp .L245
 5153               	.L256:
 5154               		.stabn	68,0,1894,.LM426-.LFBB23
 5155               	.LM426:
 5156 1bdc 6F3F      		cpi r22,lo8(-1)
 5157 1bde FFEF      		ldi r31,hi8(-1)
 5158 1be0 7F07      		cpc r23,r31
 5159 1be2 FFEF      		ldi r31,hlo8(-1)
 5160 1be4 8F07      		cpc r24,r31
 5161 1be6 FFEF      		ldi r31,hhi8(-1)
GAS LISTING /tmp/ccPugNTh.s 			page 134


 5162 1be8 9F07      		cpc r25,r31
 5163 1bea 01F4      		brne .+2
 5164 1bec 00C0      		rjmp .L278
 5165               	.L257:
 5166               		.stabn	68,0,1895,.LM427-.LFBB23
 5167               	.LM427:
 5168 1bee 6A8B      		std Y+18,r22
 5169 1bf0 7B8B      		std Y+19,r23
 5170 1bf2 8C8B      		std Y+20,r24
 5171 1bf4 9D8B      		std Y+21,r25
 5172               		.stabn	68,0,1896,.LM428-.LFBB23
 5173               	.LM428:
 5174 1bf6 1D82      		std Y+5,__zero_reg__
 5175               	.L251:
 5176               		.stabn	68,0,1899,.LM429-.LFBB23
 5177               	.LM429:
 5178 1bf8 E881      		ld r30,Y
 5179 1bfa F981      		ldd r31,Y+1
 5180 1bfc 22A5      		ldd r18,Z+42
 5181 1bfe 33A5      		ldd r19,Z+43
 5182 1c00 44A5      		ldd r20,Z+44
 5183 1c02 55A5      		ldd r21,Z+45
 5184 1c04 8E89      		ldd r24,Y+22
 5185 1c06 9F89      		ldd r25,Y+23
 5186 1c08 A88D      		ldd r26,Y+24
 5187 1c0a B98D      		ldd r27,Y+25
 5188 1c0c 2817      		cp r18,r24
 5189 1c0e 3907      		cpc r19,r25
 5190 1c10 4A07      		cpc r20,r26
 5191 1c12 5B07      		cpc r21,r27
 5192 1c14 01F4      		brne .L258
 5193 1c16 CF01      		movw r24,r30
 5194 1c18 40E0      		ldi r20,lo8(0)
 5195 1c1a 50E0      		ldi r21,hi8(0)
 5196 1c1c 60E0      		ldi r22,hlo8(0)
 5197 1c1e 70E0      		ldi r23,hhi8(0)
 5198 1c20 0E94 0000 		call move_window
 5199 1c24 8823      		tst r24
 5200 1c26 01F0      		breq .+2
 5201 1c28 00C0      		rjmp .L278
 5202               	.L258:
 5203               		.stabn	68,0,1908,.LM430-.LFBB23
 5204               	.LM430:
 5205 1c2a 0881      		ld r16,Y
 5206 1c2c 1981      		ldd r17,Y+1
 5207               	.LBB100:
 5208               	.LBB101:
 5209               		.stabn	68,0,532,.LM431-.LFBB23
 5210               	.LM431:
 5211 1c2e 2A89      		ldd r18,Y+18
 5212 1c30 3B89      		ldd r19,Y+19
 5213 1c32 4C89      		ldd r20,Y+20
 5214 1c34 5D89      		ldd r21,Y+21
 5215 1c36 2250      		subi r18,lo8(-(-2))
 5216 1c38 3040      		sbci r19,hi8(-(-2))
 5217 1c3a 4040      		sbci r20,hlo8(-(-2))
 5218 1c3c 5040      		sbci r21,hhi8(-(-2))
GAS LISTING /tmp/ccPugNTh.s 			page 135


 5219               		.stabn	68,0,533,.LM432-.LFBB23
 5220               	.LM432:
 5221 1c3e F801      		movw r30,r16
 5222 1c40 828D      		ldd r24,Z+26
 5223 1c42 938D      		ldd r25,Z+27
 5224 1c44 A48D      		ldd r26,Z+28
 5225 1c46 B58D      		ldd r27,Z+29
 5226 1c48 0297      		sbiw r24,2
 5227 1c4a A109      		sbc r26,__zero_reg__
 5228 1c4c B109      		sbc r27,__zero_reg__
 5229 1c4e 2817      		cp r18,r24
 5230 1c50 3907      		cpc r19,r25
 5231 1c52 4A07      		cpc r20,r26
 5232 1c54 5B07      		cpc r21,r27
 5233 1c56 00F0      		brlo .+2
 5234 1c58 00C0      		rjmp .L279
 5235               		.stabn	68,0,534,.LM433-.LFBB23
 5236               	.LM433:
 5237 1c5a 6280      		ldd r6,Z+2
 5238 1c5c 662D      		mov r22,r6
 5239 1c5e 70E0      		ldi r23,lo8(0)
 5240 1c60 80E0      		ldi r24,lo8(0)
 5241 1c62 90E0      		ldi r25,hi8(0)
 5242 1c64 0E94 0000 		call __mulsi3
 5243 1c68 9B01      		movw r18,r22
 5244 1c6a AC01      		movw r20,r24
 5245 1c6c F801      		movw r30,r16
 5246 1c6e 86A1      		ldd r24,Z+38
 5247 1c70 97A1      		ldd r25,Z+39
 5248 1c72 A0A5      		ldd r26,Z+40
 5249 1c74 B1A5      		ldd r27,Z+41
 5250 1c76 280F      		add r18,r24
 5251 1c78 391F      		adc r19,r25
 5252 1c7a 4A1F      		adc r20,r26
 5253 1c7c 5B1F      		adc r21,r27
 5254               	.LBE101:
 5255               	.LBE100:
 5256               		.stabn	68,0,1909,.LM434-.LFBB23
 5257               	.LM434:
 5258 1c7e 2115      		cp r18,__zero_reg__
 5259 1c80 3105      		cpc r19,__zero_reg__
 5260 1c82 4105      		cpc r20,__zero_reg__
 5261 1c84 5105      		cpc r21,__zero_reg__
 5262 1c86 01F4      		brne .+2
 5263 1c88 00C0      		rjmp .L279
 5264               	.L260:
 5265               		.stabn	68,0,1910,.LM435-.LFBB23
 5266               	.LM435:
 5267 1c8a 8D81      		ldd r24,Y+5
 5268 1c8c 5901      		movw r10,r18
 5269 1c8e 6A01      		movw r12,r20
 5270 1c90 A80E      		add r10,r24
 5271 1c92 B11C      		adc r11,__zero_reg__
 5272 1c94 C11C      		adc r12,__zero_reg__
 5273 1c96 D11C      		adc r13,__zero_reg__
 5274               		.stabn	68,0,1911,.LM436-.LFBB23
 5275               	.LM436:
GAS LISTING /tmp/ccPugNTh.s 			page 136


 5276 1c98 7401      		movw r14,r8
 5277 1c9a EF2C      		mov r14,r15
 5278 1c9c FF24      		clr r15
 5279 1c9e E694      		lsr r14
 5280               		.stabn	68,0,1912,.LM437-.LFBB23
 5281               	.LM437:
 5282 1ca0 E114      		cp r14,__zero_reg__
 5283 1ca2 F104      		cpc r15,__zero_reg__
 5284 1ca4 01F4      		brne .+2
 5285 1ca6 00C0      		rjmp .L261
 5286               		.stabn	68,0,1913,.LM438-.LFBB23
 5287               	.LM438:
 5288 1ca8 282F      		mov r18,r24
 5289 1caa 30E0      		ldi r19,lo8(0)
 5290 1cac C701      		movw r24,r14
 5291 1cae 820F      		add r24,r18
 5292 1cb0 931F      		adc r25,r19
 5293 1cb2 662D      		mov r22,r6
 5294 1cb4 70E0      		ldi r23,lo8(0)
 5295 1cb6 6817      		cp r22,r24
 5296 1cb8 7907      		cpc r23,r25
 5297 1cba 00F4      		brsh .L262
 5298               		.stabn	68,0,1914,.LM439-.LFBB23
 5299               	.LM439:
 5300 1cbc 7B01      		movw r14,r22
 5301 1cbe E21A      		sub r14,r18
 5302 1cc0 F30A      		sbc r15,r19
 5303               	.L262:
 5304               		.stabn	68,0,1915,.LM440-.LFBB23
 5305               	.LM440:
 5306 1cc2 F801      		movw r30,r16
 5307 1cc4 8181      		ldd r24,Z+1
 5308 1cc6 B201      		movw r22,r4
 5309 1cc8 A601      		movw r20,r12
 5310 1cca 9501      		movw r18,r10
 5311 1ccc 0E2D      		mov r16,r14
 5312 1cce 0E94 0000 		call disk_write
 5313 1cd2 8823      		tst r24
 5314 1cd4 01F0      		breq .+2
 5315 1cd6 00C0      		rjmp .L278
 5316               	.L263:
 5317               		.stabn	68,0,1918,.LM441-.LFBB23
 5318               	.LM441:
 5319 1cd8 E881      		ld r30,Y
 5320 1cda F981      		ldd r31,Y+1
 5321 1cdc 22A5      		ldd r18,Z+42
 5322 1cde 33A5      		ldd r19,Z+43
 5323 1ce0 44A5      		ldd r20,Z+44
 5324 1ce2 55A5      		ldd r21,Z+45
 5325 1ce4 2A19      		sub r18,r10
 5326 1ce6 3B09      		sbc r19,r11
 5327 1ce8 4C09      		sbc r20,r12
 5328 1cea 5D09      		sbc r21,r13
 5329 1cec C701      		movw r24,r14
 5330 1cee A0E0      		ldi r26,lo8(0)
 5331 1cf0 B0E0      		ldi r27,hi8(0)
 5332 1cf2 2817      		cp r18,r24
GAS LISTING /tmp/ccPugNTh.s 			page 137


 5333 1cf4 3907      		cpc r19,r25
 5334 1cf6 4A07      		cpc r20,r26
 5335 1cf8 5B07      		cpc r21,r27
 5336 1cfa 00F4      		brsh .L264
 5337               	.LBB102:
 5338               	.LBB103:
 5339               		.stabn	68,0,177,.LM442-.LFBB23
 5340               	.LM442:
 5341 1cfc DF01      		movw r26,r30
 5342 1cfe 9E96      		adiw r26,46
 5343               		.stabn	68,0,178,.LM443-.LFBB23
 5344               	.LM443:
 5345 1d00 69E0      		ldi r22,9
 5346 1d02 220F      	1:	lsl r18
 5347 1d04 331F      		rol r19
 5348 1d06 441F      		rol r20
 5349 1d08 551F      		rol r21
 5350 1d0a 6A95      		dec r22
 5351 1d0c 01F4      		brne 1b
 5352 1d0e F201      		movw r30,r4
 5353 1d10 E20F      		add r30,r18
 5354 1d12 F31F      		adc r31,r19
 5355               		.stabn	68,0,179,.LM444-.LFBB23
 5356               	.LM444:
 5357 1d14 9F01      		movw r18,r30
 5358 1d16 2050      		subi r18,lo8(-(512))
 5359 1d18 3E4F      		sbci r19,hi8(-(512))
 5360 1d1a 00C0      		rjmp .L265
 5361               	.L266:
 5362 1d1c 8191      		ld r24,Z+
 5363 1d1e 8D93      		st X+,r24
 5364               	.L265:
 5365 1d20 E217      		cp r30,r18
 5366 1d22 F307      		cpc r31,r19
 5367 1d24 01F4      		brne .L266
 5368               	.LBE103:
 5369               	.LBE102:
 5370               		.stabn	68,0,1920,.LM445-.LFBB23
 5371               	.LM445:
 5372 1d26 E881      		ld r30,Y
 5373 1d28 F981      		ldd r31,Y+1
 5374 1d2a 1482      		std Z+4,__zero_reg__
 5375               	.L264:
 5376               		.stabn	68,0,1928,.LM446-.LFBB23
 5377               	.LM446:
 5378 1d2c 8D81      		ldd r24,Y+5
 5379 1d2e 8E0D      		add r24,r14
 5380 1d30 8D83      		std Y+5,r24
 5381               		.stabn	68,0,1929,.LM447-.LFBB23
 5382               	.LM447:
 5383 1d32 B701      		movw r22,r14
 5384 1d34 762F      		mov r23,r22
 5385 1d36 6627      		clr r22
 5386 1d38 770F      		lsl r23
 5387 1d3a 00C0      		rjmp .L267
 5388               	.L261:
 5389               		.stabn	68,0,1933,.LM448-.LFBB23
GAS LISTING /tmp/ccPugNTh.s 			page 138


 5390               	.LM448:
 5391 1d3c 2E81      		ldd r18,Y+6
 5392 1d3e 3F81      		ldd r19,Y+7
 5393 1d40 4885      		ldd r20,Y+8
 5394 1d42 5985      		ldd r21,Y+9
 5395 1d44 8A85      		ldd r24,Y+10
 5396 1d46 9B85      		ldd r25,Y+11
 5397 1d48 AC85      		ldd r26,Y+12
 5398 1d4a BD85      		ldd r27,Y+13
 5399 1d4c 2817      		cp r18,r24
 5400 1d4e 3907      		cpc r19,r25
 5401 1d50 4A07      		cpc r20,r26
 5402 1d52 5B07      		cpc r21,r27
 5403 1d54 00F0      		brlo .L268
 5404               		.stabn	68,0,1934,.LM449-.LFBB23
 5405               	.LM449:
 5406 1d56 C801      		movw r24,r16
 5407 1d58 40E0      		ldi r20,lo8(0)
 5408 1d5a 50E0      		ldi r21,hi8(0)
 5409 1d5c 60E0      		ldi r22,hlo8(0)
 5410 1d5e 70E0      		ldi r23,hhi8(0)
 5411 1d60 0E94 0000 		call move_window
 5412 1d64 8823      		tst r24
 5413 1d66 01F4      		brne .L278
 5414               	.L269:
 5415               		.stabn	68,0,1935,.LM450-.LFBB23
 5416               	.LM450:
 5417 1d68 E881      		ld r30,Y
 5418 1d6a F981      		ldd r31,Y+1
 5419 1d6c A2A6      		std Z+42,r10
 5420 1d6e B3A6      		std Z+43,r11
 5421 1d70 C4A6      		std Z+44,r12
 5422 1d72 D5A6      		std Z+45,r13
 5423               	.L268:
 5424               		.stabn	68,0,1944,.LM451-.LFBB23
 5425               	.LM451:
 5426 1d74 AE8A      		std Y+22,r10
 5427 1d76 BF8A      		std Y+23,r11
 5428 1d78 C88E      		std Y+24,r12
 5429 1d7a D98E      		std Y+25,r13
 5430               		.stabn	68,0,1945,.LM452-.LFBB23
 5431               	.LM452:
 5432 1d7c 8D81      		ldd r24,Y+5
 5433 1d7e 8F5F      		subi r24,lo8(-(1))
 5434 1d80 8D83      		std Y+5,r24
 5435               	.L250:
 5436               		.stabn	68,0,1947,.LM453-.LFBB23
 5437               	.LM453:
 5438 1d82 CE80      		ldd r12,Y+6
 5439 1d84 DF80      		ldd r13,Y+7
 5440 1d86 E884      		ldd r14,Y+8
 5441 1d88 F984      		ldd r15,Y+9
 5442               		.stabn	68,0,1950,.LM454-.LFBB23
 5443               	.LM454:
 5444 1d8a 4E89      		ldd r20,Y+22
 5445 1d8c 5F89      		ldd r21,Y+23
 5446 1d8e 688D      		ldd r22,Y+24
GAS LISTING /tmp/ccPugNTh.s 			page 139


 5447 1d90 798D      		ldd r23,Y+25
 5448 1d92 8881      		ld r24,Y
 5449 1d94 9981      		ldd r25,Y+1
 5450 1d96 0E94 0000 		call move_window
 5451 1d9a 8823      		tst r24
 5452 1d9c 01F0      		breq .L270
 5453               	.L278:
 5454               		.stabn	68,0,1951,.LM455-.LFBB23
 5455               	.LM455:
 5456 1d9e 8C81      		ldd r24,Y+4
 5457 1da0 8068      		ori r24,lo8(-128)
 5458 1da2 8C83      		std Y+4,r24
 5459 1da4 7724      		clr r7
 5460 1da6 7394      		inc r7
 5461 1da8 00C0      		rjmp .L245
 5462               	.L270:
 5463               		.stabn	68,0,1947,.LM456-.LFBB23
 5464               	.LM456:
 5465 1daa C601      		movw r24,r12
 5466 1dac 9170      		andi r25,hi8(511)
 5467 1dae 20E0      		ldi r18,lo8(512)
 5468 1db0 32E0      		ldi r19,hi8(512)
 5469 1db2 281B      		sub r18,r24
 5470 1db4 390B      		sbc r19,r25
 5471 1db6 B401      		movw r22,r8
 5472 1db8 2815      		cp r18,r8
 5473 1dba 3905      		cpc r19,r9
 5474 1dbc 00F4      		brsh .L271
 5475 1dbe B901      		movw r22,r18
 5476               	.L271:
 5477               		.stabn	68,0,1952,.LM457-.LFBB23
 5478               	.LM457:
 5479 1dc0 9B01      		movw r18,r22
 5480               	.LBB104:
 5481               	.LBB105:
 5482               		.stabn	68,0,177,.LM458-.LFBB23
 5483               	.LM458:
 5484 1dc2 8E81      		ldd r24,Y+6
 5485 1dc4 9F81      		ldd r25,Y+7
 5486 1dc6 9170      		andi r25,hi8(511)
 5487 1dc8 8E96      		adiw r24,46
 5488 1dca E881      		ld r30,Y
 5489 1dcc F981      		ldd r31,Y+1
 5490 1dce E80F      		add r30,r24
 5491 1dd0 F91F      		adc r31,r25
 5492 1dd2 D201      		movw r26,r4
 5493 1dd4 00C0      		rjmp .L272
 5494               	.L273:
 5495               		.stabn	68,0,179,.LM459-.LFBB23
 5496               	.LM459:
 5497 1dd6 8D91      		ld r24,X+
 5498 1dd8 8193      		st Z+,r24
 5499               	.L272:
 5500 1dda 2150      		subi r18,lo8(-(-1))
 5501 1ddc 3040      		sbci r19,hi8(-(-1))
 5502 1dde 8FEF      		ldi r24,hi8(-1)
 5503 1de0 2F3F      		cpi r18,lo8(-1)
GAS LISTING /tmp/ccPugNTh.s 			page 140


 5504 1de2 3807      		cpc r19,r24
 5505 1de4 01F4      		brne .L273
 5506               	.LBE105:
 5507               	.LBE104:
 5508               		.stabn	68,0,1953,.LM460-.LFBB23
 5509               	.LM460:
 5510 1de6 E881      		ld r30,Y
 5511 1de8 F981      		ldd r31,Y+1
 5512 1dea 21E0      		ldi r18,lo8(1)
 5513 1dec 2483      		std Z+4,r18
 5514               	.L267:
 5515               		.stabn	68,0,1882,.LM461-.LFBB23
 5516               	.LM461:
 5517 1dee 460E      		add r4,r22
 5518 1df0 571E      		adc r5,r23
 5519 1df2 CB01      		movw r24,r22
 5520 1df4 A0E0      		ldi r26,lo8(0)
 5521 1df6 B0E0      		ldi r27,hi8(0)
 5522 1df8 2E81      		ldd r18,Y+6
 5523 1dfa 3F81      		ldd r19,Y+7
 5524 1dfc 4885      		ldd r20,Y+8
 5525 1dfe 5985      		ldd r21,Y+9
 5526 1e00 280F      		add r18,r24
 5527 1e02 391F      		adc r19,r25
 5528 1e04 4A1F      		adc r20,r26
 5529 1e06 5B1F      		adc r21,r27
 5530 1e08 2E83      		std Y+6,r18
 5531 1e0a 3F83      		std Y+7,r19
 5532 1e0c 4887      		std Y+8,r20
 5533 1e0e 5987      		std Y+9,r21
 5534 1e10 F101      		movw r30,r2
 5535 1e12 8081      		ld r24,Z
 5536 1e14 9181      		ldd r25,Z+1
 5537 1e16 860F      		add r24,r22
 5538 1e18 971F      		adc r25,r23
 5539 1e1a 9183      		std Z+1,r25
 5540 1e1c 8083      		st Z,r24
 5541 1e1e 861A      		sub r8,r22
 5542 1e20 970A      		sbc r9,r23
 5543               	.L249:
 5544               		.stabn	68,0,1881,.LM462-.LFBB23
 5545               	.LM462:
 5546 1e22 8114      		cp r8,__zero_reg__
 5547 1e24 9104      		cpc r9,__zero_reg__
 5548 1e26 01F0      		breq .+2
 5549 1e28 00C0      		rjmp .L274
 5550               	.L255:
 5551               		.stabn	68,0,1960,.LM463-.LFBB23
 5552               	.LM463:
 5553 1e2a 2E81      		ldd r18,Y+6
 5554 1e2c 3F81      		ldd r19,Y+7
 5555 1e2e 4885      		ldd r20,Y+8
 5556 1e30 5985      		ldd r21,Y+9
 5557 1e32 8A85      		ldd r24,Y+10
 5558 1e34 9B85      		ldd r25,Y+11
 5559 1e36 AC85      		ldd r26,Y+12
 5560 1e38 BD85      		ldd r27,Y+13
GAS LISTING /tmp/ccPugNTh.s 			page 141


 5561 1e3a 8217      		cp r24,r18
 5562 1e3c 9307      		cpc r25,r19
 5563 1e3e A407      		cpc r26,r20
 5564 1e40 B507      		cpc r27,r21
 5565 1e42 00F4      		brsh .L275
 5566 1e44 2A87      		std Y+10,r18
 5567 1e46 3B87      		std Y+11,r19
 5568 1e48 4C87      		std Y+12,r20
 5569 1e4a 5D87      		std Y+13,r21
 5570               	.L275:
 5571               		.stabn	68,0,1961,.LM464-.LFBB23
 5572               	.LM464:
 5573 1e4c 8C81      		ldd r24,Y+4
 5574 1e4e 8062      		ori r24,lo8(32)
 5575 1e50 8C83      		std Y+4,r24
 5576               	.L245:
 5577               		.stabn	68,0,1964,.LM465-.LFBB23
 5578               	.LM465:
 5579 1e52 872D      		mov r24,r7
 5580               	/* epilogue start */
 5581 1e54 DF91      		pop r29
 5582 1e56 CF91      		pop r28
 5583 1e58 1F91      		pop r17
 5584 1e5a 0F91      		pop r16
 5585 1e5c FF90      		pop r15
 5586 1e5e EF90      		pop r14
 5587 1e60 DF90      		pop r13
 5588 1e62 CF90      		pop r12
 5589 1e64 BF90      		pop r11
 5590 1e66 AF90      		pop r10
 5591 1e68 9F90      		pop r9
 5592 1e6a 8F90      		pop r8
 5593 1e6c 7F90      		pop r7
 5594 1e6e 6F90      		pop r6
 5595 1e70 5F90      		pop r5
 5596 1e72 4F90      		pop r4
 5597 1e74 3F90      		pop r3
 5598 1e76 2F90      		pop r2
 5599 1e78 0895      		ret
 5600               		.size	f_write, .-f_write
 5601               		.stabs	"res:r(1,16)",64,0,1865,7
 5602               		.stabs	"clst:r(2,12)",64,0,1866,22
 5603               		.stabs	"sect:r(2,12)",64,0,1866,10
 5604               		.stabs	"wcnt:r(2,2)",64,0,1867,22
 5605               		.stabs	"cc:r(2,2)",64,0,1867,14
 5606               		.stabs	"wbuff:r(0,26)=*(0,27)=k(2,5)",64,0,1868,4
 5607               		.stabn	192,0,0,.LFBB23-.LFBB23
 5608               		.stabs	"clst:r(2,12)",64,0,1908,18
 5609               		.stabn	192,0,0,.LBB100-.LFBB23
 5610               		.stabn	224,0,0,.LBE100-.LFBB23
 5611               		.stabs	"d:r(0,18)",64,0,177,26
 5612               		.stabn	192,0,0,.LBB103-.LFBB23
 5613               		.stabn	224,0,0,.LBE103-.LFBB23
 5614               		.stabs	"cnt:r(0,1)",64,0,1952,18
 5615               		.stabn	192,0,0,.LBB104-.LFBB23
 5616               		.stabs	"d:r(0,18)",64,0,177,30
 5617               		.stabn	192,0,0,.LBB105-.LFBB23
GAS LISTING /tmp/ccPugNTh.s 			page 142


 5618               		.stabn	224,0,0,.LBE105-.LFBB23
 5619               		.stabn	224,0,0,.LBE104-.LFBB23
 5620               		.stabn	224,0,0,.Lscope23-.LFBB23
 5621               	.Lscope23:
 5622               		.stabs	"",36,0,0,.Lscope23-.LFBB23
 5623               		.stabd	78,0,0
 5624               		.stabs	"f_putc:F(0,1)",36,0,3031,f_putc
 5625               		.stabs	"chr:P(0,1)",64,0,3028,14
 5626               		.stabs	"fil:P(0,23)",64,0,3029,16
 5627               	.global	f_putc
 5628               		.type	f_putc, @function
 5629               	f_putc:
 5630               		.stabd	46,0,0
2419:ff.c          **** 
2420:ff.c          **** 
2421:ff.c          **** 
2422:ff.c          **** 
2423:ff.c          **** /*-----------------------------------------------------------------------*/
2424:ff.c          **** /* Delete a File or Directory                                            */
2425:ff.c          **** /*-----------------------------------------------------------------------*/
2426:ff.c          **** 
2427:ff.c          **** FRESULT f_unlink (
2428:ff.c          **** 	const XCHAR *path		/* Pointer to the file or directory path */
2429:ff.c          **** )
2430:ff.c          **** {
2431:ff.c          **** 	FRESULT res;
2432:ff.c          **** 	DIR dj, sdj;
2433:ff.c          **** 	NAMEBUF(sfn, lfn);
2434:ff.c          **** 	BYTE *dir;
2435:ff.c          **** 	DWORD dclst;
2436:ff.c          **** 
2437:ff.c          **** 
2438:ff.c          **** 	res = chk_mounted(&path, &dj.fs, 1);
2439:ff.c          **** 	if (res != FR_OK) LEAVE_FF(dj.fs, res);
2440:ff.c          **** 
2441:ff.c          **** 	INITBUF(dj, sfn, lfn);
2442:ff.c          **** 	res = follow_path(&dj, path);			/* Follow the file path */
2443:ff.c          **** 	if (_FS_RPATH && res == FR_OK && (dj.fn[NS] & NS_DOT))
2444:ff.c          **** 		res = FR_INVALID_NAME;
2445:ff.c          **** 	if (res != FR_OK) LEAVE_FF(dj.fs, res); /* Follow failed */
2446:ff.c          **** 
2447:ff.c          **** 	dir = dj.dir;
2448:ff.c          **** 	if (!dir)								/* Is it the root directory? */
2449:ff.c          **** 		LEAVE_FF(dj.fs, FR_INVALID_NAME);
2450:ff.c          **** 	if (dir[DIR_Attr] & AM_RDO)				/* Is it a R/O object? */
2451:ff.c          **** 		LEAVE_FF(dj.fs, FR_DENIED);
2452:ff.c          **** 	dclst = ((DWORD)LD_WORD(dir+DIR_FstClusHI) << 16) | LD_WORD(dir+DIR_FstClusLO);
2453:ff.c          **** 
2454:ff.c          **** 	if (dir[DIR_Attr] & AM_DIR) {			/* It is a sub-directory */
2455:ff.c          **** 		if (dclst < 2) LEAVE_FF(dj.fs, FR_INT_ERR);
2456:ff.c          **** 		mem_cpy(&sdj, &dj, sizeof(DIR));	/* Check if the sub-dir is empty or not */
2457:ff.c          **** 		sdj.sclust = dclst;
2458:ff.c          **** 		res = dir_seek(&sdj, 2);
2459:ff.c          **** 		if (res != FR_OK) LEAVE_FF(dj.fs, res);
2460:ff.c          **** 		res = dir_read(&sdj);
2461:ff.c          **** 		if (res == FR_OK) res = FR_DENIED;	/* Not empty sub-dir */
2462:ff.c          **** 		if (res != FR_NO_FILE) LEAVE_FF(dj.fs, res);
GAS LISTING /tmp/ccPugNTh.s 			page 143


2463:ff.c          **** 	}
2464:ff.c          **** 
2465:ff.c          **** 	res = dir_remove(&dj);					/* Remove directory entry */
2466:ff.c          **** 	if (res == FR_OK) {
2467:ff.c          **** 		if (dclst)
2468:ff.c          **** 			res = remove_chain(dj.fs, dclst);	/* Remove the cluster chain */
2469:ff.c          **** 		if (res == FR_OK) res = sync(dj.fs);
2470:ff.c          **** 	}
2471:ff.c          **** 
2472:ff.c          **** 	LEAVE_FF(dj.fs, res);
2473:ff.c          **** }
2474:ff.c          **** 
2475:ff.c          **** 
2476:ff.c          **** 
2477:ff.c          **** 
2478:ff.c          **** /*-----------------------------------------------------------------------*/
2479:ff.c          **** /* Create a Directory                                                    */
2480:ff.c          **** /*-----------------------------------------------------------------------*/
2481:ff.c          **** 
2482:ff.c          **** FRESULT f_mkdir (
2483:ff.c          **** 	const XCHAR *path		/* Pointer to the directory path */
2484:ff.c          **** )
2485:ff.c          **** {
2486:ff.c          **** 	FRESULT res;
2487:ff.c          **** 	DIR dj;
2488:ff.c          **** 	NAMEBUF(sfn, lfn);
2489:ff.c          **** 	BYTE *dir, n;
2490:ff.c          **** 	DWORD dsect, dclst, pclst, tim;
2491:ff.c          **** 
2492:ff.c          **** 
2493:ff.c          **** 	res = chk_mounted(&path, &dj.fs, 1);
2494:ff.c          **** 	if (res != FR_OK) LEAVE_FF(dj.fs, res);
2495:ff.c          **** 
2496:ff.c          **** 	INITBUF(dj, sfn, lfn);
2497:ff.c          **** 	res = follow_path(&dj, path);			/* Follow the file path */
2498:ff.c          **** 	if (res == FR_OK) res = FR_EXIST;		/* Any file or directory is already existing */
2499:ff.c          **** 	if (_FS_RPATH && res == FR_NO_FILE && (dj.fn[NS] & NS_DOT))
2500:ff.c          **** 		res = FR_INVALID_NAME;
2501:ff.c          **** 	if (res != FR_NO_FILE)					/* Any error occured */
2502:ff.c          **** 		LEAVE_FF(dj.fs, res);
2503:ff.c          **** 
2504:ff.c          **** 	dclst = create_chain(dj.fs, 0);			/* Allocate a new cluster for new directory table */
2505:ff.c          **** 	res = FR_OK;
2506:ff.c          **** 	if (dclst == 0) res = FR_DENIED;
2507:ff.c          **** 	if (dclst == 1) res = FR_INT_ERR;
2508:ff.c          **** 	if (dclst == 0xFFFFFFFF) res = FR_DISK_ERR;
2509:ff.c          **** 	if (res == FR_OK)
2510:ff.c          **** 		res = move_window(dj.fs, 0);
2511:ff.c          **** 	if (res != FR_OK) LEAVE_FF(dj.fs, res);
2512:ff.c          **** 	dsect = clust2sect(dj.fs, dclst);
2513:ff.c          **** 
2514:ff.c          **** 	dir = dj.fs->win;						/* Initialize the new directory table */
2515:ff.c          **** 	mem_set(dir, 0, SS(dj.fs));
2516:ff.c          **** 	mem_set(dir+DIR_Name, ' ', 8+3);		/* Create "." entry */
2517:ff.c          **** 	dir[DIR_Name] = '.';
2518:ff.c          **** 	dir[DIR_Attr] = AM_DIR;
2519:ff.c          **** 	tim = get_fattime();
GAS LISTING /tmp/ccPugNTh.s 			page 144


2520:ff.c          **** 	ST_DWORD(dir+DIR_WrtTime, tim);
2521:ff.c          **** 	ST_WORD(dir+DIR_FstClusLO, dclst);
2522:ff.c          **** 	ST_WORD(dir+DIR_FstClusHI, dclst >> 16);
2523:ff.c          **** 	mem_cpy(dir+32, dir, 32); 			/* Create ".." entry */
2524:ff.c          **** 	dir[33] = '.';
2525:ff.c          **** 	pclst = dj.sclust;
2526:ff.c          **** 	if (dj.fs->fs_type == FS_FAT32 && pclst == dj.fs->dirbase)
2527:ff.c          **** 		pclst = 0;
2528:ff.c          **** 	ST_WORD(dir+32+DIR_FstClusLO, pclst);
2529:ff.c          **** 	ST_WORD(dir+32+DIR_FstClusHI, pclst >> 16);
2530:ff.c          **** 	for (n = 0; n < dj.fs->csize; n++) {	/* Write dot entries and clear left sectors */
2531:ff.c          **** 		dj.fs->winsect = dsect++;
2532:ff.c          **** 		dj.fs->wflag = 1;
2533:ff.c          **** 		res = move_window(dj.fs, 0);
2534:ff.c          **** 		if (res) LEAVE_FF(dj.fs, res);
2535:ff.c          **** 		mem_set(dir, 0, SS(dj.fs));
2536:ff.c          **** 	}
2537:ff.c          **** 
2538:ff.c          **** 	res = dir_register(&dj);
2539:ff.c          **** 	if (res != FR_OK) {
2540:ff.c          **** 		remove_chain(dj.fs, dclst);
2541:ff.c          **** 	} else {
2542:ff.c          **** 		dir = dj.dir;
2543:ff.c          **** 		dir[DIR_Attr] = AM_DIR;					/* Attribute */
2544:ff.c          **** 		ST_DWORD(dir+DIR_WrtTime, tim);			/* Crated time */
2545:ff.c          **** 		ST_WORD(dir+DIR_FstClusLO, dclst);		/* Table start cluster */
2546:ff.c          **** 		ST_WORD(dir+DIR_FstClusHI, dclst >> 16);
2547:ff.c          **** 		dj.fs->wflag = 1;
2548:ff.c          **** 		res = sync(dj.fs);
2549:ff.c          **** 	}
2550:ff.c          **** 
2551:ff.c          **** 	LEAVE_FF(dj.fs, res);
2552:ff.c          **** }
2553:ff.c          **** 
2554:ff.c          **** 
2555:ff.c          **** 
2556:ff.c          **** 
2557:ff.c          **** /*-----------------------------------------------------------------------*/
2558:ff.c          **** /* Change File Attribute                                                 */
2559:ff.c          **** /*-----------------------------------------------------------------------*/
2560:ff.c          **** 
2561:ff.c          **** FRESULT f_chmod (
2562:ff.c          **** 	const XCHAR *path,	/* Pointer to the file path */
2563:ff.c          **** 	BYTE value,			/* Attribute bits */
2564:ff.c          **** 	BYTE mask			/* Attribute mask to change */
2565:ff.c          **** )
2566:ff.c          **** {
2567:ff.c          **** 	FRESULT res;
2568:ff.c          **** 	DIR dj;
2569:ff.c          **** 	NAMEBUF(sfn, lfn);
2570:ff.c          **** 	BYTE *dir;
2571:ff.c          **** 
2572:ff.c          **** 
2573:ff.c          **** 	res = chk_mounted(&path, &dj.fs, 1);
2574:ff.c          **** 	if (res == FR_OK) {
2575:ff.c          **** 		INITBUF(dj, sfn, lfn);
2576:ff.c          **** 		res = follow_path(&dj, path);		/* Follow the file path */
GAS LISTING /tmp/ccPugNTh.s 			page 145


2577:ff.c          **** 		if (_FS_RPATH && res == FR_OK && (dj.fn[NS] & NS_DOT))
2578:ff.c          **** 			res = FR_INVALID_NAME;
2579:ff.c          **** 		if (res == FR_OK) {
2580:ff.c          **** 			dir = dj.dir;
2581:ff.c          **** 			if (!dir) {						/* Is it a root directory? */
2582:ff.c          **** 				res = FR_INVALID_NAME;
2583:ff.c          **** 			} else {						/* File or sub directory */
2584:ff.c          **** 				mask &= AM_RDO|AM_HID|AM_SYS|AM_ARC;	/* Valid attribute mask */
2585:ff.c          **** 				dir[DIR_Attr] = (value & mask) | (dir[DIR_Attr] & (BYTE)~mask);	/* Apply attribute change */
2586:ff.c          **** 				dj.fs->wflag = 1;
2587:ff.c          **** 				res = sync(dj.fs);
2588:ff.c          **** 			}
2589:ff.c          **** 		}
2590:ff.c          **** 	}
2591:ff.c          **** 
2592:ff.c          **** 	LEAVE_FF(dj.fs, res);
2593:ff.c          **** }
2594:ff.c          **** 
2595:ff.c          **** 
2596:ff.c          **** 
2597:ff.c          **** 
2598:ff.c          **** /*-----------------------------------------------------------------------*/
2599:ff.c          **** /* Change Timestamp                                                      */
2600:ff.c          **** /*-----------------------------------------------------------------------*/
2601:ff.c          **** 
2602:ff.c          **** FRESULT f_utime (
2603:ff.c          **** 	const XCHAR *path,	/* Pointer to the file/directory name */
2604:ff.c          **** 	const FILINFO *fno	/* Pointer to the timestamp to be set */
2605:ff.c          **** )
2606:ff.c          **** {
2607:ff.c          **** 	FRESULT res;
2608:ff.c          **** 	DIR dj;
2609:ff.c          **** 	NAMEBUF(sfn, lfn);
2610:ff.c          **** 	BYTE *dir;
2611:ff.c          **** 
2612:ff.c          **** 
2613:ff.c          **** 	res = chk_mounted(&path, &dj.fs, 1);
2614:ff.c          **** 	if (res == FR_OK) {
2615:ff.c          **** 		INITBUF(dj, sfn, lfn);
2616:ff.c          **** 		res = follow_path(&dj, path);	/* Follow the file path */
2617:ff.c          **** 		if (_FS_RPATH && res == FR_OK && (dj.fn[NS] & NS_DOT))
2618:ff.c          **** 			res = FR_INVALID_NAME;
2619:ff.c          **** 		if (res == FR_OK) {
2620:ff.c          **** 			dir = dj.dir;
2621:ff.c          **** 			if (!dir) {				/* Root directory */
2622:ff.c          **** 				res = FR_INVALID_NAME;
2623:ff.c          **** 			} else {				/* File or sub-directory */
2624:ff.c          **** 				ST_WORD(dir+DIR_WrtTime, fno->ftime);
2625:ff.c          **** 				ST_WORD(dir+DIR_WrtDate, fno->fdate);
2626:ff.c          **** 				dj.fs->wflag = 1;
2627:ff.c          **** 				res = sync(dj.fs);
2628:ff.c          **** 			}
2629:ff.c          **** 		}
2630:ff.c          **** 	}
2631:ff.c          **** 
2632:ff.c          **** 	LEAVE_FF(dj.fs, res);
2633:ff.c          **** }
GAS LISTING /tmp/ccPugNTh.s 			page 146


2634:ff.c          **** 
2635:ff.c          **** 
2636:ff.c          **** 
2637:ff.c          **** 
2638:ff.c          **** /*-----------------------------------------------------------------------*/
2639:ff.c          **** /* Rename File/Directory                                                 */
2640:ff.c          **** /*-----------------------------------------------------------------------*/
2641:ff.c          **** 
2642:ff.c          **** FRESULT f_rename (
2643:ff.c          **** 	const XCHAR *path_old,	/* Pointer to the old name */
2644:ff.c          **** 	const XCHAR *path_new	/* Pointer to the new name */
2645:ff.c          **** )
2646:ff.c          **** {
2647:ff.c          **** 	FRESULT res;
2648:ff.c          **** 	DIR dj_old, dj_new;
2649:ff.c          **** 	NAMEBUF(sfn, lfn);
2650:ff.c          **** 	BYTE buf[21], *dir;
2651:ff.c          **** 	DWORD dw;
2652:ff.c          **** 
2653:ff.c          **** 
2654:ff.c          **** 	INITBUF(dj_old, sfn, lfn);
2655:ff.c          **** 	res = chk_mounted(&path_old, &dj_old.fs, 1);
2656:ff.c          **** 	if (res == FR_OK) {
2657:ff.c          **** 		dj_new.fs = dj_old.fs;
2658:ff.c          **** 		res = follow_path(&dj_old, path_old);	/* Check old object */
2659:ff.c          **** 		if (_FS_RPATH && res == FR_OK && (dj_old.fn[NS] & NS_DOT))
2660:ff.c          **** 			res = FR_INVALID_NAME;
2661:ff.c          **** 	}
2662:ff.c          **** 	if (res != FR_OK) LEAVE_FF(dj_old.fs, res);	/* The old object is not found */
2663:ff.c          **** 
2664:ff.c          **** 	if (!dj_old.dir) LEAVE_FF(dj_old.fs, FR_NO_FILE);	/* Is root dir? */
2665:ff.c          **** 	mem_cpy(buf, dj_old.dir+DIR_Attr, 21);		/* Save the object information */
2666:ff.c          **** 
2667:ff.c          **** 	mem_cpy(&dj_new, &dj_old, sizeof(DIR));
2668:ff.c          **** 	res = follow_path(&dj_new, path_new);		/* Check new object */
2669:ff.c          **** 	if (res == FR_OK) res = FR_EXIST;			/* The new object name is already existing */
2670:ff.c          **** 	if (res == FR_NO_FILE) { 					/* Is it a valid path and no name collision? */
2671:ff.c          **** 		res = dir_register(&dj_new);			/* Register the new object */
2672:ff.c          **** 		if (res == FR_OK) {
2673:ff.c          **** 			dir = dj_new.dir;					/* Copy object information into new entry */
2674:ff.c          **** 			mem_cpy(dir+13, buf+2, 19);
2675:ff.c          **** 			dir[DIR_Attr] = buf[0] | AM_ARC;
2676:ff.c          **** 			dj_old.fs->wflag = 1;
2677:ff.c          **** 			if (dir[DIR_Attr] & AM_DIR) {		/* Update .. entry in the directory if needed */
2678:ff.c          **** 				dw = clust2sect(dj_new.fs, (DWORD)LD_WORD(dir+DIR_FstClusHI) | LD_WORD(dir+DIR_FstClusLO));
2679:ff.c          **** 				if (!dw) {
2680:ff.c          **** 					res = FR_INT_ERR;
2681:ff.c          **** 				} else {
2682:ff.c          **** 					res = move_window(dj_new.fs, dw);
2683:ff.c          **** 					dir = dj_new.fs->win+32;
2684:ff.c          **** 					if (res == FR_OK && dir[1] == '.') {
2685:ff.c          **** 						dw = (dj_new.fs->fs_type == FS_FAT32 && dj_new.sclust == dj_new.fs->dirbase) ? 0 : dj_new.scl
2686:ff.c          **** 						ST_WORD(dir+DIR_FstClusLO, dw);
2687:ff.c          **** 						ST_WORD(dir+DIR_FstClusHI, dw >> 16);
2688:ff.c          **** 						dj_new.fs->wflag = 1;
2689:ff.c          **** 					}
2690:ff.c          **** 				}
GAS LISTING /tmp/ccPugNTh.s 			page 147


2691:ff.c          **** 			}
2692:ff.c          **** 			if (res == FR_OK) {
2693:ff.c          **** 				res = dir_remove(&dj_old);			/* Remove old entry */
2694:ff.c          **** 				if (res == FR_OK)
2695:ff.c          **** 					res = sync(dj_old.fs);
2696:ff.c          **** 			}
2697:ff.c          **** 		}
2698:ff.c          **** 	}
2699:ff.c          **** 
2700:ff.c          **** 	LEAVE_FF(dj_old.fs, res);
2701:ff.c          **** }
2702:ff.c          **** 
2703:ff.c          **** #endif /* !_FS_READONLY */
2704:ff.c          **** #endif /* _FS_MINIMIZE == 0 */
2705:ff.c          **** #endif /* _FS_MINIMIZE <= 1 */
2706:ff.c          **** #endif /* _FS_MINIMIZE <= 2 */
2707:ff.c          **** 
2708:ff.c          **** 
2709:ff.c          **** 
2710:ff.c          **** /*-----------------------------------------------------------------------*/
2711:ff.c          **** /* Forward data to the stream directly (Available on only _FS_TINY cfg)  */
2712:ff.c          **** /*-----------------------------------------------------------------------*/
2713:ff.c          **** #if _USE_FORWARD && _FS_TINY
2714:ff.c          **** 
2715:ff.c          **** FRESULT f_forward (
2716:ff.c          **** 	FIL *fp, 						/* Pointer to the file object */
2717:ff.c          **** 	UINT (*func)(const BYTE*,UINT),	/* Pointer to the streaming function */
2718:ff.c          **** 	UINT btr,						/* Number of bytes to forward */
2719:ff.c          **** 	UINT *bf						/* Pointer to number of bytes forwarded */
2720:ff.c          **** )
2721:ff.c          **** {
2722:ff.c          **** 	FRESULT res;
2723:ff.c          **** 	DWORD remain, clst, sect;
2724:ff.c          **** 	UINT rcnt;
2725:ff.c          **** 
2726:ff.c          **** 
2727:ff.c          **** 	*bf = 0;
2728:ff.c          **** 
2729:ff.c          **** 	res = validate(fp->fs, fp->id);					/* Check validity of the object */
2730:ff.c          **** 	if (res != FR_OK) LEAVE_FF(fp->fs, res);
2731:ff.c          **** 	if (fp->flag & FA__ERROR)						/* Check error flag */
2732:ff.c          **** 		LEAVE_FF(fp->fs, FR_INT_ERR);
2733:ff.c          **** 	if (!(fp->flag & FA_READ))						/* Check access mode */
2734:ff.c          **** 		LEAVE_FF(fp->fs, FR_DENIED);
2735:ff.c          **** 
2736:ff.c          **** 	remain = fp->fsize - fp->fptr;
2737:ff.c          **** 	if (btr > remain) btr = (UINT)remain;			/* Truncate btr by remaining bytes */
2738:ff.c          **** 
2739:ff.c          **** 	for ( ;  btr && (*func)(NULL, 0);				/* Repeat until all data transferred or stream becomes busy *
2740:ff.c          **** 		fp->fptr += rcnt, *bf += rcnt, btr -= rcnt) {
2741:ff.c          **** 		if ((fp->fptr % SS(fp->fs)) == 0) {			/* On the sector boundary? */
2742:ff.c          **** 			if (fp->csect >= fp->fs->csize) {		/* On the cluster boundary? */
2743:ff.c          **** 				clst = (fp->fptr == 0) ?			/* On the top of the file? */
2744:ff.c          **** 					fp->org_clust : get_fat(fp->fs, fp->curr_clust);
2745:ff.c          **** 				if (clst <= 1) ABORT(fp->fs, FR_INT_ERR);
2746:ff.c          **** 				if (clst == 0xFFFFFFFF) ABORT(fp->fs, FR_DISK_ERR);
2747:ff.c          **** 				fp->curr_clust = clst;				/* Update current cluster */
GAS LISTING /tmp/ccPugNTh.s 			page 148


2748:ff.c          **** 				fp->csect = 0;						/* Reset sector address in the cluster */
2749:ff.c          **** 			}
2750:ff.c          **** 			fp->csect++;							/* Next sector address in the cluster */
2751:ff.c          **** 		}
2752:ff.c          **** 		sect = clust2sect(fp->fs, fp->curr_clust);	/* Get current data sector */
2753:ff.c          **** 		if (!sect) ABORT(fp->fs, FR_INT_ERR);
2754:ff.c          **** 		sect += fp->csect - 1;
2755:ff.c          **** 		if (move_window(fp->fs, sect))				/* Move sector window */
2756:ff.c          **** 			ABORT(fp->fs, FR_DISK_ERR);
2757:ff.c          **** 		fp->dsect = sect;
2758:ff.c          **** 		rcnt = SS(fp->fs) - (WORD)(fp->fptr % SS(fp->fs));	/* Forward data from sector window */
2759:ff.c          **** 		if (rcnt > btr) rcnt = btr;
2760:ff.c          **** 		rcnt = (*func)(&fp->fs->win[(WORD)fp->fptr % SS(fp->fs)], rcnt);
2761:ff.c          **** 		if (!rcnt) ABORT(fp->fs, FR_INT_ERR);
2762:ff.c          **** 	}
2763:ff.c          **** 
2764:ff.c          **** 	LEAVE_FF(fp->fs, FR_OK);
2765:ff.c          **** }
2766:ff.c          **** #endif /* _USE_FORWARD */
2767:ff.c          **** 
2768:ff.c          **** 
2769:ff.c          **** 
2770:ff.c          **** #if _USE_MKFS && !_FS_READONLY
2771:ff.c          **** /*-----------------------------------------------------------------------*/
2772:ff.c          **** /* Create File System on the Drive                                       */
2773:ff.c          **** /*-----------------------------------------------------------------------*/
2774:ff.c          **** #define N_ROOTDIR	512			/* Multiple of 32 and <= 2048 */
2775:ff.c          **** #define N_FATS		1			/* 1 or 2 */
2776:ff.c          **** #define MAX_SECTOR	131072000UL	/* Maximum partition size */
2777:ff.c          **** #define MIN_SECTOR	2000UL		/* Minimum partition size */
2778:ff.c          **** 
2779:ff.c          **** 
2780:ff.c          **** FRESULT f_mkfs (
2781:ff.c          **** 	BYTE drv,			/* Logical drive number */
2782:ff.c          **** 	BYTE partition,		/* Partitioning rule 0:FDISK, 1:SFD */
2783:ff.c          **** 	WORD allocsize		/* Allocation unit size [bytes] */
2784:ff.c          **** )
2785:ff.c          **** {
2786:ff.c          **** 	static const DWORD sstbl[] = { 2048000, 1024000, 512000, 256000, 128000, 64000, 32000, 16000, 8000
2787:ff.c          **** 	static const WORD cstbl[] =  {   32768,   16384,   8192,   4096,   2048, 16384,  8192,  4096, 2048
2788:ff.c          **** 	BYTE fmt, m, *tbl;
2789:ff.c          **** 	DWORD b_part, b_fat, b_dir, b_data;		/* Area offset (LBA) */
2790:ff.c          **** 	DWORD n_part, n_rsv, n_fat, n_dir;		/* Area size */
2791:ff.c          **** 	DWORD n_clst, d, n;
2792:ff.c          **** 	WORD as;
2793:ff.c          **** 	FATFS *fs;
2794:ff.c          **** 	DSTATUS stat;
2795:ff.c          **** 
2796:ff.c          **** 
2797:ff.c          **** 	/* Check validity of the parameters */
2798:ff.c          **** 	if (drv >= _DRIVES) return FR_INVALID_DRIVE;
2799:ff.c          **** 	if (partition >= 2) return FR_MKFS_ABORTED;
2800:ff.c          **** 
2801:ff.c          **** 	/* Check mounted drive and clear work area */
2802:ff.c          **** 	fs = FatFs[drv];
2803:ff.c          **** 	if (!fs) return FR_NOT_ENABLED;
2804:ff.c          **** 	fs->fs_type = 0;
GAS LISTING /tmp/ccPugNTh.s 			page 149


2805:ff.c          **** 	drv = LD2PD(drv);
2806:ff.c          **** 
2807:ff.c          **** 	/* Get disk statics */
2808:ff.c          **** 	stat = disk_initialize(drv);
2809:ff.c          **** 	if (stat & STA_NOINIT) return FR_NOT_READY;
2810:ff.c          **** 	if (stat & STA_PROTECT) return FR_WRITE_PROTECTED;
2811:ff.c          **** #if _MAX_SS != 512						/* Get disk sector size */
2812:ff.c          **** 	if (disk_ioctl(drv, GET_SECTOR_SIZE, &SS(fs)) != RES_OK
2813:ff.c          **** 		|| SS(fs) > _MAX_SS)
2814:ff.c          **** 		return FR_MKFS_ABORTED;
2815:ff.c          **** #endif
2816:ff.c          **** 	if (disk_ioctl(drv, GET_SECTOR_COUNT, &n_part) != RES_OK || n_part < MIN_SECTOR)
2817:ff.c          **** 		return FR_MKFS_ABORTED;
2818:ff.c          **** 	if (n_part > MAX_SECTOR) n_part = MAX_SECTOR;
2819:ff.c          **** 	b_part = (!partition) ? 63 : 0;		/* Boot sector */
2820:ff.c          **** 	n_part -= b_part;
2821:ff.c          **** 	for (d = 512; d <= 32768U && d != allocsize; d <<= 1) ;	/* Check validity of the allocation unit s
2822:ff.c          **** 	if (d != allocsize) allocsize = 0;
2823:ff.c          **** 	if (!allocsize) {					/* Auto selection of cluster size */
2824:ff.c          **** 		d = n_part;
2825:ff.c          **** 		for (as = SS(fs); as > 512U; as >>= 1) d >>= 1;
2826:ff.c          **** 		for (n = 0; d < sstbl[n]; n++) ;
2827:ff.c          **** 		allocsize = cstbl[n];
2828:ff.c          **** 	}
2829:ff.c          **** 	if (allocsize < SS(fs)) allocsize = SS(fs);
2830:ff.c          **** 
2831:ff.c          **** 	allocsize /= SS(fs);		/* Number of sectors per cluster */
2832:ff.c          **** 
2833:ff.c          **** 	/* Pre-compute number of clusters and FAT type */
2834:ff.c          **** 	n_clst = n_part / allocsize;
2835:ff.c          **** 	fmt = FS_FAT12;
2836:ff.c          **** 	if (n_clst >= 0xFF5) fmt = FS_FAT16;
2837:ff.c          **** 	if (n_clst >= 0xFFF5) fmt = FS_FAT32;
2838:ff.c          **** 
2839:ff.c          **** 	/* Determine offset and size of FAT structure */
2840:ff.c          **** 	switch (fmt) {
2841:ff.c          **** 	case FS_FAT12:
2842:ff.c          **** 		n_fat = ((n_clst * 3 + 1) / 2 + 3 + SS(fs) - 1) / SS(fs);
2843:ff.c          **** 		n_rsv = 1 + partition;
2844:ff.c          **** 		n_dir = N_ROOTDIR * 32 / SS(fs);
2845:ff.c          **** 		break;
2846:ff.c          **** 	case FS_FAT16:
2847:ff.c          **** 		n_fat = ((n_clst * 2) + 4 + SS(fs) - 1) / SS(fs);
2848:ff.c          **** 		n_rsv = 1 + partition;
2849:ff.c          **** 		n_dir = N_ROOTDIR * 32 / SS(fs);
2850:ff.c          **** 		break;
2851:ff.c          **** 	default:
2852:ff.c          **** 		n_fat = ((n_clst * 4) + 8 + SS(fs) - 1) / SS(fs);
2853:ff.c          **** 		n_rsv = 33 - partition;
2854:ff.c          **** 		n_dir = 0;
2855:ff.c          **** 	}
2856:ff.c          **** 	b_fat = b_part + n_rsv;			/* FATs start sector */
2857:ff.c          **** 	b_dir = b_fat + n_fat * N_FATS;	/* Directory start sector */
2858:ff.c          **** 	b_data = b_dir + n_dir;			/* Data start sector */
2859:ff.c          **** 
2860:ff.c          **** 	/* Align data start sector to erase block boundary (for flash memory media) */
2861:ff.c          **** 	if (disk_ioctl(drv, GET_BLOCK_SIZE, &n) != RES_OK) return FR_MKFS_ABORTED;
GAS LISTING /tmp/ccPugNTh.s 			page 150


2862:ff.c          **** 	n = (b_data + n - 1) & ~(n - 1);
2863:ff.c          **** 	n_fat += (n - b_data) / N_FATS;
2864:ff.c          **** 	/* b_dir and b_data are no longer used below */
2865:ff.c          **** 
2866:ff.c          **** 	/* Determine number of cluster and final check of validity of the FAT type */
2867:ff.c          **** 	n_clst = (n_part - n_rsv - n_fat * N_FATS - n_dir) / allocsize;
2868:ff.c          **** 	if (   (fmt == FS_FAT16 && n_clst < 0xFF5)
2869:ff.c          **** 		|| (fmt == FS_FAT32 && n_clst < 0xFFF5))
2870:ff.c          **** 		return FR_MKFS_ABORTED;
2871:ff.c          **** 
2872:ff.c          **** 	/* Create partition table if needed */
2873:ff.c          **** 	if (!partition) {
2874:ff.c          **** 		DWORD n_disk = b_part + n_part;
2875:ff.c          **** 
2876:ff.c          **** 		mem_set(fs->win, 0, SS(fs));
2877:ff.c          **** 		tbl = fs->win+MBR_Table;
2878:ff.c          **** 		ST_DWORD(tbl, 0x00010180);		/* Partition start in CHS */
2879:ff.c          **** 		if (n_disk < 63UL * 255 * 1024) {	/* Partition end in CHS */
2880:ff.c          **** 			n_disk = n_disk / 63 / 255;
2881:ff.c          **** 			tbl[7] = (BYTE)n_disk;
2882:ff.c          **** 			tbl[6] = (BYTE)((n_disk >> 2) | 63);
2883:ff.c          **** 		} else {
2884:ff.c          **** 			ST_WORD(&tbl[6], 0xFFFF);
2885:ff.c          **** 		}
2886:ff.c          **** 		tbl[5] = 254;
2887:ff.c          **** 		if (fmt != FS_FAT32)			/* System ID */
2888:ff.c          **** 			tbl[4] = (n_part < 0x10000) ? 0x04 : 0x06;
2889:ff.c          **** 		else
2890:ff.c          **** 			tbl[4] = 0x0c;
2891:ff.c          **** 		ST_DWORD(tbl+8, 63);			/* Partition start in LBA */
2892:ff.c          **** 		ST_DWORD(tbl+12, n_part);		/* Partition size in LBA */
2893:ff.c          **** 		ST_WORD(tbl+64, 0xAA55);		/* Signature */
2894:ff.c          **** 		if (disk_write(drv, fs->win, 0, 1) != RES_OK)
2895:ff.c          **** 			return FR_DISK_ERR;
2896:ff.c          **** 		partition = 0xF8;
2897:ff.c          **** 	} else {
2898:ff.c          **** 		partition = 0xF0;
2899:ff.c          **** 	}
2900:ff.c          **** 
2901:ff.c          **** 	/* Create boot record */
2902:ff.c          **** 	tbl = fs->win;								/* Clear buffer */
2903:ff.c          **** 	mem_set(tbl, 0, SS(fs));
2904:ff.c          **** 	ST_DWORD(tbl+BS_jmpBoot, 0x90FEEB);			/* Boot code (jmp $, nop) */
2905:ff.c          **** 	ST_WORD(tbl+BPB_BytsPerSec, SS(fs));		/* Sector size */
2906:ff.c          **** 	tbl[BPB_SecPerClus] = (BYTE)allocsize;		/* Sectors per cluster */
2907:ff.c          **** 	ST_WORD(tbl+BPB_RsvdSecCnt, n_rsv);			/* Reserved sectors */
2908:ff.c          **** 	tbl[BPB_NumFATs] = N_FATS;					/* Number of FATs */
2909:ff.c          **** 	ST_WORD(tbl+BPB_RootEntCnt, SS(fs) / 32 * n_dir); /* Number of rootdir entries */
2910:ff.c          **** 	if (n_part < 0x10000) {						/* Number of total sectors */
2911:ff.c          **** 		ST_WORD(tbl+BPB_TotSec16, n_part);
2912:ff.c          **** 	} else {
2913:ff.c          **** 		ST_DWORD(tbl+BPB_TotSec32, n_part);
2914:ff.c          **** 	}
2915:ff.c          **** 	tbl[BPB_Media] = partition;					/* Media descripter */
2916:ff.c          **** 	ST_WORD(tbl+BPB_SecPerTrk, 63);				/* Number of sectors per track */
2917:ff.c          **** 	ST_WORD(tbl+BPB_NumHeads, 255);				/* Number of heads */
2918:ff.c          **** 	ST_DWORD(tbl+BPB_HiddSec, b_part);			/* Hidden sectors */
GAS LISTING /tmp/ccPugNTh.s 			page 151


2919:ff.c          **** 	n = get_fattime();							/* Use current time as a VSN */
2920:ff.c          **** 	if (fmt != FS_FAT32) {
2921:ff.c          **** 		ST_DWORD(tbl+BS_VolID, n);				/* Volume serial number */
2922:ff.c          **** 		ST_WORD(tbl+BPB_FATSz16, n_fat);		/* Number of secters per FAT */
2923:ff.c          **** 		tbl[BS_DrvNum] = 0x80;					/* Drive number */
2924:ff.c          **** 		tbl[BS_BootSig] = 0x29;					/* Extended boot signature */
2925:ff.c          **** 		mem_cpy(tbl+BS_VolLab, "NO NAME    FAT     ", 19);	/* Volume lavel, FAT signature */
2926:ff.c          **** 	} else {
2927:ff.c          **** 		ST_DWORD(tbl+BS_VolID32, n);			/* Volume serial number */
2928:ff.c          **** 		ST_DWORD(tbl+BPB_FATSz32, n_fat);		/* Number of secters per FAT */
2929:ff.c          **** 		ST_DWORD(tbl+BPB_RootClus, 2);			/* Root directory cluster (2) */
2930:ff.c          **** 		ST_WORD(tbl+BPB_FSInfo, 1);				/* FSInfo record offset (bs+1) */
2931:ff.c          **** 		ST_WORD(tbl+BPB_BkBootSec, 6);			/* Backup boot record offset (bs+6) */
2932:ff.c          **** 		tbl[BS_DrvNum32] = 0x80;				/* Drive number */
2933:ff.c          **** 		tbl[BS_BootSig32] = 0x29;				/* Extended boot signature */
2934:ff.c          **** 		mem_cpy(tbl+BS_VolLab32, "NO NAME    FAT32   ", 19);	/* Volume lavel, FAT signature */
2935:ff.c          **** 	}
2936:ff.c          **** 	ST_WORD(tbl+BS_55AA, 0xAA55);				/* Signature */
2937:ff.c          **** 	if (SS(fs) > 512U) {
2938:ff.c          **** 		ST_WORD(tbl+SS(fs)-2, 0xAA55);
2939:ff.c          **** 	}
2940:ff.c          **** 	if (disk_write(drv, tbl, b_part+0, 1) != RES_OK)
2941:ff.c          **** 		return FR_DISK_ERR;
2942:ff.c          **** 	if (fmt == FS_FAT32)
2943:ff.c          **** 		disk_write(drv, tbl, b_part+6, 1);
2944:ff.c          **** 
2945:ff.c          **** 	/* Initialize FAT area */
2946:ff.c          **** 	for (m = 0; m < N_FATS; m++) {
2947:ff.c          **** 		mem_set(tbl, 0, SS(fs));		/* 1st sector of the FAT  */
2948:ff.c          **** 		if (fmt != FS_FAT32) {
2949:ff.c          **** 			n = (fmt == FS_FAT12) ? 0x00FFFF00 : 0xFFFFFF00;
2950:ff.c          **** 			n |= partition;
2951:ff.c          **** 			ST_DWORD(tbl, n);				/* Reserve cluster #0-1 (FAT12/16) */
2952:ff.c          **** 		} else {
2953:ff.c          **** 			ST_DWORD(tbl+0, 0xFFFFFFF8);	/* Reserve cluster #0-1 (FAT32) */
2954:ff.c          **** 			ST_DWORD(tbl+4, 0xFFFFFFFF);
2955:ff.c          **** 			ST_DWORD(tbl+8, 0x0FFFFFFF);	/* Reserve cluster #2 for root dir */
2956:ff.c          **** 		}
2957:ff.c          **** 		if (disk_write(drv, tbl, b_fat++, 1) != RES_OK)
2958:ff.c          **** 			return FR_DISK_ERR;
2959:ff.c          **** 		mem_set(tbl, 0, SS(fs));		/* Following FAT entries are filled by zero */
2960:ff.c          **** 		for (n = 1; n < n_fat; n++) {
2961:ff.c          **** 			if (disk_write(drv, tbl, b_fat++, 1) != RES_OK)
2962:ff.c          **** 				return FR_DISK_ERR;
2963:ff.c          **** 		}
2964:ff.c          **** 	}
2965:ff.c          **** 
2966:ff.c          **** 	/* Initialize Root directory */
2967:ff.c          **** 	m = (BYTE)((fmt == FS_FAT32) ? allocsize : n_dir);
2968:ff.c          **** 	do {
2969:ff.c          **** 		if (disk_write(drv, tbl, b_fat++, 1) != RES_OK)
2970:ff.c          **** 			return FR_DISK_ERR;
2971:ff.c          **** 	} while (--m);
2972:ff.c          **** 
2973:ff.c          **** 	/* Create FSInfo record if needed */
2974:ff.c          **** 	if (fmt == FS_FAT32) {
2975:ff.c          **** 		ST_WORD(tbl+BS_55AA, 0xAA55);
GAS LISTING /tmp/ccPugNTh.s 			page 152


2976:ff.c          **** 		ST_DWORD(tbl+FSI_LeadSig, 0x41615252);
2977:ff.c          **** 		ST_DWORD(tbl+FSI_StrucSig, 0x61417272);
2978:ff.c          **** 		ST_DWORD(tbl+FSI_Free_Count, n_clst - 1);
2979:ff.c          **** 		ST_DWORD(tbl+FSI_Nxt_Free, 0xFFFFFFFF);
2980:ff.c          **** 		disk_write(drv, tbl, b_part+1, 1);
2981:ff.c          **** 		disk_write(drv, tbl, b_part+7, 1);
2982:ff.c          **** 	}
2983:ff.c          **** 
2984:ff.c          **** 	return (disk_ioctl(drv, CTRL_SYNC, (void*)NULL) == RES_OK) ? FR_OK : FR_DISK_ERR;
2985:ff.c          **** }
2986:ff.c          **** 
2987:ff.c          **** #endif /* _USE_MKFS && !_FS_READONLY */
2988:ff.c          **** 
2989:ff.c          **** 
2990:ff.c          **** 
2991:ff.c          **** 
2992:ff.c          **** #if _USE_STRFUNC
2993:ff.c          **** /*-----------------------------------------------------------------------*/
2994:ff.c          **** /* Get a string from the file                                            */
2995:ff.c          **** /*-----------------------------------------------------------------------*/
2996:ff.c          **** char* f_gets (
2997:ff.c          **** 	char* buff,	/* Pointer to the string buffer to read */
2998:ff.c          **** 	int len,	/* Size of string buffer */
2999:ff.c          **** 	FIL* fil	/* Pointer to the file object */
3000:ff.c          **** )
3001:ff.c          **** {
3002:ff.c          **** 	int i = 0;
3003:ff.c          **** 	char *p = buff;
3004:ff.c          **** 	UINT rc;
3005:ff.c          **** 
3006:ff.c          **** 
3007:ff.c          **** 	while (i < len - 1) {			/* Read bytes until buffer gets filled */
3008:ff.c          **** 		f_read(fil, p, 1, &rc);
3009:ff.c          **** 		if (rc != 1) break;			/* Break when no data to read */
3010:ff.c          **** #if _USE_STRFUNC >= 2
3011:ff.c          **** 		if (*p == '\r') continue;	/* Strip '\r' */
3012:ff.c          **** #endif
3013:ff.c          **** 		i++;
3014:ff.c          **** 		if (*p++ == '\n') break;	/* Break when reached end of line */
3015:ff.c          **** 	}
3016:ff.c          **** 	*p = 0;
3017:ff.c          **** 	return i ? buff : NULL;			/* When no data read (eof or error), return with error. */
3018:ff.c          **** }
3019:ff.c          **** 
3020:ff.c          **** 
3021:ff.c          **** 
3022:ff.c          **** #if !_FS_READONLY
3023:ff.c          **** #include <stdarg.h>
3024:ff.c          **** /*-----------------------------------------------------------------------*/
3025:ff.c          **** /* Put a character to the file                                           */
3026:ff.c          **** /*-----------------------------------------------------------------------*/
3027:ff.c          **** int f_putc (
3028:ff.c          **** 	int chr,	/* A character to be output */
3029:ff.c          **** 	FIL* fil	/* Ponter to the file object */
3030:ff.c          **** )
3031:ff.c          **** {
 5631               		.stabn	68,0,3031,.LM466-.LFBB24
GAS LISTING /tmp/ccPugNTh.s 			page 153


 5632               	.LM466:
 5633               	.LFBB24:
 5634 1e7a EF92      		push r14
 5635 1e7c FF92      		push r15
 5636 1e7e 0F93      		push r16
 5637 1e80 1F93      		push r17
 5638 1e82 DF93      		push r29
 5639 1e84 CF93      		push r28
 5640 1e86 00D0      		rcall .
 5641 1e88 0F92      		push __tmp_reg__
 5642 1e8a CDB7      		in r28,__SP_L__
 5643 1e8c DEB7      		in r29,__SP_H__
 5644               	/* prologue: function */
 5645               	/* frame size = 3 */
 5646 1e8e 7C01      		movw r14,r24
 5647 1e90 8B01      		movw r16,r22
3032:ff.c          **** 	UINT bw;
3033:ff.c          **** 	char c;
3034:ff.c          **** 
3035:ff.c          **** 
3036:ff.c          **** #if _USE_STRFUNC >= 2
3037:ff.c          **** 	if (chr == '\n') f_putc ('\r', fil);	/* LF -> CRLF conversion */
 5648               		.stabn	68,0,3037,.LM467-.LFBB24
 5649               	.LM467:
 5650 1e92 8AE0      		ldi r24,lo8(10)
 5651 1e94 E816      		cp r14,r24
 5652 1e96 F104      		cpc r15,__zero_reg__
 5653 1e98 01F4      		brne .L281
 5654 1e9a 8DE0      		ldi r24,lo8(13)
 5655 1e9c 90E0      		ldi r25,hi8(13)
 5656 1e9e 0E94 0000 		call f_putc
 5657               	.L281:
3038:ff.c          **** #endif
3039:ff.c          **** 	if (!fil) {	/* Special value may be used to switch the destination to any other device */
 5658               		.stabn	68,0,3039,.LM468-.LFBB24
 5659               	.LM468:
 5660 1ea2 0115      		cp r16,__zero_reg__
 5661 1ea4 1105      		cpc r17,__zero_reg__
 5662 1ea6 01F0      		breq .L282
3040:ff.c          **** 	/*	put_console(chr);	*/
3041:ff.c          **** 		return chr;
3042:ff.c          **** 	}
3043:ff.c          **** 	c = (char)chr;
 5663               		.stabn	68,0,3043,.LM469-.LFBB24
 5664               	.LM469:
 5665 1ea8 E982      		std Y+1,r14
3044:ff.c          **** 	f_write(fil, &c, 1, &bw);	/* Write a byte to the file */
 5666               		.stabn	68,0,3044,.LM470-.LFBB24
 5667               	.LM470:
 5668 1eaa C801      		movw r24,r16
 5669 1eac BE01      		movw r22,r28
 5670 1eae 6F5F      		subi r22,lo8(-(1))
 5671 1eb0 7F4F      		sbci r23,hi8(-(1))
 5672 1eb2 41E0      		ldi r20,lo8(1)
 5673 1eb4 50E0      		ldi r21,hi8(1)
 5674 1eb6 9E01      		movw r18,r28
 5675 1eb8 2E5F      		subi r18,lo8(-(2))
GAS LISTING /tmp/ccPugNTh.s 			page 154


 5676 1eba 3F4F      		sbci r19,hi8(-(2))
 5677 1ebc 0E94 0000 		call f_write
3045:ff.c          **** 	return bw ? chr : EOF;		/* Return the result */
 5678               		.stabn	68,0,3045,.LM471-.LFBB24
 5679               	.LM471:
 5680 1ec0 8A81      		ldd r24,Y+2
 5681 1ec2 9B81      		ldd r25,Y+3
 5682 1ec4 892B      		or r24,r25
 5683 1ec6 01F4      		brne .L282
 5684 1ec8 EE24      		clr r14
 5685 1eca EA94      		dec r14
 5686 1ecc FE2C      		mov r15,r14
 5687               	.L282:
3046:ff.c          **** }
 5688               		.stabn	68,0,3046,.LM472-.LFBB24
 5689               	.LM472:
 5690 1ece C701      		movw r24,r14
 5691               	/* epilogue start */
 5692 1ed0 0F90      		pop __tmp_reg__
 5693 1ed2 0F90      		pop __tmp_reg__
 5694 1ed4 0F90      		pop __tmp_reg__
 5695 1ed6 CF91      		pop r28
 5696 1ed8 DF91      		pop r29
 5697 1eda 1F91      		pop r17
 5698 1edc 0F91      		pop r16
 5699 1ede FF90      		pop r15
 5700 1ee0 EF90      		pop r14
 5701 1ee2 0895      		ret
 5702               		.size	f_putc, .-f_putc
 5703               		.stabs	"bw:(2,2)",128,0,3032,2
 5704               		.stabs	"c:(0,2)",128,0,3033,1
 5705               		.stabn	192,0,0,.LFBB24-.LFBB24
 5706               		.stabn	224,0,0,.Lscope24-.LFBB24
 5707               	.Lscope24:
 5708               		.stabs	"",36,0,0,.Lscope24-.LFBB24
 5709               		.stabd	78,0,0
 5710               		.stabs	"f_puts:F(0,1)",36,0,3058,f_puts
 5711               		.stabs	"str:P(0,21)",64,0,3055,16
 5712               		.stabs	"fil:P(0,23)",64,0,3056,14
 5713               	.global	f_puts
 5714               		.type	f_puts, @function
 5715               	f_puts:
 5716               		.stabd	46,0,0
3047:ff.c          **** 
3048:ff.c          **** 
3049:ff.c          **** 
3050:ff.c          **** 
3051:ff.c          **** /*-----------------------------------------------------------------------*/
3052:ff.c          **** /* Put a string to the file                                              */
3053:ff.c          **** /*-----------------------------------------------------------------------*/
3054:ff.c          **** int f_puts (
3055:ff.c          **** 	const char* str,	/* Pointer to the string to be output */
3056:ff.c          **** 	FIL* fil			/* Pointer to the file object */
3057:ff.c          **** )
3058:ff.c          **** {
 5717               		.stabn	68,0,3058,.LM473-.LFBB25
 5718               	.LM473:
GAS LISTING /tmp/ccPugNTh.s 			page 155


 5719               	.LFBB25:
 5720 1ee4 EF92      		push r14
 5721 1ee6 FF92      		push r15
 5722 1ee8 0F93      		push r16
 5723 1eea 1F93      		push r17
 5724 1eec CF93      		push r28
 5725 1eee DF93      		push r29
 5726               	/* prologue: function */
 5727               	/* frame size = 0 */
 5728 1ef0 8C01      		movw r16,r24
 5729 1ef2 7B01      		movw r14,r22
 5730               		.stabn	68,0,3058,.LM474-.LFBB25
 5731               	.LM474:
 5732 1ef4 C0E0      		ldi r28,lo8(0)
 5733 1ef6 D0E0      		ldi r29,hi8(0)
 5734 1ef8 00C0      		rjmp .L285
 5735               	.L288:
3059:ff.c          **** 	int n;
3060:ff.c          **** 
3061:ff.c          **** 
3062:ff.c          **** 	for (n = 0; *str; str++, n++) {
3063:ff.c          **** 		if (f_putc(*str, fil) == EOF) return EOF;
 5736               		.stabn	68,0,3063,.LM475-.LFBB25
 5737               	.LM475:
 5738 1efa 90E0      		ldi r25,lo8(0)
 5739 1efc B701      		movw r22,r14
 5740 1efe 0E94 0000 		call f_putc
 5741 1f02 8F5F      		subi r24,lo8(-1)
 5742 1f04 9F4F      		sbci r25,hi8(-1)
 5743 1f06 01F4      		brne .L286
 5744 1f08 CFEF      		ldi r28,lo8(-1)
 5745 1f0a DFEF      		ldi r29,hi8(-1)
 5746 1f0c 00C0      		rjmp .L287
 5747               	.L286:
 5748               		.stabn	68,0,3062,.LM476-.LFBB25
 5749               	.LM476:
 5750 1f0e 0F5F      		subi r16,lo8(-(1))
 5751 1f10 1F4F      		sbci r17,hi8(-(1))
 5752 1f12 2196      		adiw r28,1
 5753               	.L285:
 5754 1f14 F801      		movw r30,r16
 5755 1f16 8081      		ld r24,Z
 5756 1f18 8823      		tst r24
 5757 1f1a 01F4      		brne .L288
 5758               	.L287:
3064:ff.c          **** 	}
3065:ff.c          **** 	return n;
3066:ff.c          **** }
 5759               		.stabn	68,0,3066,.LM477-.LFBB25
 5760               	.LM477:
 5761 1f1c CE01      		movw r24,r28
 5762               	/* epilogue start */
 5763 1f1e DF91      		pop r29
 5764 1f20 CF91      		pop r28
 5765 1f22 1F91      		pop r17
 5766 1f24 0F91      		pop r16
 5767 1f26 FF90      		pop r15
GAS LISTING /tmp/ccPugNTh.s 			page 156


 5768 1f28 EF90      		pop r14
 5769 1f2a 0895      		ret
 5770               		.size	f_puts, .-f_puts
 5771               		.stabs	"n:r(0,1)",64,0,3059,28
 5772               		.stabn	192,0,0,.LFBB25-.LFBB25
 5773               		.stabn	224,0,0,.Lscope25-.LFBB25
 5774               	.Lscope25:
 5775               		.stabs	"",36,0,0,.Lscope25-.LFBB25
 5776               		.stabd	78,0,0
 5777               		.stabs	"f_printf:F(0,1)",36,0,3079,f_printf
 5778               		.stabs	"fil:p(0,23)",160,0,3075,40
 5779               		.stabs	"str:p(0,21)",160,0,3076,42
 5780               	.global	f_printf
 5781               		.type	f_printf, @function
 5782               	f_printf:
 5783               		.stabd	46,0,0
3067:ff.c          **** 
3068:ff.c          **** 
3069:ff.c          **** 
3070:ff.c          **** 
3071:ff.c          **** /*-----------------------------------------------------------------------*/
3072:ff.c          **** /* Put a formatted string to the file                                    */
3073:ff.c          **** /*-----------------------------------------------------------------------*/
3074:ff.c          **** int f_printf (
3075:ff.c          **** 	FIL* fil,			/* Pointer to the file object */
3076:ff.c          **** 	const char* str,	/* Pointer to the format string */
3077:ff.c          **** 	...					/* Optional arguments... */
3078:ff.c          **** )
3079:ff.c          **** {
 5784               		.stabn	68,0,3079,.LM478-.LFBB26
 5785               	.LM478:
 5786               	.LFBB26:
 5787 1f2c 2F92      		push r2
 5788 1f2e 3F92      		push r3
 5789 1f30 4F92      		push r4
 5790 1f32 5F92      		push r5
 5791 1f34 6F92      		push r6
 5792 1f36 7F92      		push r7
 5793 1f38 8F92      		push r8
 5794 1f3a 9F92      		push r9
 5795 1f3c AF92      		push r10
 5796 1f3e BF92      		push r11
 5797 1f40 CF92      		push r12
 5798 1f42 DF92      		push r13
 5799 1f44 EF92      		push r14
 5800 1f46 FF92      		push r15
 5801 1f48 0F93      		push r16
 5802 1f4a 1F93      		push r17
 5803 1f4c DF93      		push r29
 5804 1f4e CF93      		push r28
 5805 1f50 CDB7      		in r28,__SP_L__
 5806 1f52 DEB7      		in r29,__SP_H__
 5807 1f54 6397      		sbiw r28,19
 5808 1f56 0FB6      		in __tmp_reg__,__SREG__
 5809 1f58 F894      		cli
 5810 1f5a DEBF      		out __SP_H__,r29
 5811 1f5c 0FBE      		out __SREG__,__tmp_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 157


 5812 1f5e CDBF      		out __SP_L__,r28
 5813               	/* prologue: function */
 5814               	/* frame size = 19 */
 5815 1f60 6AA4      		ldd r6,Y+42
 5816 1f62 7BA4      		ldd r7,Y+43
 5817               		.stabn	68,0,3079,.LM479-.LFBB26
 5818               	.LM479:
 5819 1f64 8E01      		movw r16,r28
 5820 1f66 045D      		subi r16,lo8(-(44))
 5821 1f68 1F4F      		sbci r17,hi8(-(44))
 5822 1f6a 1A8A      		std Y+18,__zero_reg__
 5823 1f6c 198A      		std Y+17,__zero_reg__
 5824 1f6e 20E0      		ldi r18,lo8(0)
 5825 1f70 30E0      		ldi r19,hi8(0)
 5826               	.L318:
3080:ff.c          **** 	va_list arp;
3081:ff.c          **** 	UCHAR c, f, r;
3082:ff.c          **** 	ULONG val;
3083:ff.c          **** 	char s[16];
3084:ff.c          **** 	int i, w, res, cc;
3085:ff.c          **** 
3086:ff.c          **** 
3087:ff.c          **** 	va_start(arp, str);
3088:ff.c          **** 
3089:ff.c          **** 	for (cc = res = 0; cc != EOF; res += cc) {
3090:ff.c          **** 		c = *str++;
 5827               		.stabn	68,0,3090,.LM480-.LFBB26
 5828               	.LM480:
 5829 1f72 D301      		movw r26,r6
 5830 1f74 8C91      		ld r24,X
3091:ff.c          **** 		if (c == 0) break;			/* End of string */
 5831               		.stabn	68,0,3091,.LM481-.LFBB26
 5832               	.LM481:
 5833 1f76 8823      		tst r24
 5834 1f78 01F4      		brne .+2
 5835 1f7a 00C0      		rjmp .L291
 5836               		.stabn	68,0,3090,.LM482-.LFBB26
 5837               	.LM482:
 5838 1f7c 0894      		sec
 5839 1f7e 611C      		adc r6,__zero_reg__
 5840 1f80 711C      		adc r7,__zero_reg__
3092:ff.c          **** 		if (c != '%') {				/* Non escape cahracter */
 5841               		.stabn	68,0,3092,.LM483-.LFBB26
 5842               	.LM483:
 5843 1f82 8532      		cpi r24,lo8(37)
 5844 1f84 01F0      		breq .L292
3093:ff.c          **** 			cc = f_putc(c, fil);
 5845               		.stabn	68,0,3093,.LM484-.LFBB26
 5846               	.LM484:
 5847 1f86 90E0      		ldi r25,lo8(0)
 5848 1f88 68A5      		ldd r22,Y+40
 5849 1f8a 79A5      		ldd r23,Y+41
 5850 1f8c 0E94 0000 		call f_putc
 5851 1f90 9C01      		movw r18,r24
3094:ff.c          **** 			if (cc != EOF) cc = 1;
 5852               		.stabn	68,0,3094,.LM485-.LFBB26
 5853               	.LM485:
GAS LISTING /tmp/ccPugNTh.s 			page 158


 5854 1f92 BFEF      		ldi r27,hi8(-1)
 5855 1f94 8F3F      		cpi r24,lo8(-1)
 5856 1f96 9B07      		cpc r25,r27
 5857 1f98 01F4      		brne .L293
 5858 1f9a 4801      		movw r8,r16
 5859 1f9c 00C0      		rjmp .L294
 5860               	.L293:
 5861 1f9e 4801      		movw r8,r16
 5862 1fa0 00C0      		rjmp .L321
 5863               	.L292:
3095:ff.c          **** 			continue;
3096:ff.c          **** 		}
3097:ff.c          **** 		w = f = 0;
3098:ff.c          **** 		c = *str++;
 5864               		.stabn	68,0,3098,.LM486-.LFBB26
 5865               	.LM486:
 5866 1fa2 D301      		movw r26,r6
 5867 1fa4 ED91      		ld r30,X+
 5868 1fa6 3D01      		movw r6,r26
3099:ff.c          **** 		if (c == '0') {				/* Flag: '0' padding */
 5869               		.stabn	68,0,3099,.LM487-.LFBB26
 5870               	.LM487:
 5871 1fa8 E033      		cpi r30,lo8(48)
 5872 1faa 01F0      		breq .L295
 5873 1fac 1B8A      		std Y+19,__zero_reg__
 5874 1fae 00C0      		rjmp .L296
 5875               	.L295:
3100:ff.c          **** 			f = 1; c = *str++;
 5876               		.stabn	68,0,3100,.LM488-.LFBB26
 5877               	.LM488:
 5878 1fb0 ED91      		ld r30,X+
 5879 1fb2 3D01      		movw r6,r26
 5880 1fb4 B1E0      		ldi r27,lo8(1)
 5881 1fb6 BB8B      		std Y+19,r27
 5882               	.L296:
 5883 1fb8 AA24      		clr r10
 5884 1fba BB24      		clr r11
 5885 1fbc 00C0      		rjmp .L297
 5886               	.L298:
3101:ff.c          **** 		}
3102:ff.c          **** 		while (c >= '0' && c <= '9') {	/* Precision */
3103:ff.c          **** 			w = w * 10 + (c - '0');
 5887               		.stabn	68,0,3103,.LM489-.LFBB26
 5888               	.LM489:
 5889 1fbe C501      		movw r24,r10
 5890 1fc0 53E0      		ldi r21,3
 5891 1fc2 880F      	1:	lsl r24
 5892 1fc4 991F      		rol r25
 5893 1fc6 5A95      		dec r21
 5894 1fc8 01F4      		brne 1b
 5895 1fca AA0C      		lsl r10
 5896 1fcc BB1C      		rol r11
 5897 1fce A80E      		add r10,r24
 5898 1fd0 B91E      		adc r11,r25
 5899 1fd2 AE0E      		add r10,r30
 5900 1fd4 B11C      		adc r11,__zero_reg__
 5901 1fd6 E0ED      		ldi r30,lo8(-48)
GAS LISTING /tmp/ccPugNTh.s 			page 159


 5902 1fd8 FFEF      		ldi r31,hi8(-48)
 5903 1fda AE0E      		add r10,r30
 5904 1fdc BF1E      		adc r11,r31
3104:ff.c          **** 			c = *str++;
 5905               		.stabn	68,0,3104,.LM490-.LFBB26
 5906               	.LM490:
 5907 1fde D301      		movw r26,r6
 5908 1fe0 ED91      		ld r30,X+
 5909 1fe2 3D01      		movw r6,r26
 5910               	.L297:
 5911               		.stabn	68,0,3102,.LM491-.LFBB26
 5912               	.LM491:
 5913 1fe4 8E2F      		mov r24,r30
 5914 1fe6 8053      		subi r24,lo8(-(-48))
 5915 1fe8 8A30      		cpi r24,lo8(10)
 5916 1fea 00F0      		brlo .L298
3105:ff.c          **** 		}
3106:ff.c          **** 		if (c == 'l') {				/* Prefix: Size is long int */
 5917               		.stabn	68,0,3106,.LM492-.LFBB26
 5918               	.LM492:
 5919 1fec EC36      		cpi r30,lo8(108)
 5920 1fee 01F4      		brne .L299
3107:ff.c          **** 			f |= 2; c = *str++;
 5921               		.stabn	68,0,3107,.LM493-.LFBB26
 5922               	.LM493:
 5923 1ff0 BB89      		ldd r27,Y+19
 5924 1ff2 B260      		ori r27,lo8(2)
 5925 1ff4 BB8B      		std Y+19,r27
 5926 1ff6 D301      		movw r26,r6
 5927 1ff8 ED91      		ld r30,X+
 5928 1ffa 3D01      		movw r6,r26
 5929               	.L299:
3108:ff.c          **** 		}
3109:ff.c          **** 		if (c == 's') {				/* Type is string */
 5930               		.stabn	68,0,3109,.LM494-.LFBB26
 5931               	.LM494:
 5932 1ffc E337      		cpi r30,lo8(115)
 5933 1ffe 01F4      		brne .L300
3110:ff.c          **** 			cc = f_puts(va_arg(arp, char*), fil);
 5934               		.stabn	68,0,3110,.LM495-.LFBB26
 5935               	.LM495:
 5936 2000 92E0      		ldi r25,lo8(2)
 5937 2002 892E      		mov r8,r25
 5938 2004 912C      		mov r9,__zero_reg__
 5939 2006 800E      		add r8,r16
 5940 2008 911E      		adc r9,r17
 5941 200a F801      		movw r30,r16
 5942 200c 8081      		ld r24,Z
 5943 200e 9181      		ldd r25,Z+1
 5944 2010 00C0      		rjmp .L322
 5945               	.L300:
3111:ff.c          **** 			continue;
3112:ff.c          **** 		}
3113:ff.c          **** 		if (c == 'c') {				/* Type is character */
 5946               		.stabn	68,0,3113,.LM496-.LFBB26
 5947               	.LM496:
 5948 2012 E336      		cpi r30,lo8(99)
GAS LISTING /tmp/ccPugNTh.s 			page 160


 5949 2014 01F4      		brne .L301
3114:ff.c          **** 			cc = f_putc(va_arg(arp, int), fil);
 5950               		.stabn	68,0,3114,.LM497-.LFBB26
 5951               	.LM497:
 5952 2016 82E0      		ldi r24,lo8(2)
 5953 2018 882E      		mov r8,r24
 5954 201a 912C      		mov r9,__zero_reg__
 5955 201c 800E      		add r8,r16
 5956 201e 911E      		adc r9,r17
 5957 2020 D801      		movw r26,r16
 5958 2022 8D91      		ld r24,X+
 5959 2024 9C91      		ld r25,X
 5960 2026 68A5      		ldd r22,Y+40
 5961 2028 79A5      		ldd r23,Y+41
 5962 202a 0E94 0000 		call f_putc
 5963 202e 9C01      		movw r18,r24
3115:ff.c          **** 			if (cc != EOF) cc = 1;
 5964               		.stabn	68,0,3115,.LM498-.LFBB26
 5965               	.LM498:
 5966 2030 BFEF      		ldi r27,hi8(-1)
 5967 2032 8F3F      		cpi r24,lo8(-1)
 5968 2034 9B07      		cpc r25,r27
 5969 2036 01F4      		brne .+2
 5970 2038 00C0      		rjmp .L294
 5971               	.L321:
 5972 203a 21E0      		ldi r18,lo8(1)
 5973 203c 30E0      		ldi r19,hi8(1)
 5974 203e 00C0      		rjmp .L294
 5975               	.L301:
3116:ff.c          **** 			continue;
3117:ff.c          **** 		}
3118:ff.c          **** 		r = 0;
3119:ff.c          **** 		if (c == 'd') r = 10;		/* Type is signed decimal */
 5976               		.stabn	68,0,3119,.LM499-.LFBB26
 5977               	.LM499:
 5978 2040 E436      		cpi r30,lo8(100)
 5979 2042 01F0      		breq .L302
3120:ff.c          **** 		if (c == 'u') r = 10;		/* Type is unsigned decimal */
 5980               		.stabn	68,0,3120,.LM500-.LFBB26
 5981               	.LM500:
 5982 2044 E537      		cpi r30,lo8(117)
 5983 2046 01F0      		breq .L302
3121:ff.c          **** 		if (c == 'X') r = 16;		/* Type is unsigned hexdecimal */
 5984               		.stabn	68,0,3121,.LM501-.LFBB26
 5985               	.LM501:
 5986 2048 E835      		cpi r30,lo8(88)
 5987 204a 01F0      		breq .+2
 5988 204c 00C0      		rjmp .L291
 5989 204e 20E1      		ldi r18,lo8(16)
 5990 2050 00C0      		rjmp .L303
 5991               	.L302:
 5992 2052 2AE0      		ldi r18,lo8(10)
 5993               	.L303:
3122:ff.c          **** 		if (r == 0) break;			/* Unknown type */
3123:ff.c          **** 		if (f & 2) {				/* Get the value */
 5994               		.stabn	68,0,3123,.LM502-.LFBB26
 5995               	.LM502:
GAS LISTING /tmp/ccPugNTh.s 			page 161


 5996 2054 FB89      		ldd r31,Y+19
 5997 2056 F1FF      		sbrs r31,1
 5998 2058 00C0      		rjmp .L304
3124:ff.c          **** 			val = (ULONG)va_arg(arp, long);
 5999               		.stabn	68,0,3124,.LM503-.LFBB26
 6000               	.LM503:
 6001 205a B4E0      		ldi r27,lo8(4)
 6002 205c 8B2E      		mov r8,r27
 6003 205e 912C      		mov r9,__zero_reg__
 6004 2060 800E      		add r8,r16
 6005 2062 911E      		adc r9,r17
 6006 2064 D801      		movw r26,r16
 6007 2066 ED90      		ld r14,X+
 6008 2068 FD90      		ld r15,X+
 6009 206a 0D91      		ld r16,X+
 6010 206c 1C91      		ld r17,X
3125:ff.c          **** 		} else {
3126:ff.c          **** 			val = (c == 'd') ? (ULONG)(long)va_arg(arp, int) : (ULONG)va_arg(arp, unsigned int);
3127:ff.c          **** 		}
3128:ff.c          **** 		/* Put numeral string */
3129:ff.c          **** 		if (c == 'd') {
 6011               		.stabn	68,0,3129,.LM504-.LFBB26
 6012               	.LM504:
 6013 206e E436      		cpi r30,lo8(100)
 6014 2070 01F4      		brne .L306
 6015 2072 00C0      		rjmp .L305
 6016               	.L304:
 6017 2074 C801      		movw r24,r16
 6018 2076 0296      		adiw r24,2
 6019 2078 D801      		movw r26,r16
 6020 207a 6D91      		ld r22,X+
 6021 207c 7C91      		ld r23,X
 6022               		.stabn	68,0,3126,.LM505-.LFBB26
 6023               	.LM505:
 6024 207e E436      		cpi r30,lo8(100)
 6025 2080 01F4      		brne .L307
 6026 2082 4C01      		movw r8,r24
 6027 2084 7B01      		movw r14,r22
 6028 2086 0027      		clr r16
 6029 2088 F7FC      		sbrc r15,7
 6030 208a 0095      		com r16
 6031 208c 102F      		mov r17,r16
 6032 208e 00C0      		rjmp .L305
 6033               	.L307:
 6034 2090 4C01      		movw r8,r24
 6035 2092 7B01      		movw r14,r22
 6036 2094 00E0      		ldi r16,lo8(0)
 6037 2096 10E0      		ldi r17,hi8(0)
 6038 2098 00C0      		rjmp .L306
 6039               	.L305:
3130:ff.c          **** 			if (val & 0x80000000) {
 6040               		.stabn	68,0,3130,.LM506-.LFBB26
 6041               	.LM506:
 6042 209a 17FF      		sbrs r17,7
 6043 209c 00C0      		rjmp .L306
3131:ff.c          **** 				val = 0 - val;
 6044               		.stabn	68,0,3131,.LM507-.LFBB26
GAS LISTING /tmp/ccPugNTh.s 			page 162


 6045               	.LM507:
 6046 209e 1095      		com r17
 6047 20a0 0095      		com r16
 6048 20a2 F094      		com r15
 6049 20a4 E094      		com r14
 6050 20a6 E11C      		adc r14,__zero_reg__
 6051 20a8 F11C      		adc r15,__zero_reg__
 6052 20aa 011D      		adc r16,__zero_reg__
 6053 20ac 111D      		adc r17,__zero_reg__
3132:ff.c          **** 				f |= 4;
 6054               		.stabn	68,0,3132,.LM508-.LFBB26
 6055               	.LM508:
 6056 20ae BB89      		ldd r27,Y+19
 6057 20b0 B460      		ori r27,lo8(4)
 6058 20b2 BB8B      		std Y+19,r27
 6059               	.L306:
3133:ff.c          **** 			}
3134:ff.c          **** 		}
3135:ff.c          **** 		i = sizeof(s) - 1; s[i] = 0;
 6060               		.stabn	68,0,3135,.LM509-.LFBB26
 6061               	.LM509:
 6062 20b4 188A      		std Y+16,__zero_reg__
 6063 20b6 AFE0      		ldi r26,lo8(15)
 6064 20b8 CA2E      		mov r12,r26
 6065 20ba D12C      		mov r13,__zero_reg__
3136:ff.c          **** 		do {
3137:ff.c          **** 			c = (UCHAR)(val % r + '0');
 6066               		.stabn	68,0,3137,.LM510-.LFBB26
 6067               	.LM510:
 6068 20bc 222E      		mov r2,r18
 6069 20be 3324      		clr r3
 6070 20c0 4424      		clr r4
 6071 20c2 5524      		clr r5
 6072               	.L311:
 6073 20c4 C801      		movw r24,r16
 6074 20c6 B701      		movw r22,r14
 6075 20c8 A201      		movw r20,r4
 6076 20ca 9101      		movw r18,r2
 6077 20cc 0E94 0000 		call __udivmodsi4
 6078 20d0 862F      		mov r24,r22
 6079 20d2 805D      		subi r24,lo8(-(48))
3138:ff.c          **** 			if (c > '9') c += 7;
 6080               		.stabn	68,0,3138,.LM511-.LFBB26
 6081               	.LM511:
 6082 20d4 8A33      		cpi r24,lo8(58)
 6083 20d6 00F0      		brlo .L308
 6084 20d8 895F      		subi r24,lo8(-(7))
 6085               	.L308:
3139:ff.c          **** 			s[--i] = c;
 6086               		.stabn	68,0,3139,.LM512-.LFBB26
 6087               	.LM512:
 6088 20da 0894      		sec
 6089 20dc C108      		sbc r12,__zero_reg__
 6090 20de D108      		sbc r13,__zero_reg__
 6091 20e0 E1E0      		ldi r30,lo8(1)
 6092 20e2 F0E0      		ldi r31,hi8(1)
 6093 20e4 EC0F      		add r30,r28
GAS LISTING /tmp/ccPugNTh.s 			page 163


 6094 20e6 FD1F      		adc r31,r29
 6095 20e8 EC0D      		add r30,r12
 6096 20ea FD1D      		adc r31,r13
 6097 20ec 8083      		st Z,r24
3140:ff.c          **** 			val /= r;
3141:ff.c          **** 		} while (i && val);
 6098               		.stabn	68,0,3141,.LM513-.LFBB26
 6099               	.LM513:
 6100 20ee C114      		cp r12,__zero_reg__
 6101 20f0 D104      		cpc r13,__zero_reg__
 6102 20f2 01F0      		breq .L310
 6103               		.stabn	68,0,3140,.LM514-.LFBB26
 6104               	.LM514:
 6105 20f4 C801      		movw r24,r16
 6106 20f6 B701      		movw r22,r14
 6107 20f8 A201      		movw r20,r4
 6108 20fa 9101      		movw r18,r2
 6109 20fc 0E94 0000 		call __udivmodsi4
 6110 2100 C901      		movw r24,r18
 6111 2102 DA01      		movw r26,r20
 6112 2104 7C01      		movw r14,r24
 6113 2106 8D01      		movw r16,r26
 6114               		.stabn	68,0,3141,.LM515-.LFBB26
 6115               	.LM515:
 6116 2108 E114      		cp r14,__zero_reg__
 6117 210a F104      		cpc r15,__zero_reg__
 6118 210c 0105      		cpc r16,__zero_reg__
 6119 210e 1105      		cpc r17,__zero_reg__
 6120 2110 01F4      		brne .L311
3142:ff.c          **** 		if (i && (f & 4)) s[--i] = '-';
 6121               		.stabn	68,0,3142,.LM516-.LFBB26
 6122               	.LM516:
 6123 2112 EB89      		ldd r30,Y+19
 6124 2114 E2FF      		sbrs r30,2
 6125 2116 00C0      		rjmp .L310
 6126 2118 0894      		sec
 6127 211a C108      		sbc r12,__zero_reg__
 6128 211c D108      		sbc r13,__zero_reg__
 6129 211e E1E0      		ldi r30,lo8(1)
 6130 2120 F0E0      		ldi r31,hi8(1)
 6131 2122 EC0F      		add r30,r28
 6132 2124 FD1F      		adc r31,r29
 6133 2126 EC0D      		add r30,r12
 6134 2128 FD1D      		adc r31,r13
 6135 212a 4DE2      		ldi r20,lo8(45)
 6136 212c 4083      		st Z,r20
 6137               	.L310:
3143:ff.c          **** 		w = sizeof(s) - 1 - w;
 6138               		.stabn	68,0,3143,.LM517-.LFBB26
 6139               	.LM517:
 6140 212e 8FE0      		ldi r24,lo8(15)
 6141 2130 90E0      		ldi r25,hi8(15)
 6142 2132 8A19      		sub r24,r10
 6143 2134 9B09      		sbc r25,r11
 6144 2136 0894      		sec
 6145 2138 C108      		sbc r12,__zero_reg__
 6146 213a D108      		sbc r13,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 164


 6147 213c E1E0      		ldi r30,lo8(1)
 6148 213e F0E0      		ldi r31,hi8(1)
 6149 2140 EC0F      		add r30,r28
 6150 2142 FD1F      		adc r31,r29
 6151 2144 EC0D      		add r30,r12
 6152 2146 FD1D      		adc r31,r13
 6153 2148 0894      		sec
 6154 214a C11C      		adc r12,__zero_reg__
 6155 214c D11C      		adc r13,__zero_reg__
3144:ff.c          **** 		while (i && i > w) s[--i] = (f & 1) ? '0' : ' ';
 6156               		.stabn	68,0,3144,.LM518-.LFBB26
 6157               	.LM518:
 6158 214e AB89      		ldd r26,Y+19
 6159 2150 2A2F      		mov r18,r26
 6160 2152 30E0      		ldi r19,lo8(0)
 6161 2154 2170      		andi r18,lo8(1)
 6162 2156 3070      		andi r19,hi8(1)
 6163 2158 00C0      		rjmp .L312
 6164               	.L316:
 6165 215a 0894      		sec
 6166 215c C108      		sbc r12,__zero_reg__
 6167 215e D108      		sbc r13,__zero_reg__
 6168 2160 2115      		cp r18,__zero_reg__
 6169 2162 3105      		cpc r19,__zero_reg__
 6170 2164 01F4      		brne .L313
 6171 2166 40E2      		ldi r20,lo8(32)
 6172 2168 00C0      		rjmp .L314
 6173               	.L313:
 6174 216a 40E3      		ldi r20,lo8(48)
 6175               	.L314:
 6176 216c 4083      		st Z,r20
 6177 216e 3197      		sbiw r30,1
 6178               	.L312:
 6179 2170 C114      		cp r12,__zero_reg__
 6180 2172 D104      		cpc r13,__zero_reg__
 6181 2174 01F0      		breq .L315
 6182 2176 8C15      		cp r24,r12
 6183 2178 9D05      		cpc r25,r13
 6184 217a 04F0      		brlt .L316
 6185               	.L315:
3145:ff.c          **** 		cc = f_puts(&s[i], fil);
 6186               		.stabn	68,0,3145,.LM519-.LFBB26
 6187               	.LM519:
 6188 217c 81E0      		ldi r24,lo8(1)
 6189 217e 90E0      		ldi r25,hi8(1)
 6190 2180 8C0F      		add r24,r28
 6191 2182 9D1F      		adc r25,r29
 6192 2184 8C0D      		add r24,r12
 6193 2186 9D1D      		adc r25,r13
 6194               	.L322:
 6195 2188 68A5      		ldd r22,Y+40
 6196 218a 79A5      		ldd r23,Y+41
 6197 218c 0E94 0000 		call f_puts
 6198 2190 9C01      		movw r18,r24
 6199               	.L294:
 6200               		.stabn	68,0,3089,.LM520-.LFBB26
 6201               	.LM520:
GAS LISTING /tmp/ccPugNTh.s 			page 165


 6202 2192 E989      		ldd r30,Y+17
 6203 2194 FA89      		ldd r31,Y+18
 6204 2196 E20F      		add r30,r18
 6205 2198 F31F      		adc r31,r19
 6206 219a FA8B      		std Y+18,r31
 6207 219c E98B      		std Y+17,r30
 6208 219e FFEF      		ldi r31,hi8(-1)
 6209 21a0 2F3F      		cpi r18,lo8(-1)
 6210 21a2 3F07      		cpc r19,r31
 6211 21a4 01F0      		breq .L317
 6212 21a6 8401      		movw r16,r8
 6213 21a8 00C0      		rjmp .L318
 6214               	.L291:
3146:ff.c          **** 	}
3147:ff.c          **** 
3148:ff.c          **** 	va_end(arp);
3149:ff.c          **** 	return (cc == EOF) ? cc : res;
 6215               		.stabn	68,0,3149,.LM521-.LFBB26
 6216               	.LM521:
 6217 21aa 4FEF      		ldi r20,hi8(-1)
 6218 21ac 2F3F      		cpi r18,lo8(-1)
 6219 21ae 3407      		cpc r19,r20
 6220 21b0 01F0      		breq .L317
 6221 21b2 2989      		ldd r18,Y+17
 6222 21b4 3A89      		ldd r19,Y+18
 6223               	.L317:
3150:ff.c          **** }
 6224               		.stabn	68,0,3150,.LM522-.LFBB26
 6225               	.LM522:
 6226 21b6 C901      		movw r24,r18
 6227               	/* epilogue start */
 6228 21b8 6396      		adiw r28,19
 6229 21ba 0FB6      		in __tmp_reg__,__SREG__
 6230 21bc F894      		cli
 6231 21be DEBF      		out __SP_H__,r29
 6232 21c0 0FBE      		out __SREG__,__tmp_reg__
 6233 21c2 CDBF      		out __SP_L__,r28
 6234 21c4 CF91      		pop r28
 6235 21c6 DF91      		pop r29
 6236 21c8 1F91      		pop r17
 6237 21ca 0F91      		pop r16
 6238 21cc FF90      		pop r15
 6239 21ce EF90      		pop r14
 6240 21d0 DF90      		pop r13
 6241 21d2 CF90      		pop r12
 6242 21d4 BF90      		pop r11
 6243 21d6 AF90      		pop r10
 6244 21d8 9F90      		pop r9
 6245 21da 8F90      		pop r8
 6246 21dc 7F90      		pop r7
 6247 21de 6F90      		pop r6
 6248 21e0 5F90      		pop r5
 6249 21e2 4F90      		pop r4
 6250 21e4 3F90      		pop r3
 6251 21e6 2F90      		pop r2
 6252 21e8 0895      		ret
 6253               		.size	f_printf, .-f_printf
GAS LISTING /tmp/ccPugNTh.s 			page 166


 6254               		.stabs	"arp:r(4,3)",64,0,3080,8
 6255               		.stabs	"c:r(2,4)",64,0,3081,30
 6256               		.stabs	"f:(2,4)",128,0,3081,19
 6257               		.stabs	"r:r(2,4)",64,0,3081,18
 6258               		.stabs	"val:r(2,11)",64,0,3082,14
 6259               		.stabs	"s:(0,28)=ar(1,4);0;15;(0,2)",128,0,3083,1
 6260               		.stabs	"i:r(0,1)",64,0,3084,12
 6261               		.stabs	"w:r(0,1)",64,0,3084,10
 6262               		.stabs	"res:(0,1)",128,0,3084,17
 6263               		.stabs	"cc:r(0,1)",64,0,3084,18
 6264               		.stabs	"str:r(0,21)",64,0,3076,6
 6265               		.stabn	192,0,0,.LFBB26-.LFBB26
 6266               		.stabn	224,0,0,.Lscope26-.LFBB26
 6267               	.Lscope26:
 6268               		.stabs	"",36,0,0,.Lscope26-.LFBB26
 6269               		.stabd	78,0,0
 6270               		.stabs	"f_read:F(1,16)",36,0,1769,f_read
 6271               		.stabs	"fp:P(0,23)",64,0,1764,28
 6272               		.stabs	"btr:P(2,2)",64,0,1766,8
 6273               		.stabs	"br:P(0,25)",64,0,1767,2
 6274               	.global	f_read
 6275               		.type	f_read, @function
 6276               	f_read:
 6277               		.stabd	46,0,0
 6278               		.stabn	68,0,1769,.LM523-.LFBB27
 6279               	.LM523:
 6280               	.LFBB27:
 6281 21ea 2F92      		push r2
 6282 21ec 3F92      		push r3
 6283 21ee 4F92      		push r4
 6284 21f0 5F92      		push r5
 6285 21f2 6F92      		push r6
 6286 21f4 7F92      		push r7
 6287 21f6 8F92      		push r8
 6288 21f8 9F92      		push r9
 6289 21fa AF92      		push r10
 6290 21fc BF92      		push r11
 6291 21fe CF92      		push r12
 6292 2200 DF92      		push r13
 6293 2202 EF92      		push r14
 6294 2204 FF92      		push r15
 6295 2206 0F93      		push r16
 6296 2208 1F93      		push r17
 6297 220a CF93      		push r28
 6298 220c DF93      		push r29
 6299               	/* prologue: function */
 6300               	/* frame size = 0 */
 6301 220e EC01      		movw r28,r24
 6302 2210 162F      		mov r17,r22
 6303 2212 072F      		mov r16,r23
 6304 2214 4A01      		movw r8,r20
 6305 2216 1901      		movw r2,r18
 6306               		.stabn	68,0,1776,.LM524-.LFBB27
 6307               	.LM524:
 6308 2218 F901      		movw r30,r18
 6309 221a 1182      		std Z+1,__zero_reg__
 6310 221c 1082      		st Z,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 167


 6311               		.stabn	68,0,1778,.LM525-.LFBB27
 6312               	.LM525:
 6313 221e 6A81      		ldd r22,Y+2
 6314 2220 7B81      		ldd r23,Y+3
 6315 2222 8881      		ld r24,Y
 6316 2224 9981      		ldd r25,Y+1
 6317 2226 0E94 0000 		call validate
 6318 222a 582E      		mov r5,r24
 6319               		.stabn	68,0,1779,.LM526-.LFBB27
 6320               	.LM526:
 6321 222c 8823      		tst r24
 6322 222e 01F0      		breq .+2
 6323 2230 00C0      		rjmp .L324
 6324               		.stabn	68,0,1780,.LM527-.LFBB27
 6325               	.LM527:
 6326 2232 8C81      		ldd r24,Y+4
 6327 2234 87FD      		sbrc r24,7
 6328 2236 00C0      		rjmp .L350
 6329               	.L325:
 6330               		.stabn	68,0,1782,.LM528-.LFBB27
 6331               	.LM528:
 6332 2238 80FD      		sbrc r24,0
 6333 223a 00C0      		rjmp .L326
 6334 223c 07E0      		ldi r16,lo8(7)
 6335 223e 502E      		mov r5,r16
 6336 2240 00C0      		rjmp .L324
 6337               	.L326:
 6338               		.stabn	68,0,1784,.LM529-.LFBB27
 6339               	.LM529:
 6340 2242 2A85      		ldd r18,Y+10
 6341 2244 3B85      		ldd r19,Y+11
 6342 2246 4C85      		ldd r20,Y+12
 6343 2248 5D85      		ldd r21,Y+13
 6344 224a 8E81      		ldd r24,Y+6
 6345 224c 9F81      		ldd r25,Y+7
 6346 224e A885      		ldd r26,Y+8
 6347 2250 B985      		ldd r27,Y+9
 6348 2252 281B      		sub r18,r24
 6349 2254 390B      		sbc r19,r25
 6350 2256 4A0B      		sbc r20,r26
 6351 2258 5B0B      		sbc r21,r27
 6352               		.stabn	68,0,1785,.LM530-.LFBB27
 6353               	.LM530:
 6354 225a C401      		movw r24,r8
 6355 225c A0E0      		ldi r26,lo8(0)
 6356 225e B0E0      		ldi r27,hi8(0)
 6357 2260 2817      		cp r18,r24
 6358 2262 3907      		cpc r19,r25
 6359 2264 4A07      		cpc r20,r26
 6360 2266 5B07      		cpc r21,r27
 6361 2268 00F4      		brsh .L327
 6362 226a 4901      		movw r8,r18
 6363               	.L327:
 6364               		.stabn	68,0,1773,.LM531-.LFBB27
 6365               	.LM531:
 6366 226c 812F      		mov r24,r17
 6367 226e 902F      		mov r25,r16
GAS LISTING /tmp/ccPugNTh.s 			page 168


 6368 2270 9C01      		movw r18,r24
 6369 2272 3901      		movw r6,r18
 6370 2274 00C0      		rjmp .L328
 6371               	.L348:
 6372               		.stabn	68,0,1789,.LM532-.LFBB27
 6373               	.LM532:
 6374 2276 2E81      		ldd r18,Y+6
 6375 2278 3F81      		ldd r19,Y+7
 6376 227a 4885      		ldd r20,Y+8
 6377 227c 5985      		ldd r21,Y+9
 6378 227e DA01      		movw r26,r20
 6379 2280 C901      		movw r24,r18
 6380 2282 9170      		andi r25,hi8(511)
 6381 2284 A070      		andi r26,hlo8(511)
 6382 2286 B070      		andi r27,hhi8(511)
 6383 2288 0097      		sbiw r24,0
 6384 228a A105      		cpc r26,__zero_reg__
 6385 228c B105      		cpc r27,__zero_reg__
 6386 228e 01F0      		breq .+2
 6387 2290 00C0      		rjmp .L329
 6388               		.stabn	68,0,1790,.LM533-.LFBB27
 6389               	.LM533:
 6390 2292 E881      		ld r30,Y
 6391 2294 F981      		ldd r31,Y+1
 6392 2296 9D81      		ldd r25,Y+5
 6393 2298 8281      		ldd r24,Z+2
 6394 229a 9817      		cp r25,r24
 6395 229c 00F0      		brlo .L330
 6396               		.stabn	68,0,1791,.LM534-.LFBB27
 6397               	.LM534:
 6398 229e 2115      		cp r18,__zero_reg__
 6399 22a0 3105      		cpc r19,__zero_reg__
 6400 22a2 4105      		cpc r20,__zero_reg__
 6401 22a4 5105      		cpc r21,__zero_reg__
 6402 22a6 01F4      		brne .L331
 6403 22a8 6E85      		ldd r22,Y+14
 6404 22aa 7F85      		ldd r23,Y+15
 6405 22ac 8889      		ldd r24,Y+16
 6406 22ae 9989      		ldd r25,Y+17
 6407 22b0 00C0      		rjmp .L332
 6408               	.L331:
 6409 22b2 4A89      		ldd r20,Y+18
 6410 22b4 5B89      		ldd r21,Y+19
 6411 22b6 6C89      		ldd r22,Y+20
 6412 22b8 7D89      		ldd r23,Y+21
 6413 22ba CF01      		movw r24,r30
 6414 22bc 0E94 0000 		call get_fat
 6415               	.L332:
 6416               		.stabn	68,0,1793,.LM535-.LFBB27
 6417               	.LM535:
 6418 22c0 6230      		cpi r22,lo8(2)
 6419 22c2 7105      		cpc r23,__zero_reg__
 6420 22c4 8105      		cpc r24,__zero_reg__
 6421 22c6 9105      		cpc r25,__zero_reg__
 6422 22c8 00F4      		brsh .L333
 6423               	.L352:
 6424 22ca 8C81      		ldd r24,Y+4
GAS LISTING /tmp/ccPugNTh.s 			page 169


 6425 22cc 8068      		ori r24,lo8(-128)
 6426 22ce 8C83      		std Y+4,r24
 6427               	.L350:
 6428 22d0 12E0      		ldi r17,lo8(2)
 6429 22d2 512E      		mov r5,r17
 6430 22d4 00C0      		rjmp .L324
 6431               	.L333:
 6432               		.stabn	68,0,1794,.LM536-.LFBB27
 6433               	.LM536:
 6434 22d6 6F3F      		cpi r22,lo8(-1)
 6435 22d8 FFEF      		ldi r31,hi8(-1)
 6436 22da 7F07      		cpc r23,r31
 6437 22dc FFEF      		ldi r31,hlo8(-1)
 6438 22de 8F07      		cpc r24,r31
 6439 22e0 FFEF      		ldi r31,hhi8(-1)
 6440 22e2 9F07      		cpc r25,r31
 6441 22e4 01F4      		brne .+2
 6442 22e6 00C0      		rjmp .L351
 6443               	.L334:
 6444               		.stabn	68,0,1795,.LM537-.LFBB27
 6445               	.LM537:
 6446 22e8 6A8B      		std Y+18,r22
 6447 22ea 7B8B      		std Y+19,r23
 6448 22ec 8C8B      		std Y+20,r24
 6449 22ee 9D8B      		std Y+21,r25
 6450               		.stabn	68,0,1796,.LM538-.LFBB27
 6451               	.LM538:
 6452 22f0 1D82      		std Y+5,__zero_reg__
 6453               	.L330:
 6454               		.stabn	68,0,1798,.LM539-.LFBB27
 6455               	.LM539:
 6456 22f2 0881      		ld r16,Y
 6457 22f4 1981      		ldd r17,Y+1
 6458               	.LBB106:
 6459               	.LBB107:
 6460               		.stabn	68,0,532,.LM540-.LFBB27
 6461               	.LM540:
 6462 22f6 2A89      		ldd r18,Y+18
 6463 22f8 3B89      		ldd r19,Y+19
 6464 22fa 4C89      		ldd r20,Y+20
 6465 22fc 5D89      		ldd r21,Y+21
 6466 22fe 2250      		subi r18,lo8(-(-2))
 6467 2300 3040      		sbci r19,hi8(-(-2))
 6468 2302 4040      		sbci r20,hlo8(-(-2))
 6469 2304 5040      		sbci r21,hhi8(-(-2))
 6470               		.stabn	68,0,533,.LM541-.LFBB27
 6471               	.LM541:
 6472 2306 F801      		movw r30,r16
 6473 2308 828D      		ldd r24,Z+26
 6474 230a 938D      		ldd r25,Z+27
 6475 230c A48D      		ldd r26,Z+28
 6476 230e B58D      		ldd r27,Z+29
 6477 2310 0297      		sbiw r24,2
 6478 2312 A109      		sbc r26,__zero_reg__
 6479 2314 B109      		sbc r27,__zero_reg__
 6480 2316 2817      		cp r18,r24
 6481 2318 3907      		cpc r19,r25
GAS LISTING /tmp/ccPugNTh.s 			page 170


 6482 231a 4A07      		cpc r20,r26
 6483 231c 5B07      		cpc r21,r27
 6484 231e 00F4      		brsh .L352
 6485               		.stabn	68,0,534,.LM542-.LFBB27
 6486               	.LM542:
 6487 2320 4280      		ldd r4,Z+2
 6488 2322 642D      		mov r22,r4
 6489 2324 70E0      		ldi r23,lo8(0)
 6490 2326 80E0      		ldi r24,lo8(0)
 6491 2328 90E0      		ldi r25,hi8(0)
 6492 232a 0E94 0000 		call __mulsi3
 6493 232e 9B01      		movw r18,r22
 6494 2330 AC01      		movw r20,r24
 6495 2332 F801      		movw r30,r16
 6496 2334 86A1      		ldd r24,Z+38
 6497 2336 97A1      		ldd r25,Z+39
 6498 2338 A0A5      		ldd r26,Z+40
 6499 233a B1A5      		ldd r27,Z+41
 6500 233c 280F      		add r18,r24
 6501 233e 391F      		adc r19,r25
 6502 2340 4A1F      		adc r20,r26
 6503 2342 5B1F      		adc r21,r27
 6504               	.LBE107:
 6505               	.LBE106:
 6506               		.stabn	68,0,1799,.LM543-.LFBB27
 6507               	.LM543:
 6508 2344 2115      		cp r18,__zero_reg__
 6509 2346 3105      		cpc r19,__zero_reg__
 6510 2348 4105      		cpc r20,__zero_reg__
 6511 234a 5105      		cpc r21,__zero_reg__
 6512 234c 01F4      		brne .+2
 6513 234e 00C0      		rjmp .L352
 6514               	.L336:
 6515               		.stabn	68,0,1800,.LM544-.LFBB27
 6516               	.LM544:
 6517 2350 8D81      		ldd r24,Y+5
 6518 2352 6901      		movw r12,r18
 6519 2354 7A01      		movw r14,r20
 6520 2356 C80E      		add r12,r24
 6521 2358 D11C      		adc r13,__zero_reg__
 6522 235a E11C      		adc r14,__zero_reg__
 6523 235c F11C      		adc r15,__zero_reg__
 6524               		.stabn	68,0,1801,.LM545-.LFBB27
 6525               	.LM545:
 6526 235e 5401      		movw r10,r8
 6527 2360 AB2C      		mov r10,r11
 6528 2362 BB24      		clr r11
 6529 2364 A694      		lsr r10
 6530               		.stabn	68,0,1802,.LM546-.LFBB27
 6531               	.LM546:
 6532 2366 A114      		cp r10,__zero_reg__
 6533 2368 B104      		cpc r11,__zero_reg__
 6534 236a 01F4      		brne .+2
 6535 236c 00C0      		rjmp .L337
 6536               		.stabn	68,0,1803,.LM547-.LFBB27
 6537               	.LM547:
 6538 236e 282F      		mov r18,r24
GAS LISTING /tmp/ccPugNTh.s 			page 171


 6539 2370 30E0      		ldi r19,lo8(0)
 6540 2372 C501      		movw r24,r10
 6541 2374 820F      		add r24,r18
 6542 2376 931F      		adc r25,r19
 6543 2378 642D      		mov r22,r4
 6544 237a 70E0      		ldi r23,lo8(0)
 6545 237c 6817      		cp r22,r24
 6546 237e 7907      		cpc r23,r25
 6547 2380 00F4      		brsh .L338
 6548               		.stabn	68,0,1804,.LM548-.LFBB27
 6549               	.LM548:
 6550 2382 5B01      		movw r10,r22
 6551 2384 A21A      		sub r10,r18
 6552 2386 B30A      		sbc r11,r19
 6553               	.L338:
 6554               		.stabn	68,0,1805,.LM549-.LFBB27
 6555               	.LM549:
 6556 2388 F801      		movw r30,r16
 6557 238a 8181      		ldd r24,Z+1
 6558 238c B301      		movw r22,r6
 6559 238e A701      		movw r20,r14
 6560 2390 9601      		movw r18,r12
 6561 2392 0A2D      		mov r16,r10
 6562 2394 0E94 0000 		call disk_read
 6563 2398 8823      		tst r24
 6564 239a 01F0      		breq .+2
 6565 239c 00C0      		rjmp .L351
 6566               	.L339:
 6567               		.stabn	68,0,1809,.LM550-.LFBB27
 6568               	.LM550:
 6569 239e E881      		ld r30,Y
 6570 23a0 F981      		ldd r31,Y+1
 6571 23a2 8481      		ldd r24,Z+4
 6572 23a4 8823      		tst r24
 6573 23a6 01F0      		breq .L340
 6574 23a8 22A5      		ldd r18,Z+42
 6575 23aa 33A5      		ldd r19,Z+43
 6576 23ac 44A5      		ldd r20,Z+44
 6577 23ae 55A5      		ldd r21,Z+45
 6578 23b0 2C19      		sub r18,r12
 6579 23b2 3D09      		sbc r19,r13
 6580 23b4 4E09      		sbc r20,r14
 6581 23b6 5F09      		sbc r21,r15
 6582 23b8 C501      		movw r24,r10
 6583 23ba A0E0      		ldi r26,lo8(0)
 6584 23bc B0E0      		ldi r27,hi8(0)
 6585 23be 2817      		cp r18,r24
 6586 23c0 3907      		cpc r19,r25
 6587 23c2 4A07      		cpc r20,r26
 6588 23c4 5B07      		cpc r21,r27
 6589 23c6 00F4      		brsh .L340
 6590               	.LBB108:
 6591               	.LBB109:
 6592               		.stabn	68,0,177,.LM551-.LFBB27
 6593               	.LM551:
 6594 23c8 A9E0      		ldi r26,9
 6595 23ca 220F      	1:	lsl r18
GAS LISTING /tmp/ccPugNTh.s 			page 172


 6596 23cc 331F      		rol r19
 6597 23ce 441F      		rol r20
 6598 23d0 551F      		rol r21
 6599 23d2 AA95      		dec r26
 6600 23d4 01F4      		brne 1b
 6601 23d6 C301      		movw r24,r6
 6602 23d8 820F      		add r24,r18
 6603 23da 931F      		adc r25,r19
 6604               		.stabn	68,0,178,.LM552-.LFBB27
 6605               	.LM552:
 6606 23dc DF01      		movw r26,r30
 6607 23de 9E96      		adiw r26,46
 6608 23e0 FC01      		movw r30,r24
 6609               		.stabn	68,0,179,.LM553-.LFBB27
 6610               	.LM553:
 6611 23e2 9C01      		movw r18,r24
 6612 23e4 2050      		subi r18,lo8(-(512))
 6613 23e6 3E4F      		sbci r19,hi8(-(512))
 6614 23e8 00C0      		rjmp .L341
 6615               	.L342:
 6616 23ea 8D91      		ld r24,X+
 6617 23ec 8193      		st Z+,r24
 6618               	.L341:
 6619 23ee E217      		cp r30,r18
 6620 23f0 F307      		cpc r31,r19
 6621 23f2 01F4      		brne .L342
 6622               	.L340:
 6623               	.LBE109:
 6624               	.LBE108:
 6625               		.stabn	68,0,1816,.LM554-.LFBB27
 6626               	.LM554:
 6627 23f4 8D81      		ldd r24,Y+5
 6628 23f6 8A0D      		add r24,r10
 6629 23f8 8D83      		std Y+5,r24
 6630               		.stabn	68,0,1817,.LM555-.LFBB27
 6631               	.LM555:
 6632 23fa B501      		movw r22,r10
 6633 23fc 762F      		mov r23,r22
 6634 23fe 6627      		clr r22
 6635 2400 770F      		lsl r23
 6636 2402 00C0      		rjmp .L343
 6637               	.L337:
 6638               		.stabn	68,0,1833,.LM556-.LFBB27
 6639               	.LM556:
 6640 2404 CE8A      		std Y+22,r12
 6641 2406 DF8A      		std Y+23,r13
 6642 2408 E88E      		std Y+24,r14
 6643 240a F98E      		std Y+25,r15
 6644               		.stabn	68,0,1834,.LM557-.LFBB27
 6645               	.LM557:
 6646 240c 8F5F      		subi r24,lo8(-(1))
 6647 240e 8D83      		std Y+5,r24
 6648               	.L329:
 6649               		.stabn	68,0,1836,.LM558-.LFBB27
 6650               	.LM558:
 6651 2410 CE80      		ldd r12,Y+6
 6652 2412 DF80      		ldd r13,Y+7
GAS LISTING /tmp/ccPugNTh.s 			page 173


 6653 2414 E884      		ldd r14,Y+8
 6654 2416 F984      		ldd r15,Y+9
 6655               		.stabn	68,0,1839,.LM559-.LFBB27
 6656               	.LM559:
 6657 2418 4E89      		ldd r20,Y+22
 6658 241a 5F89      		ldd r21,Y+23
 6659 241c 688D      		ldd r22,Y+24
 6660 241e 798D      		ldd r23,Y+25
 6661 2420 8881      		ld r24,Y
 6662 2422 9981      		ldd r25,Y+1
 6663 2424 0E94 0000 		call move_window
 6664 2428 8823      		tst r24
 6665 242a 01F0      		breq .L344
 6666               	.L351:
 6667               		.stabn	68,0,1840,.LM560-.LFBB27
 6668               	.LM560:
 6669 242c 8C81      		ldd r24,Y+4
 6670 242e 8068      		ori r24,lo8(-128)
 6671 2430 8C83      		std Y+4,r24
 6672 2432 5524      		clr r5
 6673 2434 5394      		inc r5
 6674 2436 00C0      		rjmp .L324
 6675               	.L344:
 6676               		.stabn	68,0,1836,.LM561-.LFBB27
 6677               	.LM561:
 6678 2438 C601      		movw r24,r12
 6679 243a 9170      		andi r25,hi8(511)
 6680 243c 20E0      		ldi r18,lo8(512)
 6681 243e 32E0      		ldi r19,hi8(512)
 6682 2440 281B      		sub r18,r24
 6683 2442 390B      		sbc r19,r25
 6684 2444 B401      		movw r22,r8
 6685 2446 2815      		cp r18,r8
 6686 2448 3905      		cpc r19,r9
 6687 244a 00F4      		brsh .L345
 6688 244c B901      		movw r22,r18
 6689               	.L345:
 6690               		.stabn	68,0,1841,.LM562-.LFBB27
 6691               	.LM562:
 6692 244e 9B01      		movw r18,r22
 6693               	.LBB110:
 6694               	.LBB111:
 6695               		.stabn	68,0,178,.LM563-.LFBB27
 6696               	.LM563:
 6697 2450 8E81      		ldd r24,Y+6
 6698 2452 9F81      		ldd r25,Y+7
 6699 2454 9170      		andi r25,hi8(511)
 6700 2456 8E96      		adiw r24,46
 6701 2458 E881      		ld r30,Y
 6702 245a F981      		ldd r31,Y+1
 6703 245c E80F      		add r30,r24
 6704 245e F91F      		adc r31,r25
 6705 2460 D301      		movw r26,r6
 6706 2462 00C0      		rjmp .L346
 6707               	.L347:
 6708               		.stabn	68,0,179,.LM564-.LFBB27
 6709               	.LM564:
GAS LISTING /tmp/ccPugNTh.s 			page 174


 6710 2464 8191      		ld r24,Z+
 6711 2466 8D93      		st X+,r24
 6712               	.L346:
 6713 2468 2150      		subi r18,lo8(-(-1))
 6714 246a 3040      		sbci r19,hi8(-(-1))
 6715 246c 8FEF      		ldi r24,hi8(-1)
 6716 246e 2F3F      		cpi r18,lo8(-1)
 6717 2470 3807      		cpc r19,r24
 6718 2472 01F4      		brne .L347
 6719               	.L343:
 6720               	.LBE111:
 6721               	.LBE110:
 6722               		.stabn	68,0,1788,.LM565-.LFBB27
 6723               	.LM565:
 6724 2474 660E      		add r6,r22
 6725 2476 771E      		adc r7,r23
 6726 2478 CB01      		movw r24,r22
 6727 247a A0E0      		ldi r26,lo8(0)
 6728 247c B0E0      		ldi r27,hi8(0)
 6729 247e 2E81      		ldd r18,Y+6
 6730 2480 3F81      		ldd r19,Y+7
 6731 2482 4885      		ldd r20,Y+8
 6732 2484 5985      		ldd r21,Y+9
 6733 2486 280F      		add r18,r24
 6734 2488 391F      		adc r19,r25
 6735 248a 4A1F      		adc r20,r26
 6736 248c 5B1F      		adc r21,r27
 6737 248e 2E83      		std Y+6,r18
 6738 2490 3F83      		std Y+7,r19
 6739 2492 4887      		std Y+8,r20
 6740 2494 5987      		std Y+9,r21
 6741 2496 F101      		movw r30,r2
 6742 2498 8081      		ld r24,Z
 6743 249a 9181      		ldd r25,Z+1
 6744 249c 860F      		add r24,r22
 6745 249e 971F      		adc r25,r23
 6746 24a0 9183      		std Z+1,r25
 6747 24a2 8083      		st Z,r24
 6748 24a4 861A      		sub r8,r22
 6749 24a6 970A      		sbc r9,r23
 6750               	.L328:
 6751               		.stabn	68,0,1787,.LM566-.LFBB27
 6752               	.LM566:
 6753 24a8 8114      		cp r8,__zero_reg__
 6754 24aa 9104      		cpc r9,__zero_reg__
 6755 24ac 01F0      		breq .+2
 6756 24ae 00C0      		rjmp .L348
 6757               	.L324:
 6758               		.stabn	68,0,1848,.LM567-.LFBB27
 6759               	.LM567:
 6760 24b0 852D      		mov r24,r5
 6761               	/* epilogue start */
 6762 24b2 DF91      		pop r29
 6763 24b4 CF91      		pop r28
 6764 24b6 1F91      		pop r17
 6765 24b8 0F91      		pop r16
 6766 24ba FF90      		pop r15
GAS LISTING /tmp/ccPugNTh.s 			page 175


 6767 24bc EF90      		pop r14
 6768 24be DF90      		pop r13
 6769 24c0 CF90      		pop r12
 6770 24c2 BF90      		pop r11
 6771 24c4 AF90      		pop r10
 6772 24c6 9F90      		pop r9
 6773 24c8 8F90      		pop r8
 6774 24ca 7F90      		pop r7
 6775 24cc 6F90      		pop r6
 6776 24ce 5F90      		pop r5
 6777 24d0 4F90      		pop r4
 6778 24d2 3F90      		pop r3
 6779 24d4 2F90      		pop r2
 6780 24d6 0895      		ret
 6781               		.size	f_read, .-f_read
 6782               		.stabs	"res:r(1,16)",64,0,1770,5
 6783               		.stabs	"clst:r(2,12)",64,0,1771,22
 6784               		.stabs	"sect:r(2,12)",64,0,1771,12
 6785               		.stabs	"remain:r(2,12)",64,0,1771,18
 6786               		.stabs	"rcnt:r(2,2)",64,0,1772,22
 6787               		.stabs	"cc:r(2,2)",64,0,1772,10
 6788               		.stabs	"rbuff:r(1,8)",64,0,1773,6
 6789               		.stabn	192,0,0,.LFBB27-.LFBB27
 6790               		.stabs	"clst:r(2,12)",64,0,1798,18
 6791               		.stabn	192,0,0,.LBB106-.LFBB27
 6792               		.stabn	224,0,0,.LBE106-.LFBB27
 6793               		.stabs	"d:r(0,18)",64,0,177,24
 6794               		.stabs	"s:r(0,21)",64,0,178,26
 6795               		.stabn	192,0,0,.LBB109-.LFBB27
 6796               		.stabn	224,0,0,.LBE109-.LFBB27
 6797               		.stabs	"cnt:r(0,1)",64,0,1841,18
 6798               		.stabn	192,0,0,.LBB110-.LFBB27
 6799               		.stabs	"s:r(0,21)",64,0,178,30
 6800               		.stabn	192,0,0,.LBB111-.LFBB27
 6801               		.stabn	224,0,0,.LBE111-.LFBB27
 6802               		.stabn	224,0,0,.LBE110-.LFBB27
 6803               		.stabn	224,0,0,.Lscope27-.LFBB27
 6804               	.Lscope27:
 6805               		.stabs	"",36,0,0,.Lscope27-.LFBB27
 6806               		.stabd	78,0,0
 6807               		.stabs	"f_gets:F(0,18)",36,0,3001,f_gets
 6808               		.stabs	"buff:P(0,18)",64,0,2997,12
 6809               		.stabs	"len:P(0,1)",64,0,2998,22
 6810               		.stabs	"fil:P(0,23)",64,0,2999,8
 6811               	.global	f_gets
 6812               		.type	f_gets, @function
 6813               	f_gets:
 6814               		.stabd	46,0,0
 6815               		.stabn	68,0,3001,.LM568-.LFBB28
 6816               	.LM568:
 6817               	.LFBB28:
 6818 24d8 6F92      		push r6
 6819 24da 7F92      		push r7
 6820 24dc 8F92      		push r8
 6821 24de 9F92      		push r9
 6822 24e0 AF92      		push r10
 6823 24e2 BF92      		push r11
GAS LISTING /tmp/ccPugNTh.s 			page 176


 6824 24e4 CF92      		push r12
 6825 24e6 DF92      		push r13
 6826 24e8 EF92      		push r14
 6827 24ea FF92      		push r15
 6828 24ec 0F93      		push r16
 6829 24ee 1F93      		push r17
 6830 24f0 DF93      		push r29
 6831 24f2 CF93      		push r28
 6832 24f4 00D0      		rcall .
 6833 24f6 CDB7      		in r28,__SP_L__
 6834 24f8 DEB7      		in r29,__SP_H__
 6835               	/* prologue: function */
 6836               	/* frame size = 2 */
 6837 24fa 6C01      		movw r12,r24
 6838 24fc 5B01      		movw r10,r22
 6839 24fe 4A01      		movw r8,r20
 6840               		.stabn	68,0,3001,.LM569-.LFBB28
 6841               	.LM569:
 6842 2500 8C01      		movw r16,r24
 6843 2502 EE24      		clr r14
 6844 2504 FF24      		clr r15
 6845               		.stabn	68,0,3007,.LM570-.LFBB28
 6846               	.LM570:
 6847 2506 0894      		sec
 6848 2508 A108      		sbc r10,__zero_reg__
 6849 250a B108      		sbc r11,__zero_reg__
 6850               		.stabn	68,0,3008,.LM571-.LFBB28
 6851               	.LM571:
 6852 250c 3E01      		movw r6,r28
 6853 250e 0894      		sec
 6854 2510 611C      		adc r6,__zero_reg__
 6855 2512 711C      		adc r7,__zero_reg__
 6856 2514 00C0      		rjmp .L361
 6857               	.L356:
 6858 2516 C401      		movw r24,r8
 6859 2518 B801      		movw r22,r16
 6860 251a 41E0      		ldi r20,lo8(1)
 6861 251c 50E0      		ldi r21,hi8(1)
 6862 251e 9301      		movw r18,r6
 6863 2520 0E94 0000 		call f_read
 6864               		.stabn	68,0,3009,.LM572-.LFBB28
 6865               	.LM572:
 6866 2524 8981      		ldd r24,Y+1
 6867 2526 9A81      		ldd r25,Y+2
 6868 2528 0197      		sbiw r24,1
 6869 252a 01F4      		brne .L355
 6870               		.stabn	68,0,3011,.LM573-.LFBB28
 6871               	.LM573:
 6872 252c F801      		movw r30,r16
 6873 252e 8081      		ld r24,Z
 6874 2530 8D30      		cpi r24,lo8(13)
 6875 2532 01F0      		breq .L361
 6876               		.stabn	68,0,3013,.LM574-.LFBB28
 6877               	.LM574:
 6878 2534 0894      		sec
 6879 2536 E11C      		adc r14,__zero_reg__
 6880 2538 F11C      		adc r15,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 177


 6881               		.stabn	68,0,3014,.LM575-.LFBB28
 6882               	.LM575:
 6883 253a 0F5F      		subi r16,lo8(-(1))
 6884 253c 1F4F      		sbci r17,hi8(-(1))
 6885 253e 8A30      		cpi r24,lo8(10)
 6886 2540 01F0      		breq .L355
 6887               	.L361:
 6888               		.stabn	68,0,3007,.LM576-.LFBB28
 6889               	.LM576:
 6890 2542 EA14      		cp r14,r10
 6891 2544 FB04      		cpc r15,r11
 6892 2546 04F0      		brlt .L356
 6893               	.L355:
 6894               		.stabn	68,0,3016,.LM577-.LFBB28
 6895               	.LM577:
 6896 2548 F801      		movw r30,r16
 6897 254a 1082      		st Z,__zero_reg__
 6898               		.stabn	68,0,3017,.LM578-.LFBB28
 6899               	.LM578:
 6900 254c EF28      		or r14,r15
 6901 254e 01F4      		brne .L357
 6902 2550 CC24      		clr r12
 6903 2552 DD24      		clr r13
 6904               	.L357:
 6905               		.stabn	68,0,3018,.LM579-.LFBB28
 6906               	.LM579:
 6907 2554 C601      		movw r24,r12
 6908               	/* epilogue start */
 6909 2556 0F90      		pop __tmp_reg__
 6910 2558 0F90      		pop __tmp_reg__
 6911 255a CF91      		pop r28
 6912 255c DF91      		pop r29
 6913 255e 1F91      		pop r17
 6914 2560 0F91      		pop r16
 6915 2562 FF90      		pop r15
 6916 2564 EF90      		pop r14
 6917 2566 DF90      		pop r13
 6918 2568 CF90      		pop r12
 6919 256a BF90      		pop r11
 6920 256c AF90      		pop r10
 6921 256e 9F90      		pop r9
 6922 2570 8F90      		pop r8
 6923 2572 7F90      		pop r7
 6924 2574 6F90      		pop r6
 6925 2576 0895      		ret
 6926               		.size	f_gets, .-f_gets
 6927               		.stabs	"i:r(0,1)",64,0,3002,14
 6928               		.stabs	"p:r(0,18)",64,0,3003,16
 6929               		.stabs	"rc:(2,2)",128,0,3004,1
 6930               		.stabn	192,0,0,.LFBB28-.LFBB28
 6931               		.stabn	224,0,0,.Lscope28-.LFBB28
 6932               	.Lscope28:
 6933               		.stabs	"",36,0,0,.Lscope28-.LFBB28
 6934               		.stabd	78,0,0
 6935               		.stabs	"chk_mounted:F(1,16)",36,0,1469,chk_mounted
 6936               		.stabs	"path:P(0,29)=*(0,19)",64,0,1465,26
 6937               		.stabs	"rfs:P(0,30)=*(1,7)",64,0,1466,22
GAS LISTING /tmp/ccPugNTh.s 			page 178


 6938               		.stabs	"chk_wp:P(2,5)",64,0,1467,17
 6939               	.global	chk_mounted
 6940               		.type	chk_mounted, @function
 6941               	chk_mounted:
 6942               		.stabd	46,0,0
 6943               		.stabn	68,0,1469,.LM580-.LFBB29
 6944               	.LM580:
 6945               	.LFBB29:
 6946 2578 6F92      		push r6
 6947 257a 7F92      		push r7
 6948 257c 8F92      		push r8
 6949 257e 9F92      		push r9
 6950 2580 AF92      		push r10
 6951 2582 BF92      		push r11
 6952 2584 CF92      		push r12
 6953 2586 DF92      		push r13
 6954 2588 EF92      		push r14
 6955 258a FF92      		push r15
 6956 258c 0F93      		push r16
 6957 258e 1F93      		push r17
 6958 2590 CF93      		push r28
 6959 2592 DF93      		push r29
 6960               	/* prologue: function */
 6961               	/* frame size = 0 */
 6962 2594 DC01      		movw r26,r24
 6963 2596 142F      		mov r17,r20
 6964               		.stabn	68,0,1474,.LM581-.LFBB29
 6965               	.LM581:
 6966 2598 ED91      		ld r30,X+
 6967 259a FC91      		ld r31,X
 6968 259c 1197      		sbiw r26,1
 6969               		.stabn	68,0,1478,.LM582-.LFBB29
 6970               	.LM582:
 6971 259e 8081      		ld r24,Z
 6972 25a0 282F      		mov r18,r24
 6973 25a2 30E0      		ldi r19,lo8(0)
 6974 25a4 2053      		subi r18,lo8(-(-48))
 6975 25a6 3040      		sbci r19,hi8(-(-48))
 6976               		.stabn	68,0,1479,.LM583-.LFBB29
 6977               	.LM583:
 6978 25a8 2A30      		cpi r18,10
 6979 25aa 3105      		cpc r19,__zero_reg__
 6980 25ac 00F4      		brsh .L363
 6981 25ae 8181      		ldd r24,Z+1
 6982 25b0 8A33      		cpi r24,lo8(58)
 6983 25b2 01F4      		brne .L363
 6984               		.stabn	68,0,1480,.LM584-.LFBB29
 6985               	.LM584:
 6986 25b4 3296      		adiw r30,2
 6987 25b6 ED93      		st X+,r30
 6988 25b8 FC93      		st X,r31
 6989               		.stabn	68,0,1490,.LM585-.LFBB29
 6990               	.LM585:
 6991 25ba 232B      		or r18,r19
 6992 25bc 01F0      		breq .L363
 6993 25be 8BE0      		ldi r24,lo8(11)
 6994 25c0 00C0      		rjmp .L364
GAS LISTING /tmp/ccPugNTh.s 			page 179


 6995               	.L363:
 6996               		.stabn	68,0,1492,.LM586-.LFBB29
 6997               	.LM586:
 6998 25c2 C091 0000 		lds r28,FatFs
 6999 25c6 D091 0000 		lds r29,(FatFs)+1
 7000 25ca FB01      		movw r30,r22
 7001 25cc D183      		std Z+1,r29
 7002 25ce C083      		st Z,r28
 7003               		.stabn	68,0,1493,.LM587-.LFBB29
 7004               	.LM587:
 7005 25d0 2097      		sbiw r28,0
 7006 25d2 01F4      		brne .L365
 7007 25d4 8CE0      		ldi r24,lo8(12)
 7008 25d6 00C0      		rjmp .L364
 7009               	.L365:
 7010               		.stabn	68,0,1497,.LM588-.LFBB29
 7011               	.LM588:
 7012 25d8 8881      		ld r24,Y
 7013 25da 8823      		tst r24
 7014 25dc 01F0      		breq .L366
 7015               		.stabn	68,0,1498,.LM589-.LFBB29
 7016               	.LM589:
 7017 25de 8981      		ldd r24,Y+1
 7018 25e0 0E94 0000 		call disk_status
 7019               		.stabn	68,0,1499,.LM590-.LFBB29
 7020               	.LM590:
 7021 25e4 80FD      		sbrc r24,0
 7022 25e6 00C0      		rjmp .L366
 7023               		.stabn	68,0,1501,.LM591-.LFBB29
 7024               	.LM591:
 7025 25e8 1123      		tst r17
 7026 25ea 01F4      		brne .+2
 7027 25ec 00C0      		rjmp .L367
 7028 25ee 82FD      		sbrc r24,2
 7029 25f0 00C0      		rjmp .L368
 7030 25f2 00C0      		rjmp .L367
 7031               	.L366:
 7032               		.stabn	68,0,1510,.LM592-.LFBB29
 7033               	.LM592:
 7034 25f4 1882      		st Y,__zero_reg__
 7035               		.stabn	68,0,1511,.LM593-.LFBB29
 7036               	.LM593:
 7037 25f6 1982      		std Y+1,__zero_reg__
 7038               		.stabn	68,0,1512,.LM594-.LFBB29
 7039               	.LM594:
 7040 25f8 80E0      		ldi r24,lo8(0)
 7041 25fa 0E94 0000 		call disk_initialize
 7042               		.stabn	68,0,1513,.LM595-.LFBB29
 7043               	.LM595:
 7044 25fe 80FF      		sbrs r24,0
 7045 2600 00C0      		rjmp .L369
 7046 2602 83E0      		ldi r24,lo8(3)
 7047 2604 00C0      		rjmp .L364
 7048               	.L369:
 7049               		.stabn	68,0,1520,.LM596-.LFBB29
 7050               	.LM596:
 7051 2606 1123      		tst r17
GAS LISTING /tmp/ccPugNTh.s 			page 180


 7052 2608 01F0      		breq .L370
 7053 260a 82FD      		sbrc r24,2
 7054 260c 00C0      		rjmp .L368
 7055               	.L370:
 7056               		.stabn	68,0,1524,.LM597-.LFBB29
 7057               	.LM597:
 7058 260e CE01      		movw r24,r28
 7059 2610 40E0      		ldi r20,lo8(0)
 7060 2612 50E0      		ldi r21,hi8(0)
 7061 2614 60E0      		ldi r22,hlo8(0)
 7062 2616 70E0      		ldi r23,hhi8(0)
 7063 2618 0E94 0000 		call check_fs
 7064               		.stabn	68,0,1525,.LM598-.LFBB29
 7065               	.LM598:
 7066 261c 8130      		cpi r24,lo8(1)
 7067 261e 01F0      		breq .L371
 7068 2620 AA24      		clr r10
 7069 2622 BB24      		clr r11
 7070 2624 6501      		movw r12,r10
 7071 2626 00C0      		rjmp .L372
 7072               	.L371:
 7073               		.stabn	68,0,1527,.LM599-.LFBB29
 7074               	.LM599:
 7075 2628 FE01      		movw r30,r28
 7076 262a E451      		subi r30,lo8(-(492))
 7077 262c FE4F      		sbci r31,hi8(-(492))
 7078               		.stabn	68,0,1528,.LM600-.LFBB29
 7079               	.LM600:
 7080 262e 8481      		ldd r24,Z+4
 7081 2630 8823      		tst r24
 7082 2632 01F4      		brne .+2
 7083 2634 00C0      		rjmp .L373
 7084               		.stabn	68,0,1529,.LM601-.LFBB29
 7085               	.LM601:
 7086 2636 8385      		ldd r24,Z+11
 7087 2638 90E0      		ldi r25,lo8(0)
 7088 263a A0E0      		ldi r26,lo8(0)
 7089 263c B0E0      		ldi r27,hi8(0)
 7090 263e D82E      		mov r13,r24
 7091 2640 CC24      		clr r12
 7092 2642 BB24      		clr r11
 7093 2644 AA24      		clr r10
 7094 2646 8285      		ldd r24,Z+10
 7095 2648 90E0      		ldi r25,lo8(0)
 7096 264a A0E0      		ldi r26,lo8(0)
 7097 264c B0E0      		ldi r27,hi8(0)
 7098 264e DC01      		movw r26,r24
 7099 2650 9927      		clr r25
 7100 2652 8827      		clr r24
 7101 2654 A82A      		or r10,r24
 7102 2656 B92A      		or r11,r25
 7103 2658 CA2A      		or r12,r26
 7104 265a DB2A      		or r13,r27
 7105 265c 8085      		ldd r24,Z+8
 7106 265e 90E0      		ldi r25,lo8(0)
 7107 2660 A0E0      		ldi r26,lo8(0)
 7108 2662 B0E0      		ldi r27,hi8(0)
GAS LISTING /tmp/ccPugNTh.s 			page 181


 7109 2664 A82A      		or r10,r24
 7110 2666 B92A      		or r11,r25
 7111 2668 CA2A      		or r12,r26
 7112 266a DB2A      		or r13,r27
 7113 266c 9185      		ldd r25,Z+9
 7114 266e 80E0      		ldi r24,lo8(0)
 7115 2670 A0E0      		ldi r26,lo8(0)
 7116 2672 B0E0      		ldi r27,hi8(0)
 7117 2674 A82A      		or r10,r24
 7118 2676 B92A      		or r11,r25
 7119 2678 CA2A      		or r12,r26
 7120 267a DB2A      		or r13,r27
 7121               		.stabn	68,0,1530,.LM602-.LFBB29
 7122               	.LM602:
 7123 267c CE01      		movw r24,r28
 7124 267e B601      		movw r22,r12
 7125 2680 A501      		movw r20,r10
 7126 2682 0E94 0000 		call check_fs
 7127               	.L372:
 7128               		.stabn	68,0,1533,.LM603-.LFBB29
 7129               	.LM603:
 7130 2686 8330      		cpi r24,lo8(3)
 7131 2688 01F4      		brne .L374
 7132 268a 81E0      		ldi r24,lo8(1)
 7133 268c 00C0      		rjmp .L364
 7134               	.L374:
 7135               		.stabn	68,0,1534,.LM604-.LFBB29
 7136               	.LM604:
 7137 268e 8823      		tst r24
 7138 2690 01F0      		breq .+2
 7139 2692 00C0      		rjmp .L373
 7140 2694 9AAD      		ldd r25,Y+58
 7141 2696 80E0      		ldi r24,lo8(0)
 7142 2698 29AD      		ldd r18,Y+57
 7143 269a 30E0      		ldi r19,lo8(0)
 7144 269c 822B      		or r24,r18
 7145 269e 932B      		or r25,r19
 7146 26a0 8050      		subi r24,lo8(512)
 7147 26a2 9240      		sbci r25,hi8(512)
 7148 26a4 01F0      		breq .+2
 7149 26a6 00C0      		rjmp .L373
 7150               		.stabn	68,0,1538,.LM605-.LFBB29
 7151               	.LM605:
 7152 26a8 CB5B      		subi r28,lo8(-(69))
 7153 26aa DF4F      		sbci r29,hi8(-(69))
 7154 26ac 9881      		ld r25,Y
 7155 26ae 80E0      		ldi r24,lo8(0)
 7156 26b0 2A91      		ld r18,-Y
 7157 26b2 C454      		subi r28,lo8(-(-68))
 7158 26b4 D040      		sbci r29,hi8(-(-68))
 7159 26b6 30E0      		ldi r19,lo8(0)
 7160 26b8 822B      		or r24,r18
 7161 26ba 932B      		or r25,r19
 7162 26bc 7C01      		movw r14,r24
 7163 26be 00E0      		ldi r16,lo8(0)
 7164 26c0 10E0      		ldi r17,hi8(0)
 7165               		.stabn	68,0,1539,.LM606-.LFBB29
GAS LISTING /tmp/ccPugNTh.s 			page 182


 7166               	.LM606:
 7167 26c2 E114      		cp r14,__zero_reg__
 7168 26c4 F104      		cpc r15,__zero_reg__
 7169 26c6 0105      		cpc r16,__zero_reg__
 7170 26c8 1105      		cpc r17,__zero_reg__
 7171 26ca 01F4      		brne .L375
 7172 26cc CB5A      		subi r28,lo8(-(85))
 7173 26ce DF4F      		sbci r29,hi8(-(85))
 7174 26d0 8881      		ld r24,Y
 7175 26d2 90E0      		ldi r25,lo8(0)
 7176 26d4 A0E0      		ldi r26,lo8(0)
 7177 26d6 B0E0      		ldi r27,hi8(0)
 7178 26d8 182F      		mov r17,r24
 7179 26da 0027      		clr r16
 7180 26dc FF24      		clr r15
 7181 26de EE24      		clr r14
 7182 26e0 8A91      		ld r24,-Y
 7183 26e2 90E0      		ldi r25,lo8(0)
 7184 26e4 A0E0      		ldi r26,lo8(0)
 7185 26e6 B0E0      		ldi r27,hi8(0)
 7186 26e8 DC01      		movw r26,r24
 7187 26ea 9927      		clr r25
 7188 26ec 8827      		clr r24
 7189 26ee E82A      		or r14,r24
 7190 26f0 F92A      		or r15,r25
 7191 26f2 0A2B      		or r16,r26
 7192 26f4 1B2B      		or r17,r27
 7193 26f6 2297      		sbiw r28,2
 7194 26f8 8991      		ld r24,Y+
 7195 26fa 90E0      		ldi r25,lo8(0)
 7196 26fc A0E0      		ldi r26,lo8(0)
 7197 26fe B0E0      		ldi r27,hi8(0)
 7198 2700 E82A      		or r14,r24
 7199 2702 F92A      		or r15,r25
 7200 2704 0A2B      		or r16,r26
 7201 2706 1B2B      		or r17,r27
 7202 2708 9881      		ld r25,Y
 7203 270a C355      		subi r28,lo8(-(-83))
 7204 270c D040      		sbci r29,hi8(-(-83))
 7205 270e 80E0      		ldi r24,lo8(0)
 7206 2710 A0E0      		ldi r26,lo8(0)
 7207 2712 B0E0      		ldi r27,hi8(0)
 7208 2714 E82A      		or r14,r24
 7209 2716 F92A      		or r15,r25
 7210 2718 0A2B      		or r16,r26
 7211 271a 1B2B      		or r17,r27
 7212               	.L375:
 7213               		.stabn	68,0,1540,.LM607-.LFBB29
 7214               	.LM607:
 7215 271c EE8A      		std Y+22,r14
 7216 271e FF8A      		std Y+23,r15
 7217 2720 088F      		std Y+24,r16
 7218 2722 198F      		std Y+25,r17
 7219               		.stabn	68,0,1541,.LM608-.LFBB29
 7220               	.LM608:
 7221 2724 2EAD      		ldd r18,Y+62
 7222 2726 2B83      		std Y+3,r18
GAS LISTING /tmp/ccPugNTh.s 			page 183


 7223               		.stabn	68,0,1542,.LM609-.LFBB29
 7224               	.LM609:
 7225 2728 30E0      		ldi r19,lo8(0)
 7226 272a 40E0      		ldi r20,lo8(0)
 7227 272c 50E0      		ldi r21,hi8(0)
 7228 272e C801      		movw r24,r16
 7229 2730 B701      		movw r22,r14
 7230 2732 0E94 0000 		call __mulsi3
 7231 2736 3B01      		movw r6,r22
 7232 2738 4C01      		movw r8,r24
 7233               		.stabn	68,0,1543,.LM610-.LFBB29
 7234               	.LM610:
 7235 273a 9DAD      		ldd r25,Y+61
 7236 273c 80E0      		ldi r24,lo8(0)
 7237 273e 2CAD      		ldd r18,Y+60
 7238 2740 30E0      		ldi r19,lo8(0)
 7239 2742 822B      		or r24,r18
 7240 2744 932B      		or r25,r19
 7241 2746 A0E0      		ldi r26,lo8(0)
 7242 2748 B0E0      		ldi r27,hi8(0)
 7243 274a 8A0D      		add r24,r10
 7244 274c 9B1D      		adc r25,r11
 7245 274e AC1D      		adc r26,r12
 7246 2750 BD1D      		adc r27,r13
 7247 2752 8E8F      		std Y+30,r24
 7248 2754 9F8F      		std Y+31,r25
 7249 2756 A8A3      		std Y+32,r26
 7250 2758 B9A3      		std Y+33,r27
 7251               		.stabn	68,0,1544,.LM611-.LFBB29
 7252               	.LM611:
 7253 275a 8BAD      		ldd r24,Y+59
 7254 275c 8A83      		std Y+2,r24
 7255               		.stabn	68,0,1545,.LM612-.LFBB29
 7256               	.LM612:
 7257 275e C05C      		subi r28,lo8(-(64))
 7258 2760 DF4F      		sbci r29,hi8(-(64))
 7259 2762 9881      		ld r25,Y
 7260 2764 C054      		subi r28,lo8(-(-64))
 7261 2766 D040      		sbci r29,hi8(-(-64))
 7262 2768 80E0      		ldi r24,lo8(0)
 7263 276a 2FAD      		ldd r18,Y+63
 7264 276c 422F      		mov r20,r18
 7265 276e 50E0      		ldi r21,lo8(0)
 7266 2770 482B      		or r20,r24
 7267 2772 592B      		or r21,r25
 7268 2774 5987      		std Y+9,r21
 7269 2776 4887      		std Y+8,r20
 7270               		.stabn	68,0,1546,.LM613-.LFBB29
 7271               	.LM613:
 7272 2778 CE5B      		subi r28,lo8(-(66))
 7273 277a DF4F      		sbci r29,hi8(-(66))
 7274 277c 9881      		ld r25,Y
 7275 277e 80E0      		ldi r24,lo8(0)
 7276 2780 2A91      		ld r18,-Y
 7277 2782 C154      		subi r28,lo8(-(-65))
 7278 2784 D040      		sbci r29,hi8(-(-65))
 7279 2786 30E0      		ldi r19,lo8(0)
GAS LISTING /tmp/ccPugNTh.s 			page 184


 7280 2788 822B      		or r24,r18
 7281 278a 932B      		or r25,r19
 7282 278c 7C01      		movw r14,r24
 7283 278e 00E0      		ldi r16,lo8(0)
 7284 2790 10E0      		ldi r17,hi8(0)
 7285               		.stabn	68,0,1547,.LM614-.LFBB29
 7286               	.LM614:
 7287 2792 E114      		cp r14,__zero_reg__
 7288 2794 F104      		cpc r15,__zero_reg__
 7289 2796 0105      		cpc r16,__zero_reg__
 7290 2798 1105      		cpc r17,__zero_reg__
 7291 279a 01F4      		brne .L376
 7292 279c CF5A      		subi r28,lo8(-(81))
 7293 279e DF4F      		sbci r29,hi8(-(81))
 7294 27a0 8881      		ld r24,Y
 7295 27a2 90E0      		ldi r25,lo8(0)
 7296 27a4 A0E0      		ldi r26,lo8(0)
 7297 27a6 B0E0      		ldi r27,hi8(0)
 7298 27a8 182F      		mov r17,r24
 7299 27aa 0027      		clr r16
 7300 27ac FF24      		clr r15
 7301 27ae EE24      		clr r14
 7302 27b0 8A91      		ld r24,-Y
 7303 27b2 90E0      		ldi r25,lo8(0)
 7304 27b4 A0E0      		ldi r26,lo8(0)
 7305 27b6 B0E0      		ldi r27,hi8(0)
 7306 27b8 DC01      		movw r26,r24
 7307 27ba 9927      		clr r25
 7308 27bc 8827      		clr r24
 7309 27be E82A      		or r14,r24
 7310 27c0 F92A      		or r15,r25
 7311 27c2 0A2B      		or r16,r26
 7312 27c4 1B2B      		or r17,r27
 7313 27c6 2297      		sbiw r28,2
 7314 27c8 8991      		ld r24,Y+
 7315 27ca 90E0      		ldi r25,lo8(0)
 7316 27cc A0E0      		ldi r26,lo8(0)
 7317 27ce B0E0      		ldi r27,hi8(0)
 7318 27d0 E82A      		or r14,r24
 7319 27d2 F92A      		or r15,r25
 7320 27d4 0A2B      		or r16,r26
 7321 27d6 1B2B      		or r17,r27
 7322 27d8 9881      		ld r25,Y
 7323 27da CF54      		subi r28,lo8(-(-79))
 7324 27dc D040      		sbci r29,hi8(-(-79))
 7325 27de 80E0      		ldi r24,lo8(0)
 7326 27e0 A0E0      		ldi r26,lo8(0)
 7327 27e2 B0E0      		ldi r27,hi8(0)
 7328 27e4 E82A      		or r14,r24
 7329 27e6 F92A      		or r15,r25
 7330 27e8 0A2B      		or r16,r26
 7331 27ea 1B2B      		or r17,r27
 7332               	.L376:
 7333               		.stabn	68,0,1548,.LM615-.LFBB29
 7334               	.LM615:
 7335 27ec 9DAD      		ldd r25,Y+61
 7336 27ee 80E0      		ldi r24,lo8(0)
GAS LISTING /tmp/ccPugNTh.s 			page 185


 7337 27f0 2CAD      		ldd r18,Y+60
 7338 27f2 30E0      		ldi r19,lo8(0)
 7339 27f4 822B      		or r24,r18
 7340 27f6 932B      		or r25,r19
 7341 27f8 A0E0      		ldi r26,lo8(0)
 7342 27fa B0E0      		ldi r27,hi8(0)
 7343 27fc E81A      		sub r14,r24
 7344 27fe F90A      		sbc r15,r25
 7345 2800 0A0B      		sbc r16,r26
 7346 2802 1B0B      		sbc r17,r27
 7347 2804 E618      		sub r14,r6
 7348 2806 F708      		sbc r15,r7
 7349 2808 0809      		sbc r16,r8
 7350 280a 1909      		sbc r17,r9
 7351 280c B4E0      		ldi r27,4
 7352 280e 5695      	1:	lsr r21
 7353 2810 4795      		ror r20
 7354 2812 BA95      		dec r27
 7355 2814 01F4      		brne 1b
 7356 2816 CA01      		movw r24,r20
 7357 2818 A0E0      		ldi r26,lo8(0)
 7358 281a B0E0      		ldi r27,hi8(0)
 7359 281c E81A      		sub r14,r24
 7360 281e F90A      		sbc r15,r25
 7361 2820 0A0B      		sbc r16,r26
 7362 2822 1B0B      		sbc r17,r27
 7363 2824 2A81      		ldd r18,Y+2
 7364 2826 30E0      		ldi r19,lo8(0)
 7365 2828 40E0      		ldi r20,lo8(0)
 7366 282a 50E0      		ldi r21,hi8(0)
 7367 282c C801      		movw r24,r16
 7368 282e B701      		movw r22,r14
 7369 2830 0E94 0000 		call __udivmodsi4
 7370 2834 2E5F      		subi r18,lo8(-(2))
 7371 2836 3F4F      		sbci r19,hi8(-(2))
 7372 2838 4F4F      		sbci r20,hlo8(-(2))
 7373 283a 5F4F      		sbci r21,hhi8(-(2))
 7374 283c 2A8F      		std Y+26,r18
 7375 283e 3B8F      		std Y+27,r19
 7376 2840 4C8F      		std Y+28,r20
 7377 2842 5D8F      		std Y+29,r21
 7378               		.stabn	68,0,1553,.LM616-.LFBB29
 7379               	.LM616:
 7380 2844 273F      		cpi r18,lo8(4087)
 7381 2846 8FE0      		ldi r24,hi8(4087)
 7382 2848 3807      		cpc r19,r24
 7383 284a 80E0      		ldi r24,hlo8(4087)
 7384 284c 4807      		cpc r20,r24
 7385 284e 80E0      		ldi r24,hhi8(4087)
 7386 2850 5807      		cpc r21,r24
 7387 2852 00F4      		brsh .L377
 7388 2854 11E0      		ldi r17,lo8(1)
 7389 2856 00C0      		rjmp .L378
 7390               	.L377:
 7391               		.stabn	68,0,1554,.LM617-.LFBB29
 7392               	.LM617:
 7393 2858 275F      		subi r18,lo8(65527)
GAS LISTING /tmp/ccPugNTh.s 			page 186


 7394 285a 3F4F      		sbci r19,hi8(65527)
 7395 285c 4040      		sbci r20,hlo8(65527)
 7396 285e 5040      		sbci r21,hhi8(65527)
 7397 2860 00F0      		brlo .+2
 7398 2862 00C0      		rjmp .L379
 7399 2864 12E0      		ldi r17,lo8(2)
 7400               	.L378:
 7401               		.stabn	68,0,1559,.LM618-.LFBB29
 7402               	.LM618:
 7403 2866 8E8D      		ldd r24,Y+30
 7404 2868 9F8D      		ldd r25,Y+31
 7405 286a A8A1      		ldd r26,Y+32
 7406 286c B9A1      		ldd r27,Y+33
 7407 286e 860D      		add r24,r6
 7408 2870 971D      		adc r25,r7
 7409 2872 A81D      		adc r26,r8
 7410 2874 B91D      		adc r27,r9
 7411 2876 8AA3      		std Y+34,r24
 7412 2878 9BA3      		std Y+35,r25
 7413 287a ACA3      		std Y+36,r26
 7414 287c BDA3      		std Y+37,r27
 7415               	.L381:
 7416               		.stabn	68,0,1560,.LM619-.LFBB29
 7417               	.LM619:
 7418 287e 8885      		ldd r24,Y+8
 7419 2880 9985      		ldd r25,Y+9
 7420 2882 A4E0      		ldi r26,4
 7421 2884 9695      	1:	lsr r25
 7422 2886 8795      		ror r24
 7423 2888 AA95      		dec r26
 7424 288a 01F4      		brne 1b
 7425 288c A0E0      		ldi r26,lo8(0)
 7426 288e B0E0      		ldi r27,hi8(0)
 7427 2890 2E8D      		ldd r18,Y+30
 7428 2892 3F8D      		ldd r19,Y+31
 7429 2894 48A1      		ldd r20,Y+32
 7430 2896 59A1      		ldd r21,Y+33
 7431 2898 820F      		add r24,r18
 7432 289a 931F      		adc r25,r19
 7433 289c A41F      		adc r26,r20
 7434 289e B51F      		adc r27,r21
 7435 28a0 860D      		add r24,r6
 7436 28a2 971D      		adc r25,r7
 7437 28a4 A81D      		adc r26,r8
 7438 28a6 B91D      		adc r27,r9
 7439 28a8 8EA3      		std Y+38,r24
 7440 28aa 9FA3      		std Y+39,r25
 7441 28ac A8A7      		std Y+40,r26
 7442 28ae B9A7      		std Y+41,r27
 7443               		.stabn	68,0,1564,.LM620-.LFBB29
 7444               	.LM620:
 7445 28b0 8FEF      		ldi r24,lo8(-1)
 7446 28b2 9FEF      		ldi r25,hi8(-1)
 7447 28b4 AFEF      		ldi r26,hlo8(-1)
 7448 28b6 BFEF      		ldi r27,hhi8(-1)
 7449 28b8 8E87      		std Y+14,r24
 7450 28ba 9F87      		std Y+15,r25
GAS LISTING /tmp/ccPugNTh.s 			page 187


 7451 28bc A88B      		std Y+16,r26
 7452 28be B98B      		std Y+17,r27
 7453               		.stabn	68,0,1565,.LM621-.LFBB29
 7454               	.LM621:
 7455 28c0 1C82      		std Y+4,__zero_reg__
 7456               		.stabn	68,0,1567,.LM622-.LFBB29
 7457               	.LM622:
 7458 28c2 1330      		cpi r17,lo8(3)
 7459 28c4 01F0      		breq .+2
 7460 28c6 00C0      		rjmp .L380
 7461               		.stabn	68,0,1568,.LM623-.LFBB29
 7462               	.LM623:
 7463 28c8 1D82      		std Y+5,__zero_reg__
 7464               		.stabn	68,0,1569,.LM624-.LFBB29
 7465               	.LM624:
 7466 28ca C15A      		subi r28,lo8(-(95))
 7467 28cc DF4F      		sbci r29,hi8(-(95))
 7468 28ce 3881      		ld r19,Y
 7469 28d0 20E0      		ldi r18,lo8(0)
 7470 28d2 8A91      		ld r24,-Y
 7471 28d4 CE55      		subi r28,lo8(-(-94))
 7472 28d6 D040      		sbci r29,hi8(-(-94))
 7473 28d8 90E0      		ldi r25,lo8(0)
 7474 28da 282B      		or r18,r24
 7475 28dc 392B      		or r19,r25
 7476 28de 40E0      		ldi r20,lo8(0)
 7477 28e0 50E0      		ldi r21,hi8(0)
 7478 28e2 2A0D      		add r18,r10
 7479 28e4 3B1D      		adc r19,r11
 7480 28e6 4C1D      		adc r20,r12
 7481 28e8 5D1D      		adc r21,r13
 7482 28ea 2A8B      		std Y+18,r18
 7483 28ec 3B8B      		std Y+19,r19
 7484 28ee 4C8B      		std Y+20,r20
 7485 28f0 5D8B      		std Y+21,r21
 7486               		.stabn	68,0,1570,.LM625-.LFBB29
 7487               	.LM625:
 7488 28f2 BE01      		movw r22,r28
 7489 28f4 625D      		subi r22,lo8(-(46))
 7490 28f6 7F4F      		sbci r23,hi8(-(46))
 7491 28f8 8981      		ldd r24,Y+1
 7492 28fa 01E0      		ldi r16,lo8(1)
 7493 28fc 0E94 0000 		call disk_read
 7494 2900 8823      		tst r24
 7495 2902 01F0      		breq .+2
 7496 2904 00C0      		rjmp .L380
 7497 2906 C35D      		subi r28,lo8(-(557))
 7498 2908 DD4F      		sbci r29,hi8(-(557))
 7499 290a 9881      		ld r25,Y
 7500 290c 80E0      		ldi r24,lo8(0)
 7501 290e 2A91      		ld r18,-Y
 7502 2910 CC52      		subi r28,lo8(-(-556))
 7503 2912 D240      		sbci r29,hi8(-(-556))
 7504 2914 30E0      		ldi r19,lo8(0)
 7505 2916 822B      		or r24,r18
 7506 2918 932B      		or r25,r19
 7507 291a 8555      		subi r24,lo8(-21931)
GAS LISTING /tmp/ccPugNTh.s 			page 188


 7508 291c 9A4A      		sbci r25,hi8(-21931)
 7509 291e 01F0      		breq .+2
 7510 2920 00C0      		rjmp .L380
 7511 2922 29A9      		ldd r18,Y+49
 7512 2924 30E0      		ldi r19,lo8(0)
 7513 2926 40E0      		ldi r20,lo8(0)
 7514 2928 50E0      		ldi r21,hi8(0)
 7515 292a 522F      		mov r21,r18
 7516 292c 4427      		clr r20
 7517 292e 3327      		clr r19
 7518 2930 2227      		clr r18
 7519 2932 88A9      		ldd r24,Y+48
 7520 2934 90E0      		ldi r25,lo8(0)
 7521 2936 A0E0      		ldi r26,lo8(0)
 7522 2938 B0E0      		ldi r27,hi8(0)
 7523 293a DC01      		movw r26,r24
 7524 293c 9927      		clr r25
 7525 293e 8827      		clr r24
 7526 2940 282B      		or r18,r24
 7527 2942 392B      		or r19,r25
 7528 2944 4A2B      		or r20,r26
 7529 2946 5B2B      		or r21,r27
 7530 2948 8EA5      		ldd r24,Y+46
 7531 294a 90E0      		ldi r25,lo8(0)
 7532 294c A0E0      		ldi r26,lo8(0)
 7533 294e B0E0      		ldi r27,hi8(0)
 7534 2950 282B      		or r18,r24
 7535 2952 392B      		or r19,r25
 7536 2954 4A2B      		or r20,r26
 7537 2956 5B2B      		or r21,r27
 7538 2958 9FA5      		ldd r25,Y+47
 7539 295a 80E0      		ldi r24,lo8(0)
 7540 295c A0E0      		ldi r26,lo8(0)
 7541 295e B0E0      		ldi r27,hi8(0)
 7542 2960 282B      		or r18,r24
 7543 2962 392B      		or r19,r25
 7544 2964 4A2B      		or r20,r26
 7545 2966 5B2B      		or r21,r27
 7546 2968 2255      		subi r18,lo8(1096897106)
 7547 296a 3245      		sbci r19,hi8(1096897106)
 7548 296c 4146      		sbci r20,hlo8(1096897106)
 7549 296e 5144      		sbci r21,hhi8(1096897106)
 7550 2970 01F0      		breq .+2
 7551 2972 00C0      		rjmp .L380
 7552 2974 CB5E      		subi r28,lo8(-(533))
 7553 2976 DD4F      		sbci r29,hi8(-(533))
 7554 2978 2881      		ld r18,Y
 7555 297a 30E0      		ldi r19,lo8(0)
 7556 297c 40E0      		ldi r20,lo8(0)
 7557 297e 50E0      		ldi r21,hi8(0)
 7558 2980 522F      		mov r21,r18
 7559 2982 4427      		clr r20
 7560 2984 3327      		clr r19
 7561 2986 2227      		clr r18
 7562 2988 8A91      		ld r24,-Y
 7563 298a 90E0      		ldi r25,lo8(0)
 7564 298c A0E0      		ldi r26,lo8(0)
GAS LISTING /tmp/ccPugNTh.s 			page 189


 7565 298e B0E0      		ldi r27,hi8(0)
 7566 2990 DC01      		movw r26,r24
 7567 2992 9927      		clr r25
 7568 2994 8827      		clr r24
 7569 2996 282B      		or r18,r24
 7570 2998 392B      		or r19,r25
 7571 299a 4A2B      		or r20,r26
 7572 299c 5B2B      		or r21,r27
 7573 299e 2297      		sbiw r28,2
 7574 29a0 8991      		ld r24,Y+
 7575 29a2 90E0      		ldi r25,lo8(0)
 7576 29a4 A0E0      		ldi r26,lo8(0)
 7577 29a6 B0E0      		ldi r27,hi8(0)
 7578 29a8 282B      		or r18,r24
 7579 29aa 392B      		or r19,r25
 7580 29ac 4A2B      		or r20,r26
 7581 29ae 5B2B      		or r21,r27
 7582 29b0 9881      		ld r25,Y
 7583 29b2 C351      		subi r28,lo8(-(-531))
 7584 29b4 D240      		sbci r29,hi8(-(-531))
 7585 29b6 80E0      		ldi r24,lo8(0)
 7586 29b8 A0E0      		ldi r26,lo8(0)
 7587 29ba B0E0      		ldi r27,hi8(0)
 7588 29bc 282B      		or r18,r24
 7589 29be 392B      		or r19,r25
 7590 29c0 4A2B      		or r20,r26
 7591 29c2 5B2B      		or r21,r27
 7592 29c4 2257      		subi r18,lo8(1631679090)
 7593 29c6 3247      		sbci r19,hi8(1631679090)
 7594 29c8 4144      		sbci r20,hlo8(1631679090)
 7595 29ca 5146      		sbci r21,hhi8(1631679090)
 7596 29cc 01F0      		breq .+2
 7597 29ce 00C0      		rjmp .L380
 7598               		.stabn	68,0,1574,.LM626-.LFBB29
 7599               	.LM626:
 7600 29d0 C35E      		subi r28,lo8(-(541))
 7601 29d2 DD4F      		sbci r29,hi8(-(541))
 7602 29d4 2881      		ld r18,Y
 7603 29d6 30E0      		ldi r19,lo8(0)
 7604 29d8 40E0      		ldi r20,lo8(0)
 7605 29da 50E0      		ldi r21,hi8(0)
 7606 29dc 522F      		mov r21,r18
 7607 29de 4427      		clr r20
 7608 29e0 3327      		clr r19
 7609 29e2 2227      		clr r18
 7610 29e4 8A91      		ld r24,-Y
 7611 29e6 90E0      		ldi r25,lo8(0)
 7612 29e8 A0E0      		ldi r26,lo8(0)
 7613 29ea B0E0      		ldi r27,hi8(0)
 7614 29ec DC01      		movw r26,r24
 7615 29ee 9927      		clr r25
 7616 29f0 8827      		clr r24
 7617 29f2 282B      		or r18,r24
 7618 29f4 392B      		or r19,r25
 7619 29f6 4A2B      		or r20,r26
 7620 29f8 5B2B      		or r21,r27
 7621 29fa 2297      		sbiw r28,2
GAS LISTING /tmp/ccPugNTh.s 			page 190


 7622 29fc 8991      		ld r24,Y+
 7623 29fe 90E0      		ldi r25,lo8(0)
 7624 2a00 A0E0      		ldi r26,lo8(0)
 7625 2a02 B0E0      		ldi r27,hi8(0)
 7626 2a04 282B      		or r18,r24
 7627 2a06 392B      		or r19,r25
 7628 2a08 4A2B      		or r20,r26
 7629 2a0a 5B2B      		or r21,r27
 7630 2a0c 9881      		ld r25,Y
 7631 2a0e CB51      		subi r28,lo8(-(-539))
 7632 2a10 D240      		sbci r29,hi8(-(-539))
 7633 2a12 80E0      		ldi r24,lo8(0)
 7634 2a14 A0E0      		ldi r26,lo8(0)
 7635 2a16 B0E0      		ldi r27,hi8(0)
 7636 2a18 282B      		or r18,r24
 7637 2a1a 392B      		or r19,r25
 7638 2a1c 4A2B      		or r20,r26
 7639 2a1e 5B2B      		or r21,r27
 7640 2a20 2A87      		std Y+10,r18
 7641 2a22 3B87      		std Y+11,r19
 7642 2a24 4C87      		std Y+12,r20
 7643 2a26 5D87      		std Y+13,r21
 7644               		.stabn	68,0,1575,.LM627-.LFBB29
 7645               	.LM627:
 7646 2a28 C75E      		subi r28,lo8(-(537))
 7647 2a2a DD4F      		sbci r29,hi8(-(537))
 7648 2a2c 2881      		ld r18,Y
 7649 2a2e 30E0      		ldi r19,lo8(0)
 7650 2a30 40E0      		ldi r20,lo8(0)
 7651 2a32 50E0      		ldi r21,hi8(0)
 7652 2a34 522F      		mov r21,r18
 7653 2a36 4427      		clr r20
 7654 2a38 3327      		clr r19
 7655 2a3a 2227      		clr r18
 7656 2a3c 8A91      		ld r24,-Y
 7657 2a3e 90E0      		ldi r25,lo8(0)
 7658 2a40 A0E0      		ldi r26,lo8(0)
 7659 2a42 B0E0      		ldi r27,hi8(0)
 7660 2a44 DC01      		movw r26,r24
 7661 2a46 9927      		clr r25
 7662 2a48 8827      		clr r24
 7663 2a4a 282B      		or r18,r24
 7664 2a4c 392B      		or r19,r25
 7665 2a4e 4A2B      		or r20,r26
 7666 2a50 5B2B      		or r21,r27
 7667 2a52 2297      		sbiw r28,2
 7668 2a54 8991      		ld r24,Y+
 7669 2a56 90E0      		ldi r25,lo8(0)
 7670 2a58 A0E0      		ldi r26,lo8(0)
 7671 2a5a B0E0      		ldi r27,hi8(0)
 7672 2a5c 282B      		or r18,r24
 7673 2a5e 392B      		or r19,r25
 7674 2a60 4A2B      		or r20,r26
 7675 2a62 5B2B      		or r21,r27
 7676 2a64 9881      		ld r25,Y
 7677 2a66 C751      		subi r28,lo8(-(-535))
 7678 2a68 D240      		sbci r29,hi8(-(-535))
GAS LISTING /tmp/ccPugNTh.s 			page 191


 7679 2a6a 80E0      		ldi r24,lo8(0)
 7680 2a6c A0E0      		ldi r26,lo8(0)
 7681 2a6e B0E0      		ldi r27,hi8(0)
 7682 2a70 282B      		or r18,r24
 7683 2a72 392B      		or r19,r25
 7684 2a74 4A2B      		or r20,r26
 7685 2a76 5B2B      		or r21,r27
 7686 2a78 2E87      		std Y+14,r18
 7687 2a7a 3F87      		std Y+15,r19
 7688 2a7c 488B      		std Y+16,r20
 7689 2a7e 598B      		std Y+17,r21
 7690               	.L380:
 7691               		.stabn	68,0,1579,.LM628-.LFBB29
 7692               	.LM628:
 7693 2a80 1883      		st Y,r17
 7694               		.stabn	68,0,1580,.LM629-.LFBB29
 7695               	.LM629:
 7696 2a82 1AA6      		std Y+42,__zero_reg__
 7697 2a84 1BA6      		std Y+43,__zero_reg__
 7698 2a86 1CA6      		std Y+44,__zero_reg__
 7699 2a88 1DA6      		std Y+45,__zero_reg__
 7700               		.stabn	68,0,1584,.LM630-.LFBB29
 7701               	.LM630:
 7702 2a8a 8091 0000 		lds r24,Fsid
 7703 2a8e 9091 0000 		lds r25,(Fsid)+1
 7704 2a92 0196      		adiw r24,1
 7705 2a94 9093 0000 		sts (Fsid)+1,r25
 7706 2a98 8093 0000 		sts Fsid,r24
 7707 2a9c 9F83      		std Y+7,r25
 7708 2a9e 8E83      		std Y+6,r24
 7709 2aa0 00C0      		rjmp .L367
 7710               	.L368:
 7711               		.stabn	68,0,1586,.LM631-.LFBB29
 7712               	.LM631:
 7713 2aa2 8AE0      		ldi r24,lo8(10)
 7714 2aa4 00C0      		rjmp .L364
 7715               	.L367:
 7716 2aa6 80E0      		ldi r24,lo8(0)
 7717 2aa8 00C0      		rjmp .L364
 7718               	.L373:
 7719 2aaa 8DE0      		ldi r24,lo8(13)
 7720               	.L364:
 7721               	/* epilogue start */
 7722               		.stabn	68,0,1587,.LM632-.LFBB29
 7723               	.LM632:
 7724 2aac DF91      		pop r29
 7725 2aae CF91      		pop r28
 7726 2ab0 1F91      		pop r17
 7727 2ab2 0F91      		pop r16
 7728 2ab4 FF90      		pop r15
 7729 2ab6 EF90      		pop r14
 7730 2ab8 DF90      		pop r13
 7731 2aba CF90      		pop r12
 7732 2abc BF90      		pop r11
 7733 2abe AF90      		pop r10
 7734 2ac0 9F90      		pop r9
 7735 2ac2 8F90      		pop r8
GAS LISTING /tmp/ccPugNTh.s 			page 192


 7736 2ac4 7F90      		pop r7
 7737 2ac6 6F90      		pop r6
 7738 2ac8 0895      		ret
 7739               	.L379:
 7740               		.stabn	68,0,1557,.LM633-.LFBB29
 7741               	.LM633:
 7742 2aca C35A      		subi r28,lo8(-(93))
 7743 2acc DF4F      		sbci r29,hi8(-(93))
 7744 2ace 2881      		ld r18,Y
 7745 2ad0 30E0      		ldi r19,lo8(0)
 7746 2ad2 40E0      		ldi r20,lo8(0)
 7747 2ad4 50E0      		ldi r21,hi8(0)
 7748 2ad6 522F      		mov r21,r18
 7749 2ad8 4427      		clr r20
 7750 2ada 3327      		clr r19
 7751 2adc 2227      		clr r18
 7752 2ade 8A91      		ld r24,-Y
 7753 2ae0 90E0      		ldi r25,lo8(0)
 7754 2ae2 A0E0      		ldi r26,lo8(0)
 7755 2ae4 B0E0      		ldi r27,hi8(0)
 7756 2ae6 DC01      		movw r26,r24
 7757 2ae8 9927      		clr r25
 7758 2aea 8827      		clr r24
 7759 2aec 282B      		or r18,r24
 7760 2aee 392B      		or r19,r25
 7761 2af0 4A2B      		or r20,r26
 7762 2af2 5B2B      		or r21,r27
 7763 2af4 2297      		sbiw r28,2
 7764 2af6 8991      		ld r24,Y+
 7765 2af8 90E0      		ldi r25,lo8(0)
 7766 2afa A0E0      		ldi r26,lo8(0)
 7767 2afc B0E0      		ldi r27,hi8(0)
 7768 2afe 282B      		or r18,r24
 7769 2b00 392B      		or r19,r25
 7770 2b02 4A2B      		or r20,r26
 7771 2b04 5B2B      		or r21,r27
 7772 2b06 9881      		ld r25,Y
 7773 2b08 CB55      		subi r28,lo8(-(-91))
 7774 2b0a D040      		sbci r29,hi8(-(-91))
 7775 2b0c 80E0      		ldi r24,lo8(0)
 7776 2b0e A0E0      		ldi r26,lo8(0)
 7777 2b10 B0E0      		ldi r27,hi8(0)
 7778 2b12 282B      		or r18,r24
 7779 2b14 392B      		or r19,r25
 7780 2b16 4A2B      		or r20,r26
 7781 2b18 5B2B      		or r21,r27
 7782 2b1a 2AA3      		std Y+34,r18
 7783 2b1c 3BA3      		std Y+35,r19
 7784 2b1e 4CA3      		std Y+36,r20
 7785 2b20 5DA3      		std Y+37,r21
 7786 2b22 13E0      		ldi r17,lo8(3)
 7787 2b24 00C0      		rjmp .L381
 7788               		.size	chk_mounted, .-chk_mounted
 7789               		.stabs	"fmt:r(2,5)",64,0,1470,24
 7790               		.stabs	"tbl:r(1,8)",64,0,1470,30
 7791               		.stabs	"vol:r(2,2)",64,0,1471,18
 7792               		.stabs	"bsect:r(2,12)",64,0,1473,10
GAS LISTING /tmp/ccPugNTh.s 			page 193


 7793               		.stabs	"fsize:r(2,12)",64,0,1473,14
 7794               		.stabs	"tsect:r(2,12)",64,0,1473,14
 7795               		.stabs	"mclst:r(2,12)",64,0,1473,18
 7796               		.stabs	"p:r(0,19)",64,0,1474,30
 7797               		.stabs	"fs:r(1,7)",64,0,1475,28
 7798               		.stabn	192,0,0,.LFBB29-.LFBB29
 7799               		.stabn	224,0,0,.Lscope29-.LFBB29
 7800               	.Lscope29:
 7801               		.stabs	"",36,0,0,.Lscope29-.LFBB29
 7802               		.stabd	78,0,0
 7803               		.stabs	"f_rename:F(1,16)",36,0,2646,f_rename
 7804               		.stabs	"path_old:p(0,19)",160,0,2643,78
 7805               		.stabs	"path_new:P(0,19)",64,0,2644,12
 7806               	.global	f_rename
 7807               		.type	f_rename, @function
 7808               	f_rename:
 7809               		.stabd	46,0,0
 7810               		.stabn	68,0,2646,.LM634-.LFBB30
 7811               	.LM634:
 7812               	.LFBB30:
 7813 2b26 CF92      		push r12
 7814 2b28 DF92      		push r13
 7815 2b2a EF92      		push r14
 7816 2b2c FF92      		push r15
 7817 2b2e 0F93      		push r16
 7818 2b30 1F93      		push r17
 7819 2b32 DF93      		push r29
 7820 2b34 CF93      		push r28
 7821 2b36 CDB7      		in r28,__SP_L__
 7822 2b38 DEB7      		in r29,__SP_H__
 7823 2b3a CF54      		subi r28,lo8(-(-79))
 7824 2b3c D040      		sbci r29,hi8(-(-79))
 7825 2b3e 0FB6      		in __tmp_reg__,__SREG__
 7826 2b40 F894      		cli
 7827 2b42 DEBF      		out __SP_H__,r29
 7828 2b44 0FBE      		out __SREG__,__tmp_reg__
 7829 2b46 CDBF      		out __SP_L__,r28
 7830               	/* prologue: function */
 7831               	/* frame size = 79 */
 7832 2b48 8E01      		movw r16,r28
 7833 2b4a 025B      		subi r16,lo8(-(78))
 7834 2b4c 1F4F      		sbci r17,hi8(-(78))
 7835 2b4e D801      		movw r26,r16
 7836 2b50 8D93      		st X+,r24
 7837 2b52 9C93      		st X,r25
 7838 2b54 6B01      		movw r12,r22
 7839               		.stabn	68,0,2654,.LM635-.LFBB30
 7840               	.LM635:
 7841 2b56 CE01      		movw r24,r28
 7842 2b58 0196      		adiw r24,1
 7843 2b5a 9FAB      		std Y+55,r25
 7844 2b5c 8EAB      		std Y+54,r24
 7845               		.stabn	68,0,2655,.LM636-.LFBB30
 7846               	.LM636:
 7847 2b5e 82E2      		ldi r24,lo8(34)
 7848 2b60 E82E      		mov r14,r24
 7849 2b62 F12C      		mov r15,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 194


 7850 2b64 EC0E      		add r14,r28
 7851 2b66 FD1E      		adc r15,r29
 7852 2b68 C801      		movw r24,r16
 7853 2b6a B701      		movw r22,r14
 7854 2b6c 41E0      		ldi r20,lo8(1)
 7855 2b6e 0E94 0000 		call chk_mounted
 7856               		.stabn	68,0,2656,.LM637-.LFBB30
 7857               	.LM637:
 7858 2b72 8823      		tst r24
 7859 2b74 01F0      		breq .+2
 7860 2b76 00C0      		rjmp .L384
 7861               		.stabn	68,0,2657,.LM638-.LFBB30
 7862               	.LM638:
 7863 2b78 8AA1      		ldd r24,Y+34
 7864 2b7a 9BA1      		ldd r25,Y+35
 7865 2b7c 99AF      		std Y+57,r25
 7866 2b7e 88AF      		std Y+56,r24
 7867               		.stabn	68,0,2658,.LM639-.LFBB30
 7868               	.LM639:
 7869 2b80 F801      		movw r30,r16
 7870 2b82 6081      		ld r22,Z
 7871 2b84 7181      		ldd r23,Z+1
 7872 2b86 C701      		movw r24,r14
 7873 2b88 0E94 0000 		call follow_path
 7874               		.stabn	68,0,2662,.LM640-.LFBB30
 7875               	.LM640:
 7876 2b8c 8823      		tst r24
 7877 2b8e 01F0      		breq .+2
 7878 2b90 00C0      		rjmp .L384
 7879               		.stabn	68,0,2664,.LM641-.LFBB30
 7880               	.LM641:
 7881 2b92 8CA9      		ldd r24,Y+52
 7882 2b94 9DA9      		ldd r25,Y+53
 7883 2b96 0097      		sbiw r24,0
 7884 2b98 01F4      		brne .L385
 7885 2b9a 84E0      		ldi r24,lo8(4)
 7886 2b9c 00C0      		rjmp .L384
 7887               	.L385:
 7888 2b9e DC01      		movw r26,r24
 7889 2ba0 FE01      		movw r30,r28
 7890 2ba2 3D96      		adiw r30,13
 7891 2ba4 00C0      		rjmp .L386
 7892               	.L387:
 7893               	.LBB112:
 7894               	.LBB113:
 7895               		.stabn	68,0,179,.LM642-.LFBB30
 7896               	.LM642:
 7897 2ba6 1A96      		adiw r26,10
 7898 2ba8 8C91      		ld r24,X
 7899 2baa 1A97      		sbiw r26,10
 7900 2bac 8193      		st Z+,r24
 7901               	.L386:
 7902 2bae 1196      		adiw r26,1
 7903 2bb0 EE15      		cp r30,r14
 7904 2bb2 FF05      		cpc r31,r15
 7905 2bb4 01F4      		brne .L387
 7906               	.LBE113:
GAS LISTING /tmp/ccPugNTh.s 			page 195


 7907               	.LBE112:
 7908               	.LBB114:
 7909               	.LBB115:
 7910               		.stabn	68,0,177,.LM643-.LFBB30
 7911               	.LM643:
 7912 2bb6 DE01      		movw r26,r28
 7913 2bb8 D896      		adiw r26,56
 7914               		.stabn	68,0,178,.LM644-.LFBB30
 7915               	.LM644:
 7916 2bba F701      		movw r30,r14
 7917               		.stabn	68,0,179,.LM645-.LFBB30
 7918               	.LM645:
 7919 2bbc 9D01      		movw r18,r26
 7920 2bbe 00C0      		rjmp .L388
 7921               	.L389:
 7922 2bc0 8191      		ld r24,Z+
 7923 2bc2 8D93      		st X+,r24
 7924               	.L388:
 7925 2bc4 E217      		cp r30,r18
 7926 2bc6 F307      		cpc r31,r19
 7927 2bc8 01F4      		brne .L389
 7928               	.LBE115:
 7929               	.LBE114:
 7930               		.stabn	68,0,2668,.LM646-.LFBB30
 7931               	.LM646:
 7932 2bca 8E01      		movw r16,r28
 7933 2bcc 085C      		subi r16,lo8(-(56))
 7934 2bce 1F4F      		sbci r17,hi8(-(56))
 7935 2bd0 C801      		movw r24,r16
 7936 2bd2 B601      		movw r22,r12
 7937 2bd4 0E94 0000 		call follow_path
 7938               		.stabn	68,0,2669,.LM647-.LFBB30
 7939               	.LM647:
 7940 2bd8 8823      		tst r24
 7941 2bda 01F4      		brne .L390
 7942 2bdc 88E0      		ldi r24,lo8(8)
 7943 2bde 00C0      		rjmp .L384
 7944               	.L390:
 7945               		.stabn	68,0,2670,.LM648-.LFBB30
 7946               	.LM648:
 7947 2be0 8430      		cpi r24,lo8(4)
 7948 2be2 01F0      		breq .+2
 7949 2be4 00C0      		rjmp .L384
 7950               		.stabn	68,0,2671,.LM649-.LFBB30
 7951               	.LM649:
 7952 2be6 C801      		movw r24,r16
 7953 2be8 0E94 0000 		call dir_register
 7954               		.stabn	68,0,2672,.LM650-.LFBB30
 7955               	.LM650:
 7956 2bec 8823      		tst r24
 7957 2bee 01F0      		breq .+2
 7958 2bf0 00C0      		rjmp .L384
 7959               		.stabn	68,0,2673,.LM651-.LFBB30
 7960               	.LM651:
 7961 2bf2 FE01      		movw r30,r28
 7962 2bf4 E65B      		subi r30,lo8(-(74))
 7963 2bf6 FF4F      		sbci r31,hi8(-(74))
GAS LISTING /tmp/ccPugNTh.s 			page 196


 7964 2bf8 4081      		ld r20,Z
 7965 2bfa 5181      		ldd r21,Z+1
 7966 2bfc DA01      		movw r26,r20
 7967 2bfe FE01      		movw r30,r28
 7968 2c00 3F96      		adiw r30,15
 7969 2c02 00C0      		rjmp .L391
 7970               	.L392:
 7971               	.LBB116:
 7972               	.LBB117:
 7973               		.stabn	68,0,179,.LM652-.LFBB30
 7974               	.LM652:
 7975 2c04 8191      		ld r24,Z+
 7976 2c06 1C96      		adiw r26,12
 7977 2c08 8C93      		st X,r24
 7978 2c0a 1C97      		sbiw r26,12
 7979               	.L391:
 7980 2c0c 1196      		adiw r26,1
 7981 2c0e EE15      		cp r30,r14
 7982 2c10 FF05      		cpc r31,r15
 7983 2c12 01F4      		brne .L392
 7984               	.LBE117:
 7985               	.LBE116:
 7986               		.stabn	68,0,2675,.LM653-.LFBB30
 7987               	.LM653:
 7988 2c14 8D85      		ldd r24,Y+13
 7989 2c16 8062      		ori r24,lo8(32)
 7990 2c18 DA01      		movw r26,r20
 7991 2c1a 1B96      		adiw r26,11
 7992 2c1c 8C93      		st X,r24
 7993 2c1e 1B97      		sbiw r26,11
 7994               		.stabn	68,0,2676,.LM654-.LFBB30
 7995               	.LM654:
 7996 2c20 EAA1      		ldd r30,Y+34
 7997 2c22 FBA1      		ldd r31,Y+35
 7998 2c24 81E0      		ldi r24,lo8(1)
 7999 2c26 8483      		std Z+4,r24
 8000               		.stabn	68,0,2677,.LM655-.LFBB30
 8001               	.LM655:
 8002 2c28 1B96      		adiw r26,11
 8003 2c2a 8C91      		ld r24,X
 8004 2c2c 1B97      		sbiw r26,11
 8005 2c2e 84FF      		sbrs r24,4
 8006 2c30 00C0      		rjmp .L393
 8007               		.stabn	68,0,2678,.LM656-.LFBB30
 8008               	.LM656:
 8009 2c32 C8AC      		ldd r12,Y+56
 8010 2c34 D9AC      		ldd r13,Y+57
 8011               	.LBB118:
 8012               	.LBB119:
 8013               		.stabn	68,0,532,.LM657-.LFBB30
 8014               	.LM657:
 8015 2c36 5A96      		adiw r26,26
 8016 2c38 2C91      		ld r18,X
 8017 2c3a 5A97      		sbiw r26,26
 8018 2c3c 30E0      		ldi r19,lo8(0)
 8019 2c3e 5496      		adiw r26,20
 8020 2c40 8C91      		ld r24,X
GAS LISTING /tmp/ccPugNTh.s 			page 197


 8021 2c42 5497      		sbiw r26,20
 8022 2c44 90E0      		ldi r25,lo8(0)
 8023 2c46 282B      		or r18,r24
 8024 2c48 392B      		or r19,r25
 8025 2c4a 5596      		adiw r26,21
 8026 2c4c 9C91      		ld r25,X
 8027 2c4e 5597      		sbiw r26,21
 8028 2c50 80E0      		ldi r24,lo8(0)
 8029 2c52 282B      		or r18,r24
 8030 2c54 392B      		or r19,r25
 8031 2c56 5B96      		adiw r26,27
 8032 2c58 9C91      		ld r25,X
 8033 2c5a 80E0      		ldi r24,lo8(0)
 8034 2c5c 282B      		or r18,r24
 8035 2c5e 392B      		or r19,r25
 8036 2c60 7901      		movw r14,r18
 8037 2c62 00E0      		ldi r16,lo8(0)
 8038 2c64 10E0      		ldi r17,hi8(0)
 8039 2c66 8EEF      		ldi r24,lo8(-2)
 8040 2c68 9FEF      		ldi r25,hi8(-2)
 8041 2c6a AFEF      		ldi r26,hlo8(-2)
 8042 2c6c BFEF      		ldi r27,hhi8(-2)
 8043 2c6e E80E      		add r14,r24
 8044 2c70 F91E      		adc r15,r25
 8045 2c72 0A1F      		adc r16,r26
 8046 2c74 1B1F      		adc r17,r27
 8047               		.stabn	68,0,533,.LM658-.LFBB30
 8048               	.LM658:
 8049 2c76 F601      		movw r30,r12
 8050 2c78 828D      		ldd r24,Z+26
 8051 2c7a 938D      		ldd r25,Z+27
 8052 2c7c A48D      		ldd r26,Z+28
 8053 2c7e B58D      		ldd r27,Z+29
 8054 2c80 0297      		sbiw r24,2
 8055 2c82 A109      		sbc r26,__zero_reg__
 8056 2c84 B109      		sbc r27,__zero_reg__
 8057 2c86 E816      		cp r14,r24
 8058 2c88 F906      		cpc r15,r25
 8059 2c8a 0A07      		cpc r16,r26
 8060 2c8c 1B07      		cpc r17,r27
 8061 2c8e 00F0      		brlo .+2
 8062 2c90 00C0      		rjmp .L394
 8063               		.stabn	68,0,534,.LM659-.LFBB30
 8064               	.LM659:
 8065 2c92 2281      		ldd r18,Z+2
 8066 2c94 30E0      		ldi r19,lo8(0)
 8067 2c96 40E0      		ldi r20,lo8(0)
 8068 2c98 50E0      		ldi r21,hi8(0)
 8069 2c9a C801      		movw r24,r16
 8070 2c9c B701      		movw r22,r14
 8071 2c9e 0E94 0000 		call __mulsi3
 8072 2ca2 AB01      		movw r20,r22
 8073 2ca4 BC01      		movw r22,r24
 8074 2ca6 F601      		movw r30,r12
 8075 2ca8 86A1      		ldd r24,Z+38
 8076 2caa 97A1      		ldd r25,Z+39
 8077 2cac A0A5      		ldd r26,Z+40
GAS LISTING /tmp/ccPugNTh.s 			page 198


 8078 2cae B1A5      		ldd r27,Z+41
 8079 2cb0 480F      		add r20,r24
 8080 2cb2 591F      		adc r21,r25
 8081 2cb4 6A1F      		adc r22,r26
 8082 2cb6 7B1F      		adc r23,r27
 8083               	.LBE119:
 8084               	.LBE118:
 8085               		.stabn	68,0,2679,.LM660-.LFBB30
 8086               	.LM660:
 8087 2cb8 4115      		cp r20,__zero_reg__
 8088 2cba 5105      		cpc r21,__zero_reg__
 8089 2cbc 6105      		cpc r22,__zero_reg__
 8090 2cbe 7105      		cpc r23,__zero_reg__
 8091 2cc0 01F4      		brne .+2
 8092 2cc2 00C0      		rjmp .L394
 8093               		.stabn	68,0,2682,.LM661-.LFBB30
 8094               	.LM661:
 8095 2cc4 C601      		movw r24,r12
 8096 2cc6 0E94 0000 		call move_window
 8097               		.stabn	68,0,2683,.LM662-.LFBB30
 8098               	.LM662:
 8099 2cca A8AD      		ldd r26,Y+56
 8100 2ccc B9AD      		ldd r27,Y+57
 8101               		.stabn	68,0,2684,.LM663-.LFBB30
 8102               	.LM663:
 8103 2cce 8823      		tst r24
 8104 2cd0 01F0      		breq .+2
 8105 2cd2 00C0      		rjmp .L384
 8106               		.stabn	68,0,2683,.LM664-.LFBB30
 8107               	.LM664:
 8108 2cd4 BD01      		movw r22,r26
 8109 2cd6 625B      		subi r22,lo8(-(78))
 8110 2cd8 7F4F      		sbci r23,hi8(-(78))
 8111               		.stabn	68,0,2684,.LM665-.LFBB30
 8112               	.LM665:
 8113 2cda FB01      		movw r30,r22
 8114 2cdc 8181      		ldd r24,Z+1
 8115 2cde 8E32      		cpi r24,lo8(46)
 8116 2ce0 01F4      		brne .L393
 8117               		.stabn	68,0,2685,.LM666-.LFBB30
 8118               	.LM666:
 8119 2ce2 8C91      		ld r24,X
 8120 2ce4 8330      		cpi r24,lo8(3)
 8121 2ce6 01F4      		brne .L395
 8122 2ce8 FE01      		movw r30,r28
 8123 2cea FE96      		adiw r30,62
 8124 2cec 2081      		ld r18,Z
 8125 2cee 3181      		ldd r19,Z+1
 8126 2cf0 4281      		ldd r20,Z+2
 8127 2cf2 5381      		ldd r21,Z+3
 8128 2cf4 9296      		adiw r26,34
 8129 2cf6 8D91      		ld r24,X+
 8130 2cf8 9D91      		ld r25,X+
 8131 2cfa 0D90      		ld __tmp_reg__,X+
 8132 2cfc BC91      		ld r27,X
 8133 2cfe A02D      		mov r26,__tmp_reg__
 8134 2d00 2817      		cp r18,r24
GAS LISTING /tmp/ccPugNTh.s 			page 199


 8135 2d02 3907      		cpc r19,r25
 8136 2d04 4A07      		cpc r20,r26
 8137 2d06 5B07      		cpc r21,r27
 8138 2d08 01F4      		brne .L395
 8139 2d0a 20E0      		ldi r18,lo8(0)
 8140 2d0c 30E0      		ldi r19,hi8(0)
 8141 2d0e 40E0      		ldi r20,hlo8(0)
 8142 2d10 50E0      		ldi r21,hhi8(0)
 8143 2d12 00C0      		rjmp .L396
 8144               	.L395:
 8145 2d14 FE01      		movw r30,r28
 8146 2d16 FE96      		adiw r30,62
 8147 2d18 2081      		ld r18,Z
 8148 2d1a 3181      		ldd r19,Z+1
 8149 2d1c 4281      		ldd r20,Z+2
 8150 2d1e 5381      		ldd r21,Z+3
 8151               	.L396:
 8152               		.stabn	68,0,2686,.LM667-.LFBB30
 8153               	.LM667:
 8154 2d20 DB01      		movw r26,r22
 8155 2d22 5A96      		adiw r26,26
 8156 2d24 2C93      		st X,r18
 8157 2d26 5A97      		sbiw r26,26
 8158 2d28 832F      		mov r24,r19
 8159 2d2a 9927      		clr r25
 8160 2d2c 5B96      		adiw r26,27
 8161 2d2e 8C93      		st X,r24
 8162               		.stabn	68,0,2687,.LM668-.LFBB30
 8163               	.LM668:
 8164 2d30 CA01      		movw r24,r20
 8165 2d32 AA27      		clr r26
 8166 2d34 BB27      		clr r27
 8167 2d36 FB01      		movw r30,r22
 8168 2d38 848B      		std Z+20,r24
 8169 2d3a 892F      		mov r24,r25
 8170 2d3c 9927      		clr r25
 8171 2d3e 858B      		std Z+21,r24
 8172               		.stabn	68,0,2688,.LM669-.LFBB30
 8173               	.LM669:
 8174 2d40 E8AD      		ldd r30,Y+56
 8175 2d42 F9AD      		ldd r31,Y+57
 8176 2d44 81E0      		ldi r24,lo8(1)
 8177 2d46 8483      		std Z+4,r24
 8178               	.L393:
 8179               		.stabn	68,0,2693,.LM670-.LFBB30
 8180               	.LM670:
 8181 2d48 CE01      		movw r24,r28
 8182 2d4a 8296      		adiw r24,34
 8183 2d4c 0E94 0000 		call dir_remove
 8184               		.stabn	68,0,2694,.LM671-.LFBB30
 8185               	.LM671:
 8186 2d50 8823      		tst r24
 8187 2d52 01F4      		brne .L384
 8188               		.stabn	68,0,2695,.LM672-.LFBB30
 8189               	.LM672:
 8190 2d54 8AA1      		ldd r24,Y+34
 8191 2d56 9BA1      		ldd r25,Y+35
GAS LISTING /tmp/ccPugNTh.s 			page 200


 8192 2d58 0E94 0000 		call sync
 8193 2d5c 00C0      		rjmp .L384
 8194               	.L394:
 8195 2d5e 82E0      		ldi r24,lo8(2)
 8196               	.L384:
 8197               	/* epilogue start */
 8198               		.stabn	68,0,2701,.LM673-.LFBB30
 8199               	.LM673:
 8200 2d60 C15B      		subi r28,lo8(-(79))
 8201 2d62 DF4F      		sbci r29,hi8(-(79))
 8202 2d64 0FB6      		in __tmp_reg__,__SREG__
 8203 2d66 F894      		cli
 8204 2d68 DEBF      		out __SP_H__,r29
 8205 2d6a 0FBE      		out __SREG__,__tmp_reg__
 8206 2d6c CDBF      		out __SP_L__,r28
 8207 2d6e CF91      		pop r28
 8208 2d70 DF91      		pop r29
 8209 2d72 1F91      		pop r17
 8210 2d74 0F91      		pop r16
 8211 2d76 FF90      		pop r15
 8212 2d78 EF90      		pop r14
 8213 2d7a DF90      		pop r13
 8214 2d7c CF90      		pop r12
 8215 2d7e 0895      		ret
 8216               		.size	f_rename, .-f_rename
 8217               		.stabs	"res:r(1,16)",64,0,2647,24
 8218               		.stabs	"dj_old:(1,9)",128,0,2648,34
 8219               		.stabs	"dj_new:(1,9)",128,0,2648,56
 8220               		.stabs	"sfn:(0,24)",128,0,2649,1
 8221               		.stabs	"buf:(0,31)=ar(1,4);0;20;(2,5)",128,0,2650,13
 8222               		.stabs	"dir:r(1,8)",64,0,2650,20
 8223               		.stabs	"dw:r(2,12)",64,0,2651,18
 8224               		.stabn	192,0,0,.LFBB30-.LFBB30
 8225               		.stabs	"d:r(0,18)",64,0,177,30
 8226               		.stabn	192,0,0,.LBB113-.LFBB30
 8227               		.stabn	224,0,0,.LBE113-.LFBB30
 8228               		.stabs	"d:r(0,18)",64,0,177,26
 8229               		.stabn	192,0,0,.LBB115-.LFBB30
 8230               		.stabn	224,0,0,.LBE115-.LFBB30
 8231               		.stabs	"s:r(0,21)",64,0,178,30
 8232               		.stabn	192,0,0,.LBB117-.LFBB30
 8233               		.stabn	224,0,0,.LBE117-.LFBB30
 8234               		.stabs	"clst:r(2,12)",64,0,2678,14
 8235               		.stabn	192,0,0,.LBB118-.LFBB30
 8236               		.stabn	224,0,0,.LBE118-.LFBB30
 8237               		.stabn	224,0,0,.Lscope30-.LFBB30
 8238               	.Lscope30:
 8239               		.stabs	"",36,0,0,.Lscope30-.LFBB30
 8240               		.stabd	78,0,0
 8241               		.stabs	"f_utime:F(1,16)",36,0,2606,f_utime
 8242               		.stabs	"path:p(0,19)",160,0,2603,35
 8243               		.stabs	"fno:P(0,32)=*(0,33)=k(1,14)",64,0,2604,16
 8244               	.global	f_utime
 8245               		.type	f_utime, @function
 8246               	f_utime:
 8247               		.stabd	46,0,0
 8248               		.stabn	68,0,2606,.LM674-.LFBB31
GAS LISTING /tmp/ccPugNTh.s 			page 201


 8249               	.LM674:
 8250               	.LFBB31:
 8251 2d80 EF92      		push r14
 8252 2d82 FF92      		push r15
 8253 2d84 0F93      		push r16
 8254 2d86 1F93      		push r17
 8255 2d88 DF93      		push r29
 8256 2d8a CF93      		push r28
 8257 2d8c CDB7      		in r28,__SP_L__
 8258 2d8e DEB7      		in r29,__SP_H__
 8259 2d90 A497      		sbiw r28,36
 8260 2d92 0FB6      		in __tmp_reg__,__SREG__
 8261 2d94 F894      		cli
 8262 2d96 DEBF      		out __SP_H__,r29
 8263 2d98 0FBE      		out __SREG__,__tmp_reg__
 8264 2d9a CDBF      		out __SP_L__,r28
 8265               	/* prologue: function */
 8266               	/* frame size = 36 */
 8267 2d9c 9CA3      		std Y+36,r25
 8268 2d9e 8BA3      		std Y+35,r24
 8269 2da0 8B01      		movw r16,r22
 8270               		.stabn	68,0,2613,.LM675-.LFBB31
 8271               	.LM675:
 8272 2da2 9DE0      		ldi r25,lo8(13)
 8273 2da4 E92E      		mov r14,r25
 8274 2da6 F12C      		mov r15,__zero_reg__
 8275 2da8 EC0E      		add r14,r28
 8276 2daa FD1E      		adc r15,r29
 8277 2dac CE01      		movw r24,r28
 8278 2dae 8396      		adiw r24,35
 8279 2db0 B701      		movw r22,r14
 8280 2db2 41E0      		ldi r20,lo8(1)
 8281 2db4 0E94 0000 		call chk_mounted
 8282               		.stabn	68,0,2614,.LM676-.LFBB31
 8283               	.LM676:
 8284 2db8 8823      		tst r24
 8285 2dba 01F4      		brne .L399
 8286               		.stabn	68,0,2615,.LM677-.LFBB31
 8287               	.LM677:
 8288 2dbc CE01      		movw r24,r28
 8289 2dbe 0196      		adiw r24,1
 8290 2dc0 9AA3      		std Y+34,r25
 8291 2dc2 89A3      		std Y+33,r24
 8292               		.stabn	68,0,2616,.LM678-.LFBB31
 8293               	.LM678:
 8294 2dc4 6BA1      		ldd r22,Y+35
 8295 2dc6 7CA1      		ldd r23,Y+36
 8296 2dc8 C701      		movw r24,r14
 8297 2dca 0E94 0000 		call follow_path
 8298               		.stabn	68,0,2619,.LM679-.LFBB31
 8299               	.LM679:
 8300 2dce 8823      		tst r24
 8301 2dd0 01F4      		brne .L399
 8302               		.stabn	68,0,2620,.LM680-.LFBB31
 8303               	.LM680:
 8304 2dd2 EF8D      		ldd r30,Y+31
 8305 2dd4 F8A1      		ldd r31,Y+32
GAS LISTING /tmp/ccPugNTh.s 			page 202


 8306               		.stabn	68,0,2621,.LM681-.LFBB31
 8307               	.LM681:
 8308 2dd6 3097      		sbiw r30,0
 8309 2dd8 01F4      		brne .L400
 8310 2dda 86E0      		ldi r24,lo8(6)
 8311 2ddc 00C0      		rjmp .L399
 8312               	.L400:
 8313               		.stabn	68,0,2624,.LM682-.LFBB31
 8314               	.LM682:
 8315 2dde D801      		movw r26,r16
 8316 2de0 1696      		adiw r26,6
 8317 2de2 8C91      		ld r24,X
 8318 2de4 1697      		sbiw r26,6
 8319 2de6 868B      		std Z+22,r24
 8320 2de8 1796      		adiw r26,7
 8321 2dea 8C91      		ld r24,X
 8322 2dec 1797      		sbiw r26,7
 8323 2dee 878B      		std Z+23,r24
 8324               		.stabn	68,0,2625,.LM683-.LFBB31
 8325               	.LM683:
 8326 2df0 1496      		adiw r26,4
 8327 2df2 8C91      		ld r24,X
 8328 2df4 1497      		sbiw r26,4
 8329 2df6 808F      		std Z+24,r24
 8330 2df8 1596      		adiw r26,5
 8331 2dfa 8C91      		ld r24,X
 8332 2dfc 818F      		std Z+25,r24
 8333               		.stabn	68,0,2626,.LM684-.LFBB31
 8334               	.LM684:
 8335 2dfe ED85      		ldd r30,Y+13
 8336 2e00 FE85      		ldd r31,Y+14
 8337 2e02 81E0      		ldi r24,lo8(1)
 8338 2e04 8483      		std Z+4,r24
 8339               		.stabn	68,0,2627,.LM685-.LFBB31
 8340               	.LM685:
 8341 2e06 CF01      		movw r24,r30
 8342 2e08 0E94 0000 		call sync
 8343               	.L399:
 8344               	/* epilogue start */
 8345               		.stabn	68,0,2633,.LM686-.LFBB31
 8346               	.LM686:
 8347 2e0c A496      		adiw r28,36
 8348 2e0e 0FB6      		in __tmp_reg__,__SREG__
 8349 2e10 F894      		cli
 8350 2e12 DEBF      		out __SP_H__,r29
 8351 2e14 0FBE      		out __SREG__,__tmp_reg__
 8352 2e16 CDBF      		out __SP_L__,r28
 8353 2e18 CF91      		pop r28
 8354 2e1a DF91      		pop r29
 8355 2e1c 1F91      		pop r17
 8356 2e1e 0F91      		pop r16
 8357 2e20 FF90      		pop r15
 8358 2e22 EF90      		pop r14
 8359 2e24 0895      		ret
 8360               		.size	f_utime, .-f_utime
 8361               		.stabs	"res:r(1,16)",64,0,2607,24
 8362               		.stabs	"dj:(1,9)",128,0,2608,13
GAS LISTING /tmp/ccPugNTh.s 			page 203


 8363               		.stabs	"sfn:(0,24)",128,0,2609,1
 8364               		.stabs	"dir:r(1,8)",64,0,2610,30
 8365               		.stabn	192,0,0,.LFBB31-.LFBB31
 8366               		.stabn	224,0,0,.Lscope31-.LFBB31
 8367               	.Lscope31:
 8368               		.stabs	"",36,0,0,.Lscope31-.LFBB31
 8369               		.stabd	78,0,0
 8370               		.stabs	"f_chmod:F(1,16)",36,0,2566,f_chmod
 8371               		.stabs	"path:p(0,19)",160,0,2562,35
 8372               		.stabs	"value:P(2,5)",64,0,2563,14
 8373               		.stabs	"mask:P(2,5)",64,0,2564,15
 8374               	.global	f_chmod
 8375               		.type	f_chmod, @function
 8376               	f_chmod:
 8377               		.stabd	46,0,0
 8378               		.stabn	68,0,2566,.LM687-.LFBB32
 8379               	.LM687:
 8380               	.LFBB32:
 8381 2e26 EF92      		push r14
 8382 2e28 FF92      		push r15
 8383 2e2a 0F93      		push r16
 8384 2e2c 1F93      		push r17
 8385 2e2e DF93      		push r29
 8386 2e30 CF93      		push r28
 8387 2e32 CDB7      		in r28,__SP_L__
 8388 2e34 DEB7      		in r29,__SP_H__
 8389 2e36 A497      		sbiw r28,36
 8390 2e38 0FB6      		in __tmp_reg__,__SREG__
 8391 2e3a F894      		cli
 8392 2e3c DEBF      		out __SP_H__,r29
 8393 2e3e 0FBE      		out __SREG__,__tmp_reg__
 8394 2e40 CDBF      		out __SP_L__,r28
 8395               	/* prologue: function */
 8396               	/* frame size = 36 */
 8397 2e42 9CA3      		std Y+36,r25
 8398 2e44 8BA3      		std Y+35,r24
 8399 2e46 E62E      		mov r14,r22
 8400 2e48 F42E      		mov r15,r20
 8401               		.stabn	68,0,2573,.LM688-.LFBB32
 8402               	.LM688:
 8403 2e4a 8E01      		movw r16,r28
 8404 2e4c 035F      		subi r16,lo8(-(13))
 8405 2e4e 1F4F      		sbci r17,hi8(-(13))
 8406 2e50 CE01      		movw r24,r28
 8407 2e52 8396      		adiw r24,35
 8408 2e54 B801      		movw r22,r16
 8409 2e56 41E0      		ldi r20,lo8(1)
 8410 2e58 0E94 0000 		call chk_mounted
 8411               		.stabn	68,0,2574,.LM689-.LFBB32
 8412               	.LM689:
 8413 2e5c 8823      		tst r24
 8414 2e5e 01F4      		brne .L403
 8415               		.stabn	68,0,2575,.LM690-.LFBB32
 8416               	.LM690:
 8417 2e60 CE01      		movw r24,r28
 8418 2e62 0196      		adiw r24,1
 8419 2e64 9AA3      		std Y+34,r25
GAS LISTING /tmp/ccPugNTh.s 			page 204


 8420 2e66 89A3      		std Y+33,r24
 8421               		.stabn	68,0,2576,.LM691-.LFBB32
 8422               	.LM691:
 8423 2e68 6BA1      		ldd r22,Y+35
 8424 2e6a 7CA1      		ldd r23,Y+36
 8425 2e6c C801      		movw r24,r16
 8426 2e6e 0E94 0000 		call follow_path
 8427               		.stabn	68,0,2579,.LM692-.LFBB32
 8428               	.LM692:
 8429 2e72 8823      		tst r24
 8430 2e74 01F4      		brne .L403
 8431               		.stabn	68,0,2580,.LM693-.LFBB32
 8432               	.LM693:
 8433 2e76 EF8D      		ldd r30,Y+31
 8434 2e78 F8A1      		ldd r31,Y+32
 8435               		.stabn	68,0,2581,.LM694-.LFBB32
 8436               	.LM694:
 8437 2e7a 3097      		sbiw r30,0
 8438 2e7c 01F4      		brne .L404
 8439 2e7e 86E0      		ldi r24,lo8(6)
 8440 2e80 00C0      		rjmp .L403
 8441               	.L404:
 8442               		.stabn	68,0,2584,.LM695-.LFBB32
 8443               	.LM695:
 8444 2e82 9F2D      		mov r25,r15
 8445 2e84 9772      		andi r25,lo8(39)
 8446               		.stabn	68,0,2585,.LM696-.LFBB32
 8447               	.LM696:
 8448 2e86 892F      		mov r24,r25
 8449 2e88 8095      		com r24
 8450 2e8a 2385      		ldd r18,Z+11
 8451 2e8c 8223      		and r24,r18
 8452 2e8e 9E21      		and r25,r14
 8453 2e90 892B      		or r24,r25
 8454 2e92 8387      		std Z+11,r24
 8455               		.stabn	68,0,2586,.LM697-.LFBB32
 8456               	.LM697:
 8457 2e94 ED85      		ldd r30,Y+13
 8458 2e96 FE85      		ldd r31,Y+14
 8459 2e98 81E0      		ldi r24,lo8(1)
 8460 2e9a 8483      		std Z+4,r24
 8461               		.stabn	68,0,2587,.LM698-.LFBB32
 8462               	.LM698:
 8463 2e9c CF01      		movw r24,r30
 8464 2e9e 0E94 0000 		call sync
 8465               	.L403:
 8466               	/* epilogue start */
 8467               		.stabn	68,0,2593,.LM699-.LFBB32
 8468               	.LM699:
 8469 2ea2 A496      		adiw r28,36
 8470 2ea4 0FB6      		in __tmp_reg__,__SREG__
 8471 2ea6 F894      		cli
 8472 2ea8 DEBF      		out __SP_H__,r29
 8473 2eaa 0FBE      		out __SREG__,__tmp_reg__
 8474 2eac CDBF      		out __SP_L__,r28
 8475 2eae CF91      		pop r28
 8476 2eb0 DF91      		pop r29
GAS LISTING /tmp/ccPugNTh.s 			page 205


 8477 2eb2 1F91      		pop r17
 8478 2eb4 0F91      		pop r16
 8479 2eb6 FF90      		pop r15
 8480 2eb8 EF90      		pop r14
 8481 2eba 0895      		ret
 8482               		.size	f_chmod, .-f_chmod
 8483               		.stabs	"res:r(1,16)",64,0,2567,24
 8484               		.stabs	"dj:(1,9)",128,0,2568,13
 8485               		.stabs	"sfn:(0,24)",128,0,2569,1
 8486               		.stabs	"dir:r(1,8)",64,0,2570,30
 8487               		.stabn	192,0,0,.LFBB32-.LFBB32
 8488               		.stabn	224,0,0,.Lscope32-.LFBB32
 8489               	.Lscope32:
 8490               		.stabs	"",36,0,0,.Lscope32-.LFBB32
 8491               		.stabd	78,0,0
 8492               		.stabs	"f_mkdir:F(1,16)",36,0,2485,f_mkdir
 8493               		.stabs	"path:p(0,19)",160,0,2483,35
 8494               	.global	f_mkdir
 8495               		.type	f_mkdir, @function
 8496               	f_mkdir:
 8497               		.stabd	46,0,0
 8498               		.stabn	68,0,2485,.LM700-.LFBB33
 8499               	.LM700:
 8500               	.LFBB33:
 8501 2ebc 2F92      		push r2
 8502 2ebe 3F92      		push r3
 8503 2ec0 4F92      		push r4
 8504 2ec2 5F92      		push r5
 8505 2ec4 6F92      		push r6
 8506 2ec6 7F92      		push r7
 8507 2ec8 8F92      		push r8
 8508 2eca 9F92      		push r9
 8509 2ecc AF92      		push r10
 8510 2ece BF92      		push r11
 8511 2ed0 CF92      		push r12
 8512 2ed2 DF92      		push r13
 8513 2ed4 EF92      		push r14
 8514 2ed6 FF92      		push r15
 8515 2ed8 0F93      		push r16
 8516 2eda 1F93      		push r17
 8517 2edc DF93      		push r29
 8518 2ede CF93      		push r28
 8519 2ee0 CDB7      		in r28,__SP_L__
 8520 2ee2 DEB7      		in r29,__SP_H__
 8521 2ee4 AC97      		sbiw r28,44
 8522 2ee6 0FB6      		in __tmp_reg__,__SREG__
 8523 2ee8 F894      		cli
 8524 2eea DEBF      		out __SP_H__,r29
 8525 2eec 0FBE      		out __SREG__,__tmp_reg__
 8526 2eee CDBF      		out __SP_L__,r28
 8527               	/* prologue: function */
 8528               	/* frame size = 44 */
 8529 2ef0 9CA3      		std Y+36,r25
 8530 2ef2 8BA3      		std Y+35,r24
 8531               		.stabn	68,0,2493,.LM701-.LFBB33
 8532               	.LM701:
 8533 2ef4 7DE0      		ldi r23,lo8(13)
GAS LISTING /tmp/ccPugNTh.s 			page 206


 8534 2ef6 E72E      		mov r14,r23
 8535 2ef8 F12C      		mov r15,__zero_reg__
 8536 2efa EC0E      		add r14,r28
 8537 2efc FD1E      		adc r15,r29
 8538 2efe CE01      		movw r24,r28
 8539 2f00 8396      		adiw r24,35
 8540 2f02 B701      		movw r22,r14
 8541 2f04 41E0      		ldi r20,lo8(1)
 8542 2f06 0E94 0000 		call chk_mounted
 8543 2f0a 182F      		mov r17,r24
 8544               		.stabn	68,0,2494,.LM702-.LFBB33
 8545               	.LM702:
 8546 2f0c 8823      		tst r24
 8547 2f0e 01F0      		breq .+2
 8548 2f10 00C0      		rjmp .L407
 8549               		.stabn	68,0,2496,.LM703-.LFBB33
 8550               	.LM703:
 8551 2f12 CE01      		movw r24,r28
 8552 2f14 0196      		adiw r24,1
 8553 2f16 9AA3      		std Y+34,r25
 8554 2f18 89A3      		std Y+33,r24
 8555               		.stabn	68,0,2497,.LM704-.LFBB33
 8556               	.LM704:
 8557 2f1a 6BA1      		ldd r22,Y+35
 8558 2f1c 7CA1      		ldd r23,Y+36
 8559 2f1e C701      		movw r24,r14
 8560 2f20 0E94 0000 		call follow_path
 8561 2f24 182F      		mov r17,r24
 8562               		.stabn	68,0,2498,.LM705-.LFBB33
 8563               	.LM705:
 8564 2f26 8823      		tst r24
 8565 2f28 01F4      		brne .L408
 8566 2f2a 18E0      		ldi r17,lo8(8)
 8567 2f2c 00C0      		rjmp .L407
 8568               	.L408:
 8569               		.stabn	68,0,2501,.LM706-.LFBB33
 8570               	.LM706:
 8571 2f2e 8430      		cpi r24,lo8(4)
 8572 2f30 01F0      		breq .+2
 8573 2f32 00C0      		rjmp .L407
 8574               		.stabn	68,0,2504,.LM707-.LFBB33
 8575               	.LM707:
 8576 2f34 8D85      		ldd r24,Y+13
 8577 2f36 9E85      		ldd r25,Y+14
 8578 2f38 40E0      		ldi r20,lo8(0)
 8579 2f3a 50E0      		ldi r21,hi8(0)
 8580 2f3c 60E0      		ldi r22,hlo8(0)
 8581 2f3e 70E0      		ldi r23,hhi8(0)
 8582 2f40 0E94 0000 		call create_chain
 8583 2f44 4B01      		movw r8,r22
 8584 2f46 5C01      		movw r10,r24
 8585               		.stabn	68,0,2506,.LM708-.LFBB33
 8586               	.LM708:
 8587 2f48 6115      		cp r22,__zero_reg__
 8588 2f4a 7105      		cpc r23,__zero_reg__
 8589 2f4c 8105      		cpc r24,__zero_reg__
 8590 2f4e 9105      		cpc r25,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 207


 8591 2f50 01F4      		brne .L409
 8592 2f52 17E0      		ldi r17,lo8(7)
 8593 2f54 00C0      		rjmp .L407
 8594               	.L409:
 8595               		.stabn	68,0,2507,.LM709-.LFBB33
 8596               	.LM709:
 8597 2f56 6130      		cpi r22,lo8(1)
 8598 2f58 7105      		cpc r23,__zero_reg__
 8599 2f5a 8105      		cpc r24,__zero_reg__
 8600 2f5c 9105      		cpc r25,__zero_reg__
 8601 2f5e 01F4      		brne .L410
 8602 2f60 12E0      		ldi r17,lo8(2)
 8603 2f62 00C0      		rjmp .L407
 8604               	.L410:
 8605               		.stabn	68,0,2508,.LM710-.LFBB33
 8606               	.LM710:
 8607 2f64 6F3F      		cpi r22,lo8(-1)
 8608 2f66 3FEF      		ldi r19,hi8(-1)
 8609 2f68 7307      		cpc r23,r19
 8610 2f6a 3FEF      		ldi r19,hlo8(-1)
 8611 2f6c 8307      		cpc r24,r19
 8612 2f6e 3FEF      		ldi r19,hhi8(-1)
 8613 2f70 9307      		cpc r25,r19
 8614 2f72 01F4      		brne .+2
 8615 2f74 00C0      		rjmp .L411
 8616               		.stabn	68,0,2510,.LM711-.LFBB33
 8617               	.LM711:
 8618 2f76 8D85      		ldd r24,Y+13
 8619 2f78 9E85      		ldd r25,Y+14
 8620 2f7a 40E0      		ldi r20,lo8(0)
 8621 2f7c 50E0      		ldi r21,hi8(0)
 8622 2f7e 60E0      		ldi r22,hlo8(0)
 8623 2f80 70E0      		ldi r23,hhi8(0)
 8624 2f82 0E94 0000 		call move_window
 8625 2f86 182F      		mov r17,r24
 8626               		.stabn	68,0,2511,.LM712-.LFBB33
 8627               	.LM712:
 8628 2f88 8823      		tst r24
 8629 2f8a 01F0      		breq .+2
 8630 2f8c 00C0      		rjmp .L407
 8631               		.stabn	68,0,2512,.LM713-.LFBB33
 8632               	.LM713:
 8633 2f8e 0D85      		ldd r16,Y+13
 8634 2f90 1E85      		ldd r17,Y+14
 8635               	.LBB120:
 8636               	.LBB121:
 8637               		.stabn	68,0,532,.LM714-.LFBB33
 8638               	.LM714:
 8639 2f92 6EEF      		ldi r22,lo8(-2)
 8640 2f94 C62E      		mov r12,r22
 8641 2f96 6FEF      		ldi r22,hi8(-2)
 8642 2f98 D62E      		mov r13,r22
 8643 2f9a 6FEF      		ldi r22,hlo8(-2)
 8644 2f9c E62E      		mov r14,r22
 8645 2f9e 6FEF      		ldi r22,hhi8(-2)
 8646 2fa0 F62E      		mov r15,r22
 8647 2fa2 C80C      		add r12,r8
GAS LISTING /tmp/ccPugNTh.s 			page 208


 8648 2fa4 D91C      		adc r13,r9
 8649 2fa6 EA1C      		adc r14,r10
 8650 2fa8 FB1C      		adc r15,r11
 8651               		.stabn	68,0,533,.LM715-.LFBB33
 8652               	.LM715:
 8653 2faa F801      		movw r30,r16
 8654 2fac 828D      		ldd r24,Z+26
 8655 2fae 938D      		ldd r25,Z+27
 8656 2fb0 A48D      		ldd r26,Z+28
 8657 2fb2 B58D      		ldd r27,Z+29
 8658 2fb4 0297      		sbiw r24,2
 8659 2fb6 A109      		sbc r26,__zero_reg__
 8660 2fb8 B109      		sbc r27,__zero_reg__
 8661 2fba C816      		cp r12,r24
 8662 2fbc D906      		cpc r13,r25
 8663 2fbe EA06      		cpc r14,r26
 8664 2fc0 FB06      		cpc r15,r27
 8665 2fc2 00F0      		brlo .L412
 8666 2fc4 4424      		clr r4
 8667 2fc6 5524      		clr r5
 8668 2fc8 3201      		movw r6,r4
 8669 2fca 00C0      		rjmp .L413
 8670               	.L412:
 8671               		.stabn	68,0,534,.LM716-.LFBB33
 8672               	.LM716:
 8673 2fcc F801      		movw r30,r16
 8674 2fce 2281      		ldd r18,Z+2
 8675 2fd0 30E0      		ldi r19,lo8(0)
 8676 2fd2 40E0      		ldi r20,lo8(0)
 8677 2fd4 50E0      		ldi r21,hi8(0)
 8678 2fd6 C701      		movw r24,r14
 8679 2fd8 B601      		movw r22,r12
 8680 2fda 0E94 0000 		call __mulsi3
 8681 2fde 2B01      		movw r4,r22
 8682 2fe0 3C01      		movw r6,r24
 8683 2fe2 F801      		movw r30,r16
 8684 2fe4 86A1      		ldd r24,Z+38
 8685 2fe6 97A1      		ldd r25,Z+39
 8686 2fe8 A0A5      		ldd r26,Z+40
 8687 2fea B1A5      		ldd r27,Z+41
 8688 2fec 480E      		add r4,r24
 8689 2fee 591E      		adc r5,r25
 8690 2ff0 6A1E      		adc r6,r26
 8691 2ff2 7B1E      		adc r7,r27
 8692               	.L413:
 8693               	.LBE121:
 8694               	.LBE120:
 8695               		.stabn	68,0,2514,.LM717-.LFBB33
 8696               	.LM717:
 8697 2ff4 5EE2      		ldi r21,lo8(46)
 8698 2ff6 252E      		mov r2,r21
 8699 2ff8 312C      		mov r3,__zero_reg__
 8700 2ffa 200E      		add r2,r16
 8701 2ffc 311E      		adc r3,r17
 8702 2ffe F101      		movw r30,r2
 8703 3000 80E0      		ldi r24,lo8(512)
 8704 3002 92E0      		ldi r25,hi8(512)
GAS LISTING /tmp/ccPugNTh.s 			page 209


 8705 3004 00C0      		rjmp .L414
 8706               	.L415:
 8707               	.LBB122:
 8708               	.LBB123:
 8709               		.stabn	68,0,186,.LM718-.LFBB33
 8710               	.LM718:
 8711 3006 1192      		st Z+,__zero_reg__
 8712               	.L414:
 8713 3008 0197      		sbiw r24,1
 8714 300a 2FEF      		ldi r18,hi8(-1)
 8715 300c 8F3F      		cpi r24,lo8(-1)
 8716 300e 9207      		cpc r25,r18
 8717 3010 01F4      		brne .L415
 8718 3012 F101      		movw r30,r2
 8719 3014 8BE0      		ldi r24,lo8(11)
 8720 3016 90E0      		ldi r25,hi8(11)
 8721               	.LBE123:
 8722               	.LBE122:
 8723               	.LBB124:
 8724               	.LBB125:
 8725 3018 20E2      		ldi r18,lo8(32)
 8726 301a 00C0      		rjmp .L416
 8727               	.L417:
 8728 301c 2193      		st Z+,r18
 8729               	.L416:
 8730 301e 0197      		sbiw r24,1
 8731 3020 3FEF      		ldi r19,hi8(-1)
 8732 3022 8F3F      		cpi r24,lo8(-1)
 8733 3024 9307      		cpc r25,r19
 8734 3026 01F4      		brne .L417
 8735               	.LBE125:
 8736               	.LBE124:
 8737               		.stabn	68,0,2517,.LM719-.LFBB33
 8738               	.LM719:
 8739 3028 8EE2      		ldi r24,lo8(46)
 8740 302a F801      		movw r30,r16
 8741 302c 86A7      		std Z+46,r24
 8742               		.stabn	68,0,2518,.LM720-.LFBB33
 8743               	.LM720:
 8744 302e 80E1      		ldi r24,lo8(16)
 8745 3030 81AF      		std Z+57,r24
 8746               		.stabn	68,0,2519,.LM721-.LFBB33
 8747               	.LM721:
 8748 3032 0E94 0000 		call get_fattime
 8749               		.stabn	68,0,2520,.LM722-.LFBB33
 8750               	.LM722:
 8751 3036 6CA7      		std Y+44,r22
 8752 3038 0C5B      		subi r16,lo8(-(68))
 8753 303a 1F4F      		sbci r17,hi8(-(68))
 8754 303c F801      		movw r30,r16
 8755 303e 6193      		st Z+,r22
 8756 3040 272F      		mov r18,r23
 8757 3042 3327      		clr r19
 8758 3044 2BA7      		std Y+43,r18
 8759 3046 2193      		st Z+,r18
 8760 3048 9C01      		movw r18,r24
 8761 304a 4427      		clr r20
GAS LISTING /tmp/ccPugNTh.s 			page 210


 8762 304c 5527      		clr r21
 8763 304e 2AA7      		std Y+42,r18
 8764 3050 2193      		st Z+,r18
 8765 3052 692F      		mov r22,r25
 8766 3054 7727      		clr r23
 8767 3056 8827      		clr r24
 8768 3058 9927      		clr r25
 8769 305a 69A7      		std Y+41,r22
 8770 305c 6193      		st Z+,r22
 8771               		.stabn	68,0,2521,.LM723-.LFBB33
 8772               	.LM723:
 8773 305e 88A6      		std Y+40,r8
 8774 3060 8192      		st Z+,r8
 8775 3062 8F01      		movw r16,r30
 8776 3064 892D      		mov r24,r9
 8777 3066 9927      		clr r25
 8778 3068 8FA3      		std Y+39,r24
 8779 306a 8083      		st Z,r24
 8780               		.stabn	68,0,2522,.LM724-.LFBB33
 8781               	.LM724:
 8782 306c C501      		movw r24,r10
 8783 306e AA27      		clr r26
 8784 3070 BB27      		clr r27
 8785 3072 8EA3      		std Y+38,r24
 8786 3074 0750      		subi r16,lo8(-(-7))
 8787 3076 1040      		sbci r17,hi8(-(-7))
 8788 3078 F801      		movw r30,r16
 8789 307a 8193      		st Z+,r24
 8790 307c 8F01      		movw r16,r30
 8791 307e 892F      		mov r24,r25
 8792 3080 9927      		clr r25
 8793 3082 8DA3      		std Y+37,r24
 8794 3084 8083      		st Z,r24
 8795 3086 0354      		subi r16,lo8(-(-67))
 8796 3088 1040      		sbci r17,hi8(-(-67))
 8797 308a F101      		movw r30,r2
 8798 308c 20E2      		ldi r18,lo8(32)
 8799 308e 30E0      		ldi r19,hi8(32)
 8800 3090 00C0      		rjmp .L418
 8801               	.L419:
 8802               	.LBB126:
 8803               	.LBB127:
 8804               		.stabn	68,0,179,.LM725-.LFBB33
 8805               	.LM725:
 8806 3092 8081      		ld r24,Z
 8807 3094 80A3      		std Z+32,r24
 8808 3096 3196      		adiw r30,1
 8809               	.L418:
 8810 3098 2150      		subi r18,lo8(-(-1))
 8811 309a 3040      		sbci r19,hi8(-(-1))
 8812 309c 8FEF      		ldi r24,hi8(-1)
 8813 309e 2F3F      		cpi r18,lo8(-1)
 8814 30a0 3807      		cpc r19,r24
 8815 30a2 01F4      		brne .L419
 8816               	.LBE127:
 8817               	.LBE126:
 8818               		.stabn	68,0,2524,.LM726-.LFBB33
GAS LISTING /tmp/ccPugNTh.s 			page 211


 8819               	.LM726:
 8820 30a4 015B      		subi r16,lo8(-(79))
 8821 30a6 1F4F      		sbci r17,hi8(-(79))
 8822 30a8 8EE2      		ldi r24,lo8(46)
 8823 30aa F801      		movw r30,r16
 8824 30ac 8083      		st Z,r24
 8825 30ae 0F54      		subi r16,lo8(-(-79))
 8826 30b0 1040      		sbci r17,hi8(-(-79))
 8827               		.stabn	68,0,2525,.LM727-.LFBB33
 8828               	.LM727:
 8829 30b2 2B89      		ldd r18,Y+19
 8830 30b4 3C89      		ldd r19,Y+20
 8831 30b6 4D89      		ldd r20,Y+21
 8832 30b8 5E89      		ldd r21,Y+22
 8833               		.stabn	68,0,2526,.LM728-.LFBB33
 8834               	.LM728:
 8835 30ba ED85      		ldd r30,Y+13
 8836 30bc FE85      		ldd r31,Y+14
 8837 30be 8081      		ld r24,Z
 8838 30c0 8330      		cpi r24,lo8(3)
 8839 30c2 01F4      		brne .L420
 8840 30c4 82A1      		ldd r24,Z+34
 8841 30c6 93A1      		ldd r25,Z+35
 8842 30c8 A4A1      		ldd r26,Z+36
 8843 30ca B5A1      		ldd r27,Z+37
 8844 30cc 2817      		cp r18,r24
 8845 30ce 3907      		cpc r19,r25
 8846 30d0 4A07      		cpc r20,r26
 8847 30d2 5B07      		cpc r21,r27
 8848 30d4 01F4      		brne .L420
 8849 30d6 20E0      		ldi r18,lo8(0)
 8850 30d8 30E0      		ldi r19,hi8(0)
 8851 30da 40E0      		ldi r20,hlo8(0)
 8852 30dc 50E0      		ldi r21,hhi8(0)
 8853               	.L420:
 8854               		.stabn	68,0,2528,.LM729-.LFBB33
 8855               	.LM729:
 8856 30de 0859      		subi r16,lo8(-(104))
 8857 30e0 1F4F      		sbci r17,hi8(-(104))
 8858 30e2 F801      		movw r30,r16
 8859 30e4 2193      		st Z+,r18
 8860 30e6 8F01      		movw r16,r30
 8861 30e8 832F      		mov r24,r19
 8862 30ea 9927      		clr r25
 8863 30ec 8083      		st Z,r24
 8864               		.stabn	68,0,2529,.LM730-.LFBB33
 8865               	.LM730:
 8866 30ee CA01      		movw r24,r20
 8867 30f0 AA27      		clr r26
 8868 30f2 BB27      		clr r27
 8869 30f4 0750      		subi r16,lo8(-(-7))
 8870 30f6 1040      		sbci r17,hi8(-(-7))
 8871 30f8 F801      		movw r30,r16
 8872 30fa 8193      		st Z+,r24
 8873 30fc 892F      		mov r24,r25
 8874 30fe 9927      		clr r25
 8875 3100 8083      		st Z,r24
GAS LISTING /tmp/ccPugNTh.s 			page 212


 8876 3102 7301      		movw r14,r6
 8877 3104 6201      		movw r12,r4
 8878               		.stabn	68,0,2532,.LM731-.LFBB33
 8879               	.LM731:
 8880 3106 01E0      		ldi r16,lo8(1)
 8881 3108 00C0      		rjmp .L421
 8882               	.L424:
 8883               		.stabn	68,0,2531,.LM732-.LFBB33
 8884               	.LM732:
 8885 310a C2A6      		std Z+42,r12
 8886 310c D3A6      		std Z+43,r13
 8887 310e E4A6      		std Z+44,r14
 8888 3110 F5A6      		std Z+45,r15
 8889               		.stabn	68,0,2532,.LM733-.LFBB33
 8890               	.LM733:
 8891 3112 0483      		std Z+4,r16
 8892               		.stabn	68,0,2533,.LM734-.LFBB33
 8893               	.LM734:
 8894 3114 CF01      		movw r24,r30
 8895 3116 40E0      		ldi r20,lo8(0)
 8896 3118 50E0      		ldi r21,hi8(0)
 8897 311a 60E0      		ldi r22,hlo8(0)
 8898 311c 70E0      		ldi r23,hhi8(0)
 8899 311e 0E94 0000 		call move_window
 8900 3122 182F      		mov r17,r24
 8901               		.stabn	68,0,2534,.LM735-.LFBB33
 8902               	.LM735:
 8903 3124 8823      		tst r24
 8904 3126 01F0      		breq .+2
 8905 3128 00C0      		rjmp .L407
 8906 312a F101      		movw r30,r2
 8907 312c 80E0      		ldi r24,lo8(512)
 8908 312e 92E0      		ldi r25,hi8(512)
 8909 3130 00C0      		rjmp .L422
 8910               	.L423:
 8911               	.LBB128:
 8912               	.LBB129:
 8913               		.stabn	68,0,186,.LM736-.LFBB33
 8914               	.LM736:
 8915 3132 1192      		st Z+,__zero_reg__
 8916               	.L422:
 8917 3134 0197      		sbiw r24,1
 8918 3136 2FEF      		ldi r18,hi8(-1)
 8919 3138 8F3F      		cpi r24,lo8(-1)
 8920 313a 9207      		cpc r25,r18
 8921 313c 01F4      		brne .L423
 8922               	.LBE129:
 8923               	.LBE128:
 8924               		.stabn	68,0,2531,.LM737-.LFBB33
 8925               	.LM737:
 8926 313e 0894      		sec
 8927 3140 C11C      		adc r12,__zero_reg__
 8928 3142 D11C      		adc r13,__zero_reg__
 8929 3144 E11C      		adc r14,__zero_reg__
 8930 3146 F11C      		adc r15,__zero_reg__
 8931               	.L421:
 8932               		.stabn	68,0,2530,.LM738-.LFBB33
GAS LISTING /tmp/ccPugNTh.s 			page 213


 8933               	.LM738:
 8934 3148 ED85      		ldd r30,Y+13
 8935 314a FE85      		ldd r31,Y+14
 8936 314c 9C2D      		mov r25,r12
 8937 314e 9419      		sub r25,r4
 8938 3150 8281      		ldd r24,Z+2
 8939 3152 9817      		cp r25,r24
 8940 3154 00F0      		brlo .L424
 8941               		.stabn	68,0,2538,.LM739-.LFBB33
 8942               	.LM739:
 8943 3156 CE01      		movw r24,r28
 8944 3158 0D96      		adiw r24,13
 8945 315a 0E94 0000 		call dir_register
 8946 315e 182F      		mov r17,r24
 8947               		.stabn	68,0,2539,.LM740-.LFBB33
 8948               	.LM740:
 8949 3160 8823      		tst r24
 8950 3162 01F0      		breq .L425
 8951               		.stabn	68,0,2540,.LM741-.LFBB33
 8952               	.LM741:
 8953 3164 8D85      		ldd r24,Y+13
 8954 3166 9E85      		ldd r25,Y+14
 8955 3168 B501      		movw r22,r10
 8956 316a A401      		movw r20,r8
 8957 316c 0E94 0000 		call remove_chain
 8958 3170 00C0      		rjmp .L407
 8959               	.L425:
 8960               		.stabn	68,0,2542,.LM742-.LFBB33
 8961               	.LM742:
 8962 3172 EF8D      		ldd r30,Y+31
 8963 3174 F8A1      		ldd r31,Y+32
 8964               		.stabn	68,0,2543,.LM743-.LFBB33
 8965               	.LM743:
 8966 3176 80E1      		ldi r24,lo8(16)
 8967 3178 8387      		std Z+11,r24
 8968               		.stabn	68,0,2544,.LM744-.LFBB33
 8969               	.LM744:
 8970 317a 3CA5      		ldd r19,Y+44
 8971 317c 368B      		std Z+22,r19
 8972 317e 8BA5      		ldd r24,Y+43
 8973 3180 878B      		std Z+23,r24
 8974 3182 2AA5      		ldd r18,Y+42
 8975 3184 208F      		std Z+24,r18
 8976 3186 39A5      		ldd r19,Y+41
 8977 3188 318F      		std Z+25,r19
 8978               		.stabn	68,0,2545,.LM745-.LFBB33
 8979               	.LM745:
 8980 318a 88A5      		ldd r24,Y+40
 8981 318c 828F      		std Z+26,r24
 8982 318e 2FA1      		ldd r18,Y+39
 8983 3190 238F      		std Z+27,r18
 8984               		.stabn	68,0,2546,.LM746-.LFBB33
 8985               	.LM746:
 8986 3192 3EA1      		ldd r19,Y+38
 8987 3194 348B      		std Z+20,r19
 8988 3196 8DA1      		ldd r24,Y+37
 8989 3198 858B      		std Z+21,r24
GAS LISTING /tmp/ccPugNTh.s 			page 214


 8990               		.stabn	68,0,2547,.LM747-.LFBB33
 8991               	.LM747:
 8992 319a ED85      		ldd r30,Y+13
 8993 319c FE85      		ldd r31,Y+14
 8994 319e 81E0      		ldi r24,lo8(1)
 8995 31a0 8483      		std Z+4,r24
 8996               		.stabn	68,0,2548,.LM748-.LFBB33
 8997               	.LM748:
 8998 31a2 CF01      		movw r24,r30
 8999 31a4 0E94 0000 		call sync
 9000 31a8 182F      		mov r17,r24
 9001               	.L407:
 9002               		.stabn	68,0,2552,.LM749-.LFBB33
 9003               	.LM749:
 9004 31aa 812F      		mov r24,r17
 9005               	/* epilogue start */
 9006 31ac AC96      		adiw r28,44
 9007 31ae 0FB6      		in __tmp_reg__,__SREG__
 9008 31b0 F894      		cli
 9009 31b2 DEBF      		out __SP_H__,r29
 9010 31b4 0FBE      		out __SREG__,__tmp_reg__
 9011 31b6 CDBF      		out __SP_L__,r28
 9012 31b8 CF91      		pop r28
 9013 31ba DF91      		pop r29
 9014 31bc 1F91      		pop r17
 9015 31be 0F91      		pop r16
 9016 31c0 FF90      		pop r15
 9017 31c2 EF90      		pop r14
 9018 31c4 DF90      		pop r13
 9019 31c6 CF90      		pop r12
 9020 31c8 BF90      		pop r11
 9021 31ca AF90      		pop r10
 9022 31cc 9F90      		pop r9
 9023 31ce 8F90      		pop r8
 9024 31d0 7F90      		pop r7
 9025 31d2 6F90      		pop r6
 9026 31d4 5F90      		pop r5
 9027 31d6 4F90      		pop r4
 9028 31d8 3F90      		pop r3
 9029 31da 2F90      		pop r2
 9030 31dc 0895      		ret
 9031               	.L411:
 9032               		.stabn	68,0,2548,.LM750-.LFBB33
 9033               	.LM750:
 9034 31de 11E0      		ldi r17,lo8(1)
 9035 31e0 00C0      		rjmp .L407
 9036               		.size	f_mkdir, .-f_mkdir
 9037               		.stabs	"res:r(1,16)",64,0,2486,17
 9038               		.stabs	"dj:(1,9)",128,0,2487,13
 9039               		.stabs	"sfn:(0,24)",128,0,2488,1
 9040               		.stabs	"dir:r(1,8)",64,0,2489,2
 9041               		.stabs	"dsect:r(2,12)",64,0,2490,12
 9042               		.stabs	"dclst:r(2,12)",64,0,2490,8
 9043               		.stabs	"pclst:r(2,12)",64,0,2490,18
 9044               		.stabs	"tim:r(2,12)",64,0,2490,22
 9045               		.stabn	192,0,0,.LFBB33-.LFBB33
 9046               		.stabs	"clst:r(2,12)",64,0,2512,12
GAS LISTING /tmp/ccPugNTh.s 			page 215


 9047               		.stabn	192,0,0,.LBB120-.LFBB33
 9048               		.stabn	224,0,0,.LBE120-.LFBB33
 9049               		.stabs	"cnt:r(0,1)",64,0,2515,24
 9050               		.stabn	192,0,0,.LBB122-.LFBB33
 9051               		.stabn	224,0,0,.LBE122-.LFBB33
 9052               		.stabs	"cnt:r(0,1)",64,0,2516,24
 9053               		.stabn	192,0,0,.LBB124-.LFBB33
 9054               		.stabn	224,0,0,.LBE124-.LFBB33
 9055               		.stabs	"cnt:r(0,1)",64,0,2523,18
 9056               		.stabn	192,0,0,.LBB126-.LFBB33
 9057               		.stabs	"s:r(0,21)",64,0,178,30
 9058               		.stabn	192,0,0,.LBB127-.LFBB33
 9059               		.stabn	224,0,0,.LBE127-.LFBB33
 9060               		.stabn	224,0,0,.LBE126-.LFBB33
 9061               		.stabs	"cnt:r(0,1)",64,0,2535,24
 9062               		.stabn	192,0,0,.LBB128-.LFBB33
 9063               		.stabn	224,0,0,.LBE128-.LFBB33
 9064               		.stabn	224,0,0,.Lscope33-.LFBB33
 9065               	.Lscope33:
 9066               		.stabs	"",36,0,0,.Lscope33-.LFBB33
 9067               		.stabd	78,0,0
 9068               		.stabs	"f_unlink:F(1,16)",36,0,2430,f_unlink
 9069               		.stabs	"path:p(0,19)",160,0,2428,57
 9070               	.global	f_unlink
 9071               		.type	f_unlink, @function
 9072               	f_unlink:
 9073               		.stabd	46,0,0
 9074               		.stabn	68,0,2430,.LM751-.LFBB34
 9075               	.LM751:
 9076               	.LFBB34:
 9077 31e2 CF92      		push r12
 9078 31e4 DF92      		push r13
 9079 31e6 EF92      		push r14
 9080 31e8 FF92      		push r15
 9081 31ea 0F93      		push r16
 9082 31ec 1F93      		push r17
 9083 31ee DF93      		push r29
 9084 31f0 CF93      		push r28
 9085 31f2 CDB7      		in r28,__SP_L__
 9086 31f4 DEB7      		in r29,__SP_H__
 9087 31f6 EA97      		sbiw r28,58
 9088 31f8 0FB6      		in __tmp_reg__,__SREG__
 9089 31fa F894      		cli
 9090 31fc DEBF      		out __SP_H__,r29
 9091 31fe 0FBE      		out __SREG__,__tmp_reg__
 9092 3200 CDBF      		out __SP_L__,r28
 9093               	/* prologue: function */
 9094               	/* frame size = 58 */
 9095 3202 9AAF      		std Y+58,r25
 9096 3204 89AF      		std Y+57,r24
 9097               		.stabn	68,0,2438,.LM752-.LFBB34
 9098               	.LM752:
 9099 3206 0DE0      		ldi r16,lo8(13)
 9100 3208 C02E      		mov r12,r16
 9101 320a D12C      		mov r13,__zero_reg__
 9102 320c CC0E      		add r12,r28
 9103 320e DD1E      		adc r13,r29
GAS LISTING /tmp/ccPugNTh.s 			page 216


 9104 3210 CE01      		movw r24,r28
 9105 3212 C996      		adiw r24,57
 9106 3214 B601      		movw r22,r12
 9107 3216 41E0      		ldi r20,lo8(1)
 9108 3218 0E94 0000 		call chk_mounted
 9109               		.stabn	68,0,2439,.LM753-.LFBB34
 9110               	.LM753:
 9111 321c 8823      		tst r24
 9112 321e 01F0      		breq .+2
 9113 3220 00C0      		rjmp .L428
 9114               		.stabn	68,0,2441,.LM754-.LFBB34
 9115               	.LM754:
 9116 3222 CE01      		movw r24,r28
 9117 3224 0196      		adiw r24,1
 9118 3226 9AA3      		std Y+34,r25
 9119 3228 89A3      		std Y+33,r24
 9120               		.stabn	68,0,2442,.LM755-.LFBB34
 9121               	.LM755:
 9122 322a 69AD      		ldd r22,Y+57
 9123 322c 7AAD      		ldd r23,Y+58
 9124 322e C601      		movw r24,r12
 9125 3230 0E94 0000 		call follow_path
 9126               		.stabn	68,0,2445,.LM756-.LFBB34
 9127               	.LM756:
 9128 3234 8823      		tst r24
 9129 3236 01F0      		breq .+2
 9130 3238 00C0      		rjmp .L428
 9131               		.stabn	68,0,2447,.LM757-.LFBB34
 9132               	.LM757:
 9133 323a EF8D      		ldd r30,Y+31
 9134 323c F8A1      		ldd r31,Y+32
 9135               		.stabn	68,0,2448,.LM758-.LFBB34
 9136               	.LM758:
 9137 323e 3097      		sbiw r30,0
 9138 3240 01F4      		brne .L429
 9139 3242 86E0      		ldi r24,lo8(6)
 9140 3244 00C0      		rjmp .L428
 9141               	.L429:
 9142               		.stabn	68,0,2450,.LM759-.LFBB34
 9143               	.LM759:
 9144 3246 8385      		ldd r24,Z+11
 9145 3248 482F      		mov r20,r24
 9146 324a 80FD      		sbrc r24,0
 9147 324c 00C0      		rjmp .L430
 9148               		.stabn	68,0,2452,.LM760-.LFBB34
 9149               	.LM760:
 9150 324e 9589      		ldd r25,Z+21
 9151 3250 80E0      		ldi r24,lo8(0)
 9152 3252 2489      		ldd r18,Z+20
 9153 3254 30E0      		ldi r19,lo8(0)
 9154 3256 822B      		or r24,r18
 9155 3258 932B      		or r25,r19
 9156 325a A0E0      		ldi r26,lo8(0)
 9157 325c B0E0      		ldi r27,hi8(0)
 9158 325e 8C01      		movw r16,r24
 9159 3260 FF24      		clr r15
 9160 3262 EE24      		clr r14
GAS LISTING /tmp/ccPugNTh.s 			page 217


 9161 3264 938D      		ldd r25,Z+27
 9162 3266 80E0      		ldi r24,lo8(0)
 9163 3268 228D      		ldd r18,Z+26
 9164 326a 30E0      		ldi r19,lo8(0)
 9165 326c 822B      		or r24,r18
 9166 326e 932B      		or r25,r19
 9167 3270 A0E0      		ldi r26,lo8(0)
 9168 3272 B0E0      		ldi r27,hi8(0)
 9169 3274 E82A      		or r14,r24
 9170 3276 F92A      		or r15,r25
 9171 3278 0A2B      		or r16,r26
 9172 327a 1B2B      		or r17,r27
 9173               		.stabn	68,0,2454,.LM761-.LFBB34
 9174               	.LM761:
 9175 327c 44FF      		sbrs r20,4
 9176 327e 00C0      		rjmp .L431
 9177               		.stabn	68,0,2455,.LM762-.LFBB34
 9178               	.LM762:
 9179 3280 82E0      		ldi r24,lo8(2)
 9180 3282 E816      		cp r14,r24
 9181 3284 F104      		cpc r15,__zero_reg__
 9182 3286 0105      		cpc r16,__zero_reg__
 9183 3288 1105      		cpc r17,__zero_reg__
 9184 328a 00F4      		brsh .L432
 9185 328c 82E0      		ldi r24,lo8(2)
 9186 328e 00C0      		rjmp .L428
 9187               	.L432:
 9188               	.LBB130:
 9189               	.LBB131:
 9190               		.stabn	68,0,177,.LM763-.LFBB34
 9191               	.LM763:
 9192 3290 DE01      		movw r26,r28
 9193 3292 9396      		adiw r26,35
 9194               		.stabn	68,0,178,.LM764-.LFBB34
 9195               	.LM764:
 9196 3294 F601      		movw r30,r12
 9197               		.stabn	68,0,179,.LM765-.LFBB34
 9198               	.LM765:
 9199 3296 9D01      		movw r18,r26
 9200 3298 00C0      		rjmp .L433
 9201               	.L434:
 9202 329a 8191      		ld r24,Z+
 9203 329c 8D93      		st X+,r24
 9204               	.L433:
 9205 329e E217      		cp r30,r18
 9206 32a0 F307      		cpc r31,r19
 9207 32a2 01F4      		brne .L434
 9208               	.LBE131:
 9209               	.LBE130:
 9210               		.stabn	68,0,2457,.LM766-.LFBB34
 9211               	.LM766:
 9212 32a4 E9A6      		std Y+41,r14
 9213 32a6 FAA6      		std Y+42,r15
 9214 32a8 0BA7      		std Y+43,r16
 9215 32aa 1CA7      		std Y+44,r17
 9216               		.stabn	68,0,2458,.LM767-.LFBB34
 9217               	.LM767:
GAS LISTING /tmp/ccPugNTh.s 			page 218


 9218 32ac E3E2      		ldi r30,lo8(35)
 9219 32ae CE2E      		mov r12,r30
 9220 32b0 D12C      		mov r13,__zero_reg__
 9221 32b2 CC0E      		add r12,r28
 9222 32b4 DD1E      		adc r13,r29
 9223 32b6 C601      		movw r24,r12
 9224 32b8 62E0      		ldi r22,lo8(2)
 9225 32ba 70E0      		ldi r23,hi8(2)
 9226 32bc 0E94 0000 		call dir_seek
 9227               		.stabn	68,0,2459,.LM768-.LFBB34
 9228               	.LM768:
 9229 32c0 8823      		tst r24
 9230 32c2 01F4      		brne .L428
 9231               		.stabn	68,0,2460,.LM769-.LFBB34
 9232               	.LM769:
 9233 32c4 C601      		movw r24,r12
 9234 32c6 0E94 0000 		call dir_read
 9235               		.stabn	68,0,2461,.LM770-.LFBB34
 9236               	.LM770:
 9237 32ca 8823      		tst r24
 9238 32cc 01F0      		breq .L430
 9239               		.stabn	68,0,2462,.LM771-.LFBB34
 9240               	.LM771:
 9241 32ce 8430      		cpi r24,lo8(4)
 9242 32d0 01F4      		brne .L428
 9243               	.L431:
 9244               		.stabn	68,0,2465,.LM772-.LFBB34
 9245               	.LM772:
 9246 32d2 CE01      		movw r24,r28
 9247 32d4 0D96      		adiw r24,13
 9248 32d6 0E94 0000 		call dir_remove
 9249               		.stabn	68,0,2466,.LM773-.LFBB34
 9250               	.LM773:
 9251 32da 8823      		tst r24
 9252 32dc 01F4      		brne .L428
 9253               		.stabn	68,0,2467,.LM774-.LFBB34
 9254               	.LM774:
 9255 32de E114      		cp r14,__zero_reg__
 9256 32e0 F104      		cpc r15,__zero_reg__
 9257 32e2 0105      		cpc r16,__zero_reg__
 9258 32e4 1105      		cpc r17,__zero_reg__
 9259 32e6 01F0      		breq .L435
 9260               		.stabn	68,0,2468,.LM775-.LFBB34
 9261               	.LM775:
 9262 32e8 8D85      		ldd r24,Y+13
 9263 32ea 9E85      		ldd r25,Y+14
 9264 32ec B801      		movw r22,r16
 9265 32ee A701      		movw r20,r14
 9266 32f0 0E94 0000 		call remove_chain
 9267               		.stabn	68,0,2469,.LM776-.LFBB34
 9268               	.LM776:
 9269 32f4 8823      		tst r24
 9270 32f6 01F4      		brne .L428
 9271               	.L435:
 9272 32f8 8D85      		ldd r24,Y+13
 9273 32fa 9E85      		ldd r25,Y+14
 9274 32fc 0E94 0000 		call sync
GAS LISTING /tmp/ccPugNTh.s 			page 219


 9275 3300 00C0      		rjmp .L428
 9276               	.L430:
 9277 3302 87E0      		ldi r24,lo8(7)
 9278               	.L428:
 9279               	/* epilogue start */
 9280               		.stabn	68,0,2473,.LM777-.LFBB34
 9281               	.LM777:
 9282 3304 EA96      		adiw r28,58
 9283 3306 0FB6      		in __tmp_reg__,__SREG__
 9284 3308 F894      		cli
 9285 330a DEBF      		out __SP_H__,r29
 9286 330c 0FBE      		out __SREG__,__tmp_reg__
 9287 330e CDBF      		out __SP_L__,r28
 9288 3310 CF91      		pop r28
 9289 3312 DF91      		pop r29
 9290 3314 1F91      		pop r17
 9291 3316 0F91      		pop r16
 9292 3318 FF90      		pop r15
 9293 331a EF90      		pop r14
 9294 331c DF90      		pop r13
 9295 331e CF90      		pop r12
 9296 3320 0895      		ret
 9297               		.size	f_unlink, .-f_unlink
 9298               		.stabs	"res:r(1,16)",64,0,2431,24
 9299               		.stabs	"dj:(1,9)",128,0,2432,13
 9300               		.stabs	"sdj:(1,9)",128,0,2432,35
 9301               		.stabs	"sfn:(0,24)",128,0,2433,1
 9302               		.stabs	"dir:r(1,8)",64,0,2434,30
 9303               		.stabs	"dclst:r(2,12)",64,0,2435,14
 9304               		.stabn	192,0,0,.LFBB34-.LFBB34
 9305               		.stabs	"d:r(0,18)",64,0,177,26
 9306               		.stabn	192,0,0,.LBB131-.LFBB34
 9307               		.stabn	224,0,0,.LBE131-.LFBB34
 9308               		.stabn	224,0,0,.Lscope34-.LFBB34
 9309               	.Lscope34:
 9310               		.stabs	"",36,0,0,.Lscope34-.LFBB34
 9311               		.stabd	78,0,0
 9312               		.stabs	"f_getfree:F(1,16)",36,0,2320,f_getfree
 9313               		.stabs	"path:p(0,19)",160,0,2316,1
 9314               		.stabs	"nclst:p(0,34)=*(2,12)",160,0,2317,4
 9315               		.stabs	"fatfs:P(0,30)",64,0,2318,4
 9316               	.global	f_getfree
 9317               		.type	f_getfree, @function
 9318               	f_getfree:
 9319               		.stabd	46,0,0
 9320               		.stabn	68,0,2320,.LM778-.LFBB35
 9321               	.LM778:
 9322               	.LFBB35:
 9323 3322 2F92      		push r2
 9324 3324 3F92      		push r3
 9325 3326 4F92      		push r4
 9326 3328 5F92      		push r5
 9327 332a 6F92      		push r6
 9328 332c 7F92      		push r7
 9329 332e 8F92      		push r8
 9330 3330 9F92      		push r9
 9331 3332 AF92      		push r10
GAS LISTING /tmp/ccPugNTh.s 			page 220


 9332 3334 BF92      		push r11
 9333 3336 CF92      		push r12
 9334 3338 DF92      		push r13
 9335 333a EF92      		push r14
 9336 333c FF92      		push r15
 9337 333e 0F93      		push r16
 9338 3340 1F93      		push r17
 9339 3342 DF93      		push r29
 9340 3344 CF93      		push r28
 9341 3346 CDB7      		in r28,__SP_L__
 9342 3348 DEB7      		in r29,__SP_H__
 9343 334a 2997      		sbiw r28,9
 9344 334c 0FB6      		in __tmp_reg__,__SREG__
 9345 334e F894      		cli
 9346 3350 DEBF      		out __SP_H__,r29
 9347 3352 0FBE      		out __SREG__,__tmp_reg__
 9348 3354 CDBF      		out __SP_L__,r28
 9349               	/* prologue: function */
 9350               	/* frame size = 9 */
 9351 3356 9A83      		std Y+2,r25
 9352 3358 8983      		std Y+1,r24
 9353 335a 7D83      		std Y+5,r23
 9354 335c 6C83      		std Y+4,r22
 9355 335e 2A01      		movw r4,r20
 9356               		.stabn	68,0,2328,.LM779-.LFBB35
 9357               	.LM779:
 9358 3360 CE01      		movw r24,r28
 9359 3362 0196      		adiw r24,1
 9360 3364 BA01      		movw r22,r20
 9361 3366 40E0      		ldi r20,lo8(0)
 9362 3368 0E94 0000 		call chk_mounted
 9363               		.stabn	68,0,2329,.LM780-.LFBB35
 9364               	.LM780:
 9365 336c 8823      		tst r24
 9366 336e 01F0      		breq .+2
 9367 3370 00C0      		rjmp .L439
 9368               		.stabn	68,0,2332,.LM781-.LFBB35
 9369               	.LM781:
 9370 3372 D201      		movw r26,r4
 9371 3374 ED91      		ld r30,X+
 9372 3376 FC91      		ld r31,X
 9373 3378 2685      		ldd r18,Z+14
 9374 337a 3785      		ldd r19,Z+15
 9375 337c 4089      		ldd r20,Z+16
 9376 337e 5189      		ldd r21,Z+17
 9377 3380 E28C      		ldd r14,Z+26
 9378 3382 F38C      		ldd r15,Z+27
 9379 3384 048D      		ldd r16,Z+28
 9380 3386 158D      		ldd r17,Z+29
 9381 3388 D801      		movw r26,r16
 9382 338a C701      		movw r24,r14
 9383 338c 0297      		sbiw r24,2
 9384 338e A109      		sbc r26,__zero_reg__
 9385 3390 B109      		sbc r27,__zero_reg__
 9386 3392 8217      		cp r24,r18
 9387 3394 9307      		cpc r25,r19
 9388 3396 A407      		cpc r26,r20
GAS LISTING /tmp/ccPugNTh.s 			page 221


 9389 3398 B507      		cpc r27,r21
 9390 339a 00F0      		brlo .L440
 9391               		.stabn	68,0,2333,.LM782-.LFBB35
 9392               	.LM782:
 9393 339c EC81      		ldd r30,Y+4
 9394 339e FD81      		ldd r31,Y+5
 9395 33a0 2083      		st Z,r18
 9396 33a2 3183      		std Z+1,r19
 9397 33a4 4283      		std Z+2,r20
 9398 33a6 5383      		std Z+3,r21
 9399 33a8 00C0      		rjmp .L457
 9400               	.L440:
 9401               		.stabn	68,0,2338,.LM783-.LFBB35
 9402               	.LM783:
 9403 33aa 3080      		ld r3,Z
 9404 33ac 3B82      		std Y+3,r3
 9405               		.stabn	68,0,2340,.LM784-.LFBB35
 9406               	.LM784:
 9407 33ae 232D      		mov r18,r3
 9408 33b0 2130      		cpi r18,lo8(1)
 9409 33b2 01F4      		brne .L441
 9410 33b4 AA24      		clr r10
 9411 33b6 BB24      		clr r11
 9412 33b8 6501      		movw r12,r10
 9413 33ba 92E0      		ldi r25,lo8(2)
 9414 33bc E92E      		mov r14,r25
 9415 33be F12C      		mov r15,__zero_reg__
 9416 33c0 012D      		mov r16,__zero_reg__
 9417 33c2 112D      		mov r17,__zero_reg__
 9418               	.L445:
 9419               		.stabn	68,0,2343,.LM785-.LFBB35
 9420               	.LM785:
 9421 33c4 D201      		movw r26,r4
 9422 33c6 8D91      		ld r24,X+
 9423 33c8 9C91      		ld r25,X
 9424 33ca B801      		movw r22,r16
 9425 33cc A701      		movw r20,r14
 9426 33ce 0E94 0000 		call get_fat
 9427               		.stabn	68,0,2344,.LM786-.LFBB35
 9428               	.LM786:
 9429 33d2 6F3F      		cpi r22,lo8(-1)
 9430 33d4 BFEF      		ldi r27,hi8(-1)
 9431 33d6 7B07      		cpc r23,r27
 9432 33d8 BFEF      		ldi r27,hlo8(-1)
 9433 33da 8B07      		cpc r24,r27
 9434 33dc BFEF      		ldi r27,hhi8(-1)
 9435 33de 9B07      		cpc r25,r27
 9436 33e0 01F4      		brne .L442
 9437 33e2 81E0      		ldi r24,lo8(1)
 9438 33e4 00C0      		rjmp .L439
 9439               	.L442:
 9440               		.stabn	68,0,2345,.LM787-.LFBB35
 9441               	.LM787:
 9442 33e6 6130      		cpi r22,lo8(1)
 9443 33e8 7105      		cpc r23,__zero_reg__
 9444 33ea 8105      		cpc r24,__zero_reg__
 9445 33ec 9105      		cpc r25,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 222


 9446 33ee 01F4      		brne .L443
 9447 33f0 82E0      		ldi r24,lo8(2)
 9448 33f2 00C0      		rjmp .L439
 9449               	.L443:
 9450               		.stabn	68,0,2346,.LM788-.LFBB35
 9451               	.LM788:
 9452 33f4 6115      		cp r22,__zero_reg__
 9453 33f6 7105      		cpc r23,__zero_reg__
 9454 33f8 8105      		cpc r24,__zero_reg__
 9455 33fa 9105      		cpc r25,__zero_reg__
 9456 33fc 01F4      		brne .L444
 9457 33fe 0894      		sec
 9458 3400 A11C      		adc r10,__zero_reg__
 9459 3402 B11C      		adc r11,__zero_reg__
 9460 3404 C11C      		adc r12,__zero_reg__
 9461 3406 D11C      		adc r13,__zero_reg__
 9462               	.L444:
 9463               		.stabn	68,0,2347,.LM789-.LFBB35
 9464               	.LM789:
 9465 3408 0894      		sec
 9466 340a E11C      		adc r14,__zero_reg__
 9467 340c F11C      		adc r15,__zero_reg__
 9468 340e 011D      		adc r16,__zero_reg__
 9469 3410 111D      		adc r17,__zero_reg__
 9470 3412 D201      		movw r26,r4
 9471 3414 ED91      		ld r30,X+
 9472 3416 FC91      		ld r31,X
 9473 3418 828D      		ldd r24,Z+26
 9474 341a 938D      		ldd r25,Z+27
 9475 341c A48D      		ldd r26,Z+28
 9476 341e B58D      		ldd r27,Z+29
 9477 3420 E816      		cp r14,r24
 9478 3422 F906      		cpc r15,r25
 9479 3424 0A07      		cpc r16,r26
 9480 3426 1B07      		cpc r17,r27
 9481 3428 00F0      		brlo .L445
 9482 342a 00C0      		rjmp .L446
 9483               	.L441:
 9484               		.stabn	68,0,2350,.LM790-.LFBB35
 9485               	.LM790:
 9486 342c 668C      		ldd r6,Z+30
 9487 342e 778C      		ldd r7,Z+31
 9488 3430 80A0      		ldd r8,Z+32
 9489 3432 91A0      		ldd r9,Z+33
 9490 3434 AA24      		clr r10
 9491 3436 BB24      		clr r11
 9492 3438 6501      		movw r12,r10
 9493 343a 60E0      		ldi r22,lo8(0)
 9494 343c 70E0      		ldi r23,hi8(0)
 9495 343e E0E0      		ldi r30,lo8(0)
 9496 3440 F0E0      		ldi r31,hi8(0)
 9497               	.L452:
 9498               		.stabn	68,0,2353,.LM791-.LFBB35
 9499               	.LM791:
 9500 3442 6115      		cp r22,__zero_reg__
 9501 3444 7105      		cpc r23,__zero_reg__
 9502 3446 01F4      		brne .L447
GAS LISTING /tmp/ccPugNTh.s 			page 223


 9503               		.stabn	68,0,2354,.LM792-.LFBB35
 9504               	.LM792:
 9505 3448 F201      		movw r30,r4
 9506 344a 8081      		ld r24,Z
 9507 344c 9181      		ldd r25,Z+1
 9508 344e B401      		movw r22,r8
 9509 3450 A301      		movw r20,r6
 9510 3452 0E94 0000 		call move_window
 9511               		.stabn	68,0,2355,.LM793-.LFBB35
 9512               	.LM793:
 9513 3456 8823      		tst r24
 9514 3458 01F0      		breq .+2
 9515 345a 00C0      		rjmp .L439
 9516               		.stabn	68,0,2354,.LM794-.LFBB35
 9517               	.LM794:
 9518 345c 0894      		sec
 9519 345e 611C      		adc r6,__zero_reg__
 9520 3460 711C      		adc r7,__zero_reg__
 9521 3462 811C      		adc r8,__zero_reg__
 9522 3464 911C      		adc r9,__zero_reg__
 9523               		.stabn	68,0,2357,.LM795-.LFBB35
 9524               	.LM795:
 9525 3466 D201      		movw r26,r4
 9526 3468 ED91      		ld r30,X+
 9527 346a FC91      		ld r31,X
 9528 346c BE96      		adiw r30,46
 9529 346e 60E0      		ldi r22,lo8(512)
 9530 3470 72E0      		ldi r23,hi8(512)
 9531               	.L447:
 9532 3472 B181      		ldd r27,Z+1
 9533 3474 B887      		std Y+8,r27
 9534 3476 2081      		ld r18,Z
 9535 3478 2987      		std Y+9,r18
 9536               		.stabn	68,0,2360,.LM796-.LFBB35
 9537               	.LM796:
 9538 347a 3B81      		ldd r19,Y+3
 9539 347c 3230      		cpi r19,lo8(2)
 9540 347e 01F4      		brne .L448
 9541               		.stabn	68,0,2361,.LM797-.LFBB35
 9542               	.LM797:
 9543 3480 BF83      		std Y+7,r27
 9544 3482 1E82      		std Y+6,__zero_reg__
 9545 3484 822F      		mov r24,r18
 9546 3486 90E0      		ldi r25,lo8(0)
 9547 3488 AE81      		ldd r26,Y+6
 9548 348a BF81      		ldd r27,Y+7
 9549 348c 8A2B      		or r24,r26
 9550 348e 9B2B      		or r25,r27
 9551 3490 892B      		or r24,r25
 9552 3492 01F4      		brne .L449
 9553 3494 0894      		sec
 9554 3496 A11C      		adc r10,__zero_reg__
 9555 3498 B11C      		adc r11,__zero_reg__
 9556 349a C11C      		adc r12,__zero_reg__
 9557 349c D11C      		adc r13,__zero_reg__
 9558               	.L449:
 9559               		.stabn	68,0,2362,.LM798-.LFBB35
GAS LISTING /tmp/ccPugNTh.s 			page 224


 9560               	.LM798:
 9561 349e 3296      		adiw r30,2
 9562 34a0 6250      		subi r22,lo8(-(-2))
 9563 34a2 7040      		sbci r23,hi8(-(-2))
 9564 34a4 00C0      		rjmp .L450
 9565               	.L448:
 9566               		.stabn	68,0,2364,.LM799-.LFBB35
 9567               	.LM799:
 9568 34a6 2381      		ldd r18,Z+3
 9569 34a8 30E0      		ldi r19,lo8(0)
 9570 34aa 40E0      		ldi r20,lo8(0)
 9571 34ac 50E0      		ldi r21,hi8(0)
 9572 34ae 522F      		mov r21,r18
 9573 34b0 4427      		clr r20
 9574 34b2 3327      		clr r19
 9575 34b4 2227      		clr r18
 9576 34b6 8281      		ldd r24,Z+2
 9577 34b8 90E0      		ldi r25,lo8(0)
 9578 34ba A0E0      		ldi r26,lo8(0)
 9579 34bc B0E0      		ldi r27,hi8(0)
 9580 34be DC01      		movw r26,r24
 9581 34c0 9927      		clr r25
 9582 34c2 8827      		clr r24
 9583 34c4 282B      		or r18,r24
 9584 34c6 392B      		or r19,r25
 9585 34c8 4A2B      		or r20,r26
 9586 34ca 5B2B      		or r21,r27
 9587 34cc 3984      		ldd r3,Y+9
 9588 34ce 832D      		mov r24,r3
 9589 34d0 90E0      		ldi r25,lo8(0)
 9590 34d2 A0E0      		ldi r26,lo8(0)
 9591 34d4 B0E0      		ldi r27,hi8(0)
 9592 34d6 282B      		or r18,r24
 9593 34d8 392B      		or r19,r25
 9594 34da 4A2B      		or r20,r26
 9595 34dc 5B2B      		or r21,r27
 9596 34de 3884      		ldd r3,Y+8
 9597 34e0 2224      		clr r2
 9598 34e2 C101      		movw r24,r2
 9599 34e4 A0E0      		ldi r26,lo8(0)
 9600 34e6 B0E0      		ldi r27,hi8(0)
 9601 34e8 282B      		or r18,r24
 9602 34ea 392B      		or r19,r25
 9603 34ec 4A2B      		or r20,r26
 9604 34ee 5B2B      		or r21,r27
 9605 34f0 5F70      		andi r21,hhi8(268435455)
 9606 34f2 2115      		cp r18,__zero_reg__
 9607 34f4 3105      		cpc r19,__zero_reg__
 9608 34f6 4105      		cpc r20,__zero_reg__
 9609 34f8 5105      		cpc r21,__zero_reg__
 9610 34fa 01F4      		brne .L451
 9611 34fc 0894      		sec
 9612 34fe A11C      		adc r10,__zero_reg__
 9613 3500 B11C      		adc r11,__zero_reg__
 9614 3502 C11C      		adc r12,__zero_reg__
 9615 3504 D11C      		adc r13,__zero_reg__
 9616               	.L451:
GAS LISTING /tmp/ccPugNTh.s 			page 225


 9617               		.stabn	68,0,2365,.LM800-.LFBB35
 9618               	.LM800:
 9619 3506 3496      		adiw r30,4
 9620 3508 6450      		subi r22,lo8(-(-4))
 9621 350a 7040      		sbci r23,hi8(-(-4))
 9622               	.L450:
 9623               		.stabn	68,0,2367,.LM801-.LFBB35
 9624               	.LM801:
 9625 350c 0894      		sec
 9626 350e E108      		sbc r14,__zero_reg__
 9627 3510 F108      		sbc r15,__zero_reg__
 9628 3512 0109      		sbc r16,__zero_reg__
 9629 3514 1109      		sbc r17,__zero_reg__
 9630 3516 E114      		cp r14,__zero_reg__
 9631 3518 F104      		cpc r15,__zero_reg__
 9632 351a 0105      		cpc r16,__zero_reg__
 9633 351c 1105      		cpc r17,__zero_reg__
 9634 351e 01F0      		breq .+2
 9635 3520 00C0      		rjmp .L452
 9636               	.L446:
 9637               		.stabn	68,0,2369,.LM802-.LFBB35
 9638               	.LM802:
 9639 3522 D201      		movw r26,r4
 9640 3524 ED91      		ld r30,X+
 9641 3526 FC91      		ld r31,X
 9642 3528 A686      		std Z+14,r10
 9643 352a B786      		std Z+15,r11
 9644 352c C08A      		std Z+16,r12
 9645 352e D18A      		std Z+17,r13
 9646               		.stabn	68,0,2370,.LM803-.LFBB35
 9647               	.LM803:
 9648 3530 BB81      		ldd r27,Y+3
 9649 3532 B330      		cpi r27,lo8(3)
 9650 3534 01F4      		brne .L453
 9651 3536 81E0      		ldi r24,lo8(1)
 9652 3538 8583      		std Z+5,r24
 9653               	.L453:
 9654               		.stabn	68,0,2371,.LM804-.LFBB35
 9655               	.LM804:
 9656 353a EC81      		ldd r30,Y+4
 9657 353c FD81      		ldd r31,Y+5
 9658 353e A082      		st Z,r10
 9659 3540 B182      		std Z+1,r11
 9660 3542 C282      		std Z+2,r12
 9661 3544 D382      		std Z+3,r13
 9662               	.L457:
 9663 3546 80E0      		ldi r24,lo8(0)
 9664               	.L439:
 9665               	/* epilogue start */
 9666               		.stabn	68,0,2374,.LM805-.LFBB35
 9667               	.LM805:
 9668 3548 2996      		adiw r28,9
 9669 354a 0FB6      		in __tmp_reg__,__SREG__
 9670 354c F894      		cli
 9671 354e DEBF      		out __SP_H__,r29
 9672 3550 0FBE      		out __SREG__,__tmp_reg__
 9673 3552 CDBF      		out __SP_L__,r28
GAS LISTING /tmp/ccPugNTh.s 			page 226


 9674 3554 CF91      		pop r28
 9675 3556 DF91      		pop r29
 9676 3558 1F91      		pop r17
 9677 355a 0F91      		pop r16
 9678 355c FF90      		pop r15
 9679 355e EF90      		pop r14
 9680 3560 DF90      		pop r13
 9681 3562 CF90      		pop r12
 9682 3564 BF90      		pop r11
 9683 3566 AF90      		pop r10
 9684 3568 9F90      		pop r9
 9685 356a 8F90      		pop r8
 9686 356c 7F90      		pop r7
 9687 356e 6F90      		pop r6
 9688 3570 5F90      		pop r5
 9689 3572 4F90      		pop r4
 9690 3574 3F90      		pop r3
 9691 3576 2F90      		pop r2
 9692 3578 0895      		ret
 9693               		.size	f_getfree, .-f_getfree
 9694               		.stabs	"res:r(1,16)",64,0,2321,24
 9695               		.stabs	"n:r(2,12)",64,0,2322,10
 9696               		.stabs	"clst:r(2,12)",64,0,2322,14
 9697               		.stabs	"sect:r(2,12)",64,0,2322,6
 9698               		.stabs	"stat:r(2,12)",64,0,2322,22
 9699               		.stabs	"i:r(2,2)",64,0,2323,22
 9700               		.stabs	"fat:(2,5)",128,0,2324,3
 9701               		.stabs	"p:r(1,8)",64,0,2324,30
 9702               		.stabn	192,0,0,.LFBB35-.LFBB35
 9703               		.stabn	224,0,0,.Lscope35-.LFBB35
 9704               	.Lscope35:
 9705               		.stabs	"",36,0,0,.Lscope35-.LFBB35
 9706               		.stabd	78,0,0
 9707               		.stabs	"f_stat:F(1,16)",36,0,2287,f_stat
 9708               		.stabs	"path:p(0,19)",160,0,2284,35
 9709               		.stabs	"fno:P(0,17)",64,0,2285,12
 9710               	.global	f_stat
 9711               		.type	f_stat, @function
 9712               	f_stat:
 9713               		.stabd	46,0,0
 9714               		.stabn	68,0,2287,.LM806-.LFBB36
 9715               	.LM806:
 9716               	.LFBB36:
 9717 357a CF92      		push r12
 9718 357c DF92      		push r13
 9719 357e EF92      		push r14
 9720 3580 FF92      		push r15
 9721 3582 1F93      		push r17
 9722 3584 DF93      		push r29
 9723 3586 CF93      		push r28
 9724 3588 CDB7      		in r28,__SP_L__
 9725 358a DEB7      		in r29,__SP_H__
 9726 358c A497      		sbiw r28,36
 9727 358e 0FB6      		in __tmp_reg__,__SREG__
 9728 3590 F894      		cli
 9729 3592 DEBF      		out __SP_H__,r29
 9730 3594 0FBE      		out __SREG__,__tmp_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 227


 9731 3596 CDBF      		out __SP_L__,r28
 9732               	/* prologue: function */
 9733               	/* frame size = 36 */
 9734 3598 9CA3      		std Y+36,r25
 9735 359a 8BA3      		std Y+35,r24
 9736 359c 6B01      		movw r12,r22
 9737               		.stabn	68,0,2293,.LM807-.LFBB36
 9738               	.LM807:
 9739 359e 2DE0      		ldi r18,lo8(13)
 9740 35a0 E22E      		mov r14,r18
 9741 35a2 F12C      		mov r15,__zero_reg__
 9742 35a4 EC0E      		add r14,r28
 9743 35a6 FD1E      		adc r15,r29
 9744 35a8 CE01      		movw r24,r28
 9745 35aa 8396      		adiw r24,35
 9746 35ac B701      		movw r22,r14
 9747 35ae 40E0      		ldi r20,lo8(0)
 9748 35b0 0E94 0000 		call chk_mounted
 9749 35b4 182F      		mov r17,r24
 9750               		.stabn	68,0,2294,.LM808-.LFBB36
 9751               	.LM808:
 9752 35b6 8823      		tst r24
 9753 35b8 01F4      		brne .L459
 9754               		.stabn	68,0,2295,.LM809-.LFBB36
 9755               	.LM809:
 9756 35ba CE01      		movw r24,r28
 9757 35bc 0196      		adiw r24,1
 9758 35be 9AA3      		std Y+34,r25
 9759 35c0 89A3      		std Y+33,r24
 9760               		.stabn	68,0,2296,.LM810-.LFBB36
 9761               	.LM810:
 9762 35c2 6BA1      		ldd r22,Y+35
 9763 35c4 7CA1      		ldd r23,Y+36
 9764 35c6 C701      		movw r24,r14
 9765 35c8 0E94 0000 		call follow_path
 9766 35cc 182F      		mov r17,r24
 9767               		.stabn	68,0,2297,.LM811-.LFBB36
 9768               	.LM811:
 9769 35ce 8823      		tst r24
 9770 35d0 01F4      		brne .L459
 9771               		.stabn	68,0,2298,.LM812-.LFBB36
 9772               	.LM812:
 9773 35d2 8F8D      		ldd r24,Y+31
 9774 35d4 98A1      		ldd r25,Y+32
 9775 35d6 892B      		or r24,r25
 9776 35d8 01F4      		brne .L460
 9777 35da 16E0      		ldi r17,lo8(6)
 9778 35dc 00C0      		rjmp .L459
 9779               	.L460:
 9780               		.stabn	68,0,2299,.LM813-.LFBB36
 9781               	.LM813:
 9782 35de C701      		movw r24,r14
 9783 35e0 B601      		movw r22,r12
 9784 35e2 0E94 0000 		call get_fileinfo
 9785               	.L459:
 9786               		.stabn	68,0,2306,.LM814-.LFBB36
 9787               	.LM814:
GAS LISTING /tmp/ccPugNTh.s 			page 228


 9788 35e6 812F      		mov r24,r17
 9789               	/* epilogue start */
 9790 35e8 A496      		adiw r28,36
 9791 35ea 0FB6      		in __tmp_reg__,__SREG__
 9792 35ec F894      		cli
 9793 35ee DEBF      		out __SP_H__,r29
 9794 35f0 0FBE      		out __SREG__,__tmp_reg__
 9795 35f2 CDBF      		out __SP_L__,r28
 9796 35f4 CF91      		pop r28
 9797 35f6 DF91      		pop r29
 9798 35f8 1F91      		pop r17
 9799 35fa FF90      		pop r15
 9800 35fc EF90      		pop r14
 9801 35fe DF90      		pop r13
 9802 3600 CF90      		pop r12
 9803 3602 0895      		ret
 9804               		.size	f_stat, .-f_stat
 9805               		.stabs	"res:r(1,16)",64,0,2288,17
 9806               		.stabs	"dj:(1,9)",128,0,2289,13
 9807               		.stabs	"sfn:(0,24)",128,0,2290,1
 9808               		.stabn	192,0,0,.LFBB36-.LFBB36
 9809               		.stabn	224,0,0,.Lscope36-.LFBB36
 9810               	.Lscope36:
 9811               		.stabs	"",36,0,0,.Lscope36-.LFBB36
 9812               		.stabd	78,0,0
 9813               		.stabs	"f_opendir:F(1,16)",36,0,2205,f_opendir
 9814               		.stabs	"dj:P(0,16)",64,0,2202,16
 9815               		.stabs	"path:p(0,19)",160,0,2203,13
 9816               	.global	f_opendir
 9817               		.type	f_opendir, @function
 9818               	f_opendir:
 9819               		.stabd	46,0,0
 9820               		.stabn	68,0,2205,.LM815-.LFBB37
 9821               	.LM815:
 9822               	.LFBB37:
 9823 3604 0F93      		push r16
 9824 3606 1F93      		push r17
 9825 3608 DF93      		push r29
 9826 360a CF93      		push r28
 9827 360c CDB7      		in r28,__SP_L__
 9828 360e DEB7      		in r29,__SP_H__
 9829 3610 2E97      		sbiw r28,14
 9830 3612 0FB6      		in __tmp_reg__,__SREG__
 9831 3614 F894      		cli
 9832 3616 DEBF      		out __SP_H__,r29
 9833 3618 0FBE      		out __SREG__,__tmp_reg__
 9834 361a CDBF      		out __SP_L__,r28
 9835               	/* prologue: function */
 9836               	/* frame size = 14 */
 9837 361c 8C01      		movw r16,r24
 9838 361e 7E87      		std Y+14,r23
 9839 3620 6D87      		std Y+13,r22
 9840               		.stabn	68,0,2211,.LM816-.LFBB37
 9841               	.LM816:
 9842 3622 CE01      		movw r24,r28
 9843 3624 0D96      		adiw r24,13
 9844 3626 B801      		movw r22,r16
GAS LISTING /tmp/ccPugNTh.s 			page 229


 9845 3628 40E0      		ldi r20,lo8(0)
 9846 362a 0E94 0000 		call chk_mounted
 9847               		.stabn	68,0,2212,.LM817-.LFBB37
 9848               	.LM817:
 9849 362e 8823      		tst r24
 9850 3630 01F0      		breq .+2
 9851 3632 00C0      		rjmp .L463
 9852               		.stabn	68,0,2213,.LM818-.LFBB37
 9853               	.LM818:
 9854 3634 CE01      		movw r24,r28
 9855 3636 0196      		adiw r24,1
 9856 3638 D801      		movw r26,r16
 9857 363a 5596      		adiw r26,20+1
 9858 363c 9C93      		st X,r25
 9859 363e 8E93      		st -X,r24
 9860 3640 5497      		sbiw r26,20
 9861               		.stabn	68,0,2214,.LM819-.LFBB37
 9862               	.LM819:
 9863 3642 6D85      		ldd r22,Y+13
 9864 3644 7E85      		ldd r23,Y+14
 9865 3646 C801      		movw r24,r16
 9866 3648 0E94 0000 		call follow_path
 9867               		.stabn	68,0,2215,.LM820-.LFBB37
 9868               	.LM820:
 9869 364c 8823      		tst r24
 9870 364e 01F4      		brne .L464
 9871               		.stabn	68,0,2216,.LM821-.LFBB37
 9872               	.LM821:
 9873 3650 D801      		movw r26,r16
 9874 3652 5296      		adiw r26,18
 9875 3654 ED91      		ld r30,X+
 9876 3656 FC91      		ld r31,X
 9877 3658 5397      		sbiw r26,18+1
 9878               		.stabn	68,0,2217,.LM822-.LFBB37
 9879               	.LM822:
 9880 365a 3097      		sbiw r30,0
 9881 365c 01F0      		breq .L465
 9882               		.stabn	68,0,2218,.LM823-.LFBB37
 9883               	.LM823:
 9884 365e 8385      		ldd r24,Z+11
 9885 3660 84FF      		sbrs r24,4
 9886 3662 00C0      		rjmp .L468
 9887               	.L466:
 9888               		.stabn	68,0,2219,.LM824-.LFBB37
 9889               	.LM824:
 9890 3664 3589      		ldd r19,Z+21
 9891 3666 20E0      		ldi r18,lo8(0)
 9892 3668 8489      		ldd r24,Z+20
 9893 366a 90E0      		ldi r25,lo8(0)
 9894 366c 282B      		or r18,r24
 9895 366e 392B      		or r19,r25
 9896 3670 40E0      		ldi r20,lo8(0)
 9897 3672 50E0      		ldi r21,hi8(0)
 9898 3674 A901      		movw r20,r18
 9899 3676 3327      		clr r19
 9900 3678 2227      		clr r18
 9901 367a 938D      		ldd r25,Z+27
GAS LISTING /tmp/ccPugNTh.s 			page 230


 9902 367c 80E0      		ldi r24,lo8(0)
 9903 367e 628D      		ldd r22,Z+26
 9904 3680 70E0      		ldi r23,lo8(0)
 9905 3682 862B      		or r24,r22
 9906 3684 972B      		or r25,r23
 9907 3686 A0E0      		ldi r26,lo8(0)
 9908 3688 B0E0      		ldi r27,hi8(0)
 9909 368a 282B      		or r18,r24
 9910 368c 392B      		or r19,r25
 9911 368e 4A2B      		or r20,r26
 9912 3690 5B2B      		or r21,r27
 9913 3692 F801      		movw r30,r16
 9914 3694 2683      		std Z+6,r18
 9915 3696 3783      		std Z+7,r19
 9916 3698 4087      		std Z+8,r20
 9917 369a 5187      		std Z+9,r21
 9918               	.L465:
 9919               		.stabn	68,0,2225,.LM825-.LFBB37
 9920               	.LM825:
 9921 369c D801      		movw r26,r16
 9922 369e ED91      		ld r30,X+
 9923 36a0 FC91      		ld r31,X
 9924 36a2 1197      		sbiw r26,1
 9925 36a4 8681      		ldd r24,Z+6
 9926 36a6 9781      		ldd r25,Z+7
 9927 36a8 1396      		adiw r26,2+1
 9928 36aa 9C93      		st X,r25
 9929 36ac 8E93      		st -X,r24
 9930 36ae 1297      		sbiw r26,2
 9931               		.stabn	68,0,2226,.LM826-.LFBB37
 9932               	.LM826:
 9933 36b0 C801      		movw r24,r16
 9934 36b2 60E0      		ldi r22,lo8(0)
 9935 36b4 70E0      		ldi r23,hi8(0)
 9936 36b6 0E94 0000 		call dir_seek
 9937               	.L464:
 9938               		.stabn	68,0,2229,.LM827-.LFBB37
 9939               	.LM827:
 9940 36ba 8430      		cpi r24,lo8(4)
 9941 36bc 01F4      		brne .L463
 9942               	.L468:
 9943 36be 85E0      		ldi r24,lo8(5)
 9944               	.L463:
 9945               	/* epilogue start */
 9946               		.stabn	68,0,2233,.LM828-.LFBB37
 9947               	.LM828:
 9948 36c0 2E96      		adiw r28,14
 9949 36c2 0FB6      		in __tmp_reg__,__SREG__
 9950 36c4 F894      		cli
 9951 36c6 DEBF      		out __SP_H__,r29
 9952 36c8 0FBE      		out __SREG__,__tmp_reg__
 9953 36ca CDBF      		out __SP_L__,r28
 9954 36cc CF91      		pop r28
 9955 36ce DF91      		pop r29
 9956 36d0 1F91      		pop r17
 9957 36d2 0F91      		pop r16
 9958 36d4 0895      		ret
GAS LISTING /tmp/ccPugNTh.s 			page 231


 9959               		.size	f_opendir, .-f_opendir
 9960               		.stabs	"res:r(1,16)",64,0,2206,24
 9961               		.stabs	"sfn:(0,24)",128,0,2207,1
 9962               		.stabs	"dir:r(1,8)",64,0,2208,30
 9963               		.stabn	192,0,0,.LFBB37-.LFBB37
 9964               		.stabn	224,0,0,.Lscope37-.LFBB37
 9965               	.Lscope37:
 9966               		.stabs	"",36,0,0,.Lscope37-.LFBB37
 9967               		.stabd	78,0,0
 9968               		.stabs	"f_open:F(1,16)",36,0,1670,f_open
 9969               		.stabs	"fp:P(0,23)",64,0,1666,6
 9970               		.stabs	"path:p(0,19)",160,0,1667,35
 9971               		.stabs	"mode:P(2,5)",64,0,1668,20
 9972               	.global	f_open
 9973               		.type	f_open, @function
 9974               	f_open:
 9975               		.stabd	46,0,0
 9976               		.stabn	68,0,1670,.LM829-.LFBB38
 9977               	.LM829:
 9978               	.LFBB38:
 9979 36d6 5F92      		push r5
 9980 36d8 6F92      		push r6
 9981 36da 7F92      		push r7
 9982 36dc 8F92      		push r8
 9983 36de 9F92      		push r9
 9984 36e0 AF92      		push r10
 9985 36e2 BF92      		push r11
 9986 36e4 CF92      		push r12
 9987 36e6 DF92      		push r13
 9988 36e8 EF92      		push r14
 9989 36ea FF92      		push r15
 9990 36ec 0F93      		push r16
 9991 36ee 1F93      		push r17
 9992 36f0 DF93      		push r29
 9993 36f2 CF93      		push r28
 9994 36f4 CDB7      		in r28,__SP_L__
 9995 36f6 DEB7      		in r29,__SP_H__
 9996 36f8 A497      		sbiw r28,36
 9997 36fa 0FB6      		in __tmp_reg__,__SREG__
 9998 36fc F894      		cli
 9999 36fe DEBF      		out __SP_H__,r29
 10000 3700 0FBE      		out __SREG__,__tmp_reg__
 10001 3702 CDBF      		out __SP_L__,r28
 10002               	/* prologue: function */
 10003               	/* frame size = 36 */
 10004 3704 3C01      		movw r6,r24
 10005 3706 7CA3      		std Y+36,r23
 10006 3708 6BA3      		std Y+35,r22
 10007               		.stabn	68,0,1677,.LM830-.LFBB38
 10008               	.LM830:
 10009 370a DC01      		movw r26,r24
 10010 370c 1D92      		st X+,__zero_reg__
 10011 370e 1C92      		st X,__zero_reg__
 10012               		.stabn	68,0,1679,.LM831-.LFBB38
 10013               	.LM831:
 10014 3710 6FE1      		ldi r22,lo8(31)
 10015 3712 562E      		mov r5,r22
GAS LISTING /tmp/ccPugNTh.s 			page 232


 10016 3714 5422      		and r5,r20
 10017               		.stabn	68,0,1680,.LM832-.LFBB38
 10018               	.LM832:
 10019 3716 8E01      		movw r16,r28
 10020 3718 035F      		subi r16,lo8(-(13))
 10021 371a 1F4F      		sbci r17,hi8(-(13))
 10022 371c 4E71      		andi r20,lo8(30)
 10023 371e CE01      		movw r24,r28
 10024 3720 8396      		adiw r24,35
 10025 3722 B801      		movw r22,r16
 10026 3724 0E94 0000 		call chk_mounted
 10027               		.stabn	68,0,1685,.LM833-.LFBB38
 10028               	.LM833:
 10029 3728 8823      		tst r24
 10030 372a 01F0      		breq .L470
 10031 372c 282F      		mov r18,r24
 10032 372e 00C0      		rjmp .L471
 10033               	.L470:
 10034               		.stabn	68,0,1686,.LM834-.LFBB38
 10035               	.LM834:
 10036 3730 CE01      		movw r24,r28
 10037 3732 0196      		adiw r24,1
 10038 3734 9AA3      		std Y+34,r25
 10039 3736 89A3      		std Y+33,r24
 10040               		.stabn	68,0,1687,.LM835-.LFBB38
 10041               	.LM835:
 10042 3738 6BA1      		ldd r22,Y+35
 10043 373a 7CA1      		ldd r23,Y+36
 10044 373c C801      		movw r24,r16
 10045 373e 0E94 0000 		call follow_path
 10046 3742 282F      		mov r18,r24
 10047               		.stabn	68,0,1691,.LM836-.LFBB38
 10048               	.LM836:
 10049 3744 452D      		mov r20,r5
 10050 3746 50E0      		ldi r21,lo8(0)
 10051 3748 CA01      		movw r24,r20
 10052 374a 8C71      		andi r24,lo8(28)
 10053 374c 9070      		andi r25,hi8(28)
 10054 374e 892B      		or r24,r25
 10055 3750 01F4      		brne .+2
 10056 3752 00C0      		rjmp .L472
 10057               	.LBB132:
 10058               		.stabn	68,0,1694,.LM837-.LFBB38
 10059               	.LM837:
 10060 3754 2223      		tst r18
 10061 3756 01F0      		breq .L473
 10062               		.stabn	68,0,1695,.LM838-.LFBB38
 10063               	.LM838:
 10064 3758 2430      		cpi r18,lo8(4)
 10065 375a 01F0      		breq .+2
 10066 375c 00C0      		rjmp .L471
 10067               		.stabn	68,0,1696,.LM839-.LFBB38
 10068               	.LM839:
 10069 375e C801      		movw r24,r16
 10070 3760 0E94 0000 		call dir_register
 10071 3764 282F      		mov r18,r24
 10072               		.stabn	68,0,1697,.LM840-.LFBB38
GAS LISTING /tmp/ccPugNTh.s 			page 233


 10073               	.LM840:
 10074 3766 8823      		tst r24
 10075 3768 01F0      		breq .+2
 10076 376a 00C0      		rjmp .L471
 10077               		.stabn	68,0,1698,.LM841-.LFBB38
 10078               	.LM841:
 10079 376c B8E0      		ldi r27,lo8(8)
 10080 376e 5B2A      		or r5,r27
 10081               		.stabn	68,0,1699,.LM842-.LFBB38
 10082               	.LM842:
 10083 3770 CF8C      		ldd r12,Y+31
 10084 3772 D8A0      		ldd r13,Y+32
 10085 3774 00C0      		rjmp .L474
 10086               	.L473:
 10087               		.stabn	68,0,1702,.LM843-.LFBB38
 10088               	.LM843:
 10089 3776 52FE      		sbrs r5,2
 10090 3778 00C0      		rjmp .L475
 10091 377a 28E0      		ldi r18,lo8(8)
 10092 377c 00C0      		rjmp .L471
 10093               	.L475:
 10094               		.stabn	68,0,1704,.LM844-.LFBB38
 10095               	.LM844:
 10096 377e CF8C      		ldd r12,Y+31
 10097 3780 D8A0      		ldd r13,Y+32
 10098               		.stabn	68,0,1705,.LM845-.LFBB38
 10099               	.LM845:
 10100 3782 C114      		cp r12,__zero_reg__
 10101 3784 D104      		cpc r13,__zero_reg__
 10102 3786 01F4      		brne .+2
 10103 3788 00C0      		rjmp .L476
 10104 378a F601      		movw r30,r12
 10105 378c 8385      		ldd r24,Z+11
 10106 378e 8171      		andi r24,lo8(17)
 10107 3790 01F0      		breq .+2
 10108 3792 00C0      		rjmp .L476
 10109               		.stabn	68,0,1707,.LM846-.LFBB38
 10110               	.LM846:
 10111 3794 53FE      		sbrs r5,3
 10112 3796 00C0      		rjmp .L474
 10113               		.stabn	68,0,1708,.LM847-.LFBB38
 10114               	.LM847:
 10115 3798 9589      		ldd r25,Z+21
 10116 379a 80E0      		ldi r24,lo8(0)
 10117 379c 2489      		ldd r18,Z+20
 10118 379e 30E0      		ldi r19,lo8(0)
 10119 37a0 822B      		or r24,r18
 10120 37a2 932B      		or r25,r19
 10121 37a4 A0E0      		ldi r26,lo8(0)
 10122 37a6 B0E0      		ldi r27,hi8(0)
 10123 37a8 8C01      		movw r16,r24
 10124 37aa FF24      		clr r15
 10125 37ac EE24      		clr r14
 10126 37ae 938D      		ldd r25,Z+27
 10127 37b0 80E0      		ldi r24,lo8(0)
 10128 37b2 228D      		ldd r18,Z+26
 10129 37b4 30E0      		ldi r19,lo8(0)
GAS LISTING /tmp/ccPugNTh.s 			page 234


 10130 37b6 822B      		or r24,r18
 10131 37b8 932B      		or r25,r19
 10132 37ba A0E0      		ldi r26,lo8(0)
 10133 37bc B0E0      		ldi r27,hi8(0)
 10134 37be E82A      		or r14,r24
 10135 37c0 F92A      		or r15,r25
 10136 37c2 0A2B      		or r16,r26
 10137 37c4 1B2B      		or r17,r27
 10138               		.stabn	68,0,1709,.LM848-.LFBB38
 10139               	.LM848:
 10140 37c6 148A      		std Z+20,__zero_reg__
 10141 37c8 158A      		std Z+21,__zero_reg__
 10142               		.stabn	68,0,1710,.LM849-.LFBB38
 10143               	.LM849:
 10144 37ca 128E      		std Z+26,__zero_reg__
 10145 37cc 138E      		std Z+27,__zero_reg__
 10146               		.stabn	68,0,1711,.LM850-.LFBB38
 10147               	.LM850:
 10148 37ce 148E      		std Z+28,__zero_reg__
 10149 37d0 158E      		std Z+29,__zero_reg__
 10150 37d2 168E      		std Z+30,__zero_reg__
 10151 37d4 178E      		std Z+31,__zero_reg__
 10152               		.stabn	68,0,1712,.LM851-.LFBB38
 10153               	.LM851:
 10154 37d6 ED85      		ldd r30,Y+13
 10155 37d8 FE85      		ldd r31,Y+14
 10156 37da 81E0      		ldi r24,lo8(1)
 10157 37dc 8483      		std Z+4,r24
 10158               		.stabn	68,0,1713,.LM852-.LFBB38
 10159               	.LM852:
 10160 37de 82A4      		ldd r8,Z+42
 10161 37e0 93A4      		ldd r9,Z+43
 10162 37e2 A4A4      		ldd r10,Z+44
 10163 37e4 B5A4      		ldd r11,Z+45
 10164               		.stabn	68,0,1714,.LM853-.LFBB38
 10165               	.LM853:
 10166 37e6 E114      		cp r14,__zero_reg__
 10167 37e8 F104      		cpc r15,__zero_reg__
 10168 37ea 0105      		cpc r16,__zero_reg__
 10169 37ec 1105      		cpc r17,__zero_reg__
 10170 37ee 01F0      		breq .L477
 10171               		.stabn	68,0,1715,.LM854-.LFBB38
 10172               	.LM854:
 10173 37f0 CF01      		movw r24,r30
 10174 37f2 B801      		movw r22,r16
 10175 37f4 A701      		movw r20,r14
 10176 37f6 0E94 0000 		call remove_chain
 10177 37fa 282F      		mov r18,r24
 10178               		.stabn	68,0,1716,.LM855-.LFBB38
 10179               	.LM855:
 10180 37fc 8823      		tst r24
 10181 37fe 01F0      		breq .+2
 10182 3800 00C0      		rjmp .L471
 10183               		.stabn	68,0,1717,.LM856-.LFBB38
 10184               	.LM856:
 10185 3802 ED85      		ldd r30,Y+13
 10186 3804 FE85      		ldd r31,Y+14
GAS LISTING /tmp/ccPugNTh.s 			page 235


 10187 3806 0894      		sec
 10188 3808 E108      		sbc r14,__zero_reg__
 10189 380a F108      		sbc r15,__zero_reg__
 10190 380c 0109      		sbc r16,__zero_reg__
 10191 380e 1109      		sbc r17,__zero_reg__
 10192 3810 E286      		std Z+10,r14
 10193 3812 F386      		std Z+11,r15
 10194 3814 0487      		std Z+12,r16
 10195 3816 1587      		std Z+13,r17
 10196               	.L477:
 10197               		.stabn	68,0,1719,.LM857-.LFBB38
 10198               	.LM857:
 10199 3818 8D85      		ldd r24,Y+13
 10200 381a 9E85      		ldd r25,Y+14
 10201 381c B501      		movw r22,r10
 10202 381e A401      		movw r20,r8
 10203 3820 0E94 0000 		call move_window
 10204 3824 282F      		mov r18,r24
 10205               		.stabn	68,0,1720,.LM858-.LFBB38
 10206               	.LM858:
 10207 3826 8823      		tst r24
 10208 3828 01F0      		breq .+2
 10209 382a 00C0      		rjmp .L471
 10210               	.L474:
 10211               		.stabn	68,0,1723,.LM859-.LFBB38
 10212               	.LM859:
 10213 382c 53FE      		sbrs r5,3
 10214 382e 00C0      		rjmp .L478
 10215               		.stabn	68,0,1724,.LM860-.LFBB38
 10216               	.LM860:
 10217 3830 D601      		movw r26,r12
 10218 3832 1B96      		adiw r26,11
 10219 3834 1C92      		st X,__zero_reg__
 10220               		.stabn	68,0,1725,.LM861-.LFBB38
 10221               	.LM861:
 10222 3836 0E94 0000 		call get_fattime
 10223               		.stabn	68,0,1726,.LM862-.LFBB38
 10224               	.LM862:
 10225 383a F601      		movw r30,r12
 10226 383c 6687      		std Z+14,r22
 10227 383e 272F      		mov r18,r23
 10228 3840 3327      		clr r19
 10229 3842 2787      		std Z+15,r18
 10230 3844 9C01      		movw r18,r24
 10231 3846 4427      		clr r20
 10232 3848 5527      		clr r21
 10233 384a 208B      		std Z+16,r18
 10234 384c 692F      		mov r22,r25
 10235 384e 7727      		clr r23
 10236 3850 8827      		clr r24
 10237 3852 9927      		clr r25
 10238 3854 618B      		std Z+17,r22
 10239               		.stabn	68,0,1727,.LM863-.LFBB38
 10240               	.LM863:
 10241 3856 ED85      		ldd r30,Y+13
 10242 3858 FE85      		ldd r31,Y+14
 10243 385a 81E0      		ldi r24,lo8(1)
GAS LISTING /tmp/ccPugNTh.s 			page 236


 10244 385c 8483      		std Z+4,r24
 10245               		.stabn	68,0,1728,.LM864-.LFBB38
 10246               	.LM864:
 10247 385e F0E2      		ldi r31,lo8(32)
 10248 3860 5F2A      		or r5,r31
 10249 3862 00C0      		rjmp .L478
 10250               	.L472:
 10251               	.LBE132:
 10252               		.stabn	68,0,1734,.LM865-.LFBB38
 10253               	.LM865:
 10254 3864 2223      		tst r18
 10255 3866 01F0      		breq .+2
 10256 3868 00C0      		rjmp .L471
 10257               		.stabn	68,0,1735,.LM866-.LFBB38
 10258               	.LM866:
 10259 386a CF8C      		ldd r12,Y+31
 10260 386c D8A0      		ldd r13,Y+32
 10261               		.stabn	68,0,1736,.LM867-.LFBB38
 10262               	.LM867:
 10263 386e C114      		cp r12,__zero_reg__
 10264 3870 D104      		cpc r13,__zero_reg__
 10265 3872 01F4      		brne .+2
 10266 3874 00C0      		rjmp .L479
 10267 3876 D601      		movw r26,r12
 10268 3878 1B96      		adiw r26,11
 10269 387a 8C91      		ld r24,X
 10270 387c 84FD      		sbrc r24,4
 10271 387e 00C0      		rjmp .L479
 10272               		.stabn	68,0,1739,.LM868-.LFBB38
 10273               	.LM868:
 10274 3880 51FE      		sbrs r5,1
 10275 3882 00C0      		rjmp .L478
 10276 3884 80FD      		sbrc r24,0
 10277 3886 00C0      		rjmp .L476
 10278               	.L478:
 10279               		.stabn	68,0,1742,.LM869-.LFBB38
 10280               	.LM869:
 10281 3888 ED85      		ldd r30,Y+13
 10282 388a FE85      		ldd r31,Y+14
 10283 388c 22A5      		ldd r18,Z+42
 10284 388e 33A5      		ldd r19,Z+43
 10285 3890 44A5      		ldd r20,Z+44
 10286 3892 55A5      		ldd r21,Z+45
 10287 3894 D301      		movw r26,r6
 10288 3896 5A96      		adiw r26,26
 10289 3898 2D93      		st X+,r18
 10290 389a 3D93      		st X+,r19
 10291 389c 4D93      		st X+,r20
 10292 389e 5C93      		st X,r21
 10293 38a0 5D97      		sbiw r26,26+3
 10294               		.stabn	68,0,1743,.LM870-.LFBB38
 10295               	.LM870:
 10296 38a2 8F8D      		ldd r24,Y+31
 10297 38a4 98A1      		ldd r25,Y+32
 10298 38a6 5F96      		adiw r26,30+1
 10299 38a8 9C93      		st X,r25
 10300 38aa 8E93      		st -X,r24
GAS LISTING /tmp/ccPugNTh.s 			page 237


 10301 38ac 5E97      		sbiw r26,30
 10302               		.stabn	68,0,1745,.LM871-.LFBB38
 10303               	.LM871:
 10304 38ae 1496      		adiw r26,4
 10305 38b0 5C92      		st X,r5
 10306               		.stabn	68,0,1746,.LM872-.LFBB38
 10307               	.LM872:
 10308 38b2 D601      		movw r26,r12
 10309 38b4 5596      		adiw r26,21
 10310 38b6 3C91      		ld r19,X
 10311 38b8 5597      		sbiw r26,21
 10312 38ba 20E0      		ldi r18,lo8(0)
 10313 38bc 5496      		adiw r26,20
 10314 38be 8C91      		ld r24,X
 10315 38c0 5497      		sbiw r26,20
 10316 38c2 90E0      		ldi r25,lo8(0)
 10317 38c4 282B      		or r18,r24
 10318 38c6 392B      		or r19,r25
 10319 38c8 40E0      		ldi r20,lo8(0)
 10320 38ca 50E0      		ldi r21,hi8(0)
 10321 38cc A901      		movw r20,r18
 10322 38ce 3327      		clr r19
 10323 38d0 2227      		clr r18
 10324 38d2 5B96      		adiw r26,27
 10325 38d4 9C91      		ld r25,X
 10326 38d6 5B97      		sbiw r26,27
 10327 38d8 80E0      		ldi r24,lo8(0)
 10328 38da 5A96      		adiw r26,26
 10329 38dc 6C91      		ld r22,X
 10330 38de 70E0      		ldi r23,lo8(0)
 10331 38e0 862B      		or r24,r22
 10332 38e2 972B      		or r25,r23
 10333 38e4 A0E0      		ldi r26,lo8(0)
 10334 38e6 B0E0      		ldi r27,hi8(0)
 10335 38e8 282B      		or r18,r24
 10336 38ea 392B      		or r19,r25
 10337 38ec 4A2B      		or r20,r26
 10338 38ee 5B2B      		or r21,r27
 10339 38f0 D301      		movw r26,r6
 10340 38f2 1E96      		adiw r26,14
 10341 38f4 2D93      		st X+,r18
 10342 38f6 3D93      		st X+,r19
 10343 38f8 4D93      		st X+,r20
 10344 38fa 5C93      		st X,r21
 10345 38fc 5197      		sbiw r26,14+3
 10346               		.stabn	68,0,1748,.LM873-.LFBB38
 10347               	.LM873:
 10348 38fe D601      		movw r26,r12
 10349 3900 5F96      		adiw r26,31
 10350 3902 2C91      		ld r18,X
 10351 3904 5F97      		sbiw r26,31
 10352 3906 30E0      		ldi r19,lo8(0)
 10353 3908 40E0      		ldi r20,lo8(0)
 10354 390a 50E0      		ldi r21,hi8(0)
 10355 390c 522F      		mov r21,r18
 10356 390e 4427      		clr r20
 10357 3910 3327      		clr r19
GAS LISTING /tmp/ccPugNTh.s 			page 238


 10358 3912 2227      		clr r18
 10359 3914 5E96      		adiw r26,30
 10360 3916 8C91      		ld r24,X
 10361 3918 90E0      		ldi r25,lo8(0)
 10362 391a A0E0      		ldi r26,lo8(0)
 10363 391c B0E0      		ldi r27,hi8(0)
 10364 391e DC01      		movw r26,r24
 10365 3920 9927      		clr r25
 10366 3922 8827      		clr r24
 10367 3924 282B      		or r18,r24
 10368 3926 392B      		or r19,r25
 10369 3928 4A2B      		or r20,r26
 10370 392a 5B2B      		or r21,r27
 10371 392c D601      		movw r26,r12
 10372 392e 5C96      		adiw r26,28
 10373 3930 8C91      		ld r24,X
 10374 3932 90E0      		ldi r25,lo8(0)
 10375 3934 A0E0      		ldi r26,lo8(0)
 10376 3936 B0E0      		ldi r27,hi8(0)
 10377 3938 282B      		or r18,r24
 10378 393a 392B      		or r19,r25
 10379 393c 4A2B      		or r20,r26
 10380 393e 5B2B      		or r21,r27
 10381 3940 D601      		movw r26,r12
 10382 3942 5D96      		adiw r26,29
 10383 3944 9C91      		ld r25,X
 10384 3946 80E0      		ldi r24,lo8(0)
 10385 3948 A0E0      		ldi r26,lo8(0)
 10386 394a B0E0      		ldi r27,hi8(0)
 10387 394c 282B      		or r18,r24
 10388 394e 392B      		or r19,r25
 10389 3950 4A2B      		or r20,r26
 10390 3952 5B2B      		or r21,r27
 10391 3954 D301      		movw r26,r6
 10392 3956 1A96      		adiw r26,10
 10393 3958 2D93      		st X+,r18
 10394 395a 3D93      		st X+,r19
 10395 395c 4D93      		st X+,r20
 10396 395e 5C93      		st X,r21
 10397 3960 1D97      		sbiw r26,10+3
 10398               		.stabn	68,0,1749,.LM874-.LFBB38
 10399               	.LM874:
 10400 3962 1696      		adiw r26,6
 10401 3964 1D92      		st X+,__zero_reg__
 10402 3966 1D92      		st X+,__zero_reg__
 10403 3968 1D92      		st X+,__zero_reg__
 10404 396a 1C92      		st X,__zero_reg__
 10405 396c 1997      		sbiw r26,6+3
 10406 396e 8FEF      		ldi r24,lo8(-1)
 10407 3970 1596      		adiw r26,5
 10408 3972 8C93      		st X,r24
 10409 3974 1597      		sbiw r26,5
 10410               		.stabn	68,0,1750,.LM875-.LFBB38
 10411               	.LM875:
 10412 3976 5696      		adiw r26,22
 10413 3978 1D92      		st X+,__zero_reg__
 10414 397a 1D92      		st X+,__zero_reg__
GAS LISTING /tmp/ccPugNTh.s 			page 239


 10415 397c 1D92      		st X+,__zero_reg__
 10416 397e 1C92      		st X,__zero_reg__
 10417 3980 5997      		sbiw r26,22+3
 10418               		.stabn	68,0,1751,.LM876-.LFBB38
 10419               	.LM876:
 10420 3982 1196      		adiw r26,1
 10421 3984 FC93      		st X,r31
 10422 3986 EE93      		st -X,r30
 10423 3988 8681      		ldd r24,Z+6
 10424 398a 9781      		ldd r25,Z+7
 10425 398c 1396      		adiw r26,2+1
 10426 398e 9C93      		st X,r25
 10427 3990 8E93      		st -X,r24
 10428 3992 1297      		sbiw r26,2
 10429 3994 20E0      		ldi r18,lo8(0)
 10430 3996 00C0      		rjmp .L471
 10431               	.L476:
 10432               		.stabn	68,0,1753,.LM877-.LFBB38
 10433               	.LM877:
 10434 3998 27E0      		ldi r18,lo8(7)
 10435 399a 00C0      		rjmp .L471
 10436               	.L479:
 10437 399c 24E0      		ldi r18,lo8(4)
 10438               	.L471:
 10439               		.stabn	68,0,1754,.LM878-.LFBB38
 10440               	.LM878:
 10441 399e 822F      		mov r24,r18
 10442               	/* epilogue start */
 10443 39a0 A496      		adiw r28,36
 10444 39a2 0FB6      		in __tmp_reg__,__SREG__
 10445 39a4 F894      		cli
 10446 39a6 DEBF      		out __SP_H__,r29
 10447 39a8 0FBE      		out __SREG__,__tmp_reg__
 10448 39aa CDBF      		out __SP_L__,r28
 10449 39ac CF91      		pop r28
 10450 39ae DF91      		pop r29
 10451 39b0 1F91      		pop r17
 10452 39b2 0F91      		pop r16
 10453 39b4 FF90      		pop r15
 10454 39b6 EF90      		pop r14
 10455 39b8 DF90      		pop r13
 10456 39ba CF90      		pop r12
 10457 39bc BF90      		pop r11
 10458 39be AF90      		pop r10
 10459 39c0 9F90      		pop r9
 10460 39c2 8F90      		pop r8
 10461 39c4 7F90      		pop r7
 10462 39c6 6F90      		pop r6
 10463 39c8 5F90      		pop r5
 10464 39ca 0895      		ret
 10465               		.size	f_open, .-f_open
 10466               		.stabs	"res:r(1,16)",64,0,1671,18
 10467               		.stabs	"dj:(1,9)",128,0,1672,13
 10468               		.stabs	"sfn:(0,24)",128,0,1673,1
 10469               		.stabs	"dir:r(1,8)",64,0,1674,12
 10470               		.stabn	192,0,0,.LFBB38-.LFBB38
 10471               		.stabs	"ps:r(2,12)",64,0,1692,8
GAS LISTING /tmp/ccPugNTh.s 			page 240


 10472               		.stabs	"cl:r(2,12)",64,0,1692,14
 10473               		.stabn	192,0,0,.LBB132-.LFBB38
 10474               		.stabn	224,0,0,.LBE132-.LFBB38
 10475               		.stabn	224,0,0,.Lscope38-.LFBB38
 10476               	.Lscope38:
 10477               		.stabs	"",36,0,0,.Lscope38-.LFBB38
 10478               		.stabd	78,0,0
 10479               		.data
 10480               		.type	cvt.1849, @object
 10481               		.size	cvt.1849, 128
 10482               	cvt.1849:
 10483 000b 80        		.byte	-128
 10484 000c 9A        		.byte	-102
 10485 000d 90        		.byte	-112
 10486 000e 41        		.byte	65
 10487 000f 8E        		.byte	-114
 10488 0010 41        		.byte	65
 10489 0011 8F        		.byte	-113
 10490 0012 80        		.byte	-128
 10491 0013 45        		.byte	69
 10492 0014 45        		.byte	69
 10493 0015 45        		.byte	69
 10494 0016 49        		.byte	73
 10495 0017 49        		.byte	73
 10496 0018 49        		.byte	73
 10497 0019 8E        		.byte	-114
 10498 001a 8F        		.byte	-113
 10499 001b 90        		.byte	-112
 10500 001c 92        		.byte	-110
 10501 001d 92        		.byte	-110
 10502 001e 4F        		.byte	79
 10503 001f 99        		.byte	-103
 10504 0020 4F        		.byte	79
 10505 0021 55        		.byte	85
 10506 0022 55        		.byte	85
 10507 0023 59        		.byte	89
 10508 0024 99        		.byte	-103
 10509 0025 9A        		.byte	-102
 10510 0026 9B        		.byte	-101
 10511 0027 9C        		.byte	-100
 10512 0028 9D        		.byte	-99
 10513 0029 9E        		.byte	-98
 10514 002a 9F        		.byte	-97
 10515 002b 41        		.byte	65
 10516 002c 49        		.byte	73
 10517 002d 4F        		.byte	79
 10518 002e 55        		.byte	85
 10519 002f A5        		.byte	-91
 10520 0030 A5        		.byte	-91
 10521 0031 A6        		.byte	-90
 10522 0032 A7        		.byte	-89
 10523 0033 A8        		.byte	-88
 10524 0034 A9        		.byte	-87
 10525 0035 AA        		.byte	-86
 10526 0036 AB        		.byte	-85
 10527 0037 AC        		.byte	-84
 10528 0038 21        		.byte	33
GAS LISTING /tmp/ccPugNTh.s 			page 241


 10529 0039 AE        		.byte	-82
 10530 003a AF        		.byte	-81
 10531 003b B0        		.byte	-80
 10532 003c B1        		.byte	-79
 10533 003d B2        		.byte	-78
 10534 003e B3        		.byte	-77
 10535 003f B4        		.byte	-76
 10536 0040 B5        		.byte	-75
 10537 0041 B6        		.byte	-74
 10538 0042 B7        		.byte	-73
 10539 0043 B8        		.byte	-72
 10540 0044 B9        		.byte	-71
 10541 0045 BA        		.byte	-70
 10542 0046 BB        		.byte	-69
 10543 0047 BC        		.byte	-68
 10544 0048 BD        		.byte	-67
 10545 0049 BE        		.byte	-66
 10546 004a BF        		.byte	-65
 10547 004b C0        		.byte	-64
 10548 004c C1        		.byte	-63
 10549 004d C2        		.byte	-62
 10550 004e C3        		.byte	-61
 10551 004f C4        		.byte	-60
 10552 0050 C5        		.byte	-59
 10553 0051 C6        		.byte	-58
 10554 0052 C7        		.byte	-57
 10555 0053 C8        		.byte	-56
 10556 0054 C9        		.byte	-55
 10557 0055 CA        		.byte	-54
 10558 0056 CB        		.byte	-53
 10559 0057 CC        		.byte	-52
 10560 0058 CD        		.byte	-51
 10561 0059 CE        		.byte	-50
 10562 005a CF        		.byte	-49
 10563 005b D0        		.byte	-48
 10564 005c D1        		.byte	-47
 10565 005d D2        		.byte	-46
 10566 005e D3        		.byte	-45
 10567 005f D4        		.byte	-44
 10568 0060 D5        		.byte	-43
 10569 0061 D6        		.byte	-42
 10570 0062 D7        		.byte	-41
 10571 0063 D8        		.byte	-40
 10572 0064 D9        		.byte	-39
 10573 0065 DA        		.byte	-38
 10574 0066 DB        		.byte	-37
 10575 0067 DC        		.byte	-36
 10576 0068 DD        		.byte	-35
 10577 0069 DE        		.byte	-34
 10578 006a DF        		.byte	-33
 10579 006b E0        		.byte	-32
 10580 006c E1        		.byte	-31
 10581 006d E2        		.byte	-30
 10582 006e E3        		.byte	-29
 10583 006f E4        		.byte	-28
 10584 0070 E5        		.byte	-27
 10585 0071 E6        		.byte	-26
GAS LISTING /tmp/ccPugNTh.s 			page 242


 10586 0072 E7        		.byte	-25
 10587 0073 E8        		.byte	-24
 10588 0074 E9        		.byte	-23
 10589 0075 EA        		.byte	-22
 10590 0076 EB        		.byte	-21
 10591 0077 EC        		.byte	-20
 10592 0078 ED        		.byte	-19
 10593 0079 EE        		.byte	-18
 10594 007a EF        		.byte	-17
 10595 007b F0        		.byte	-16
 10596 007c F1        		.byte	-15
 10597 007d F2        		.byte	-14
 10598 007e F3        		.byte	-13
 10599 007f F4        		.byte	-12
 10600 0080 F5        		.byte	-11
 10601 0081 F6        		.byte	-10
 10602 0082 F7        		.byte	-9
 10603 0083 F8        		.byte	-8
 10604 0084 F9        		.byte	-7
 10605 0085 FA        		.byte	-6
 10606 0086 FB        		.byte	-5
 10607 0087 FC        		.byte	-4
 10608 0088 FD        		.byte	-3
 10609 0089 FE        		.byte	-2
 10610 008a FF        		.byte	-1
 10611               		.lcomm FatFs,2
 10612               		.lcomm Fsid,2
 10613               		.stabs	"cvt:V(0,35)=ar(1,4);0;127;(0,27)",38,0,1103,cvt.1849
 10614               		.stabs	"FatFs:S(0,36)=ar(1,4);0;0;(1,7)",40,0,133,FatFs
 10615               		.stabs	"Fsid:S(2,8)",40,0,136,Fsid
 10616               		.text
 10617               		.stabs	"",100,0,0,.Letext0
 10618               	.Letext0:
GAS LISTING /tmp/ccPugNTh.s 			page 243


DEFINED SYMBOLS
                            *ABS*:0000000000000000 ff.c
     /tmp/ccPugNTh.s:2      *ABS*:000000000000003f __SREG__
     /tmp/ccPugNTh.s:3      *ABS*:000000000000003e __SP_H__
     /tmp/ccPugNTh.s:4      *ABS*:000000000000003d __SP_L__
     /tmp/ccPugNTh.s:5      *ABS*:0000000000000034 __CCP__
     /tmp/ccPugNTh.s:6      *ABS*:0000000000000000 __tmp_reg__
     /tmp/ccPugNTh.s:7      *ABS*:0000000000000001 __zero_reg__
     /tmp/ccPugNTh.s:73     .text:0000000000000000 clust2sect
     /tmp/ccPugNTh.s:159    .text:000000000000007a get_fileinfo
     /tmp/ccPugNTh.s:371    .text:0000000000000192 f_mount
                             .bss:0000000000000000 FatFs
     /tmp/ccPugNTh.s:425    .text:00000000000001bc move_window
     /tmp/ccPugNTh.s:603    .text:00000000000002ae put_fat
     /tmp/ccPugNTh.s:911    .text:0000000000000486 get_fat
     /tmp/ccPugNTh.s:1198   .text:000000000000065a dir_seek
     /tmp/ccPugNTh.s:1531   .text:0000000000000852 create_chain
     /tmp/ccPugNTh.s:1850   .text:0000000000000a3a remove_chain
     /tmp/ccPugNTh.s:2022   .text:0000000000000b30 dir_remove
     /tmp/ccPugNTh.s:2087   .text:0000000000000b72 dir_next
     /tmp/ccPugNTh.s:2609   .text:0000000000000e6c follow_path
     /tmp/ccPugNTh.s:10482  .data:000000000000000b cvt.1849
     /tmp/ccPugNTh.s:3125   .text:00000000000010bc dir_register
     /tmp/ccPugNTh.s:3285   .text:000000000000116a dir_read
     /tmp/ccPugNTh.s:3388   .text:00000000000011d2 check_fs
     /tmp/ccPugNTh.s:3545   .text:00000000000012d8 sync
     /tmp/ccPugNTh.s:3748   .text:00000000000013f6 validate
     /tmp/ccPugNTh.s:3792   .text:0000000000001422 f_truncate
     /tmp/ccPugNTh.s:3995   .text:000000000000153c f_readdir
     /tmp/ccPugNTh.s:4124   .text:00000000000015de f_lseek
     /tmp/ccPugNTh.s:4768   .text:00000000000019ce f_sync
     /tmp/ccPugNTh.s:4931   .text:0000000000001ab0 f_close
     /tmp/ccPugNTh.s:4970   .text:0000000000001ac8 f_write
     /tmp/ccPugNTh.s:5629   .text:0000000000001e7a f_putc
     /tmp/ccPugNTh.s:5715   .text:0000000000001ee4 f_puts
     /tmp/ccPugNTh.s:5782   .text:0000000000001f2c f_printf
     /tmp/ccPugNTh.s:6276   .text:00000000000021ea f_read
     /tmp/ccPugNTh.s:6813   .text:00000000000024d8 f_gets
     /tmp/ccPugNTh.s:6941   .text:0000000000002578 chk_mounted
     /tmp/ccPugNTh.s:10611  .bss:0000000000000002 Fsid
     /tmp/ccPugNTh.s:7808   .text:0000000000002b26 f_rename
     /tmp/ccPugNTh.s:8246   .text:0000000000002d80 f_utime
     /tmp/ccPugNTh.s:8376   .text:0000000000002e26 f_chmod
     /tmp/ccPugNTh.s:8496   .text:0000000000002ebc f_mkdir
     /tmp/ccPugNTh.s:9072   .text:00000000000031e2 f_unlink
     /tmp/ccPugNTh.s:9318   .text:0000000000003322 f_getfree
     /tmp/ccPugNTh.s:9712   .text:000000000000357a f_stat
     /tmp/ccPugNTh.s:9818   .text:0000000000003604 f_opendir
     /tmp/ccPugNTh.s:9974   .text:00000000000036d6 f_open

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
__mulsi3
disk_write
disk_read
disk_ioctl
GAS LISTING /tmp/ccPugNTh.s 			page 244


disk_status
__udivmodsi4
get_fattime
disk_initialize
